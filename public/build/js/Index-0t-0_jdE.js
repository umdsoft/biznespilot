import{r as t,b as e,o as a,v as s,x as r,z as i,H as l,A as n,I as o,K as d,D as c,C as u,E as g,B as x,F as y,G as p,L as m}from"./chunk-7Urb0kxg.js";import{_ as h}from"./chunk-NrbfQB88.js";import{a as k}from"./chunk-DKkye6wf.js";import{u as v}from"./app-DFslr8vl.js";import"./chunk-Dm-LAqtr.js";import"./chunk-Dg8ilgYs.js";import"./chunk-Rl16a4N0.js";import"./chunk-C1ExV0Y3.js";import"./chunk-DUcDuGHI.js";import"./chunk-C3XJH04c.js";import"./chunk-D2XW56yD.js";import"./chunk-DS-Zp4Qb.js";import"./chunk-Sfe4u6kO.js";import"./chunk-BAC6lhkp.js";import"./chunk-BugzYCIx.js";import"./chunk-ab1b1Fp4.js";import"./chunk-DhwSyUm1.js";import"./chunk-9PkX4iPz.js";import"./chunk-DOBCiesv.js";import"./chunk-YGW1Cp7-.js";import"./chunk-afst19KZ.js";import"./chunk-D4tA7yBb.js";import"./chunk-Di7Oc7TS.js";const b={class:"py-6"},w={class:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8"},f={class:"mb-6 flex items-center justify-between"},_={class:"text-xl font-semibold text-gray-900 dark:text-white"},j={class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},A={class:"flex items-center gap-3"},B={value:"7"},M={value:"30"},C={value:"90"},F={value:"365"},$=["disabled"],G={class:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},L={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},z={class:"flex items-center gap-3"},V={class:"text-2xl font-semibold text-gray-900 dark:text-white"},H={class:"text-xs text-gray-500 dark:text-gray-400"},I={class:"text-xs text-green-600 dark:text-green-400 flex items-center mt-0.5"},R={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},q={class:"flex items-center gap-3"},D={class:"text-2xl font-semibold text-gray-900 dark:text-white"},E={class:"text-xs text-gray-500 dark:text-gray-400"},K={class:"text-xs text-gray-400 dark:text-gray-500 mt-0.5"},O={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},U={class:"flex items-center gap-3"},Z={class:"text-2xl font-semibold text-gray-900 dark:text-white"},J={class:"text-xs text-gray-500 dark:text-gray-400"},N={class:"text-xs text-gray-400 dark:text-gray-500 mt-0.5"},P={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},Q={class:"flex items-center gap-3"},S={class:"text-xs text-gray-500 dark:text-gray-400"},T={class:"text-xs text-gray-400 dark:text-gray-500 mt-0.5"},W={class:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6"},X={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},Y={class:"flex items-center justify-between mb-4"},tt={class:"text-sm font-medium text-gray-900 dark:text-white"},et={class:"h-48"},at={class:"w-full h-full",viewBox:"0 0 400 150",preserveAspectRatio:"none"},st=["y1","y2"],rt=["d"],it=["d"],lt=["cx","cy"],nt={class:"flex justify-between mt-2 text-xs text-gray-500 dark:text-gray-400"},ot={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},dt={class:"flex items-center justify-between mb-4"},ct={class:"text-sm font-medium text-gray-900 dark:text-white"},ut={class:"h-48"},gt={class:"w-full h-full",viewBox:"0 0 400 150",preserveAspectRatio:"none"},xt=["y1","y2"],yt=["d"],pt=["d"],mt=["cx","cy"],ht={class:"flex justify-between mt-2 text-xs text-gray-500 dark:text-gray-400"},kt={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden"},vt={class:"px-4 py-3 border-b border-gray-200 dark:border-gray-700"},bt={class:"text-sm font-medium text-gray-900 dark:text-white"},wt={class:"p-4"},ft={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},_t={class:"flex items-center justify-between mb-2"},jt={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},At={class:"text-2xl font-semibold text-gray-900 dark:text-white"},Bt={class:"text-xs text-gray-500 dark:text-gray-400"},Mt={key:0,class:"col-span-4 py-8 text-center text-sm text-gray-500 dark:text-gray-400"},Ct={__name:"Index",props:{initialAnalytics:{type:Object,default:()=>({})}},setup(Ct){const{t:Ft}=v(),$t=Ct,Gt=t(!1),Lt=t("30"),zt=t({active_subscriptions:$t.initialAnalytics.active_subscriptions||0,subscription_growth:$t.initialAnalytics.subscription_growth||0,avg_campaigns:$t.initialAnalytics.average_campaigns_per_business?.toFixed(1)||"0.0",avg_conversations:$t.initialAnalytics.average_conversations_per_business?.toFixed(1)||"0.0",churn_rate:$t.initialAnalytics.churn_rate||0,user_growth:$t.initialAnalytics.user_growth||[],business_growth:$t.initialAnalytics.business_growth||[],top_industries:$t.initialAnalytics.top_industries||[]}),Vt=e(()=>zt.value.user_growth?zt.value.user_growth.map(t=>t.count):[]),Ht=e(()=>zt.value.business_growth?zt.value.business_growth.map(t=>t.count):[]),It=(t,e=400,a=150,s=10)=>{if(!t||0===t.length)return[];const r=Math.max(...t,1),i=(e-2*s)/(t.length-1||1);return t.map((t,e)=>({x:s+e*i,y:a-s-t/r*(a-2*s)}))},Rt=e(()=>It(Vt.value)),qt=e(()=>It(Ht.value)),Dt=t=>t&&0!==t.length?t.map((t,e)=>`${0===e?"M":"L"} ${t.x} ${t.y}`).join(" "):"",Et=(t,e=150)=>{if(!t||0===t.length)return"";return`${Dt(t)} L ${t[t.length-1].x} ${e} L ${t[0].x} ${e} Z`},Kt=e(()=>Dt(Rt.value)),Ot=e(()=>Et(Rt.value)),Ut=e(()=>Dt(qt.value)),Zt=e(()=>Et(qt.value)),Jt=async()=>{Gt.value=!0;try{const t=await k.get("/admin/analytics",{params:{period:Lt.value}});zt.value={active_subscriptions:t.data.analytics.active_subscriptions||0,subscription_growth:t.data.analytics.subscription_growth||0,avg_campaigns:t.data.analytics.average_campaigns_per_business?.toFixed(1)||"0.0",avg_conversations:t.data.analytics.average_conversations_per_business?.toFixed(1)||"0.0",churn_rate:t.data.analytics.churn_rate||0,user_growth:t.data.analytics.user_growth||[],business_growth:t.data.analytics.business_growth||[],top_industries:t.data.analytics.top_industries||[]}}catch(t){}finally{Gt.value=!1}};return a(()=>{$t.initialAnalytics.active_subscriptions||Jt()}),(t,e)=>(g(),s(h,{title:n(Ft)("admin.analytics.title")},{default:r(()=>[i("div",b,[i("div",w,[i("div",f,[i("div",null,[i("h1",_,l(n(Ft)("admin.analytics.title")),1),i("p",j,l(n(Ft)("admin.analytics.subtitle")),1)]),i("div",A,[o(i("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>Lt.value=t),class:"px-3 py-2 text-sm border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[i("option",B,l(n(Ft)("admin.analytics.last_7_days")),1),i("option",M,l(n(Ft)("admin.analytics.last_30_days")),1),i("option",C,l(n(Ft)("admin.analytics.last_90_days")),1),i("option",F,l(n(Ft)("admin.analytics.last_year")),1)],512),[[d,Lt.value]]),i("button",{onClick:Jt,disabled:Gt.value,class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-lg transition-colors disabled:opacity-50"},[(g(),c("svg",{class:x(["w-4 h-4",Gt.value?"animate-spin":""]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...e[1]||(e[1]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),u(" "+l(n(Ft)("admin.analytics.refresh")),1)],8,$)])]),i("div",G,[i("div",L,[i("div",z,[e[3]||(e[3]=i("div",{class:"w-10 h-10 bg-green-50 dark:bg-green-900/30 rounded-lg flex items-center justify-center"},[i("svg",{class:"w-5 h-5 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),i("div",null,[i("p",V,l(zt.value.active_subscriptions),1),i("p",H,l(n(Ft)("admin.analytics.active_subscriptions")),1),i("p",I,[e[2]||(e[2]=i("svg",{class:"w-3 h-3 mr-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[i("path",{"fill-rule":"evenodd",d:"M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),u(" +"+l(zt.value.subscription_growth)+"% ",1)])])])]),i("div",R,[i("div",q,[e[4]||(e[4]=i("div",{class:"w-10 h-10 bg-blue-50 dark:bg-blue-900/30 rounded-lg flex items-center justify-center"},[i("svg",{class:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})])],-1)),i("div",null,[i("p",D,l(zt.value.avg_campaigns),1),i("p",E,l(n(Ft)("admin.analytics.avg_campaigns")),1),i("p",K,l(n(Ft)("admin.analytics.per_business")),1)])])]),i("div",O,[i("div",U,[e[5]||(e[5]=i("div",{class:"w-10 h-10 bg-purple-50 dark:bg-purple-900/30 rounded-lg flex items-center justify-center"},[i("svg",{class:"w-5 h-5 text-purple-600 dark:text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1)),i("div",null,[i("p",Z,l(zt.value.avg_conversations),1),i("p",J,l(n(Ft)("admin.analytics.avg_conversations")),1),i("p",N,l(n(Ft)("admin.analytics.per_business")),1)])])]),i("div",P,[i("div",Q,[e[6]||(e[6]=i("div",{class:"w-10 h-10 bg-orange-50 dark:bg-orange-900/30 rounded-lg flex items-center justify-center"},[i("svg",{class:"w-5 h-5 text-orange-600 dark:text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})])],-1)),i("div",null,[i("p",{class:x(["text-2xl font-semibold",zt.value.churn_rate>5?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"])},l(zt.value.churn_rate)+"% ",3),i("p",S,l(n(Ft)("admin.analytics.churn_rate")),1),i("p",T,l(n(Ft)("admin.analytics.this_month")),1)])])])]),i("div",W,[i("div",X,[i("div",Y,[i("h3",tt,l(n(Ft)("admin.dashboard.users_growth")),1)]),i("div",et,[(g(),c("svg",at,[(g(),c(y,null,p(5,t=>i("line",{key:t,x1:"0",y1:37.5*(t-1),x2:"400",y2:37.5*(t-1),stroke:"currentColor",class:"text-gray-100 dark:text-gray-700","stroke-width":"1"},null,8,st)),64)),i("path",{d:Ot.value,fill:"url(#usersGradientAnalytics)",opacity:"0.3"},null,8,rt),i("path",{d:Kt.value,fill:"none",stroke:"#3B82F6","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,8,it),(g(!0),c(y,null,p(Rt.value,(t,e)=>(g(),c("circle",{key:e,cx:t.x,cy:t.y,r:"4",fill:"#3B82F6"},null,8,lt))),128)),e[7]||(e[7]=i("defs",null,[i("linearGradient",{id:"usersGradientAnalytics",x1:"0",y1:"0",x2:"0",y2:"1"},[i("stop",{offset:"0%","stop-color":"#3B82F6"}),i("stop",{offset:"100%","stop-color":"#3B82F6","stop-opacity":"0"})])],-1))]))]),i("div",nt,[(g(!0),c(y,null,p(zt.value.user_growth,(t,e)=>(g(),c("span",{key:e},l(t.month),1))),128))])]),i("div",ot,[i("div",dt,[i("h3",ct,l(n(Ft)("admin.dashboard.businesses_growth")),1)]),i("div",ut,[(g(),c("svg",gt,[(g(),c(y,null,p(5,t=>i("line",{key:t,x1:"0",y1:37.5*(t-1),x2:"400",y2:37.5*(t-1),stroke:"currentColor",class:"text-gray-100 dark:text-gray-700","stroke-width":"1"},null,8,xt)),64)),i("path",{d:Zt.value,fill:"url(#businessesGradientAnalytics)",opacity:"0.3"},null,8,yt),i("path",{d:Ut.value,fill:"none",stroke:"#10B981","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,8,pt),(g(!0),c(y,null,p(qt.value,(t,e)=>(g(),c("circle",{key:e,cx:t.x,cy:t.y,r:"4",fill:"#10B981"},null,8,mt))),128)),e[8]||(e[8]=i("defs",null,[i("linearGradient",{id:"businessesGradientAnalytics",x1:"0",y1:"0",x2:"0",y2:"1"},[i("stop",{offset:"0%","stop-color":"#10B981"}),i("stop",{offset:"100%","stop-color":"#10B981","stop-opacity":"0"})])],-1))]))]),i("div",ht,[(g(!0),c(y,null,p(zt.value.business_growth,(t,e)=>(g(),c("span",{key:e},l(t.month),1))),128))])])]),i("div",kt,[i("div",vt,[i("h3",bt,l(n(Ft)("admin.analytics.top_industries")),1)]),i("div",wt,[i("div",ft,[(g(!0),c(y,null,p(zt.value.top_industries,(t,e)=>(g(),c("div",{key:t.name,class:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4"},[i("div",_t,[i("span",jt,l(t.name),1),i("span",{class:x(["px-2 py-0.5 text-xs font-medium rounded",{"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":0===e,"bg-gray-100 text-gray-600 dark:bg-gray-600 dark:text-gray-300":1===e,"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":2===e,"bg-gray-50 text-gray-500 dark:bg-gray-700 dark:text-gray-400":e>2}])}," #"+l(e+1),3)]),i("p",At,l(t.count),1),i("p",Bt,l(n(Ft)("admin.analytics.businesses")),1)]))),128)),zt.value.top_industries&&0!==zt.value.top_industries.length?m("",!0):(g(),c("div",Mt,l(n(Ft)("admin.common.no_data")),1))])])])])])]),_:1},8,["title"]))}};export{Ct as default};
