import{b as e,r,w as a,v as t,x as l,L as s,y as d,A as o,B as i,N as n,C as u,I as g,D as p,J as c,K as b,E as m,z as x,O as y,F as h,G as f,H as k,P as v}from"./chunk-CpmtkKLp.js";import{u as w,h as _,l as j}from"./chunk-BhZp3z4u.js";import{_ as C}from"./chunk-D7SyfRoT.js";import{_ as T}from"./chunk-DbFbpSR2.js";import{_ as U}from"./chunk-BHCorYK2.js";import{_ as V}from"./chunk-Cb_-eVu9.js";import{r as z}from"./chunk-BuJDoypK.js";import{r as S}from"./chunk--c0I9cx_.js";import{r as Y}from"./chunk-CDwIUdYJ.js";import{r as q}from"./chunk-eMHYSAeQ.js";import{a as L}from"./chunk-De_qwhex.js";import{r as M}from"./chunk-DNKDGYPp.js";import{r as A}from"./chunk-yvcCPqrN.js";import{r as B}from"./chunk-CAoK8Mdm.js";import{r as I}from"./chunk-BvbZUszZ.js";import{r as N}from"./chunk-BiW1c8q7.js";import{r as O}from"./chunk-DCXiFUg-.js";import{r as Q}from"./chunk-Bsc1JRL5.js";import{r as F}from"./chunk-CBAnz7Zv.js";import{r as K}from"./chunk-C-9FsB6U.js";import"./app-C-ZlocOh.js";import"./chunk-BWiubfpN.js";import"./chunk-CouA7u-j.js";import"./chunk-DmrwHl-6.js";import"./chunk-beXL1A--.js";import"./chunk-BiBvtcLb.js";import"./chunk-CTIk0k8a.js";import"./chunk-dqIIyBTR.js";import"./chunk-CvscUVdi.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-3cs9K1fB.js";import"./chunk-BG5DB3cD.js";import"./chunk-CdKrFGoA.js";import"./chunk-DvBKKKMs.js";const $={class:"py-6 min-h-screen bg-gradient-to-br from-gray-50 via-white to-purple-50/30 dark:from-gray-900 dark:via-gray-800 dark:to-purple-900/20"},D={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},P={class:"mb-8"},R={class:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3"},E={class:"w-12 h-12 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg"},G={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden"},H={class:"px-6 py-4 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/30 dark:to-indigo-900/30 border-b border-purple-100 dark:border-purple-800"},J={class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},X={class:"p-6"},Z={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},W=["onClick"],ee={class:"flex items-start justify-between mb-2"},re={class:"font-bold text-gray-900 dark:text-white"},ae={class:"flex items-center justify-between text-sm"},te={class:"text-purple-600 font-semibold"},le={class:"text-green-600"},se={class:"mt-2 text-xs text-gray-500"},de={key:0,class:"mt-2 text-sm text-red-600"},oe={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden"},ie={class:"px-6 py-4 bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/30 dark:to-cyan-900/30 border-b border-blue-100 dark:border-blue-800"},ne={class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},ue={class:"p-6"},ge={class:"grid grid-cols-2 md:grid-cols-5 gap-3"},pe=["onClick"],ce={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden"},be={class:"px-6 py-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 border-b border-green-100 dark:border-green-800"},me={class:"flex items-center justify-between"},xe={class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},ye={class:"ml-2 px-2.5 py-0.5 bg-green-100 text-green-700 rounded-full text-sm"},he={class:"p-6"},fe={class:"flex flex-wrap items-center gap-4 mb-4"},ke={class:"relative flex-1 min-w-48"},ve=["value"],we={class:"flex items-center gap-2 cursor-pointer"},_e={class:"max-h-96 overflow-y-auto border border-gray-200 dark:border-gray-600 rounded-xl"},je=["onClick"],Ce={class:"flex-shrink-0"},Te={class:"flex-1 min-w-0"},Ue={class:"font-medium text-gray-900 dark:text-white truncate"},Ve={class:"text-sm text-gray-500 truncate"},ze={class:"flex items-center gap-2"},Se={key:0,class:"p-8 text-center text-gray-500"},Ye={key:0,class:"mt-2 text-sm text-red-600"},qe={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden"},Le={class:"px-6 py-4 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/30 dark:to-orange-900/30 border-b border-yellow-100 dark:border-yellow-800"},Me={class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},Ae={class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},Be={class:"relative"},Ie=["placeholder"],Ne={class:"p-4 bg-green-50 dark:bg-green-900/30 rounded-xl"},Oe={class:"text-2xl font-bold text-green-800 dark:text-green-300"},Qe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Fe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Ke={class:"md:col-span-2"},$e={class:"md:col-span-2"},De={class:"flex items-center gap-3 cursor-pointer"},Pe=["disabled"],Re={class:"flex items-center justify-between p-6 bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700"},Ee={class:"text-gray-600 dark:text-gray-400"},Ge={class:"font-semibold text-purple-600"},He={class:"font-semibold"},Je=["disabled"],Xe={__name:"Create",props:{panelType:String,offers:Array,leads:Array,channels:Object},setup(Xe){const Ze=Xe,We=e(()=>({business:T,saleshead:U,operator:V}[Ze.panelType]||C)),er=()=>({saleshead:"sales-head",business:"business",operator:"operator"}[Ze.panelType]||Ze.panelType),rr=w({offer_id:"",lead_ids:[],channel:"telegram",custom_price:null,discount:null,discount_code:"",scheduled_at:"",expires_at:"",notes:"",send_immediately:!0}),ar=e(()=>Ze.offers.find(e=>e.id===rr.offer_id)),tr=r(""),lr=r(""),sr=r(!1),dr=e(()=>{let e=Ze.leads;if(tr.value){const r=tr.value.toLowerCase();e=e.filter(e=>e.name?.toLowerCase().includes(r)||e.phone?.includes(r)||e.email?.toLowerCase().includes(r))}return lr.value&&(e=e.filter(e=>e.status===lr.value)),sr.value&&(e=e.filter(e=>e.has_telegram)),e}),or=e(()=>dr.value.length>0&&dr.value.every(e=>rr.lead_ids.includes(e.id))),ir=()=>{if(or.value)rr.lead_ids=rr.lead_ids.filter(e=>!dr.value.find(r=>r.id===e));else{const e=dr.value.map(e=>e.id);rr.lead_ids=[...new Set([...rr.lead_ids,...e])]}},nr=e=>e?new Intl.NumberFormat("uz-UZ").format(e):"0",ur=e(()=>{const e=rr.custom_price||ar.value?.pricing||0,r=rr.discount||0;return Math.max(0,e-r)}),gr=()=>{rr.post(route(`${er()}.offer-automation.store`))};a(()=>rr.channel,e=>{"telegram"===e&&(sr.value=!0)});const pr={new:"Yangi",contacted:"Bog'lanildi",qualified:"Malakali",proposal:"Taklif",negotiation:"Muzokara"};return(e,r)=>(p(),t(y(We.value),{title:"Taklif Yuborish"},{default:l(()=>[s(o(_),{title:"Taklif Yuborish"}),d("div",$,[d("div",D,[d("div",P,[s(o(j),{href:e.route(`${er()}.offer-automation.index`),class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-purple-600 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-4"},{default:l(()=>[s(o(z),{class:"w-4 h-4"}),r[10]||(r[10]=i(" Orqaga ",-1))]),_:1},8,["href"]),d("h1",R,[d("div",E,[s(o(S),{class:"w-6 h-6 text-white"})]),r[11]||(r[11]=i(" Taklif Yuborish ",-1))]),r[12]||(r[12]=d("p",{class:"text-gray-500 dark:text-gray-400 mt-2"}," Tanlangan lidlarga taklif yuborish ",-1))]),d("form",{onSubmit:n(gr,["prevent"]),class:"space-y-6"},[d("div",G,[d("div",H,[d("h2",J,[s(o(Y),{class:"w-5 h-5 text-purple-600"}),r[13]||(r[13]=i(" 1. Taklifni Tanlang ",-1))])]),d("div",X,[d("div",Z,[(p(!0),u(c,null,b(Xe.offers,e=>(p(),u("div",{key:e.id,onClick:r=>o(rr).offer_id=e.id,class:m(["p-4 border-2 rounded-xl cursor-pointer transition-all",o(rr).offer_id===e.id?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-600 hover:border-purple-300"])},[d("div",ee,[d("h3",re,x(e.name),1),o(rr).offer_id===e.id?(p(),t(o(q),{key:0,class:"w-6 h-6 text-purple-600"})):g("",!0)]),d("div",ae,[d("span",te,x(nr(e.pricing))+" so'm",1),d("span",le,x(e.conversion_rate)+"% CR",1)]),d("div",se," Qiymat bali: "+x(e.value_score),1)],10,W))),128))]),o(rr).errors.offer_id?(p(),u("p",de,x(o(rr).errors.offer_id),1)):g("",!0)])]),d("div",oe,[d("div",ie,[d("h2",ne,[s(o(L),{class:"w-5 h-5 text-blue-600"}),r[14]||(r[14]=i(" 2. Kanal Tanlang ",-1))])]),d("div",ue,[d("div",ge,[(p(!0),u(c,null,b(Xe.channels,(e,r)=>{return p(),u("button",{key:r,type:"button",onClick:e=>o(rr).channel=r,class:m(["p-4 border-2 rounded-xl flex flex-col items-center gap-2 transition-all",o(rr).channel===r?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-blue-300"])},[(p(),t(y((a=r,{telegram:L,sms:K,email:F,whatsapp:L,manual:M}[a]||L)),{class:m(["w-6 h-6",o(rr).channel===r?"text-blue-600":"text-gray-400"])},null,8,["class"])),d("span",{class:m(["text-sm font-medium",o(rr).channel===r?"text-blue-600":"text-gray-600 dark:text-gray-400"])},x(e),3)],10,pe);var a}),128))])])]),d("div",ce,[d("div",be,[d("div",me,[d("h2",xe,[s(o(M),{class:"w-5 h-5 text-green-600"}),r[15]||(r[15]=i(" 3. Lidlarni Tanlang ",-1)),d("span",ye,x(o(rr).lead_ids.length)+" ta tanlandi ",1)])])]),d("div",he,[d("div",fe,[d("div",ke,[s(o(A),{class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),h(d("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>tr.value=e),type:"text",placeholder:"Ism, telefon yoki email...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[f,tr.value]])]),h(d("select",{"onUpdate:modelValue":r[1]||(r[1]=e=>lr.value=e),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[r[16]||(r[16]=d("option",{value:""},"Barcha holatlar",-1)),(p(),u(c,null,b(pr,(e,r)=>d("option",{key:r,value:r},x(e),9,ve)),64))],512),[[k,lr.value]]),d("label",we,[h(d("input",{type:"checkbox","onUpdate:modelValue":r[2]||(r[2]=e=>sr.value=e),class:"w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500"},null,512),[[v,sr.value]]),r[17]||(r[17]=d("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Faqat Telegram",-1))]),d("button",{type:"button",onClick:ir,class:"px-4 py-2 text-sm font-medium text-purple-600 hover:text-purple-700 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors"},x(or.value?"Barchasini olib tashlash":"Barchasini tanlash"),1)]),d("div",_e,[(p(!0),u(c,null,b(dr.value,e=>(p(),u("div",{key:e.id,onClick:r=>(e=>{const r=rr.lead_ids.indexOf(e);r>-1?rr.lead_ids.splice(r,1):rr.lead_ids.push(e)})(e.id),class:m(["flex items-center gap-4 p-4 border-b border-gray-100 dark:border-gray-700 last:border-b-0 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",{"bg-purple-50 dark:bg-purple-900/20":o(rr).lead_ids.includes(e.id)}])},[d("div",Ce,[d("div",{class:m(["w-6 h-6 rounded border-2 flex items-center justify-center transition-colors",o(rr).lead_ids.includes(e.id)?"bg-purple-600 border-purple-600":"border-gray-300 dark:border-gray-600"])},[o(rr).lead_ids.includes(e.id)?(p(),t(o(B),{key:0,class:"w-4 h-4 text-white"})):g("",!0)],2)]),d("div",Te,[d("p",Ue,x(e.name),1),d("p",Ve,x(e.phone),1)]),d("div",ze,[d("span",{class:m(["px-2 py-1 text-xs font-medium rounded-full",{"bg-blue-100 text-blue-700":"new"===e.status,"bg-yellow-100 text-yellow-700":"contacted"===e.status,"bg-green-100 text-green-700":"qualified"===e.status,"bg-purple-100 text-purple-700":"proposal"===e.status,"bg-orange-100 text-orange-700":"negotiation"===e.status}])},x(pr[e.status]),3),e.has_telegram?(p(),t(o(L),{key:0,class:"w-5 h-5 text-blue-500",title:"Telegram mavjud"})):g("",!0)])],10,je))),128)),0===dr.value.length?(p(),u("div",Se," Lidlar topilmadi ")):g("",!0)]),o(rr).errors.lead_ids?(p(),u("p",Ye,x(o(rr).errors.lead_ids),1)):g("",!0)])]),d("div",qe,[d("div",Le,[d("h2",Me,[s(o(I),{class:"w-5 h-5 text-yellow-600"}),r[18]||(r[18]=i(" 4. Qo'shimcha Sozlamalar ",-1))])]),d("div",Ae,[d("div",null,[r[19]||(r[19]=d("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Maxsus Narx (ixtiyoriy) ",-1)),d("div",Be,[s(o(N),{class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),h(d("input",{"onUpdate:modelValue":r[3]||(r[3]=e=>o(rr).custom_price=e),type:"number",placeholder:ar.value?nr(ar.value.pricing):"0",class:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,8,Ie),[[f,o(rr).custom_price,void 0,{number:!0}]])])]),d("div",null,[r[20]||(r[20]=d("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Chegirma Summasi ",-1)),h(d("input",{"onUpdate:modelValue":r[4]||(r[4]=e=>o(rr).discount=e),type:"number",placeholder:"0",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[f,o(rr).discount,void 0,{number:!0}]])]),d("div",null,[r[21]||(r[21]=d("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Chegirma Kodi ",-1)),h(d("input",{"onUpdate:modelValue":r[5]||(r[5]=e=>o(rr).discount_code=e),type:"text",placeholder:"MAXSUS20",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[f,o(rr).discount_code]])]),d("div",Ne,[r[22]||(r[22]=d("p",{class:"text-sm text-green-700 dark:text-green-400 mb-1"},"Yakuniy Narx",-1)),d("p",Oe,x(nr(ur.value))+" so'm",1)]),d("div",null,[d("label",Qe,[s(o(O),{class:"w-4 h-4 inline mr-1"}),r[23]||(r[23]=i(" Rejalashtirilgan Vaqt ",-1))]),h(d("input",{"onUpdate:modelValue":r[6]||(r[6]=e=>o(rr).scheduled_at=e),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[f,o(rr).scheduled_at]])]),d("div",null,[d("label",Fe,[s(o(Q),{class:"w-4 h-4 inline mr-1"}),r[24]||(r[24]=i(" Amal Qilish Muddati ",-1))]),h(d("input",{"onUpdate:modelValue":r[7]||(r[7]=e=>o(rr).expires_at=e),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[f,o(rr).expires_at]])]),d("div",Ke,[r[25]||(r[25]=d("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Qo'shimcha Izoh ",-1)),h(d("textarea",{"onUpdate:modelValue":r[8]||(r[8]=e=>o(rr).notes=e),rows:"2",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Ichki izohlar..."},null,512),[[f,o(rr).notes]])]),d("div",$e,[d("label",De,[h(d("input",{type:"checkbox","onUpdate:modelValue":r[9]||(r[9]=e=>o(rr).send_immediately=e),disabled:!!o(rr).scheduled_at,class:"w-5 h-5 rounded border-gray-300 text-purple-600 focus:ring-purple-500"},null,8,Pe),[[v,o(rr).send_immediately]]),r[26]||(r[26]=d("span",{class:"text-gray-700 dark:text-gray-300"},"Darhol yuborish",-1))])])])]),d("div",Re,[d("div",Ee,[d("span",Ge,x(o(rr).lead_ids.length),1),r[27]||(r[27]=i(" ta lidga ",-1)),d("span",He,x(ar.value?.name||"taklif"),1),r[28]||(r[28]=i(" yuboriladi ",-1))]),d("button",{type:"submit",disabled:o(rr).processing||!o(rr).offer_id||0===o(rr).lead_ids.length,class:"inline-flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-semibold rounded-xl hover:from-purple-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg"},[s(o(S),{class:"w-5 h-5"}),i(" "+x(o(rr).processing?"Yuborilmoqda...":"Yuborish"),1)],8,Je)])],32)])])]),_:1}))}};export{Xe as default};
