import{b as e,a as t}from"./chunk-BhZp3z4u.js";import{j as a,k as s,_ as l}from"./chunk-D7SyfRoT.js";import{u as r}from"./app-C-ZlocOh.js";import{r as n,o,e as i,v as u,x as d,U as c,C as v,D as p,J as f,K as x,A as h,I as m,z as y,y as b,O as g}from"./chunk-CpmtkKLp.js";const k={key:0,class:"pt-3 mt-3 border-t border-gray-200 dark:border-gray-700"},w={key:0,class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},j={key:1,class:"mb-2"},_={class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},I={class:"flex-1"},A={key:0,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},M={key:1,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},z={key:2,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},B={key:3,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-orange-500 text-white rounded-full"},C={__name:"BusinessLayout",props:{title:{type:String,default:""}},setup(C){const{t:D}=r(),J=e(),K=a,L=n(0),O=n(0),S=n({total:0,overdue:0}),U=n({total:0,overdue:0});let W=null,$=null,q=null,E=null;const F=async()=>{try{const e=await t.get("/business/inbox",{headers:{Accept:"application/json"}});void 0!==e.data.stats?.unread?.total&&(L.value=e.data.stats.unread.total)}catch(e){e.response}},G=async()=>{try{const e=await t.get("/business/api/sales/stats");void 0!==e.data?.new_leads&&(O.value=e.data.new_leads)}catch(e){e.response}},H=async()=>{try{const e=await t.get("/business/tasks/stats");e.data&&(S.value={total:e.data.total||0,overdue:e.data.overdue||0})}catch(e){e.response}},N=async()=>{try{const e=await t.get("/business/todos/api/dashboard");e.data?.stats&&(U.value={total:e.data.stats.total_today||0,overdue:e.data.stats.overdue||0})}catch(e){e.response}},P=e=>{const t=J.url;return e.exact?t===e.href||t===e.href+"/":e.activeMatch?e.activeMatch(t):t.startsWith(e.href)};return o(()=>{F(),G(),H(),N(),W=setInterval(F,1e4),$=setInterval(G,15e3),q=setInterval(H,1e4),E=setInterval(N,3e4)}),i(()=>{W&&clearInterval(W),$&&clearInterval($),q&&clearInterval(q),E&&clearInterval(E)}),(e,t)=>(p(),u(l,{title:C.title||h(D)("layout.home"),config:h(K)},{navigation:d(()=>[(p(!0),v(f,null,x(h(K).navigation,(e,t)=>(p(),v(f,{key:t},[t>0?(p(),v("div",k,[e.title?(p(),v("p",w,y(e.title),1)):m("",!0)])):e.title?(p(),v("div",j,[b("p",_,y(e.title),1)])):m("",!0),(p(!0),v(f,null,x(e.items,e=>(p(),u(s,{key:e.href,href:e.href,active:P(e)},{default:d(()=>[(p(),u(g(e.icon),{class:"w-5 h-5 mr-3"})),b("span",I,y(e.label),1),"/business/inbox"===e.href&&L.value>0?(p(),v("span",A,y(L.value>99?"99+":L.value),1)):m("",!0),"/business/sales"===e.href&&O.value>0?(p(),v("span",M,y(O.value>99?"99+":O.value),1)):m("",!0),"/business/tasks"===e.href&&S.value.overdue>0?(p(),v("span",z,y(S.value.overdue>99?"99+":S.value.overdue),1)):m("",!0),"/business/todos"===e.href&&U.value.overdue>0?(p(),v("span",B,y(U.value.overdue>99?"99+":U.value.overdue),1)):m("",!0)]),_:2},1032,["href","active"]))),128))],64))),128))]),default:d(()=>[c(e.$slots,"default")]),_:3},8,["title","config"]))}};export{C as _};
