import{r as e,b as t,v as a,x as r,y as s,C as l,I as d,F as o,H as n,D as i,J as p,K as g,z as x,B as u,E as c,N as y,G as m}from"./chunk-CpmtkKLp.js";import{r as b}from"./chunk-BhZp3z4u.js";import{_ as k}from"./chunk-BHCorYK2.js";import"./chunk-D7SyfRoT.js";import"./app-C-ZlocOh.js";import"./chunk-BWiubfpN.js";import"./chunk-CouA7u-j.js";import"./chunk-DmrwHl-6.js";import"./chunk-De_qwhex.js";import"./chunk-eMHYSAeQ.js";import"./chunk-beXL1A--.js";import"./chunk-CAoK8Mdm.js";import"./chunk-BiBvtcLb.js";import"./chunk-DNKDGYPp.js";import"./chunk-BiW1c8q7.js";import"./chunk-CTIk0k8a.js";import"./chunk-dqIIyBTR.js";import"./chunk-CvscUVdi.js";import"./chunk-BvbZUszZ.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-DCXiFUg-.js";import"./chunk-Bsc1JRL5.js";import"./chunk-BuJDoypK.js";import"./chunk-3cs9K1fB.js";import"./chunk-BG5DB3cD.js";import"./chunk-CdKrFGoA.js";import"./chunk-DvBKKKMs.js";const h={class:"mb-8"},v={class:"flex items-center justify-between flex-wrap gap-4"},f={class:"flex items-center gap-3"},w=["value"],j={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8"},_={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},S={class:"text-2xl font-bold text-gray-900 dark:text-white"},q={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},C={class:"text-2xl font-bold text-red-600"},A={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},J={class:"text-2xl font-bold text-yellow-600"},U={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},B={class:"text-2xl font-bold text-orange-600"},Q={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},K={class:"text-2xl font-bold text-purple-600"},D={class:"border-b border-gray-200 dark:border-gray-700 mb-6"},M={class:"flex gap-8"},N={key:0,class:"px-2 py-0.5 bg-orange-100 text-orange-700 rounded-full text-xs"},T={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},V={class:"overflow-x-auto"},z={class:"w-full"},O={class:"divide-y divide-gray-200 dark:divide-gray-700"},$={class:"px-6 py-4 whitespace-nowrap"},F={class:"flex items-center"},I={class:"w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center text-red-700 dark:text-red-400 font-medium"},H={class:"ml-3 font-medium text-gray-900 dark:text-white"},R={class:"px-6 py-4"},X={class:"font-medium text-gray-900 dark:text-white"},Y={class:"text-sm text-gray-500"},Z={class:"px-6 py-4 text-right font-bold text-red-600"},E={class:"px-6 py-4 text-center"},G={class:"px-6 py-4 text-center"},L={class:"px-6 py-4 text-center text-sm text-gray-500"},P={class:"px-6 py-4 text-center"},W={class:"flex items-center justify-center gap-2"},ee=["onClick"],te=["onClick"],ae=["onClick"],re={key:0},se={key:1,class:"space-y-4"},le={class:"flex items-start justify-between mb-4"},de={class:"flex items-center gap-3"},oe={class:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center text-red-700 dark:text-red-400 font-medium text-lg"},ne={class:"font-bold text-gray-900 dark:text-white"},ie={class:"text-sm text-gray-500"},pe={class:"text-right"},ge={class:"text-xl font-bold text-red-600"},xe={class:"text-sm text-gray-500"},ue={class:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4 mb-4"},ce={class:"text-gray-700 dark:text-gray-300"},ye={class:"flex justify-end gap-3"},me=["onClick"],be=["onClick"],ke={key:0,class:"bg-white dark:bg-gray-800 rounded-xl p-12 text-center text-gray-500 border border-gray-200 dark:border-gray-700"},he={key:2,class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},ve={class:"overflow-x-auto"},fe={class:"w-full"},we={class:"divide-y divide-gray-200 dark:divide-gray-700"},je={class:"px-6 py-4 whitespace-nowrap"},_e={class:"flex items-center"},Se={class:"w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center text-yellow-700 dark:text-yellow-400 font-medium"},qe={class:"ml-3 font-medium text-gray-900 dark:text-white"},Ce={class:"px-6 py-4"},Ae={class:"font-medium text-gray-900 dark:text-white"},Je={class:"text-sm text-gray-500"},Ue={class:"px-6 py-4 text-center"},Be={class:"font-bold text-yellow-600"},Qe={class:"px-6 py-4 text-center"},Ke={class:"px-6 py-4 text-center text-sm text-gray-500"},De={key:0},Me={key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Ne={class:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6"},Te=["value"],Ve=["value"],ze={class:"flex justify-end gap-3"},Oe={__name:"Penalties",props:{penalties:Array,warnings:Array,penaltyRules:Array,teamMembers:Array,stats:Object,currentStatus:String,month:Number,year:Number,panelType:String},setup(Oe){const $e=Oe;(new Date).getFullYear();const Fe=e($e.month||(new Date).getMonth()+1),Ie=e($e.currentStatus||""),He=e("all"),Re=e(!1),Xe=e({user_id:"",rule_id:"",amount:0,reason:""}),Ye=t(()=>$e.penalties.filter(e=>"appealed"===e.status)),Ze=e=>e?new Intl.NumberFormat("uz-UZ").format(e)+" so'm":"0 so'm",Ee=e=>e?new Date(e).toLocaleDateString("uz-UZ"):"-",Ge=e=>e?e.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?",Le=e=>{const t={pending:"px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-700",confirmed:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700",appealed:"px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-700",cancelled:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700"};return t[e]||t.pending},Pe=()=>{b.get("/sales-head/sales-kpi/penalties",{month:Fe.value,status:Ie.value},{preserveState:!0})},We=()=>{Xe.value={user_id:"",rule_id:"",amount:0,reason:""},Re.value=!0},et=()=>{b.post("/sales-head/sales-kpi/penalties/manual",Xe.value,{onSuccess:()=>{Re.value=!1}})};return(e,t)=>(i(),a(k,{title:"Jarimalar"},{default:r(()=>[s("div",h,[s("div",v,[t[12]||(t[12]=s("div",null,[s("h2",{class:"text-3xl font-bold text-gray-900 dark:text-gray-100"},"Jarimalar"),s("p",{class:"mt-2 text-gray-600 dark:text-gray-400"},"Jarimalarni ko'rish va shikoyatlarni ko'rib chiqish")],-1)),s("div",f,[o(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>Ie.value=e),onChange:Pe,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[...t[10]||(t[10]=[s("option",{value:""},"Barchasi",-1),s("option",{value:"pending"},"Kutilmoqda",-1),s("option",{value:"confirmed"},"Tasdiqlangan",-1),s("option",{value:"appealed"},"Shikoyat qilingan",-1),s("option",{value:"cancelled"},"Bekor qilingan",-1)])],544),[[n,Ie.value]]),o(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>Fe.value=e),onChange:Pe,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[(i(),l(p,null,g(12,e=>s("option",{key:e,value:e},x((e=>["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentabr","Oktabr","Noyabr","Dekabr"][e-1])(e)),9,w)),64))],544),[[n,Fe.value]]),s("button",{onClick:We,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center gap-2"},[...t[11]||(t[11]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" Qo'lda jarima ",-1)])])])])]),s("div",j,[s("div",_,[t[13]||(t[13]=s("p",{class:"text-sm text-gray-500 mb-1"},"Jami jarimalar",-1)),s("p",S,x(Oe.stats.total_count),1)]),s("div",q,[t[14]||(t[14]=s("p",{class:"text-sm text-gray-500 mb-1"},"Jami summa",-1)),s("p",C,x(Ze(Oe.stats.total_amount)),1)]),s("div",A,[t[15]||(t[15]=s("p",{class:"text-sm text-gray-500 mb-1"},"Kutilmoqda",-1)),s("p",J,x(Oe.stats.pending_count),1)]),s("div",U,[t[16]||(t[16]=s("p",{class:"text-sm text-gray-500 mb-1"},"Shikoyatlar",-1)),s("p",B,x(Oe.stats.appealed_count),1)]),s("div",Q,[t[17]||(t[17]=s("p",{class:"text-sm text-gray-500 mb-1"},"Avtomatik",-1)),s("p",K,x(Oe.stats.auto_count),1)])]),s("div",D,[s("nav",M,[s("button",{onClick:t[2]||(t[2]=e=>He.value="all"),class:c(["pb-4 px-1 font-medium text-sm border-b-2 transition-colors","all"===He.value?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700"])}," Barcha jarimalar ",2),s("button",{onClick:t[3]||(t[3]=e=>He.value="appeals"),class:c(["pb-4 px-1 font-medium text-sm border-b-2 transition-colors flex items-center gap-2","appeals"===He.value?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"])},[t[18]||(t[18]=u(" Shikoyatlar ",-1)),Oe.stats.appealed_count>0?(i(),l("span",N,x(Oe.stats.appealed_count),1)):d("",!0)],2),s("button",{onClick:t[4]||(t[4]=e=>He.value="warnings"),class:c(["pb-4 px-1 font-medium text-sm border-b-2 transition-colors","warnings"===He.value?"border-yellow-500 text-yellow-600":"border-transparent text-gray-500 hover:text-gray-700"])}," Ogohlantirishlar ",2)])]),"all"===He.value?(i(),l("div",T,[s("div",V,[s("table",z,[t[20]||(t[20]=s("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[s("tr",null,[s("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Xodim"),s("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Sabab"),s("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Summa"),s("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Turi"),s("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Holat"),s("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Sana"),s("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amal")])],-1)),s("tbody",O,[(i(!0),l(p,null,g(Oe.penalties,e=>{return i(),l("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[s("td",$,[s("div",F,[s("div",I,x(Ge(e.user?.name)),1),s("span",H,x(e.user?.name),1)])]),s("td",R,[s("div",X,x(e.penalty_rule?.name||"Qo'lda jarima"),1),s("div",Y,x(e.reason),1)]),s("td",Z," -"+x(Ze(e.penalty_amount)),1),s("td",E,[s("span",{class:c(e.is_auto?"px-2 py-1 bg-purple-100 text-purple-700 rounded text-xs":"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs")},x(e.is_auto?"Avtomatik":"Qo'lda"),3)]),s("td",G,[s("span",{class:c(Le(e.status))},x((t=e.status,{pending:"Kutilmoqda",confirmed:"Tasdiqlangan",appealed:"Shikoyat",cancelled:"Bekor qilingan"}[t]||t)),3)]),s("td",L,x(Ee(e.triggered_at)),1),s("td",P,[s("div",W,["pending"===e.status?(i(),l("button",{key:0,onClick:t=>(e=>{b.post(`/sales-head/sales-kpi/penalties/${e.id}/confirm`)})(e),class:"px-2 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700"}," Tasdiqlash ",8,ee)):d("",!0),"pending"===e.status?(i(),l("button",{key:1,onClick:t=>(e=>{b.post(`/sales-head/sales-kpi/penalties/${e.id}/cancel`)})(e),class:"px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs hover:bg-gray-300"}," Bekor ",8,te)):d("",!0),"appealed"===e.status?(i(),l("button",{key:2,onClick:e=>{},class:"px-2 py-1 bg-orange-600 text-white rounded text-xs hover:bg-orange-700"}," Ko'rib chiqish ",8,ae)):d("",!0)])])]);var t}),128)),0===Oe.penalties.length?(i(),l("tr",re,[...t[19]||(t[19]=[s("td",{colspan:"7",class:"px-6 py-12 text-center text-gray-500"}," Jarimalar topilmadi ",-1)])])):d("",!0)])])])])):d("",!0),"appeals"===He.value?(i(),l("div",se,[(i(!0),l(p,null,g(Ye.value,e=>(i(),l("div",{key:e.id,class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-orange-200 dark:border-orange-700"},[s("div",le,[s("div",de,[s("div",oe,x(Ge(e.user?.name)),1),s("div",null,[s("h3",ne,x(e.user?.name),1),s("p",ie,x(e.penalty_rule?.name||"Qo'lda jarima"),1)])]),s("div",pe,[s("p",ge,"-"+x(Ze(e.penalty_amount)),1),s("p",xe,x(Ee(e.triggered_at)),1)])]),s("div",ue,[t[21]||(t[21]=s("p",{class:"text-sm font-medium text-orange-700 dark:text-orange-400 mb-1"},"Shikoyat sababi:",-1)),s("p",ce,x(e.appeal_reason||"Sabab ko'rsatilmagan"),1)]),s("div",ye,[s("button",{onClick:t=>{return a=e,void b.post(`/sales-head/sales-kpi/penalties/${a.id}/appeal`,{decision:"rejected"});var a},class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"}," Rad etish ",8,me),s("button",{onClick:t=>{return a=e,void b.post(`/sales-head/sales-kpi/penalties/${a.id}/appeal`,{decision:"accepted"});var a},class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"}," Qabul qilish ",8,be)])]))),128)),0===Ye.value.length?(i(),l("div",ke," Ko'rib chiqilishi kerak bo'lgan shikoyatlar yo'q ")):d("",!0)])):d("",!0),"warnings"===He.value?(i(),l("div",he,[s("div",ve,[s("table",fe,[t[23]||(t[23]=s("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[s("tr",null,[s("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Xodim"),s("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Ogohlantirish"),s("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Ketma-ketlik"),s("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Qolgan"),s("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Sana")])],-1)),s("tbody",we,[(i(!0),l(p,null,g(Oe.warnings,e=>(i(),l("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[s("td",je,[s("div",_e,[s("div",Se,x(Ge(e.user?.name)),1),s("span",qe,x(e.user?.name),1)])]),s("td",Ce,[s("div",Ae,x(e.penalty_rule?.name),1),s("div",Je,x(e.message),1)]),s("td",Ue,[s("span",Be,x(e.sequence_count),1)]),s("td",Qe,[s("span",{class:c(e.warnings_remaining<=1?"text-red-600 font-bold":"text-gray-600")},x(e.warnings_remaining),3)]),s("td",Ke,x(Ee(e.created_at)),1)]))),128)),0===Oe.warnings.length?(i(),l("tr",De,[...t[22]||(t[22]=[s("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-500"}," Ogohlantirishlar topilmadi ",-1)])])):d("",!0)])])])])):d("",!0),Re.value?(i(),l("div",Me,[s("div",Ne,[t[31]||(t[31]=s("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-4"},"Qo'lda jarima berish",-1)),s("form",{onSubmit:y(et,["prevent"]),class:"space-y-4"},[s("div",null,[t[25]||(t[25]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Xodim",-1)),o(s("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>Xe.value.user_id=e),required:"",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},[t[24]||(t[24]=s("option",{value:""},"Tanlang...",-1)),(i(!0),l(p,null,g(Oe.teamMembers,e=>(i(),l("option",{key:e.id,value:e.id},x(e.name),9,Te))),128))],512),[[n,Xe.value.user_id]])]),s("div",null,[t[27]||(t[27]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Jarima qoidasi (ixtiyoriy)",-1)),o(s("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>Xe.value.rule_id=e),class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},[t[26]||(t[26]=s("option",{value:""},"Qoidasiz",-1)),(i(!0),l(p,null,g(Oe.penaltyRules,e=>(i(),l("option",{key:e.id,value:e.id},x(e.name),9,Ve))),128))],512),[[n,Xe.value.rule_id]])]),s("div",null,[t[28]||(t[28]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Summa",-1)),o(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>Xe.value.amount=e),type:"number",required:"",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},null,512),[[m,Xe.value.amount,void 0,{number:!0}]])]),s("div",null,[t[29]||(t[29]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Sabab",-1)),o(s("textarea",{"onUpdate:modelValue":t[8]||(t[8]=e=>Xe.value.reason=e),rows:"2",required:"",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},null,512),[[m,Xe.value.reason]])]),s("div",ze,[s("button",{type:"button",onClick:t[9]||(t[9]=e=>Re.value=!1),class:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}," Bekor qilish "),t[30]||(t[30]=s("button",{type:"submit",class:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700"}," Jarima berish ",-1))])],32)])])):d("",!0)]),_:1}))}};export{Oe as default};
