import{r as x,o as E,b as U,D as o,y as P,z as r,A as b,B as v,L as y,S as m,H as s,Q as A,F as C,G as F,C as f,E as l,I as _,Z as L,J as R,K as T,R as $}from"./chunk-BcTZxe-J.js";import{h as D}from"./chunk-BYRtWSr0.js";import{u as I}from"./app-DWC75jbx.js";import{u as N,t as H}from"./chunk-D2n0vPlk.js";import{_ as O}from"./chunk-DlAUqK2U.js";import"./chunk-C1xeNfMu.js";const q={key:0,class:"bg-white dark:bg-gray-800 rounded-3xl shadow-2xl overflow-hidden border border-gray-100 dark:border-gray-700"},Z={class:"text-2xl font-bold leading-tight"},J={key:0,class:"mt-3 text-white/90 text-base"},W={key:1,class:"mt-5 inline-flex items-center gap-2 px-5 py-2.5 bg-white/20 backdrop-blur-sm rounded-full text-sm font-medium"},G={key:0,class:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl text-red-700 dark:text-red-400 text-sm"},K={class:"block text-sm font-semibold text-gray-700 dark:text-gray-200"},Q={key:0,class:"text-red-500 ml-0.5"},X=["onUpdate:modelValue","type","placeholder"],Y=["value","onInput","placeholder"],ee=["onUpdate:modelValue","placeholder"],te=["onUpdate:modelValue"],re={value:""},ae=["value"],oe={key:4,class:"flex items-center gap-3 cursor-pointer p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl border border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},le=["onUpdate:modelValue"],se={class:"text-gray-700 dark:text-gray-200"},de={key:5,class:"text-red-500 text-xs mt-1"},ne=["disabled"],ie={key:0,class:"flex items-center justify-center gap-2"},ce={key:1},ue={key:1,class:"bg-white dark:bg-gray-800 rounded-3xl shadow-2xl overflow-hidden border border-gray-100 dark:border-gray-700"},me={class:"p-10 text-center"},ge={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-3"},pe={class:"text-gray-600 dark:text-gray-300 mb-8 text-lg"},be={key:0,class:"mb-8"},ye={class:"text-sm font-medium text-gray-600 dark:text-gray-300 mb-4"},he=["href"],ve=["href"],xe={key:2,class:"w-full"},fe={class:"relative w-full rounded-xl overflow-hidden shadow-lg",style:{"padding-bottom":"56.25%"}},ke=["src"],_e={class:"mt-3 text-xs text-gray-400 dark:text-gray-500 text-center"},we={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},Ce={key:2,class:"mt-8 text-center"},Fe={__name:"LeadForm",props:{leadForm:Object,isEmbed:Boolean,slug:String,trackingScripts:{type:Object,default:()=>({})}},setup(c){const{t:i}=I(),h=c;N(h.trackingScripts);const g=x({}),k=x(!1),w=x(!1),u=x(null),p=x({});E(()=>{h.leadForm.fields.forEach(t=>{g.value[t.id]=""});const a=new URLSearchParams(window.location.search);window.utmParams={utm_source:a.get("utm_source"),utm_medium:a.get("utm_medium"),utm_campaign:a.get("utm_campaign"),utm_term:a.get("utm_term"),utm_content:a.get("utm_content")}});const S=a=>{const t=g.value[a.id];if(a.required&&!t)return i("public_form.required_field");if(t)switch(a.type){case"email":if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return i("public_form.invalid_email");break;case"phone":if(!/^\+?[0-9\s\-()]{7,20}$/.test(t.replace(/\s/g,"")))return i("public_form.invalid_phone");break}return null},V=()=>{p.value={};let a=!0;return h.leadForm.fields.forEach(t=>{const e=S(t);e&&(p.value[t.id]=e,a=!1)}),a},M=async()=>{if(V()){k.value=!0;try{const t=await(await fetch(`/f/${h.slug}/submit`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({...g.value,...window.utmParams})})).json();t.success?(u.value=t,w.value=!0,H("lead_form",h.leadForm.title||h.slug),t.redirect_url&&setTimeout(()=>{window.location.href=t.redirect_url},3e3)):p.value={form:t.error||i("public_form.error")}}catch{p.value={form:i("public_form.network_error")}}finally{k.value=!1}}},z=a=>({text:"text",email:"email",phone:"tel",number:"number"})[a]||"text",j=(a,t)=>{let e=a.target.value.replace(/\D/g,"");e.startsWith("998")?e="+"+e:e.startsWith("+")||e.length>0&&(e="+998"+e),e.length>4&&(e=e.slice(0,4)+" "+e.slice(4)),e.length>7&&(e=e.slice(0,7)+" "+e.slice(7)),e.length>11&&(e=e.slice(0,11)+" "+e.slice(11)),e.length>14&&(e=e.slice(0,14)+" "+e.slice(14)),g.value[t]=e.slice(0,17)},B=a=>{if(!a)return"";const t=a.match(/(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);if(t)return`https://www.youtube.com/embed/${t[1]}?rel=0&modestbranding=1`;const e=a.match(/vimeo\.com\/(?:video\/)?(\d+)/);if(e)return`https://player.vimeo.com/video/${e[1]}?dnt=1`;const d=a.match(/kinescope\.io\/(?:embed\/)?([a-zA-Z0-9]+)/);return d?`https://kinescope.io/embed/${d[1]}`:(a.includes("/embed/")||a.includes("player.vimeo.com"),a)},n=U(()=>h.leadForm.theme_color||"#6366f1");return(a,t)=>(l(),o("div",{class:v(["min-h-screen",c.isEmbed?"bg-transparent":"bg-gray-50 dark:bg-gray-900"])},[P(b(D),{title:c.leadForm.title},null,8,["title"]),r("div",{class:v(["w-full",c.isEmbed?"":"min-h-screen flex items-center justify-center p-4"])},[r("div",{class:v(["w-full",c.isEmbed?"":"max-w-md"])},[w.value?(l(),o("div",ue,[r("div",me,[r("div",{class:"w-24 h-24 mx-auto rounded-full flex items-center justify-center mb-6 shadow-lg",style:m({backgroundColor:n.value+"15"})},[(l(),o("svg",{class:"w-12 h-12",style:m({color:n.value}),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[2]||(t[2]=[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M5 13l4 4L19 7"},null,-1)])],4))],4),r("h2",ge,s(b(i)("public_form.thank_you")),1),r("p",pe,s(u.value?.message||b(i)("public_form.success_message")),1),u.value?.lead_magnet?(l(),o("div",be,[r("div",{class:"p-6 rounded-2xl border-2 border-dashed",style:m({backgroundColor:n.value+"08",borderColor:n.value+"30"})},[r("p",ye,s(u.value.lead_magnet.title||b(i)("public_form.your_gift")),1),u.value.lead_magnet.type==="file"?(l(),o("a",{key:0,href:u.value.lead_magnet.download_url,class:"inline-flex items-center gap-2 px-6 py-3 text-white font-semibold rounded-xl transition-all",style:m({backgroundColor:n.value})},[t[3]||(t[3]=r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),f(" "+s(b(i)("public_form.download")),1)],12,he)):u.value.lead_magnet.type==="link"?(l(),o("a",{key:1,href:u.value.lead_magnet.link,target:"_blank",class:"inline-flex items-center gap-2 px-6 py-3 text-white font-semibold rounded-xl transition-all",style:m({backgroundColor:n.value})},[t[4]||(t[4]=r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)),f(" "+s(b(i)("public_form.open")),1)],12,ve)):u.value.lead_magnet.type==="video"?(l(),o("div",xe,[r("div",fe,[r("iframe",{src:B(u.value.lead_magnet.link),class:"absolute inset-0 w-full h-full",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,ke)]),r("p",_e,s(b(i)("public_form.video_notice")),1)])):u.value.lead_magnet.type==="coupon"||u.value.lead_magnet.type==="text"?(l(),o("div",{key:3,class:"p-4 bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed",style:m({borderColor:n.value})},[r("p",{class:"text-xl font-bold",style:m({color:n.value})},s(u.value.lead_magnet.text),5)],4)):y("",!0)],4)])):y("",!0),u.value?.redirect_url?(l(),o("p",we,s(b(i)("public_form.redirect_notice")),1)):y("",!0)])])):(l(),o("div",q,[r("div",{class:"px-8 py-10 text-center text-white",style:m({backgroundColor:n.value})},[r("h1",Z,s(c.leadForm.title),1),c.leadForm.description?(l(),o("p",J,s(c.leadForm.description),1)):y("",!0),c.leadForm.has_lead_magnet&&c.leadForm.lead_magnet_title?(l(),o("div",W,[t[0]||(t[0]=r("span",null,"ðŸŽ",-1)),r("span",null,s(c.leadForm.lead_magnet_title),1)])):y("",!0)],4),r("form",{onSubmit:A(M,["prevent"]),class:"p-8 space-y-5"},[p.value.form?(l(),o("div",G,s(p.value.form),1)):y("",!0),(l(!0),o(C,null,F(c.leadForm.fields,e=>(l(),o("div",{key:e.id,class:"space-y-2"},[r("label",K,[f(s(e.label)+" ",1),e.required?(l(),o("span",Q,"*")):y("",!0)]),["text","email","number"].includes(e.type)?_((l(),o("input",{key:0,"onUpdate:modelValue":d=>g.value[e.id]=d,type:z(e.type),placeholder:e.placeholder,class:v(["w-full px-4 py-3.5 bg-white dark:bg-gray-700 border-2 rounded-xl focus:ring-2 focus:border-transparent transition-all text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500",p.value[e.id]?"border-red-300 dark:border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-opacity-50"]),style:m({"--tw-ring-color":n.value})},null,14,X)),[[L,g.value[e.id]]]):e.type==="phone"?(l(),o("input",{key:1,value:g.value[e.id],onInput:d=>j(d,e.id),type:"tel",placeholder:e.placeholder||"+998 90 123 45 67",class:v(["w-full px-4 py-3.5 bg-white dark:bg-gray-700 border-2 rounded-xl focus:ring-2 focus:border-transparent transition-all text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500",p.value[e.id]?"border-red-300 dark:border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-opacity-50"]),style:m({"--tw-ring-color":n.value})},null,46,Y)):e.type==="textarea"?_((l(),o("textarea",{key:2,"onUpdate:modelValue":d=>g.value[e.id]=d,placeholder:e.placeholder,rows:"3",class:v(["w-full px-4 py-3.5 bg-white dark:bg-gray-700 border-2 rounded-xl focus:ring-2 focus:border-transparent transition-all resize-none text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500",p.value[e.id]?"border-red-300 dark:border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-opacity-50"]),style:m({"--tw-ring-color":n.value})},null,14,ee)),[[R,g.value[e.id]]]):e.type==="select"?_((l(),o("select",{key:3,"onUpdate:modelValue":d=>g.value[e.id]=d,class:v(["w-full px-4 py-3.5 bg-white dark:bg-gray-700 border-2 rounded-xl focus:ring-2 focus:border-transparent transition-all text-gray-900 dark:text-gray-100",p.value[e.id]?"border-red-300 dark:border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-opacity-50"]),style:m({"--tw-ring-color":n.value})},[r("option",re,s(e.placeholder||b(i)("public_form.select_placeholder")),1),(l(!0),o(C,null,F(e.options,d=>(l(),o("option",{key:d,value:d},s(d),9,ae))),128))],14,te)),[[T,g.value[e.id]]]):e.type==="checkbox"?(l(),o("label",oe,[_(r("input",{"onUpdate:modelValue":d=>g.value[e.id]=d,type:"checkbox",class:"w-5 h-5 rounded border-gray-300 dark:border-gray-500",style:m({accentColor:n.value})},null,12,le),[[$,g.value[e.id]]]),r("span",se,s(e.placeholder||e.label),1)])):y("",!0),p.value[e.id]?(l(),o("p",de,s(p.value[e.id]),1)):y("",!0)]))),128)),r("button",{type:"submit",disabled:k.value,class:"w-full py-4 mt-2 text-white text-lg font-bold rounded-xl shadow-lg transition-all transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",style:m({backgroundColor:n.value,boxShadow:`0 10px 30px -5px ${n.value}50`})},[k.value?(l(),o("span",ie,[t[1]||(t[1]=r("svg",{class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),f(" "+s(b(i)("public_form.submitting")),1)])):(l(),o("span",ce,s(c.leadForm.submit_button_text||b(i)("public_form.submit")),1))],12,ne)],32)])),c.isEmbed?y("",!0):(l(),o("div",Ce,[...t[5]||(t[5]=[r("a",{href:"https://biznespilot.uz",target:"_blank",class:"inline-flex items-center gap-1.5 text-xs text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors"},[r("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z","clip-rule":"evenodd"})]),f(" Powered by BiznesPilot ")],-1)])]))],2)],2)],2))}},Ee=O(Fe,[["__scopeId","data-v-294a41db"]]);export{Ee as default};
