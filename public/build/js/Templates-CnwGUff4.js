import{h as H,l as Q,r as j}from"./chunk-BYRtWSr0.js";import{_ as W}from"./chunk-Dd--AZOj.js";import{r as _,w as Y,b as X,v as P,E as d,y as u,x as I,D as m,L as k,z as e,T as z,H as a,A as t,I as B,J as q,F as S,G as O,B as A,O as J,P as Z,C as T}from"./chunk-BcTZxe-J.js";import{u as G}from"./app-DWC75jbx.js";import{r as ee}from"./chunk-BqueMrU7.js";import{r as te}from"./chunk-CoBrxO6j.js";import{e as D}from"./chunk-CYarSvys.js";import{r as R}from"./chunk-gCWBLgcy.js";import{r as ae}from"./chunk-BHX0ueEB.js";import{r as M}from"./chunk-g9W46QGO.js";import{r as L}from"./chunk-EvWs7tbK.js";import{r as re}from"./chunk-DlCydy0c.js";import"./chunk-C1xeNfMu.js";import"./chunk-BVYwhYNk.js";import"./chunk-_yYzsx_i.js";import"./chunk-Rs1WNzbn.js";import"./chunk-CJsSO8V8.js";import"./chunk-CrR1zWIb.js";import"./chunk-CQoMtUf7.js";import"./chunk-qVc0_oyq.js";import"./chunk-LBbTbQSS.js";import"./chunk-I93QdGKi.js";import"./chunk-DNp5bQOL.js";import"./chunk-CG0drqHE.js";import"./chunk-CklLzvQL.js";import"./chunk-CnrLL2pV.js";import"./chunk-D58UsNjm.js";import"./chunk-Ba8J67bG.js";const oe={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},se={class:"flex min-h-full items-center justify-center p-4"},le={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col"},ne={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},ie={class:"text-lg font-semibold text-gray-900 dark:text-white"},de={class:"flex-1 overflow-y-auto p-6 space-y-4"},ce={key:0,class:"p-3 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm rounded-lg"},ge={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ue=["placeholder"],pe={key:0,class:"mt-1 text-sm text-red-600"},me={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ye=["placeholder"],be={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},he={class:"grid grid-cols-5 gap-2"},xe=["onClick"],ve={class:"hidden sm:inline"},fe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ke={class:"space-y-2 mb-3"},_e={class:"flex items-center gap-2 p-3"},we={class:"flex-1 text-sm text-gray-700 dark:text-gray-300"},$e=["onClick"],Ce={key:0,class:"border-t border-gray-200 dark:border-gray-600 pl-6 pr-3 py-2 space-y-1"},Te={class:"flex-1"},je=["onClick"],Se={class:"border-t border-gray-200 dark:border-gray-600 pl-6 pr-3 py-2"},Oe=["onKeyup","placeholder"],Fe={class:"flex gap-2"},Ae=["placeholder"],Ie={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700"},Ee=["disabled"],Ne={__name:"TemplateModal",props:{show:Boolean,template:Object,categories:Object,categoryIcons:Object},emits:["close","saved"],setup(y,{emit:c}){const{t:p}=G(),v=y,w=c,s=_({name:"",description:"",category:"custom",items:[]}),h=_(""),f=_(!1),x=_({}),$=()=>{s.value={name:"",description:"",category:"custom",items:[]},h.value="",x.value={}};Y(()=>v.template,async o=>{if(o)try{const i=await fetch(route("business.todo-templates.show",o.id),{headers:{Accept:"application/json"}});if(i.ok){const n=await i.json();s.value={name:n.template.name||"",description:n.template.description||"",category:n.template.category||"custom",items:n.items||[]}}}catch(i){console.error("Failed to load template:",i),s.value={name:o.name||"",description:o.description||"",category:o.category||"custom",items:[]}}else $()},{immediate:!0});const F=()=>{h.value.trim()&&(s.value.items.push({title:h.value.trim(),description:null,default_assignee_role:null,due_days_offset:null,children:[]}),h.value="")},E=o=>{s.value.items.splice(o,1)},N=(o,i)=>{i.trim()&&s.value.items[o].children.push({title:i.trim(),description:null,default_assignee_role:null,due_days_offset:null,children:[]})},K=(o,i)=>{s.value.items[o].children.splice(i,1)},V=async()=>{f.value=!0,x.value={};const o=v.template?route("business.todo-templates.update",v.template.id):route("business.todo-templates.store"),i=v.template?"PUT":"POST";try{const n=await fetch(o,{method:i,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:s.value.name,description:s.value.description||null,category:s.value.category,items:s.value.items})}),b=await n.json();n.ok?(w("saved"),w("close"),$()):x.value=b.errors||{general:b.error||p("common.error")}}catch(n){console.error("Failed to save template:",n),x.value={general:p("todos.template.network_error")}}finally{f.value=!1}},g=()=>{w("close"),$()},l=X(()=>!!v.template),r=X(()=>l.value?p("todos.template.edit_title"):p("todos.template.new_title"));return(o,i)=>(d(),P(Z,{to:"body"},[u(z,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:I(()=>[y.show?(d(),m("div",oe,[e("div",{class:"fixed inset-0 bg-gray-500 dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-75",onClick:g}),e("div",se,[u(z,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:I(()=>[y.show?(d(),m("div",le,[e("div",ne,[e("h3",ie,a(r.value),1),e("button",{onClick:g,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"},[u(t(ee),{class:"w-5 h-5"})])]),e("div",de,[x.value.general?(d(),m("div",ce,a(x.value.general),1)):k("",!0),e("div",null,[e("label",ge,a(t(p)("todos.template.name"))+" * ",1),B(e("input",{"onUpdate:modelValue":i[0]||(i[0]=n=>s.value.name=n),type:"text",required:"",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:t(p)("todos.template.name_placeholder")},null,8,ue),[[q,s.value.name]]),x.value.name?(d(),m("p",pe,a(x.value.name[0]),1)):k("",!0)]),e("div",null,[e("label",me,a(t(p)("todos.template.description")),1),B(e("textarea",{"onUpdate:modelValue":i[1]||(i[1]=n=>s.value.description=n),rows:"2",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:t(p)("todos.template.description_placeholder")},null,8,ye),[[q,s.value.description]])]),e("div",null,[e("label",be,a(t(p)("todos.template.category")),1),e("div",he,[(d(!0),m(S,null,O(y.categories,(n,b)=>(d(),m("button",{key:b,type:"button",onClick:C=>s.value.category=b,class:A(["px-3 py-2 text-sm font-medium rounded-lg transition-colors flex items-center justify-center gap-1",s.value.category===b?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[e("span",null,a(y.categoryIcons[b]),1),e("span",ve,a(n),1)],10,xe))),128))])]),e("div",null,[e("label",fe,a(t(p)("todos.template.tasks")),1),e("div",ke,[(d(!0),m(S,null,O(s.value.items,(n,b)=>(d(),m("div",{key:b,class:"bg-gray-50 dark:bg-gray-700 rounded-lg overflow-hidden"},[e("div",_e,[n.children?.length?(d(),P(t(te),{key:0,class:"w-4 h-4 text-gray-400"})):k("",!0),e("span",we,a(n.title),1),e("button",{type:"button",onClick:C=>E(b),class:"p-1 text-gray-400 hover:text-red-500"},[u(t(D),{class:"w-4 h-4"})],8,$e)]),n.children?.length?(d(),m("div",Ce,[(d(!0),m(S,null,O(n.children,(C,U)=>(d(),m("div",{key:U,class:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"},[i[3]||(i[3]=e("span",{class:"w-1.5 h-1.5 bg-gray-400 rounded-full"},null,-1)),e("span",Te,a(C.title),1),e("button",{type:"button",onClick:dt=>K(b,U),class:"p-1 text-gray-400 hover:text-red-500"},[u(t(D),{class:"w-3 h-3"})],8,je)]))),128))])):k("",!0),e("div",Se,[e("input",{type:"text",onKeyup:J(C=>{N(b,C.target.value),C.target.value=""},["enter"]),class:"w-full px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-600 text-gray-900 dark:text-white",placeholder:t(p)("todos.template.add_subtask")},null,40,Oe)])]))),128))]),e("div",Fe,[B(e("input",{"onUpdate:modelValue":i[2]||(i[2]=n=>h.value=n),type:"text",onKeyup:J(F,["enter"]),class:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:t(p)("todos.template.new_task")},null,40,Ae),[[q,h.value]]),e("button",{type:"button",onClick:F,class:"px-3 py-2 bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-500"},[u(t(R),{class:"w-5 h-5"})])])])]),e("div",Ie,[e("button",{type:"button",onClick:g,class:"px-4 py-2.5 text-gray-700 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},a(t(p)("common.cancel")),1),e("button",{onClick:V,disabled:f.value,class:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl transition-colors disabled:opacity-50"},a(f.value?t(p)("common.saving")+"...":t(p)("common.save")),9,Ee)])])):k("",!0)]),_:1})])])):k("",!0)]),_:1})]))}},Ke={class:"h-full flex flex-col -m-4 sm:-m-6 lg:-m-8"},Ve={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 lg:px-8 py-4"},Be={class:"flex items-center justify-between"},qe={class:"flex items-center gap-4"},Me={class:"text-2xl font-bold text-gray-900 dark:text-white"},Pe={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},De={class:"flex items-center gap-2 mt-6 overflow-x-auto pb-2"},Re=["onClick"],Ue={class:"flex-1 overflow-y-auto p-4 sm:p-6 lg:p-8"},Xe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ze={class:"p-5"},Je={class:"flex items-start justify-between mb-3"},Le={class:"flex items-center gap-3"},Ge={class:"text-2xl"},He={class:"font-semibold text-gray-900 dark:text-white"},Qe={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mb-4 line-clamp-2"},We={class:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400"},Ye={class:"flex items-center gap-1"},Ze={class:"flex items-center gap-1"},et={class:"border-t border-gray-200 dark:border-gray-700 px-5 py-3 bg-gray-50 dark:bg-gray-800/50 flex items-center justify-between"},tt=["onClick","disabled"],at={class:"flex items-center gap-1"},rt=["onClick","title"],ot=["onClick","title"],st=["onClick","title"],lt={key:0,class:"col-span-full text-center py-16"},nt={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},it={class:"text-gray-500 dark:text-gray-400 mb-6"},qt={__name:"Templates",props:{templates:Array,categories:Object,categoryIcons:Object,currentCategory:String},setup(y){const{t:c}=G(),p=y,v=_(!1),w=_(null),s=_(p.currentCategory||"all"),h=_(null),f=(g=null)=>{w.value=g,v.value=!0},x=()=>{v.value=!1,w.value=null},$=g=>{s.value=g,j.get(route("business.todo-templates.index"),{category:g},{preserveState:!0,preserveScroll:!0})},F=async g=>{if(confirm(c("templates.delete_confirm")))try{(await fetch(route("business.todo-templates.destroy",g.id),{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}})).ok&&j.reload()}catch(l){console.error("Failed to delete template:",l)}},E=async g=>{try{(await fetch(route("business.todo-templates.duplicate",g.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}})).ok&&j.reload()}catch(l){console.error("Failed to duplicate template:",l)}},N=async g=>{h.value=g.id;try{const l=await fetch(route("business.todo-templates.apply",g.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({})});if(l.ok){const r=await l.json();alert(r.message),j.visit(route("business.todos.index"))}}catch(l){console.error("Failed to apply template:",l)}finally{h.value=null}},K=()=>{j.reload()},V=g=>{const l={onboarding:"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400",sales:"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400",operations:"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-400",marketing:"bg-orange-100 text-orange-700 dark:bg-orange-900/50 dark:text-orange-400",custom:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"};return l[g]||l.custom};return(g,l)=>(d(),P(W,{title:t(c)("templates.title")},{default:I(()=>[u(t(H),{title:t(c)("templates.title")},null,8,["title"]),e("div",Ke,[e("div",Ve,[e("div",Be,[e("div",qe,[u(t(Q),{href:g.route("business.todos.index"),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"},{default:I(()=>[u(t(ae),{class:"w-5 h-5"})]),_:1},8,["href"]),e("div",null,[e("h1",Me,a(t(c)("templates.heading")),1),e("p",Pe,a(t(c)("templates.description")),1)])]),e("button",{onClick:l[0]||(l[0]=r=>f()),class:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl transition-colors shadow-lg shadow-blue-500/25"},[u(t(R),{class:"w-5 h-5"}),T(" "+a(t(c)("templates.new")),1)])]),e("div",De,[e("button",{onClick:l[1]||(l[1]=r=>$("all")),class:A(["px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap",s.value==="all"?"bg-gray-900 dark:bg-white text-white dark:text-gray-900":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},a(t(c)("templates.all")),3),(d(!0),m(S,null,O(y.categories,(r,o)=>(d(),m("button",{key:o,onClick:i=>$(o),class:A(["px-4 py-2 text-sm font-medium rounded-lg transition-colors whitespace-nowrap flex items-center gap-2",s.value===o?"bg-gray-900 dark:bg-white text-white dark:text-gray-900":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[e("span",null,a(y.categoryIcons[o]),1),T(" "+a(r),1)],10,Re))),128))])]),e("div",Ue,[e("div",Xe,[(d(!0),m(S,null,O(y.templates,r=>(d(),m("div",{key:r.id,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all overflow-hidden"},[e("div",ze,[e("div",Je,[e("div",Le,[e("span",Ge,a(r.icon),1),e("div",null,[e("h3",He,a(r.name),1),e("span",{class:A(["text-xs px-2 py-0.5 rounded",V(r.category)])},a(r.category_label),3)])])]),r.description?(d(),m("p",Qe,a(r.description),1)):k("",!0),e("div",We,[e("span",Ye,[u(t(M),{class:"w-4 h-4"}),T(" "+a(t(c)("templates.tasks_count",{count:r.items_count})),1)]),e("span",Ze,[u(t(L),{class:"w-4 h-4"}),T(" "+a(t(c)("templates.usage_count",{count:r.usage_count})),1)])])]),e("div",et,[e("button",{onClick:o=>N(r),disabled:h.value===r.id,class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors disabled:opacity-50"},[u(t(L),{class:"w-4 h-4"}),T(" "+a(h.value===r.id?t(c)("templates.applying"):t(c)("templates.apply")),1)],8,tt),e("div",at,[e("button",{onClick:o=>E(r),class:"p-2 text-gray-400 hover:text-blue-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",title:t(c)("templates.duplicate")},[u(t(M),{class:"w-5 h-5"})],8,rt),e("button",{onClick:o=>f(r),class:"p-2 text-gray-400 hover:text-blue-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",title:t(c)("templates.edit")},[u(t(re),{class:"w-5 h-5"})],8,ot),e("button",{onClick:o=>F(r),class:"p-2 text-gray-400 hover:text-red-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700",title:t(c)("templates.delete")},[u(t(D),{class:"w-5 h-5"})],8,st)])])]))),128)),y.templates.length===0?(d(),m("div",lt,[u(t(M),{class:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600 mb-4"}),e("h3",nt,a(t(c)("templates.empty")),1),e("p",it,a(t(c)("templates.empty_desc")),1),e("button",{onClick:l[2]||(l[2]=r=>f()),class:"inline-flex items-center gap-2 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl transition-colors"},[u(t(R),{class:"w-5 h-5"}),T(" "+a(t(c)("templates.new")),1)])])):k("",!0)])])]),u(Ne,{show:v.value,template:w.value,categories:y.categories,"category-icons":y.categoryIcons,onClose:x,onSaved:K},null,8,["show","template","categories","category-icons"])]),_:1},8,["title"]))}};export{qt as default};
