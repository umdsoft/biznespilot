import{r as L,l as je}from"./chunk-BVrjkT6E.js";import{b as K,r as j,w as te,v as U,F as a,y as f,x as Q,C as l,D as h,z as e,T as Y,H as t,A as r,Q as ne,J as M,K as B,G as T,I as P,L as G,O as pe,P as ie,B as _,_ as Te,E as N,M as ae,S as oe,W as Oe}from"./chunk-KPSVwAyv.js";import{u as re,r as J,i as se}from"./app-BtfI-58n.js";import{r as ce}from"./chunk-Qe-_4ASA.js";import{f as xe,c as le,g as ve,s as Me,o as Ae}from"./chunk-Qa9RIO0M.js";import{r as ee}from"./chunk-Tj_a7zxz.js";import{_ as he}from"./chunk-DlAUqK2U.js";import{r as ye}from"./chunk-a4bA4f3r.js";import{r as be}from"./chunk-qku2UxUN.js";import{a as Z}from"./chunk-D-7B8ZCD.js";import{r as de}from"./chunk-BgOPVSvg.js";import{r as Pe}from"./chunk-Dd0ZqfO5.js";import{r as ke}from"./chunk-Dfha1x8d.js";import{r as Re}from"./chunk-jrLe6Yn-.js";import{r as qe}from"./chunk-C-3dICy5.js";import{r as Fe}from"./chunk-BB-VyOHu.js";import{r as Ke}from"./chunk-DkomcDkT.js";import{r as me}from"./chunk-CYw1XsNK.js";const Ue={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Ve={class:"flex min-h-full items-center justify-center p-4"},De={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-lg w-full"},Ee={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Ne={class:"text-lg font-semibold text-gray-900 dark:text-white"},Be={key:0,class:"p-3 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm rounded-lg"},ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ie=["placeholder"],Xe={key:0,class:"mt-1 text-sm text-red-600"},Le={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},We=["placeholder"],He={class:"grid grid-cols-2 gap-4"},Je={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ge=["value"],Qe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ye=["value"],Ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},et={key:1},tt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},rt={value:""},at=["value"],ot={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},st={class:"space-y-2 mb-2"},lt={class:"flex-1 text-sm text-gray-700 dark:text-gray-300"},dt=["onClick"],nt={class:"flex gap-2"},it=["placeholder"],ct={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700"},ut=["disabled"],gt={__name:"TodoModal",props:{show:Boolean,todo:Object,teamMembers:Array,templates:Array,types:Object,priorities:Object,panelType:{type:String,default:"business",validator:d=>["business","saleshead"].includes(d)}},emits:["close","saved"],setup(d,{emit:O}){const{t:o}=re(),i=d,R=K(()=>i.panelType==="saleshead"?"sales-head":"business"),C=O,s=j({title:"",description:"",type:"personal",priority:"medium",due_date:"",assigned_to:"",subtasks:[]}),$=j(""),k=j(!1),S=j({}),F=()=>{s.value={title:"",description:"",type:"personal",priority:"medium",due_date:"",assigned_to:"",subtasks:[]},$.value="",S.value={}};te(()=>i.todo,w=>{w?s.value={title:w.title||"",description:w.description||"",type:w.type||"personal",priority:w.priority||"medium",due_date:w.due_date?w.due_date.slice(0,16):"",assigned_to:w.assignee?.id||"",subtasks:w.subtasks?.map(p=>({title:p.title}))||[]}:F()},{immediate:!0});const z=()=>{$.value.trim()&&(s.value.subtasks.push({title:$.value.trim()}),$.value="")},V=w=>{s.value.subtasks.splice(w,1)},D=async()=>{k.value=!0,S.value={};const w=i.todo?route(`${R.value}.todos.update`,i.todo.id):route(`${R.value}.todos.store`);try{await J();const p={title:s.value.title,description:s.value.description||null,type:s.value.type,priority:s.value.priority,due_date:s.value.due_date||null,assigned_to:s.value.assigned_to||null,subtasks:s.value.subtasks},b=i.todo?await window.axios.put(w,p):await window.axios.post(w,p);b.data.success!==!1?(C("saved"),C("close"),F()):S.value=b.data.errors||{general:b.data.error||o("todo.error_occurred")}}catch(p){if(console.error("Failed to save todo:",p),se(p)){S.value={general:o("todo.session_expired")},await J();return}p.response?.data?.errors?S.value=p.response.data.errors:p.response?.data?.error?S.value={general:p.response.data.error}:S.value={general:o("todo.network_error")}}finally{k.value=!1}},I=()=>{C("close"),F()},W=K(()=>!!i.todo),H=K(()=>W.value?o("todo.edit_title"):o("todo.new_title"));return(w,p)=>(a(),U(ie,{to:"body"},[f(Y,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Q(()=>[d.show?(a(),l("div",Ue,[e("div",{class:"fixed inset-0 bg-gray-500 dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-75",onClick:I}),e("div",Ve,[f(Y,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:Q(()=>[d.show?(a(),l("div",De,[e("div",Ee,[e("h3",Ne,t(H.value),1),e("button",{onClick:I,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"},[f(r(ce),{class:"w-5 h-5"})])]),e("form",{onSubmit:ne(D,["prevent"]),class:"p-6 space-y-4"},[S.value.general?(a(),l("div",Be,t(S.value.general),1)):h("",!0),e("div",null,[e("label",ze,t(r(o)("todo.title_label"))+" * ",1),M(e("input",{"onUpdate:modelValue":p[0]||(p[0]=b=>s.value.title=b),type:"text",required:"",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:r(o)("todo.title_placeholder")},null,8,Ie),[[B,s.value.title]]),S.value.title?(a(),l("p",Xe,t(S.value.title[0]),1)):h("",!0)]),e("div",null,[e("label",Le,t(r(o)("todo.description_label")),1),M(e("textarea",{"onUpdate:modelValue":p[1]||(p[1]=b=>s.value.description=b),rows:"3",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:r(o)("todo.description_placeholder")},null,8,We),[[B,s.value.description]])]),e("div",He,[e("div",null,[e("label",Je,t(r(o)("todo.type_label")),1),M(e("select",{"onUpdate:modelValue":p[2]||(p[2]=b=>s.value.type=b),class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[(a(!0),l(T,null,P(d.types,(b,q)=>(a(),l("option",{key:q,value:q},t(b),9,Ge))),128))],512),[[G,s.value.type]])]),e("div",null,[e("label",Qe,t(r(o)("todo.priority_label")),1),M(e("select",{"onUpdate:modelValue":p[3]||(p[3]=b=>s.value.priority=b),class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[(a(!0),l(T,null,P(d.priorities,(b,q)=>(a(),l("option",{key:q,value:q},t(b),9,Ye))),128))],512),[[G,s.value.priority]])])]),e("div",null,[e("label",Ze,t(r(o)("todo.due_date_label")),1),M(e("input",{"onUpdate:modelValue":p[4]||(p[4]=b=>s.value.due_date=b),type:"datetime-local",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[B,s.value.due_date]])]),d.teamMembers&&d.teamMembers.length>0?(a(),l("div",et,[e("label",tt,t(r(o)("todo.assignee_label")),1),M(e("select",{"onUpdate:modelValue":p[5]||(p[5]=b=>s.value.assigned_to=b),class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e("option",rt,t(r(o)("todo.assignee_self")),1),(a(!0),l(T,null,P(d.teamMembers,b=>(a(),l("option",{key:b.id,value:b.id},t(b.name)+" ("+t(b.role)+") ",9,at))),128))],512),[[G,s.value.assigned_to]])])):h("",!0),e("div",null,[e("label",ot,t(r(o)("todo.subtasks_label")),1),e("div",st,[(a(!0),l(T,null,P(s.value.subtasks,(b,q)=>(a(),l("div",{key:q,class:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700 rounded-lg"},[e("span",lt,t(b.title),1),e("button",{type:"button",onClick:A=>V(q),class:"p-1 text-gray-400 hover:text-red-500"},[f(r(xe),{class:"w-4 h-4"})],8,dt)]))),128))]),e("div",nt,[M(e("input",{"onUpdate:modelValue":p[6]||(p[6]=b=>$.value=b),type:"text",onKeyup:pe(z,["enter"]),class:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:r(o)("todo.new_subtask")},null,40,it),[[B,$.value]]),e("button",{type:"button",onClick:z,class:"px-3 py-2 bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-500"},[f(r(ee),{class:"w-5 h-5"})])])])],32),e("div",ct,[e("button",{type:"button",onClick:I,class:"px-4 py-2.5 text-gray-700 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},t(r(o)("common.cancel")),1),e("button",{onClick:D,disabled:k.value,class:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl transition-colors disabled:opacity-50"},t(k.value?r(o)("todo.saving"):r(o)("common.save")),9,ut)])])):h("",!0)]),_:1})])])):h("",!0)]),_:1})]))}},yt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},bt={class:"flex min-h-full items-center justify-center p-4"},mt={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full"},pt={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},xt={class:"text-lg font-semibold text-gray-900 dark:text-white"},vt={key:0,class:"p-3 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm rounded-lg"},ht={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},kt={class:"grid grid-cols-4 gap-2"},ft=["onClick"],_t={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},wt={key:1},$t={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Ct={class:"flex gap-2"},St=["onClick"],jt={key:2},Tt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Ot=["placeholder"],Mt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},At={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Pt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Rt={class:"space-y-2"},qt=["value"],Ft={class:"text-sm text-gray-700 dark:text-gray-300"},Kt={class:"flex items-center justify-between px-6 py-4 border-t border-gray-200 dark:border-gray-700"},Ut={class:"flex items-center gap-3"},Vt=["disabled"],Dt={__name:"RecurrenceModal",props:{show:Boolean,todo:Object,panelType:{type:String,default:"business",validator:d=>["business","saleshead"].includes(d)}},emits:["close","saved"],setup(d,{emit:O}){const{t:o}=re(),i=d,R=K(()=>i.panelType==="saleshead"?"sales-head":"business"),C=O,s=j({frequency:"daily",interval:1,days_of_week:[],day_of_month:null,start_date:"",end_date:"",generation_mode:"on_time"}),$=j(!1),k=j({}),S=K(()=>({daily:o("todos.recurrence.daily"),weekly:o("todos.recurrence.weekly"),monthly:o("todos.recurrence.monthly"),yearly:o("todos.recurrence.yearly")})),F=K(()=>[{value:1,label:o("todos.recurrence.day_mon")},{value:2,label:o("todos.recurrence.day_tue")},{value:3,label:o("todos.recurrence.day_wed")},{value:4,label:o("todos.recurrence.day_thu")},{value:5,label:o("todos.recurrence.day_fri")},{value:6,label:o("todos.recurrence.day_sat")},{value:7,label:o("todos.recurrence.day_sun")}]),z=K(()=>({on_time:o("todos.recurrence.on_time"),advance:o("todos.recurrence.advance")})),V=()=>new Date().toISOString().split("T")[0],D=()=>{s.value={frequency:"daily",interval:1,days_of_week:[],day_of_month:null,start_date:V(),end_date:"",generation_mode:"on_time"},k.value={}};te(()=>i.todo,A=>{if(A?.recurrence){const y=A.recurrence;s.value={frequency:y.frequency||"daily",interval:y.interval||1,days_of_week:y.days_of_week||[],day_of_month:y.day_of_month||null,start_date:y.start_date||V(),end_date:y.end_date||"",generation_mode:y.generation_mode||"on_time"}}else D()},{immediate:!0});const I=A=>{const y=s.value.days_of_week.indexOf(A);y>-1?s.value.days_of_week.splice(y,1):(s.value.days_of_week.push(A),s.value.days_of_week.sort((u,x)=>u-x))},W=async()=>{$.value=!0,k.value={};const A=i.todo?.recurrence?route(`${R.value}.todo-recurrences.update`,i.todo.recurrence.id):route(`${R.value}.todos.recurrence.store`,i.todo.id);try{await J();const y={frequency:s.value.frequency,interval:s.value.interval,days_of_week:s.value.frequency==="weekly"?s.value.days_of_week:null,day_of_month:s.value.frequency==="monthly"?s.value.day_of_month:null,start_date:s.value.start_date,end_date:s.value.end_date||null,generation_mode:s.value.generation_mode},u=i.todo?.recurrence?await window.axios.put(A,y):await window.axios.post(A,y);u.data.success!==!1?(C("saved"),C("close"),D()):k.value=u.data.errors||{general:u.data.error||o("common.error")}}catch(y){if(console.error("Failed to save recurrence:",y),se(y)){k.value={general:o("todos.recurrence.session_expired")},await J();return}y.response?.data?.errors?k.value=y.response.data.errors:y.response?.data?.error?k.value={general:y.response.data.error}:k.value={general:o("todos.recurrence.network_error")}}finally{$.value=!1}},H=async()=>{if(i.todo?.recurrence&&confirm(o("todos.recurrence.delete_confirm")))try{await J(),(await window.axios.delete(route(`${R.value}.todo-recurrences.destroy`,i.todo.recurrence.id))).data.success!==!1&&(C("saved"),C("close"))}catch(A){console.error("Failed to delete recurrence:",A),se(A)&&(k.value={general:o("todos.recurrence.session_expired")},await J())}},w=()=>{C("close"),D()},p=K(()=>!!i.todo?.recurrence),b=K(()=>p.value?o("todos.recurrence.edit_title"):o("todos.recurrence.title")),q=K(()=>({daily:o("todos.recurrence.interval_day"),weekly:o("todos.recurrence.interval_week"),monthly:o("todos.recurrence.interval_month"),yearly:o("todos.recurrence.interval_year")})[s.value.frequency]||"");return(A,y)=>(a(),U(ie,{to:"body"},[f(Y,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Q(()=>[d.show?(a(),l("div",yt,[e("div",{class:"fixed inset-0 bg-gray-500 dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-75",onClick:w}),e("div",bt,[f(Y,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:Q(()=>[d.show?(a(),l("div",mt,[e("div",pt,[e("h3",xt,t(b.value),1),e("button",{onClick:w,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"},[f(r(ce),{class:"w-5 h-5"})])]),e("form",{onSubmit:ne(W,["prevent"]),class:"p-6 space-y-4"},[k.value.general?(a(),l("div",vt,t(k.value.general),1)):h("",!0),e("div",null,[e("label",ht,t(r(o)("todos.recurrence.frequency")),1),e("div",kt,[(a(!0),l(T,null,P(S.value,(u,x)=>(a(),l("button",{key:x,type:"button",onClick:c=>s.value.frequency=x,class:_(["px-3 py-2 text-sm font-medium rounded-lg transition-colors",s.value.frequency===x?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},t(u),11,ft))),128))])]),e("div",null,[e("label",_t,t(r(o)("todos.recurrence.every"))+" "+t(q.value),1),M(e("input",{"onUpdate:modelValue":y[0]||(y[0]=u=>s.value.interval=u),type:"number",min:"1",max:"365",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[B,s.value.interval,void 0,{number:!0}]])]),s.value.frequency==="weekly"?(a(),l("div",wt,[e("label",$t,t(r(o)("todos.recurrence.days")),1),e("div",Ct,[(a(!0),l(T,null,P(F.value,u=>(a(),l("button",{key:u.value,type:"button",onClick:x=>I(u.value),class:_(["w-10 h-10 text-sm font-medium rounded-lg transition-colors",s.value.days_of_week.includes(u.value)?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},t(u.label),11,St))),128))])])):h("",!0),s.value.frequency==="monthly"?(a(),l("div",jt,[e("label",Tt,t(r(o)("todos.recurrence.day_of_month")),1),M(e("input",{"onUpdate:modelValue":y[1]||(y[1]=u=>s.value.day_of_month=u),type:"number",min:"1",max:"31",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:r(o)("todos.recurrence.day_of_month_placeholder")},null,8,Ot),[[B,s.value.day_of_month,void 0,{number:!0}]])])):h("",!0),e("div",null,[e("label",Mt,t(r(o)("todos.recurrence.start_date")),1),M(e("input",{"onUpdate:modelValue":y[2]||(y[2]=u=>s.value.start_date=u),type:"date",required:"",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[B,s.value.start_date]])]),e("div",null,[e("label",At,t(r(o)("todos.recurrence.end_date")),1),M(e("input",{"onUpdate:modelValue":y[3]||(y[3]=u=>s.value.end_date=u),type:"date",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[B,s.value.end_date]])]),e("div",null,[e("label",Pt,t(r(o)("todos.recurrence.generation_time")),1),e("div",Rt,[(a(!0),l(T,null,P(z.value,(u,x)=>(a(),l("label",{key:x,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[M(e("input",{type:"radio","onUpdate:modelValue":y[4]||(y[4]=c=>s.value.generation_mode=c),value:x,class:"text-blue-600 focus:ring-blue-500"},null,8,qt),[[Te,s.value.generation_mode]]),e("span",Ft,t(u),1)]))),128))])])],32),e("div",Kt,[e("div",null,[p.value?(a(),l("button",{key:0,type:"button",onClick:H,class:"text-sm text-red-600 hover:text-red-700 font-medium"},t(r(o)("common.delete")),1)):h("",!0)]),e("div",Ut,[e("button",{type:"button",onClick:w,class:"px-4 py-2.5 text-gray-700 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},t(r(o)("common.cancel")),1),e("button",{onClick:W,disabled:$.value,class:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl transition-colors disabled:opacity-50"},t($.value?r(o)("common.saving")+"...":r(o)("common.save")),9,Vt)])])])):h("",!0)]),_:1})])])):h("",!0)]),_:1})]))}},Et={class:"flex min-h-screen items-start justify-center p-4 pt-16"},Nt={class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl z-10"},Bt={class:"p-6"},zt={class:"flex items-start gap-4 mb-6"},It=["disabled"],Xt={class:"flex-1"},Lt={class:"flex items-center flex-wrap gap-2 mt-2"},Wt={class:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-sm"},Ht={key:1,class:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 text-sm"},Jt={key:0,class:"mb-6 p-4 bg-purple-50 dark:bg-purple-900/20 rounded-xl border border-purple-200 dark:border-purple-800/30"},Gt={class:"flex items-center justify-between mb-3"},Qt={class:"font-semibold text-purple-800 dark:text-purple-300 flex items-center gap-2"},Yt={class:"text-sm font-bold text-purple-700 dark:text-purple-400"},Zt={class:"h-2 bg-purple-200 dark:bg-purple-800/50 rounded-full overflow-hidden mb-3"},er={class:"space-y-2"},tr={class:"flex items-center gap-2"},rr={class:"text-sm text-gray-700 dark:text-gray-300"},ar={class:"flex items-center gap-2"},or={key:0,class:"text-xs text-green-600 dark:text-green-400"},sr={key:2,class:"w-5 h-5 rounded-full border-2 border-gray-300 dark:border-gray-600"},lr={key:0,class:"mt-3 flex items-center gap-2 text-sm text-amber-600 dark:text-amber-400"},dr={class:"mb-6"},nr={class:"text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2"},ir=["placeholder"],cr={key:1,class:"text-gray-700 dark:text-gray-300"},ur={key:1,class:"grid grid-cols-2 gap-4 mb-6"},gr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},yr=["value"],br={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},mr=["value"],pr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},xr={key:0},vr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},hr={value:""},kr=["value"],fr={key:1,class:"col-span-2"},_r={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},wr={class:"flex flex-wrap gap-2"},$r=["onClick"],Cr={key:2,class:"mb-6"},Sr={class:"space-y-2"},jr=["onClick"],Tr={class:"mb-6"},Or={class:"flex gap-2"},Mr=["placeholder"],Ar=["disabled"],Pr={class:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700"},Rr={class:"text-xs text-gray-500 dark:text-gray-400"},qr={class:"flex items-center gap-2"},Fr=["disabled"],Kr={__name:"TodoDetailModal",props:{show:Boolean,todo:Object,teamMembers:Array,types:Object,priorities:Object},emits:["close","update","delete","toggle","toggleSubtask","addSubtask"],setup(d,{emit:O}){const{t:o}=re(),i=d,R=O,C=j(!1),s=j({}),$=j(""),k=j(!0),S=j(!1);te(()=>i.todo,u=>{u&&(s.value={title:u.title,description:u.description||"",type:u.type,priority:u.priority,due_date:u.due_date?u.due_date.substring(0,16):"",assigned_to:u.assignee?.id||"",assignee_ids:u.assignees?.map(x=>x.user_id)||[]})},{immediate:!0});const F={urgent:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",border:"border-red-500"},high:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-400",border:"border-orange-500"},medium:{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-400",border:"border-yellow-500"},low:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-400",border:"border-green-500"}},z={personal:ve,team:be,process:le},V=K(()=>i.todo?.status==="completed"),D=K(()=>i.todo?.is_team_task),I=()=>{C.value=!1,R("close")},W=()=>{C.value=!0},H=()=>{C.value=!1,i.todo&&(s.value={title:i.todo.title,description:i.todo.description||"",type:i.todo.type,priority:i.todo.priority,due_date:i.todo.due_date?i.todo.due_date.substring(0,16):"",assigned_to:i.todo.assignee?.id||"",assignee_ids:i.todo.assignees?.map(u=>u.user_id)||[]})},w=async()=>{S.value=!0;try{await R("update",i.todo.id,s.value),C.value=!1}finally{S.value=!1}},p=()=>{R("toggle",i.todo)},b=()=>{confirm(o("todos.detail.delete_confirm"))&&R("delete",i.todo)},q=()=>{$.value.trim()&&(R("addSubtask",i.todo,$.value.trim()),$.value="")},A=u=>{R("toggleSubtask",i.todo,u)},y=u=>{const x=s.value.assignee_ids.indexOf(u);x>-1?s.value.assignee_ids.splice(x,1):s.value.assignee_ids.push(u)};return(u,x)=>(a(),U(ie,{to:"body"},[f(Y,{name:"modal"},{default:Q(()=>[d.show&&d.todo?(a(),l("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:ne(I,["self"])},[e("div",Et,[e("div",{class:"fixed inset-0 bg-black/60",onClick:I}),e("div",Nt,[e("div",{class:_(["h-2 rounded-t-2xl",F[d.todo.priority]?.border?`bg-${d.todo.priority==="urgent"?"red":d.todo.priority==="high"?"orange":d.todo.priority==="medium"?"yellow":"green"}-500`:"bg-gray-400"])},null,2),e("div",Bt,[e("div",zt,[e("button",{onClick:p,disabled:D.value&&!d.todo.can_complete,class:_(["flex-shrink-0 w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all mt-1",V.value?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-green-400",D.value&&!d.todo.can_complete?"opacity-50 cursor-not-allowed":""])},[V.value?(a(),U(r(ye),{key:0,class:"w-5 h-5"})):h("",!0)],10,It),e("div",Xt,[C.value?M((a(),l("input",{key:0,"onUpdate:modelValue":x[0]||(x[0]=c=>s.value.title=c),type:"text",class:"w-full text-xl font-bold bg-transparent border-b-2 border-blue-500 text-gray-900 dark:text-white focus:outline-none pb-1"},null,512)),[[B,s.value.title]]):(a(),l("h2",{key:1,class:_(["text-xl font-bold text-gray-900 dark:text-white",V.value?"line-through text-gray-500":""])},t(d.todo.title),3)),e("div",Lt,[e("span",Wt,[(a(),U(ae(z[d.todo.type]),{class:"w-4 h-4"})),N(" "+t(d.todo.type_label),1)]),e("span",{class:_(["px-2.5 py-1 rounded-lg text-sm font-medium",F[d.todo.priority]?.bg,F[d.todo.priority]?.text])},t(d.todo.priority_label),3),d.todo.due_date_formatted?(a(),l("span",{key:0,class:_(["inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-sm",d.todo.is_overdue?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"])},[f(r(Z),{class:"w-4 h-4"}),N(" "+t(d.todo.due_date_formatted),1)],2)):h("",!0),d.todo.is_recurring?(a(),l("span",Ht,[f(r(le),{class:"w-4 h-4"}),N(" "+t(d.todo.recurrence?.frequency_label),1)])):h("",!0)])]),e("button",{onClick:I,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"},[f(r(ce),{class:"w-6 h-6"})])]),D.value?(a(),l("div",Jt,[e("div",Gt,[e("h3",Qt,[f(r(be),{class:"w-5 h-5"}),N(" "+t(r(o)("todos.detail.team_progress")),1)]),e("span",Yt,t(d.todo.completed_assignees_count)+"/"+t(d.todo.assignees_count)+" "+t(r(o)("todos.detail.completed")),1)]),e("div",Zt,[e("div",{style:oe({width:`${d.todo.team_progress}%`}),class:"h-full bg-purple-500 transition-all duration-300"},null,4)]),e("div",er,[(a(!0),l(T,null,P(d.todo.assignees,c=>(a(),l("div",{key:c.id,class:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-lg"},[e("div",tr,[e("div",{class:_(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",c.is_completed?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"])},t(c.user?.name?.charAt(0).toUpperCase()),3),e("span",rr,t(c.user?.name),1)]),e("div",ar,[c.is_completed?(a(),l("span",or,t(c.completed_at),1)):h("",!0),c.is_completed?(a(),U(r(ye),{key:1,class:"w-5 h-5 text-green-500"})):(a(),l("div",sr))])]))),128))]),!d.todo.is_team_completed&&d.todo.assignees_count>0?(a(),l("div",lr,[f(r(de),{class:"w-4 h-4"}),N(" "+t(r(o)("todos.detail.team_incomplete_warning")),1)])):h("",!0)])):h("",!0),e("div",dr,[e("h3",nr,t(r(o)("todos.detail.description")),1),C.value?M((a(),l("textarea",{key:0,"onUpdate:modelValue":x[1]||(x[1]=c=>s.value.description=c),rows:"3",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white resize-none",placeholder:r(o)("todos.detail.description_placeholder")},null,8,ir)),[[B,s.value.description]]):(a(),l("p",cr,t(d.todo.description||r(o)("todos.detail.no_description")),1))]),C.value?(a(),l("div",ur,[e("div",null,[e("label",gr,t(r(o)("todos.detail.type")),1),M(e("select",{"onUpdate:modelValue":x[2]||(x[2]=c=>s.value.type=c),class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"},[(a(!0),l(T,null,P(d.types,(c,X)=>(a(),l("option",{key:X,value:X},t(c),9,yr))),128))],512),[[G,s.value.type]])]),e("div",null,[e("label",br,t(r(o)("todos.detail.priority")),1),M(e("select",{"onUpdate:modelValue":x[3]||(x[3]=c=>s.value.priority=c),class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"},[(a(!0),l(T,null,P(d.priorities,(c,X)=>(a(),l("option",{key:X,value:X},t(c),9,mr))),128))],512),[[G,s.value.priority]])]),e("div",null,[e("label",pr,t(r(o)("todos.detail.due_date")),1),M(e("input",{"onUpdate:modelValue":x[4]||(x[4]=c=>s.value.due_date=c),type:"datetime-local",class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"},null,512),[[B,s.value.due_date]])]),s.value.type!=="team"?(a(),l("div",xr,[e("label",vr,t(r(o)("todos.detail.assign_to")),1),M(e("select",{"onUpdate:modelValue":x[5]||(x[5]=c=>s.value.assigned_to=c),class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"},[e("option",hr,t(r(o)("common.select")),1),(a(!0),l(T,null,P(d.teamMembers,c=>(a(),l("option",{key:c.id,value:c.id},t(c.name),9,kr))),128))],512),[[G,s.value.assigned_to]])])):h("",!0),s.value.type==="team"?(a(),l("div",fr,[e("label",_r,t(r(o)("todos.detail.team_members")),1),e("div",wr,[(a(!0),l(T,null,P(d.teamMembers,c=>(a(),l("button",{key:c.id,onClick:X=>y(c.id),class:_(["px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",s.value.assignee_ids.includes(c.id)?"bg-purple-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},t(c.name),11,$r))),128))])])):h("",!0)])):h("",!0),d.todo.subtasks&&d.todo.subtasks.length>0?(a(),l("div",Cr,[e("button",{onClick:x[6]||(x[6]=c=>k.value=!k.value),class:"flex items-center gap-2 text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 hover:text-gray-700 dark:hover:text-gray-200"},[(a(),U(ae(k.value?r(Pe):r(Me)),{class:"w-4 h-4"})),N(" "+t(r(o)("todos.detail.subtasks"))+" ("+t(d.todo.completed_subtasks_count)+"/"+t(d.todo.subtasks_count)+") ",1)]),M(e("div",Sr,[(a(!0),l(T,null,P(d.todo.subtasks,c=>(a(),l("div",{key:c.id,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[e("button",{onClick:X=>A(c),class:_(["flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",c.is_completed?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-green-400"])},[c.is_completed?(a(),U(r(ke),{key:0,class:"w-3 h-3"})):h("",!0)],10,jr),e("span",{class:_(["text-sm",c.is_completed?"line-through text-gray-400":"text-gray-700 dark:text-gray-300"])},t(c.title),3)]))),128))],512),[[Oe,k.value]])])):h("",!0),e("div",Tr,[e("div",Or,[M(e("input",{"onUpdate:modelValue":x[7]||(x[7]=c=>$.value=c),type:"text",placeholder:r(o)("todos.detail.add_subtask_placeholder"),onKeyup:pe(q,["enter"]),class:"flex-1 px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white text-sm"},null,40,Mr),[[B,$.value]]),e("button",{onClick:q,disabled:!$.value.trim(),class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg transition-colors"},[f(r(ee),{class:"w-5 h-5"})],8,Ar)])]),e("div",Pr,[e("div",Rr,t(r(o)("todos.detail.created"))+": "+t(d.todo.created_at),1),e("div",qr,[C.value?(a(),l(T,{key:0},[e("button",{onClick:H,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},t(r(o)("common.cancel")),1),e("button",{onClick:w,disabled:S.value,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors"},t(S.value?r(o)("common.saving")+"...":r(o)("common.save")),9,Fr)],64)):(a(),l(T,{key:1},[e("button",{onClick:b,class:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"},[f(r(xe),{class:"w-5 h-5"})]),e("button",{onClick:W,class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-medium rounded-lg transition-colors flex items-center gap-2"},[f(r(Re),{class:"w-4 h-4"}),N(" "+t(r(o)("common.edit")),1)])],64))])])])])])])):h("",!0)]),_:1})]))}},Ur=he(Kr,[["__scopeId","data-v-8996e677"]]),Vr={class:"h-full flex flex-col -m-4 sm:-m-6 lg:-m-8"},Dr={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 lg:px-8 py-4"},Er={class:"flex items-center justify-between"},Nr={class:"text-2xl font-bold text-gray-900 dark:text-white"},Br={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},zr={class:"flex items-center gap-3"},Ir={class:"flex items-center gap-4 mt-4"},Xr={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},Lr=["onClick"],Wr={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},Hr=["onClick"],Jr={class:"flex items-center gap-4 ml-auto text-sm"},Gr={class:"flex items-center gap-1.5 text-red-600 dark:text-red-400"},Qr={class:"font-semibold"},Yr={class:"text-gray-500 dark:text-gray-400"},Zr={class:"flex items-center gap-1.5 text-green-600 dark:text-green-400"},ea={class:"font-semibold"},ta={class:"text-gray-500 dark:text-gray-400"},ra={class:"flex-1 overflow-x-auto p-4 sm:p-6"},aa={class:"flex gap-4 h-full min-w-max"},oa={class:"p-3 flex items-center gap-2"},sa={class:"font-semibold text-gray-700 dark:text-gray-300 text-sm"},la={class:"ml-auto text-xs font-bold px-2 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-full"},da={class:"flex-1 overflow-y-auto p-2 space-y-2"},na=["onClick"],ia={class:"flex items-start gap-2 mb-2"},ca={class:"flex-1 min-w-0"},ua={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-2"},ga=["onClick"],ya={class:"flex items-center flex-wrap gap-1.5 mt-2"},ba={key:0,class:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400"},ma={key:0,class:"mt-3"},pa={class:"flex items-center justify-between text-xs mb-1"},xa={class:"text-gray-500 dark:text-gray-400"},va={class:"font-medium text-gray-700 dark:text-gray-300"},ha={class:"h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},ka={class:"flex items-center mt-2 -space-x-1"},fa=["title"],_a={key:0,class:"w-6 h-6 rounded-full border-2 border-white dark:border-gray-800 bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-xs font-medium text-gray-600 dark:text-gray-400"},wa={key:1,class:"mt-3"},$a={class:"flex items-center justify-between text-xs mb-1"},Ca={class:"text-gray-500 dark:text-gray-400"},Sa={class:"font-medium text-gray-700 dark:text-gray-300"},ja={class:"h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Ta={class:"flex items-center justify-between mt-3 pt-2 border-t border-gray-100 dark:border-gray-700"},Oa={key:1,class:"text-xs text-gray-400"},Ma={key:2,class:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400"},Aa={class:"w-5 h-5 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center text-xs font-medium text-gray-700 dark:text-gray-300"},Pa={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},Ra={class:"text-sm"},qa={class:"p-2 border-t border-gray-200 dark:border-gray-700"},Fa={__name:"TodosIndex",props:{todos:Object,stats:Object,teamMembers:Array,templates:Array,types:Object,priorities:Object,statuses:Object,filter:String,statusFilter:String,panelType:{type:String,default:"business",validator:d=>["business","saleshead","marketing","finance","operator","hr"].includes(d)}},setup(d){const{t:O}=re(),o=d,i=K(()=>({business:{primaryColor:"blue",routePrefix:"business",buttonClass:"bg-blue-600 hover:bg-blue-700 shadow-blue-500/25",templatesRoute:"business.todo-templates.index"},saleshead:{primaryColor:"emerald",routePrefix:"sales-head",buttonClass:"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-500/25",templatesRoute:"sales-head.todo-templates.index"},marketing:{primaryColor:"blue",routePrefix:"marketing",buttonClass:"bg-blue-600 hover:bg-blue-700 shadow-blue-500/25",templatesRoute:"marketing.todo-templates.index"},finance:{primaryColor:"green",routePrefix:"finance",buttonClass:"bg-green-600 hover:bg-green-700 shadow-green-500/25",templatesRoute:"finance.todo-templates.index"},operator:{primaryColor:"blue",routePrefix:"operator",buttonClass:"bg-blue-600 hover:bg-blue-700 shadow-blue-500/25",templatesRoute:"operator.todo-templates.index"},hr:{primaryColor:"purple",routePrefix:"hr",buttonClass:"bg-purple-600 hover:bg-purple-700 shadow-purple-500/25",templatesRoute:"hr.todo-templates.index"}})[o.panelType]),R=j(!1),C=j(!1),s=j(!1),$=j(null),k=j(null),S=j(null),F=j(o.filter||"all"),z=j(o.statusFilter||"active"),V=j(null),D=[{key:"overdue",labelKey:"todos.columns.overdue",color:"red",icon:de},{key:"today",labelKey:"todos.columns.today",color:"blue",icon:me},{key:"tomorrow",labelKey:"todos.columns.tomorrow",color:"indigo",icon:Z},{key:"this_week",labelKey:"todos.columns.this_week",color:"purple",icon:Z},{key:"later",labelKey:"todos.columns.later",color:"gray",icon:Z}],I=[{value:"all",labelKey:"todos.filters.all"},{value:"personal",labelKey:"todos.filters.personal"},{value:"team",labelKey:"todos.filters.team"},{value:"process",labelKey:"todos.filters.process"}],W=[{value:"active",labelKey:"todos.status.active"},{value:"completed",labelKey:"todos.status.completed"},{value:"all",labelKey:"todos.status.all"}];te([F,z],()=>{L.get(route(`${i.value.routePrefix}.todos.index`),{filter:F.value,status:z.value},{preserveState:!0,preserveScroll:!0})});const H=(v=null)=>{$.value=v,R.value=!0},w=()=>{R.value=!1,$.value=null},p=()=>{C.value=!1,S.value=null},b=async v=>{V.value=v.id;try{const m=await fetch(route(`${i.value.routePrefix}.todos.show`,v.id),{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(m.ok){const g=await m.json();k.value=g.todo,s.value=!0}}catch(m){console.error("Failed to load todo:",m)}finally{V.value=null}},q=()=>{s.value=!1,k.value=null},A=async(v,m)=>{m?.stopPropagation();try{(await fetch(route(`${i.value.routePrefix}.todos.toggle`,v.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}})).ok&&L.reload({preserveScroll:!0})}catch(g){console.error("Failed to toggle todo:",g)}},y=()=>{L.reload({preserveScroll:!0})},u=()=>{L.reload({preserveScroll:!0})},x=async(v,m)=>{try{const g=await fetch(route(`${i.value.routePrefix}.todos.update`,v),{method:"PUT",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(m)});if(g.ok){const n=await g.json();k.value=n.todo,L.reload({preserveScroll:!0})}}catch(g){console.error("Failed to update todo:",g)}},c=async v=>{try{(await fetch(route(`${i.value.routePrefix}.todos.destroy`,v.id),{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}})).ok&&(q(),L.reload({preserveScroll:!0}))}catch(m){console.error("Failed to delete todo:",m)}},X=async v=>{try{const m=await fetch(route(`${i.value.routePrefix}.todos.toggle`,v.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}});if(m.ok){const g=await m.json();k.value=g.todo,L.reload({preserveScroll:!0})}}catch(m){console.error("Failed to toggle todo:",m)}},fe=async(v,m)=>{try{if((await fetch(route(`${i.value.routePrefix}.todos.subtasks.toggle`,[v.id,m.id]),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}})).ok){const n=await fetch(route(`${i.value.routePrefix}.todos.show`,v.id),{headers:{Accept:"application/json"}});if(n.ok){const E=await n.json();k.value=E.todo}L.reload({preserveScroll:!0})}}catch(g){console.error("Failed to toggle subtask:",g)}},_e=async(v,m)=>{try{if((await fetch(route(`${i.value.routePrefix}.todos.subtasks.store`,v.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({title:m})})).ok){const n=await fetch(route(`${i.value.routePrefix}.todos.show`,v.id),{headers:{Accept:"application/json"}});if(n.ok){const E=await n.json();k.value=E.todo}L.reload({preserveScroll:!0})}}catch(g){console.error("Failed to add subtask:",g)}},we=v=>{const m={urgent:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500"};return m[v]||m.medium},$e=v=>{const m={urgent:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-400",high:"bg-orange-100 text-orange-700 dark:bg-orange-900/50 dark:text-orange-400",medium:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/50 dark:text-yellow-400",low:"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400"};return m[v]||m.medium},Ce=v=>{const m={red:"bg-red-500",blue:"bg-blue-500",indigo:"bg-indigo-500",purple:"bg-purple-500",gray:"bg-gray-500"};return m[v]||m.gray},ue=v=>o.todos[v]||[],ge=v=>ue(v).length,Se=K(()=>{try{return route(i.value.templatesRoute),!0}catch{return!1}});return(v,m)=>(a(),l(T,null,[e("div",Vr,[e("div",Dr,[e("div",Er,[e("div",null,[e("h1",Nr,t(r(O)("todos.title")),1),e("p",Br,t(r(O)("todos.active_count",{count:d.stats.total})),1)]),e("div",zr,[Se.value?(a(),U(r(je),{key:0,href:v.route(i.value.templatesRoute),class:"inline-flex items-center gap-2 px-4 py-2.5 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 font-medium rounded-xl transition-colors"},{default:Q(()=>[f(r(qe),{class:"w-5 h-5"}),N(" "+t(r(O)("todos.templates")),1)]),_:1},8,["href"])):h("",!0),e("button",{onClick:m[0]||(m[0]=g=>H()),class:_(["inline-flex items-center gap-2 px-4 py-2.5 text-white font-medium rounded-xl transition-colors shadow-lg",i.value.buttonClass])},[f(r(ee),{class:"w-5 h-5"}),N(" "+t(r(O)("todos.new_task")),1)],2)])]),e("div",Ir,[e("div",Xr,[(a(),l(T,null,P(I,g=>e("button",{key:g.value,onClick:n=>F.value=g.value,class:_(["px-4 py-2 text-sm font-medium rounded-md transition-colors",F.value===g.value?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])},t(r(O)(g.labelKey)),11,Lr)),64))]),e("div",Wr,[(a(),l(T,null,P(W,g=>e("button",{key:g.value,onClick:n=>z.value=g.value,class:_(["px-4 py-2 text-sm font-medium rounded-md transition-colors",z.value===g.value?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])},t(r(O)(g.labelKey)),11,Hr)),64))]),e("div",Jr,[e("div",Gr,[f(r(de),{class:"w-4 h-4"}),e("span",Qr,t(d.stats.overdue),1),e("span",Yr,t(r(O)("todos.stats.overdue")),1)]),e("div",Zr,[f(r(ke),{class:"w-4 h-4"}),e("span",ea,t(d.stats.completed_today),1),e("span",ta,t(r(O)("todos.stats.completed_today")),1)])])])]),e("div",ra,[e("div",aa,[(a(),l(T,null,P(D,g=>e("div",{key:g.key,class:"flex flex-col w-80 bg-gray-100 dark:bg-gray-800/50 rounded-xl"},[e("div",oa,[e("div",{class:_(["w-2 h-2 rounded-full",Ce(g.color)])},null,2),e("h3",sa,t(r(O)(g.labelKey)),1),e("span",la,t(ge(g.key)),1)]),e("div",da,[(a(!0),l(T,null,P(ue(g.key),n=>(a(),l("div",{key:n.id,onClick:E=>b(n),class:_(["bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3 cursor-pointer transition-all hover:shadow-md hover:border-gray-300 dark:hover:border-gray-600",V.value===n.id?"opacity-50":"",n.status==="completed"?"opacity-60":""])},[e("div",ia,[e("div",{class:_(["w-1 h-full min-h-[20px] rounded-full",we(n.priority)])},null,2),e("div",ca,[e("h4",{class:_(["font-medium text-gray-900 dark:text-white text-sm leading-snug",n.status==="completed"?"line-through text-gray-500 dark:text-gray-500":""])},t(n.title),3),n.description?(a(),l("p",ua,t(n.description),1)):h("",!0)]),e("button",{onClick:E=>A(n,E),class:_(["flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-all",n.status==="completed"?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-green-400 hover:bg-green-50 dark:hover:bg-green-900/20"])},[n.status==="completed"?(a(),U(r(Fe),{key:0,class:"w-3 h-3"})):h("",!0)],10,ga)]),e("div",ya,[e("span",{class:_(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs",n.type==="team"?"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-400":n.type==="process"?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"])},[n.type==="team"?(a(),U(r(Ae),{key:0,class:"w-3 h-3"})):n.type==="process"?(a(),U(r(Ke),{key:1,class:"w-3 h-3"})):(a(),U(r(ve),{key:2,class:"w-3 h-3"})),N(" "+t(n.type_label),1)],2),e("span",{class:_(["px-1.5 py-0.5 rounded text-xs font-medium",$e(n.priority)])},t(n.priority_label),3),n.is_recurring?(a(),l("span",ba,[f(r(le),{class:"w-3 h-3"})])):h("",!0)]),n.type==="team"&&n.assignees&&n.assignees.length>0?(a(),l("div",ma,[e("div",pa,[e("span",xa,t(r(O)("todos.team_progress")),1),e("span",va,t(n.completed_assignees_count||0)+"/"+t(n.assignees_count||n.assignees.length),1)]),e("div",ha,[e("div",{style:oe({width:`${n.team_progress||0}%`}),class:_(["h-full transition-all duration-300",(n.team_progress||0)===100?"bg-green-500":"bg-blue-500"])},null,6)]),e("div",ka,[(a(!0),l(T,null,P(n.assignees.slice(0,5),(E,Ka)=>(a(),l("div",{key:E.id,class:_(["w-6 h-6 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center text-xs font-medium",E.is_completed?"bg-green-500 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300"]),title:E.user?.name+(E.is_completed?" (bajarilgan)":"")},t(E.user?.name?.charAt(0)?.toUpperCase()),11,fa))),128)),n.assignees.length>5?(a(),l("div",_a," +"+t(n.assignees.length-5),1)):h("",!0)])])):n.subtasks_count>0?(a(),l("div",wa,[e("div",$a,[e("span",Ca,t(r(O)("todos.subtasks")),1),e("span",Sa,t(n.completed_subtasks_count)+"/"+t(n.subtasks_count),1)]),e("div",ja,[e("div",{style:oe({width:`${n.progress}%`}),class:_(["h-full transition-all duration-300",n.progress===100?"bg-green-500":"bg-blue-500"])},null,6)])])):h("",!0),e("div",Ta,[n.due_date_formatted?(a(),l("div",{key:0,class:_(["flex items-center gap-1 text-xs",n.is_overdue?"text-red-500":"text-gray-500 dark:text-gray-400"])},[f(r(me),{class:"w-3.5 h-3.5"}),N(" "+t(n.due_date_formatted),1)],2)):(a(),l("div",Oa,t(r(O)("todos.no_deadline")),1)),n.type!=="team"&&n.assignee?(a(),l("div",Ma,[e("div",Aa,t(n.assignee.name?.charAt(0)?.toUpperCase()),1)])):h("",!0)])],10,na))),128)),ge(g.key)===0?(a(),l("div",Pa,[(a(),U(ae(g.icon),{class:"w-8 h-8 mx-auto mb-2 opacity-50"})),e("p",Ra,t(r(O)("todos.no_tasks")),1)])):h("",!0)]),e("div",qa,[e("button",{onClick:m[1]||(m[1]=n=>H()),class:"w-full flex items-center justify-center gap-2 py-2 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors"},[f(r(ee),{class:"w-4 h-4"}),N(" "+t(r(O)("todos.add_task")),1)])])])),64))])])]),f(gt,{show:R.value,todo:$.value,"team-members":d.teamMembers,templates:d.templates,types:d.types,priorities:d.priorities,"panel-type":d.panelType,onClose:w,onSaved:y},null,8,["show","todo","team-members","templates","types","priorities","panel-type"]),f(Dt,{show:C.value,todo:S.value,"panel-type":d.panelType,onClose:p,onSaved:u},null,8,["show","todo","panel-type"]),f(Ur,{show:s.value,todo:k.value,"team-members":d.teamMembers,types:d.types,priorities:d.priorities,onClose:q,onUpdate:x,onDelete:c,onToggle:X,onToggleSubtask:fe,onAddSubtask:_e},null,8,["show","todo","team-members","types","priorities"])],64))}},to=he(Fa,[["__scopeId","data-v-2a143832"]]);export{to as T};
