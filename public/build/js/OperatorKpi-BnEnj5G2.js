import{r as k,v as I,x as K,z as t,H as s,J as v,L as M,K as P,C as d,D as i,F as o,B as l,G as u,I as x,S as A}from"./chunk-KPSVwAyv.js";import{r as _}from"./chunk-BVrjkT6E.js";import{_ as O}from"./chunk-Cy19HSui.js";import"./chunk-S7b6IQvx.js";import"./app-906_W7J6.js";import"./chunk-BvkwlYlD.js";import"./chunk-BgShz32H.js";import"./chunk-Qe-_4ASA.js";import"./chunk-Ch0Q6XPl.js";import"./chunk-Dfha1x8d.js";import"./chunk-BgOPVSvg.js";import"./chunk-CYw1XsNK.js";import"./chunk-qku2UxUN.js";import"./chunk-D5sR6A8B.js";import"./chunk-Dems4pAU.js";import"./chunk-D59q4lxq.js";import"./chunk-Cw_2vanC.js";import"./chunk-14qmXdHo.js";import"./chunk-DN454CZt.js";import"./chunk-CYZ54WJE.js";import"./chunk-D-7B8ZCD.js";import"./chunk-J14gS6og.js";import"./chunk-B1Yis8U5.js";import"./chunk-CXygRKxK.js";import"./chunk-31-ywezX.js";import"./chunk-CQ-EgyBm.js";const U={class:"mb-8"},V={class:"flex items-center gap-4 mb-4"},H={class:"flex items-center gap-4"},J={class:"w-16 h-16 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-emerald-700 dark:text-emerald-400 font-bold text-xl"},L={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},N={class:"text-gray-600 dark:text-gray-400"},R={class:"flex items-center gap-3"},F={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8"},Y={class:"bg-gradient-to-r from-emerald-500 to-green-500 rounded-xl p-6 text-white"},Z={class:"text-3xl font-bold"},$={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},E={class:"flex items-center gap-2"},G={class:"text-2xl font-bold text-gray-900 dark:text-white"},Q={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},W={class:"text-2xl font-bold text-yellow-600"},X={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},tt={class:"text-2xl font-bold text-purple-600"},et={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},rt={class:"text-2xl font-bold text-orange-600"},st={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"},at={class:"lg:col-span-2 space-y-4"},nt={class:"flex items-center justify-between mb-4"},ot={class:"font-bold text-gray-900 dark:text-white"},dt={class:"text-sm text-gray-500"},lt={class:"flex items-center justify-between text-sm mb-2"},it={class:"text-gray-500"},gt={class:"text-gray-500"},ut={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3"},xt={class:"mt-3 flex items-center justify-between text-sm"},ct={class:"text-gray-500"},mt={key:0,class:"bg-white dark:bg-gray-800 rounded-xl p-12 text-center text-gray-500 border border-gray-200 dark:border-gray-700"},yt={class:"space-y-6"},bt={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},pt={class:"space-y-3"},ft={class:"flex-1 min-w-0"},ht={class:"font-medium text-gray-900 dark:text-white truncate"},kt={class:"text-xs text-gray-500"},vt={key:0,class:"text-center text-gray-500 text-sm py-4"},_t={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},wt={class:"space-y-3"},Bt={class:"font-medium text-gray-900 dark:text-white text-sm"},jt={class:"text-xs text-gray-500"},St={class:"text-red-600 font-bold text-sm"},Ct={key:0,class:"text-center text-green-600 text-sm py-4"},Dt={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},qt={key:0,class:"space-y-3"},Tt={class:"flex justify-between"},zt={class:"flex justify-between"},It={class:"flex justify-between"},Kt={class:"font-bold text-green-600"},Mt={class:"flex justify-between"},Pt={class:"font-bold text-red-600"},At={class:"pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-between"},Ot={class:"text-xl font-bold text-emerald-600"},Ut={class:"pt-2"},Vt={key:1,class:"text-center text-gray-500 py-4"},Ht={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},Jt={class:"overflow-x-auto"},Lt={class:"w-full"},Nt={class:"divide-y divide-gray-200 dark:divide-gray-700"},Rt={class:"px-4 py-3 text-sm text-gray-900 dark:text-white"},Ft={class:"px-4 py-3 text-center"},Yt={class:"px-4 py-3 text-center"},Zt={class:"font-medium"},$t={class:"px-4 py-3 text-center"},Et={key:0},_e={__name:"OperatorKpi",props:{user:Object,summary:Object,kpiDetails:Array,userStats:Object,recentAchievements:Array,penalties:Array,currentBonus:Object,historicalData:Array,scoreChange:Number,period:String,date:String,panelType:String},setup(a){const c=a,m=k(c.period||"monthly"),y=k(c.date||new Date().toISOString().split("T")[0]),w=()=>{_.get("/sales-head/sales-kpi/leaderboard")},b=()=>{_.get(`/sales-head/sales-kpi/operator/${c.user.id}`,{period:m.value,date:y.value},{preserveState:!0})},g=n=>n?new Intl.NumberFormat("uz-UZ").format(n)+" so'm":"0 so'm",p=n=>n?new Date(n).toLocaleDateString("uz-UZ",{day:"numeric",month:"short"}):"-",B=n=>n?n.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?",f=n=>n>=100?"text-green-600":n>=80?"text-blue-600":n>=60?"text-yellow-600":"text-red-600",j=n=>n>=100?"text-green-600":n>=80?"text-blue-600":"text-yellow-600",S=n=>n>=100?"bg-green-500":n>=80?"bg-blue-500":n>=60?"bg-yellow-500":"bg-red-500",h=n=>n>0?"text-green-600 text-sm":n<0?"text-red-600 text-sm":"text-gray-500 text-sm",C=n=>{const e={bronze:"bg-orange-100 dark:bg-orange-900/30",silver:"bg-gray-200 dark:bg-gray-700",gold:"bg-yellow-100 dark:bg-yellow-900/30",platinum:"bg-blue-100 dark:bg-blue-900/30",diamond:"bg-purple-100 dark:bg-purple-900/30"};return e[n]||e.bronze},D=n=>{const e={standard:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700",excellent:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700",accelerator:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700"};return e[n]||e.standard},q=n=>({exceptional:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700",excellent:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700",good:"px-2 py-1 rounded text-xs font-medium bg-teal-100 text-teal-700",meets:"px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-700",developing:"px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-700",needs_improvement:"px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-700"})[n]||"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700",T=n=>{const e={pending:"px-3 py-2 rounded-lg text-sm font-medium bg-yellow-100 text-yellow-700",approved:"px-3 py-2 rounded-lg text-sm font-medium bg-green-100 text-green-700",rejected:"px-3 py-2 rounded-lg text-sm font-medium bg-red-100 text-red-700"};return e[n]||e.pending},z=n=>({pending:"Kutilmoqda",approved:"Tasdiqlangan",rejected:"Rad etilgan"})[n]||n;return(n,e)=>(o(),I(O,{title:a.user?.name+" - KPI"},{default:K(()=>[t("div",U,[t("div",V,[t("button",{onClick:w,class:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"},[...e[2]||(e[2]=[t("svg",{class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),t("div",H,[t("div",J,s(B(a.user?.name)),1),t("div",null,[t("h2",L,s(a.user?.name),1),t("p",N,s(a.user?.position||"Sotuv operatori"),1)])])]),t("div",R,[v(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>m.value=r),onChange:b,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[...e[3]||(e[3]=[t("option",{value:"daily"},"Kunlik",-1),t("option",{value:"weekly"},"Haftalik",-1),t("option",{value:"monthly"},"Oylik",-1)])],544),[[M,m.value]]),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>y.value=r),type:"date",onChange:b,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},null,544),[[P,y.value]])])]),t("div",F,[t("div",Y,[e[4]||(e[4]=t("p",{class:"text-sm text-emerald-100 mb-1"},"Umumiy ball",-1)),t("p",Z,s(a.summary?.overall_score||0)+"%",1),a.scoreChange?(o(),d("p",{key:0,class:l([a.scoreChange>0?"text-emerald-200":"text-red-200","text-sm mt-1"])},s(a.scoreChange>0?"+":"")+s(a.scoreChange)+"% oldingi davrdan ",3)):i("",!0)]),t("div",$,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-500 mb-1"},"Reyting",-1)),t("div",E,[t("p",G,"#"+s(a.summary?.rank_in_team||"-"),1),a.summary?.rank_change?(o(),d("span",{key:0,class:l(h(a.summary.rank_change))},s(a.summary.rank_change>0?"â†‘":"â†“")+" "+s(Math.abs(a.summary.rank_change)),3)):i("",!0)])]),t("div",Q,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500 mb-1"},"Yutuqlar",-1)),t("p",W,s(a.userStats?.achievements_count||0),1)]),t("div",X,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-500 mb-1"},"Ballar",-1)),t("p",tt,s(a.userStats?.total_points||0),1)]),t("div",et,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-500 mb-1"},"Streak",-1)),t("p",rt,s(a.userStats?.current_streak||0)+" kun",1)])]),t("div",st,[t("div",at,[e[9]||(e[9]=t("h3",{class:"font-bold text-gray-900 dark:text-white"},"KPI ko'rsatkichlari",-1)),(o(!0),d(u,null,x(a.kpiDetails,r=>(o(),d("div",{key:r.kpi_setting_id,class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},[t("div",nt,[t("div",null,[t("h4",ot,s(r.name),1),t("p",dt,s(r.description),1)]),t("span",{class:l([f(r.score),"text-lg font-bold"])},s(r.score)+"%",3)]),t("div",lt,[t("span",it,"Haqiqiy: "+s(r.actual)+" "+s(r.unit),1),t("span",gt,"Maqsad: "+s(r.target)+" "+s(r.unit),1)]),t("div",ut,[t("div",{class:l([S(r.score),"h-3 rounded-full transition-all duration-500"]),style:A({width:Math.min(r.score,100)+"%"})},null,6)]),t("div",xt,[t("span",ct,"Vazn: "+s(r.weight)+"%",1),t("span",{class:l([r.score>=100?"text-green-600":"text-gray-600","font-medium"])},s(r.score>=100?"Maqsadga yetdi âœ“":"Davom etilmoqda"),3)])]))),128)),a.kpiDetails.length===0?(o(),d("div",mt," Bu davr uchun KPI ma'lumotlari yo'q ")):i("",!0)]),t("div",yt,[t("div",bt,[e[10]||(e[10]=t("h3",{class:"font-bold text-gray-900 dark:text-white mb-4"},"So'nggi yutuqlar",-1)),t("div",pt,[(o(!0),d(u,null,x(a.recentAchievements,r=>(o(),d("div",{key:r.id,class:"flex items-center gap-3"},[t("div",{class:l(["w-10 h-10 rounded-lg flex items-center justify-center text-lg",C(r.achievement?.tier)])},s(r.achievement?.icon||"ðŸ†"),3),t("div",ft,[t("p",ht,s(r.achievement?.name),1),t("p",kt,s(p(r.earned_at)),1)])]))),128)),a.recentAchievements.length===0?(o(),d("div",vt," Yutuqlar yo'q ")):i("",!0)])]),t("div",_t,[e[11]||(e[11]=t("h3",{class:"font-bold text-gray-900 dark:text-white mb-4"},"Bu oylik jarimalar",-1)),t("div",wt,[(o(!0),d(u,null,x(a.penalties,r=>(o(),d("div",{key:r.id,class:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg"},[t("div",null,[t("p",Bt,s(r.penalty_rule?.name||r.reason),1),t("p",jt,s(p(r.triggered_at)),1)]),t("span",St,"-"+s(g(r.penalty_amount)),1)]))),128)),a.penalties.length===0?(o(),d("div",Ct," Jarimalar yo'q âœ“ ")):i("",!0)])]),t("div",Dt,[e[17]||(e[17]=t("h3",{class:"font-bold text-gray-900 dark:text-white mb-4"},"Bonus holati",-1)),a.currentBonus?(o(),d("div",qt,[t("div",Tt,[e[12]||(e[12]=t("span",{class:"text-gray-500"},"KPI ball:",-1)),t("span",{class:l(["font-bold",j(a.currentBonus.kpi_score)])},s(a.currentBonus.kpi_score)+"%",3)]),t("div",zt,[e[13]||(e[13]=t("span",{class:"text-gray-500"},"Tier:",-1)),t("span",{class:l(D(a.currentBonus.applied_tier))},s(a.currentBonus.applied_tier),3)]),t("div",It,[e[14]||(e[14]=t("span",{class:"text-gray-500"},"Hisoblangan bonus:",-1)),t("span",Kt,s(g(a.currentBonus.base_amount)),1)]),t("div",Mt,[e[15]||(e[15]=t("span",{class:"text-gray-500"},"Jarimalar:",-1)),t("span",Pt,"-"+s(g(a.currentBonus.total_penalties||0)),1)]),t("div",At,[e[16]||(e[16]=t("span",{class:"font-medium text-gray-900 dark:text-white"},"Jami:",-1)),t("span",Ot,s(g(a.currentBonus.final_amount)),1)]),t("div",Ut,[t("span",{class:l([T(a.currentBonus.status),"w-full flex justify-center"])},s(z(a.currentBonus.status)),3)])])):(o(),d("div",Vt," Bu oy uchun bonus hali hisoblanmagan "))])])]),t("div",Ht,[e[20]||(e[20]=t("h3",{class:"font-bold text-gray-900 dark:text-white mb-4"},"Tarixiy natijalar",-1)),t("div",Jt,[t("table",Lt,[e[19]||(e[19]=t("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Davr"),t("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Ball"),t("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Reyting"),t("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Tier")])],-1)),t("tbody",Nt,[(o(!0),d(u,null,x(a.historicalData,r=>(o(),d("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",Rt,s(r.period_label),1),t("td",Ft,[t("span",{class:l(f(r.overall_score))},s(r.overall_score)+"%",3)]),t("td",Yt,[t("span",Zt,"#"+s(r.rank_in_team),1),r.rank_change?(o(),d("span",{key:0,class:l([h(r.rank_change),"ml-1 text-xs"])},s(r.rank_change>0?"â†‘":"â†“")+s(Math.abs(r.rank_change)),3)):i("",!0)]),t("td",$t,[t("span",{class:l(q(r.performance_tier))},s(r.tier_label),3)])]))),128)),a.historicalData.length===0?(o(),d("tr",Et,[...e[18]||(e[18]=[t("td",{colspan:"4",class:"px-4 py-8 text-center text-gray-500"}," Tarixiy ma'lumotlar yo'q ",-1)])])):i("",!0)])])])])]),_:1},8,["title"]))}};export{_e as default};
