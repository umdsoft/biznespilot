import{b as j,C as c,z as e,B as x,D as w,H as t,A as o,F as i,d as F,a as I,r as p,v as A,x as k,y as f,J as M,L as B,G as N,I as H,K as R,E as T}from"./chunk-KPSVwAyv.js";import{l as q,r as _}from"./chunk-BVrjkT6E.js";import{_ as E}from"./chunk-BZbMWG3C.js";import{u as V}from"./app-906_W7J6.js";import{v as D,n as G}from"./chunk-S7b6IQvx.js";import{_ as J}from"./chunk-CD__AGCm.js";import{r as K}from"./chunk-gMRH-wg7.js";import"./chunk-BvkwlYlD.js";import"./chunk-BgShz32H.js";import"./chunk-Qe-_4ASA.js";import"./chunk-Ch0Q6XPl.js";import"./chunk-Dfha1x8d.js";import"./chunk-BgOPVSvg.js";import"./chunk-CYw1XsNK.js";import"./chunk-qku2UxUN.js";import"./chunk-D5sR6A8B.js";import"./chunk-Dems4pAU.js";import"./chunk-D59q4lxq.js";import"./chunk-Cw_2vanC.js";import"./chunk-14qmXdHo.js";import"./chunk-DN454CZt.js";import"./chunk-CYZ54WJE.js";import"./chunk-D-7B8ZCD.js";import"./chunk-J14gS6og.js";const O={class:"flex items-start gap-3"},Z={class:"flex-1 min-w-0"},P={class:"flex items-center justify-between"},Q={class:"font-semibold text-gray-900 truncate"},W={key:0,class:"text-xs text-gray-400"},X={class:"text-sm text-gray-600 mt-1 line-clamp-2"},Y={class:"flex items-center gap-3 mt-2 text-xs text-gray-500"},ee={key:0},te={key:1,class:"px-2 py-0.5 bg-gray-100 rounded"},se={__name:"AlertCard",props:{alert:{type:Object,required:!0}},emits:["click"],setup(r){const{t:s}=V(),$=r,u=j(()=>{const n=$.alert.type;return{warning:"border-yellow-200",error:"border-red-200",success:"border-green-200",info:"border-blue-200"}[n]||"border-gray-200"}),y=j(()=>{const n=$.alert.type;return{warning:"bg-yellow-100",error:"bg-red-100",success:"bg-green-100",info:"bg-blue-100"}[n]||"bg-gray-100"}),g=j(()=>{const n=$.alert.type;return{warning:"text-yellow-600",error:"text-red-600",success:"text-green-600",info:"text-blue-600"}[n]||"text-gray-600"}),m=n=>{if(!n)return"";const a=new Date(n),S=new Date-a,h=Math.floor(S/6e4),b=Math.floor(h/60),C=Math.floor(b/24);return h<1?s("dashboard.time.now"):h<60?s("dashboard.time.minutes_ago",{count:h}):b<24?s("dashboard.time.hours_ago",{count:b}):C<7?s("dashboard.time.days_ago",{count:C}):a.toLocaleDateString("uz-UZ")};return(n,a)=>(i(),c("div",{class:x(["bg-white rounded-lg border p-4 hover:shadow-md transition-shadow cursor-pointer",u.value]),onClick:a[0]||(a[0]=z=>n.$emit("click",r.alert))},[e("div",O,[e("div",{class:x([y.value,"w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0"])},[r.alert.type==="warning"?(i(),c("svg",{key:0,class:x(["w-5 h-5",g.value]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...a[1]||(a[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])],2)):r.alert.type==="error"?(i(),c("svg",{key:1,class:x(["w-5 h-5",g.value]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...a[2]||(a[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)):r.alert.type==="success"?(i(),c("svg",{key:2,class:x(["w-5 h-5",g.value]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...a[3]||(a[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)):(i(),c("svg",{key:3,class:x(["w-5 h-5",g.value]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...a[4]||(a[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2))],2),e("div",Z,[e("div",P,[e("h3",Q,t(r.alert.title),1),r.alert.is_read?(i(),c("span",W,t(o(s)("dashboard.alert.read")),1)):w("",!0)]),e("p",X,t(r.alert.message),1),e("div",Y,[r.alert.created_at?(i(),c("span",ee,t(m(r.alert.created_at)),1)):w("",!0),r.alert.category?(i(),c("span",te,t(r.alert.category),1)):w("",!0)])])])],2))}},oe={class:"flex items-center justify-between"},re={class:"text-xl font-semibold text-gray-800 dark:text-gray-200"},ae={class:"py-6"},le={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ne={class:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6"},de={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700"},ie={class:"text-sm text-gray-500 dark:text-gray-400"},ce={class:"text-2xl font-bold text-gray-900 dark:text-white"},ue={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-red-200 dark:border-red-800"},ge={class:"text-sm text-red-600 dark:text-red-400"},me={class:"text-2xl font-bold text-red-600 dark:text-red-400"},ve={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-yellow-200 dark:border-yellow-800"},ye={class:"text-sm text-yellow-600 dark:text-yellow-400"},he={class:"text-2xl font-bold text-yellow-600 dark:text-yellow-400"},xe={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-green-200 dark:border-green-800"},fe={class:"text-sm text-green-600 dark:text-green-400"},be={class:"text-2xl font-bold text-green-600 dark:text-green-400"},pe={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-200 dark:border-gray-700"},ke={class:"text-sm text-gray-500 dark:text-gray-400"},_e={class:"text-2xl font-bold text-gray-900 dark:text-white"},we={class:"flex flex-wrap gap-4 mb-6"},$e={value:"all"},ze={value:"active"},Ce={value:"acknowledged"},Me={value:"resolved"},Se={value:"snoozed"},je={value:"dismissed"},Be={value:"all"},Ae={value:"critical"},De={value:"high"},Ve={value:"medium"},Le={value:"low"},Ue={value:"info"},Fe={class:"space-y-4"},Ie={key:0,class:"text-center py-12 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},Ne={class:"text-gray-500 dark:text-gray-400"},He={key:0,class:"mt-6"},Re={class:"p-6"},Te={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},qe={class:"mb-4"},Ee={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Ge=["placeholder"],Je={class:"flex justify-end space-x-3"},Ke={class:"p-6"},Oe={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},Ze={class:"mb-4"},Pe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Qe={value:1},We={value:4},Xe={value:24},Ye={value:72},et={value:168},tt={class:"flex justify-end space-x-3"},Ct=F({__name:"Index",props:{alerts:{},stats:{},filters:{}},setup(r){const{t:s}=V(),u=I({...r.filters}),y=p(!1),g=p(!1),m=p(null),n=p(""),a=p(24);function z(){_.get("/business/alerts",{status:u.status!=="all"?u.status:void 0,severity:u.severity!=="all"?u.severity:void 0},{preserveState:!0,preserveScroll:!0})}async function S(v){_.post(`/business/alerts/${v}/acknowledge`,{},{preserveScroll:!0})}function h(v){m.value=v,n.value="",y.value=!0}async function b(){m.value&&_.post(`/business/alerts/${m.value}/resolve`,{resolution:n.value},{preserveScroll:!0,onSuccess:()=>{y.value=!1,m.value=null}})}function C(v){m.value=v,a.value=24,g.value=!0}async function L(){m.value&&_.post(`/business/alerts/${m.value}/snooze`,{hours:a.value},{preserveScroll:!0,onSuccess:()=>{g.value=!1,m.value=null}})}async function U(v){confirm(s("alerts.dismiss.confirm"))&&_.post(`/business/alerts/${v}/dismiss`,{},{preserveScroll:!0})}return(v,l)=>(i(),A(E,{title:o(s)("alerts.title")},{header:k(()=>[e("div",oe,[e("h2",re,t(o(s)("alerts.title")),1),f(o(q),{href:"/business/alerts/rules",class:"inline-flex items-center px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"},{default:k(()=>[f(o(G),{class:"w-4 h-4 mr-2"}),T(" "+t(o(s)("alerts.rules")),1)]),_:1})])]),default:k(()=>[e("div",ae,[e("div",le,[e("div",ne,[e("div",de,[e("p",ie,t(o(s)("alerts.stats.total")),1),e("p",ce,t(r.stats.total),1)]),e("div",ue,[e("p",ge,t(o(s)("alerts.stats.active")),1),e("p",me,t(r.stats.active),1)]),e("div",ve,[e("p",ye,t(o(s)("alerts.stats.acknowledged")),1),e("p",he,t(r.stats.acknowledged),1)]),e("div",xe,[e("p",fe,t(o(s)("alerts.stats.resolved")),1),e("p",be,t(r.stats.resolved),1)]),e("div",pe,[e("p",ke,t(o(s)("alerts.stats.avg_time")),1),e("p",_e,t(r.stats.avg_resolution_time?r.stats.avg_resolution_time+" daq":"-"),1)])]),e("div",we,[M(e("select",{"onUpdate:modelValue":l[0]||(l[0]=d=>u.status=d),onChange:z,class:"rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 text-sm"},[e("option",$e,t(o(s)("alerts.filter.all_statuses")),1),e("option",ze,t(o(s)("alerts.filter.active")),1),e("option",Ce,t(o(s)("alerts.filter.acknowledged")),1),e("option",Me,t(o(s)("alerts.filter.resolved")),1),e("option",Se,t(o(s)("alerts.filter.snoozed")),1),e("option",je,t(o(s)("alerts.filter.dismissed")),1)],544),[[B,u.status]]),M(e("select",{"onUpdate:modelValue":l[1]||(l[1]=d=>u.severity=d),onChange:z,class:"rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 text-sm"},[e("option",Be,t(o(s)("alerts.filter.all_severities")),1),e("option",Ae,t(o(s)("alerts.filter.critical")),1),e("option",De,t(o(s)("alerts.filter.high")),1),e("option",Ve,t(o(s)("alerts.filter.medium")),1),e("option",Le,t(o(s)("alerts.filter.low")),1),e("option",Ue,t(o(s)("alerts.filter.info")),1)],544),[[B,u.severity]])]),e("div",Fe,[(i(!0),c(N,null,H(r.alerts.data,d=>(i(),A(se,{key:d.id,alert:d,onAcknowledge:S,onResolve:h,onSnooze:C,onDismiss:U},null,8,["alert"]))),128)),r.alerts.data.length===0?(i(),c("div",Ie,[f(o(K),{class:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e("p",Ne,t(o(s)("alerts.empty")),1)])):w("",!0)]),r.alerts.last_page>1?(i(),c("div",He,[f(J,{links:r.alerts.links},null,8,["links"])])):w("",!0)])]),f(D,{show:y.value,onClose:l[4]||(l[4]=d=>y.value=!1)},{default:k(()=>[e("div",Re,[e("h3",Te,t(o(s)("alerts.resolve.title")),1),e("div",qe,[e("label",Ee,t(o(s)("alerts.resolve.desc_label")),1),M(e("textarea",{"onUpdate:modelValue":l[2]||(l[2]=d=>n.value=d),rows:"3",class:"w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300",placeholder:o(s)("alerts.resolve.placeholder")},null,8,Ge),[[R,n.value]])]),e("div",Je,[e("button",{onClick:l[3]||(l[3]=d=>y.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"},t(o(s)("common.cancel")),1),e("button",{onClick:b,class:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg"},t(o(s)("alerts.resolve.submit")),1)])])]),_:1},8,["show"]),f(D,{show:g.value,onClose:l[7]||(l[7]=d=>g.value=!1)},{default:k(()=>[e("div",Ke,[e("h3",Oe,t(o(s)("alerts.snooze.title")),1),e("div",Ze,[e("label",Pe,t(o(s)("alerts.snooze.duration")),1),M(e("select",{"onUpdate:modelValue":l[5]||(l[5]=d=>a.value=d),class:"w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300"},[e("option",Qe,t(o(s)("alerts.snooze.1h")),1),e("option",We,t(o(s)("alerts.snooze.4h")),1),e("option",Xe,t(o(s)("alerts.snooze.1d")),1),e("option",Ye,t(o(s)("alerts.snooze.3d")),1),e("option",et,t(o(s)("alerts.snooze.1w")),1)],512),[[B,a.value]])]),e("div",tt,[e("button",{onClick:l[6]||(l[6]=d=>g.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"},t(o(s)("common.cancel")),1),e("button",{onClick:L,class:"px-4 py-2 text-sm font-medium text-white bg-yellow-600 hover:bg-yellow-700 rounded-lg"},t(o(s)("alerts.snooze.submit")),1)])])]),_:1},8,["show"])]),_:1},8,["title"]))}});export{Ct as default};
