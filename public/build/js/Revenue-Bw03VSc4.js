import{h as t,l as e}from"./chunk-DKkye6wf.js";import{_ as a}from"./chunk-BB8-4400.js";import{u as r}from"./app-DFslr8vl.js";import{C as s,r as o}from"./chunk-Dl5Vnr2b.js";import{r as n}from"./chunk-Sfe4u6kO.js";import{r as l}from"./chunk-BugzYCIx.js";import{r as d}from"./chunk-CROtfHv8.js";import{a as i}from"./chunk-YGW1Cp7-.js";import{r as c}from"./chunk-CoFofPT-.js";import{r as g}from"./chunk-ab1b1Fp4.js";import{r as y,b as m,v as u,x as b,y as p,z as x,A as h,D as f,L as k,C as v,H as w,B as _,E as j,F as C,G as O}from"./chunk-7Urb0kxg.js";import"./chunk-Dm-LAqtr.js";import"./chunk-Dg8ilgYs.js";import"./chunk-Rl16a4N0.js";import"./chunk-C1ExV0Y3.js";import"./chunk-DUcDuGHI.js";import"./chunk-C3XJH04c.js";import"./chunk-D2XW56yD.js";import"./chunk-DS-Zp4Qb.js";import"./chunk-BAC6lhkp.js";import"./chunk-DhwSyUm1.js";import"./chunk-9PkX4iPz.js";import"./chunk-DOBCiesv.js";import"./chunk-afst19KZ.js";import"./chunk-D4tA7yBb.js";import"./chunk-Di7Oc7TS.js";const R={class:"py-12"},D={class:"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8"},L={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4"},S={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-3"},T={class:"mt-2 text-gray-600 dark:text-gray-400"},U={class:"flex gap-2"},E=["disabled"],F=["disabled"],z={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-8"},B={class:"flex items-center gap-2"},N={class:"text-sm font-medium text-gray-700 dark:text-gray-300 mr-4"},q={class:"flex gap-2"},A={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-8"},I={class:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-4 flex items-center gap-2"},J={key:0,class:"bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-xl shadow-md p-6 mb-8"},P={class:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-6 flex items-center gap-2"},K={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},X={class:"bg-white dark:bg-gray-800 rounded-lg p-4"},G={class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},H={class:"text-xl font-bold text-gray-900 dark:text-gray-100"},Z={class:"bg-white dark:bg-gray-800 rounded-lg p-4"},$={class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},M={class:"text-xl font-bold text-gray-900 dark:text-gray-100"},Q={class:"bg-white dark:bg-gray-800 rounded-lg p-4"},V={class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},W={class:"text-xl font-bold text-green-600 dark:text-green-400"},Y={class:"bg-white dark:bg-gray-800 rounded-lg p-4"},tt={class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},et={class:"text-xl font-bold text-indigo-600 dark:text-indigo-400"},at={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},rt={class:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-4"},st={class:"overflow-x-auto"},ot={class:"w-full"},nt={class:"border-b border-gray-200 dark:border-gray-700"},lt={class:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300"},dt={class:"py-3 px-4 font-medium text-gray-900 dark:text-gray-100"},it={class:"py-3 px-4 text-right font-semibold text-green-600 dark:text-green-400"},ct={class:"py-3 px-4 text-right text-gray-700 dark:text-gray-300"},gt={class:"py-3 px-4 text-right text-gray-700 dark:text-gray-300"};s.register(...o);const yt={mounted(){this.$nextTick(()=>{this.initializeCharts()})},methods:{initializeCharts(){if(this.revenueChartData){const t=document.getElementById("revenueTrendsChart");t&&new s(t,{type:"line",data:this.revenueChartData,options:this.chartOptions})}if(this.forecastChartData){const t=document.getElementById("forecastChart");t&&new s(t,{type:"line",data:this.forecastChartData,options:this.chartOptions})}}}},mt=Object.assign(yt,{__name:"Revenue",props:{trends:{type:Object,default:()=>({chart_data:{labels:[],datasets:[]},trends:[]})},forecast:{type:Object,default:()=>({forecast:[],summary:{avg_daily_revenue:0,recent_avg:0,growth_rate:0,forecast_total:0}})},period:String},setup(s){const{t:o}=r(),yt=s,mt=y(yt.period||"daily"),ut=y(!1),bt=y(!1),pt=t=>new Intl.NumberFormat("uz-UZ").format(t)+" so'm",xt=t=>{mt.value=t,window.location.href=route("business.analytics.revenue",{period:t})},ht=async()=>{ut.value=!0;try{const t=await fetch(route("business.analytics.export.pdf"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({report_type:"revenue"})});if(t.ok){const e=await t.blob(),a=window.URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download="revenue_report.pdf",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(a),document.body.removeChild(r)}else alert(o("common.error"))}catch(t){alert(o("common.error"))}finally{ut.value=!1}},ft=async()=>{bt.value=!0;try{const t=await fetch(route("business.analytics.export.excel"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({report_type:"revenue"})});if(t.ok){const e=await t.blob(),a=window.URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download="revenue_report.xlsx",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(a),document.body.removeChild(r)}else alert(o("common.error"))}catch(t){alert(o("common.error"))}finally{bt.value=!1}};return m(()=>yt.trends?.chart_data?{labels:yt.trends.chart_data.labels,datasets:yt.trends.chart_data.datasets.map(t=>({...t,fill:!0}))}:null),m(()=>{if(!yt.forecast?.forecast)return null;const t=yt.forecast.forecast.map(t=>t.label),e=yt.forecast.forecast.map(t=>t.forecast_revenue),a=yt.forecast.forecast.map(t=>t.lower_bound);return{labels:t,datasets:[{label:"Forecast",data:e,borderColor:"rgb(99, 102, 241)",backgroundColor:"rgba(99, 102, 241, 0.1)",fill:!0},{label:"Upper Bound",data:yt.forecast.forecast.map(t=>t.upper_bound),borderColor:"rgb(239, 68, 68)",borderDash:[5,5],fill:!1},{label:"Lower Bound",data:a,borderColor:"rgb(34, 197, 94)",borderDash:[5,5],fill:!1}]}}),(r,y)=>(j(),u(a,{title:h(o)("analytics.revenue_analytics")},{default:b(()=>{return[p(h(t),{title:h(o)("analytics.revenue_analytics")},null,8,["title"]),x("div",R,[x("div",D,[x("div",L,[x("div",null,[x("h1",S,[p(h(n),{class:"w-10 h-10 text-green-600 dark:text-green-400"}),v(" "+w(h(o)("analytics.revenue_analytics")),1)]),x("p",T,w(h(o)("analytics.revenue_desc")),1)]),x("div",U,[p(h(e),{href:r.route("business.analytics.index"),class:"inline-flex items-center px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium rounded-lg transition-colors gap-2"},{default:b(()=>[p(h(l),{class:"w-4 h-4"}),y[3]||(y[3]=v(" Dashboard ",-1))]),_:1},8,["href"]),x("button",{onClick:ht,disabled:ut.value,class:"inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white font-medium rounded-lg transition-colors gap-2"},[p(h(d),{class:"w-4 h-4"}),v(" "+w(ut.value?h(o)("common.loading"):"PDF"),1)],8,E),x("button",{onClick:ft,disabled:bt.value,class:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white font-medium rounded-lg transition-colors gap-2"},[p(h(d),{class:"w-4 h-4"}),v(" "+w(bt.value?h(o)("common.loading"):"Excel"),1)],8,F)])]),x("div",z,[x("div",B,[p(h(i),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"}),x("span",N,w(h(o)("analytics.period"))+":",1),x("div",q,[x("button",{onClick:y[0]||(y[0]=t=>xt("daily")),class:_(["daily"===mt.value?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600","px-4 py-2 rounded-lg font-medium transition-colors"])},w(h(o)("analytics.daily")),3),x("button",{onClick:y[1]||(y[1]=t=>xt("weekly")),class:_(["weekly"===mt.value?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600","px-4 py-2 rounded-lg font-medium transition-colors"])},w(h(o)("analytics.weekly")),3),x("button",{onClick:y[2]||(y[2]=t=>xt("monthly")),class:_(["monthly"===mt.value?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600","px-4 py-2 rounded-lg font-medium transition-colors"])},w(h(o)("analytics.monthly")),3)])])]),x("div",A,[x("h3",I,[p(h(c),{class:"w-6 h-6 text-green-600 dark:text-green-400"}),y[4]||(y[4]=v(" Revenue Trends ",-1))]),y[5]||(y[5]=x("div",{class:"h-80"},[x("canvas",{id:"revenueTrendsChart"})],-1))]),s.forecast&&s.forecast.forecast?(j(),f("div",J,[x("h3",P,[p(h(g),{class:"w-6 h-6 text-indigo-600 dark:text-indigo-400"}),v(" "+w(h(o)("analytics.revenue_forecast")),1)]),x("div",K,[x("div",X,[x("p",G,w(h(o)("analytics.avg_daily")),1),x("p",H,w(pt(s.forecast.summary.avg_daily_revenue)),1)]),x("div",Z,[x("p",$,w(h(o)("analytics.recent_avg")),1),x("p",M,w(pt(s.forecast.summary.recent_avg)),1)]),x("div",Q,[x("p",V,w(h(o)("analytics.growth_rate")),1),x("p",W,w((a=s.forecast.summary.growth_rate,a?.toFixed(1)||"0"))+"%",1)]),x("div",Y,[x("p",tt,w(h(o)("analytics.forecast_total")),1),x("p",et,w(pt(s.forecast.summary.forecast_total)),1)])]),y[6]||(y[6]=x("div",{class:"bg-white dark:bg-gray-800 rounded-lg p-4"},[x("div",{class:"h-80"},[x("canvas",{id:"forecastChart"})])],-1))])):k("",!0),x("div",at,[x("h3",rt,w(h(o)("analytics.revenue_details")),1),x("div",st,[x("table",ot,[x("thead",null,[x("tr",nt,[x("th",lt,w(h(o)("common.date")),1),y[7]||(y[7]=x("th",{class:"text-right py-3 px-4 font-semibold text-gray-700 dark:text-gray-300"},"Revenue",-1)),y[8]||(y[8]=x("th",{class:"text-right py-3 px-4 font-semibold text-gray-700 dark:text-gray-300"},"Deals",-1)),y[9]||(y[9]=x("th",{class:"text-right py-3 px-4 font-semibold text-gray-700 dark:text-gray-300"},"Avg Deal Size",-1))])]),x("tbody",null,[(j(!0),f(C,null,O(s.trends.trends,(t,e)=>(j(),f("tr",{key:t.date,class:_([e%2==0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700/50","hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors"])},[x("td",dt,w(t.label),1),x("td",it,w(pt(t.revenue)),1),x("td",ct,w(t.deal_count),1),x("td",gt,w(pt(t.avg_deal_size)),1)],2))),128))])])])])])])];var a}),_:1},8,["title"]))}});export{mt as default};
