import{r as c,b as K,v as z,x as F,z as t,D as d,L as n,I as u,K as h,E as o,F as x,G as p,H as a,C as M,B as y,Q as I,J as $}from"./chunk-BcTZxe-J.js";import{r as m}from"./chunk-BYRtWSr0.js";import{_ as O}from"./chunk-BVg2xI-u.js";import"./chunk-CYarSvys.js";import"./app-DWC75jbx.js";import"./chunk-C1xeNfMu.js";import"./chunk-BVYwhYNk.js";import"./chunk-BqueMrU7.js";import"./chunk-_yYzsx_i.js";import"./chunk-Rs1WNzbn.js";import"./chunk-CJsSO8V8.js";import"./chunk-CrR1zWIb.js";import"./chunk-CQoMtUf7.js";import"./chunk-qVc0_oyq.js";import"./chunk-LBbTbQSS.js";import"./chunk-I93QdGKi.js";import"./chunk-DNp5bQOL.js";import"./chunk-CG0drqHE.js";import"./chunk-CklLzvQL.js";import"./chunk-CnrLL2pV.js";import"./chunk-D58UsNjm.js";import"./chunk-Ba8J67bG.js";import"./chunk-BHX0ueEB.js";import"./chunk-Dy6aDPCS.js";import"./chunk-CKHdppiT.js";import"./chunk-Sr2jsNPC.js";import"./chunk-Bv_bj7dx.js";const L={class:"mb-8"},H={class:"flex items-center justify-between flex-wrap gap-4"},R={class:"flex items-center gap-3"},X=["value"],E={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8"},Y={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},Z={class:"text-2xl font-bold text-gray-900 dark:text-white"},G={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},W={class:"text-2xl font-bold text-red-600"},tt={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},et={class:"text-2xl font-bold text-yellow-600"},rt={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},at={class:"text-2xl font-bold text-orange-600"},st={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},ot={class:"text-2xl font-bold text-purple-600"},dt={class:"border-b border-gray-200 dark:border-gray-700 mb-6"},lt={class:"flex gap-8"},nt={key:0,class:"px-2 py-0.5 bg-orange-100 text-orange-700 rounded-full text-xs"},it={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},gt={class:"overflow-x-auto"},ut={class:"w-full"},xt={class:"divide-y divide-gray-200 dark:divide-gray-700"},pt={class:"px-6 py-4 whitespace-nowrap"},yt={class:"flex items-center"},mt={class:"w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center text-red-700 dark:text-red-400 font-medium"},ct={class:"ml-3 font-medium text-gray-900 dark:text-white"},bt={class:"px-6 py-4"},kt={class:"font-medium text-gray-900 dark:text-white"},ht={class:"text-sm text-gray-500"},vt={class:"px-6 py-4 text-right font-bold text-red-600"},ft={class:"px-6 py-4 text-center"},_t={class:"px-6 py-4 text-center"},wt={class:"px-6 py-4 text-center text-sm text-gray-500"},St={class:"px-6 py-4 text-center"},Ct={class:"flex items-center justify-center gap-2"},jt=["onClick"],qt=["onClick"],Mt=["onClick"],$t={key:0},Bt={key:1,class:"space-y-4"},At={class:"flex items-start justify-between mb-4"},Dt={class:"flex items-center gap-3"},Jt={class:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center text-red-700 dark:text-red-400 font-medium text-lg"},Qt={class:"font-bold text-gray-900 dark:text-white"},Tt={class:"text-sm text-gray-500"},Ut={class:"text-right"},Vt={class:"text-xl font-bold text-red-600"},Nt={class:"text-sm text-gray-500"},Pt={class:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4 mb-4"},Kt={class:"text-gray-700 dark:text-gray-300"},zt={class:"flex justify-end gap-3"},Ft=["onClick"],It=["onClick"],Ot={key:0,class:"bg-white dark:bg-gray-800 rounded-xl p-12 text-center text-gray-500 border border-gray-200 dark:border-gray-700"},Lt={key:2,class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},Ht={class:"overflow-x-auto"},Rt={class:"w-full"},Xt={class:"divide-y divide-gray-200 dark:divide-gray-700"},Et={class:"px-6 py-4 whitespace-nowrap"},Yt={class:"flex items-center"},Zt={class:"w-10 h-10 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center text-yellow-700 dark:text-yellow-400 font-medium"},Gt={class:"ml-3 font-medium text-gray-900 dark:text-white"},Wt={class:"px-6 py-4"},te={class:"font-medium text-gray-900 dark:text-white"},ee={class:"text-sm text-gray-500"},re={class:"px-6 py-4 text-center"},ae={class:"font-bold text-yellow-600"},se={class:"px-6 py-4 text-center"},oe={class:"px-6 py-4 text-center text-sm text-gray-500"},de={key:0},le={key:3,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},ne={class:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6"},ie=["value"],ge=["value"],ue={class:"flex justify-end gap-3"},Pe={__name:"Penalties",props:{penalties:Array,warnings:Array,penaltyRules:Array,teamMembers:Array,stats:Object,currentStatus:String,month:Number,year:Number,panelType:String},setup(l){const v=l;new Date().getFullYear();const f=c(v.month||new Date().getMonth()+1),_=c(v.currentStatus||""),g=c("all"),b=c(!1),i=c({user_id:"",rule_id:"",amount:0,reason:""}),j=K(()=>v.penalties.filter(s=>s.status==="appealed")),B=s=>["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentabr","Oktabr","Noyabr","Dekabr"][s-1],w=s=>s?new Intl.NumberFormat("uz-UZ").format(s)+" so'm":"0 so'm",S=s=>s?new Date(s).toLocaleDateString("uz-UZ"):"-",C=s=>s?s.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?",A=s=>{const e={pending:"px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-700",confirmed:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700",appealed:"px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-700",cancelled:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700"};return e[s]||e.pending},D=s=>({pending:"Kutilmoqda",confirmed:"Tasdiqlangan",appealed:"Shikoyat",cancelled:"Bekor qilingan"})[s]||s,q=()=>{m.get("/sales-head/sales-kpi/penalties",{month:f.value,status:_.value},{preserveState:!0})},J=()=>{i.value={user_id:"",rule_id:"",amount:0,reason:""},b.value=!0},Q=()=>{m.post("/sales-head/sales-kpi/penalties/manual",i.value,{onSuccess:()=>{b.value=!1}})},T=s=>{m.post(`/sales-head/sales-kpi/penalties/${s.id}/confirm`)},U=s=>{m.post(`/sales-head/sales-kpi/penalties/${s.id}/cancel`)},V=s=>{m.post(`/sales-head/sales-kpi/penalties/${s.id}/appeal`,{decision:"accepted"})},N=s=>{m.post(`/sales-head/sales-kpi/penalties/${s.id}/appeal`,{decision:"rejected"})},P=s=>{};return(s,e)=>(o(),z(O,{title:"Jarimalar"},{default:F(()=>[t("div",L,[t("div",H,[e[12]||(e[12]=t("div",null,[t("h2",{class:"text-3xl font-bold text-gray-900 dark:text-gray-100"},"Jarimalar"),t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"},"Jarimalarni ko'rish va shikoyatlarni ko'rib chiqish")],-1)),t("div",R,[u(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>_.value=r),onChange:q,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[...e[10]||(e[10]=[t("option",{value:""},"Barchasi",-1),t("option",{value:"pending"},"Kutilmoqda",-1),t("option",{value:"confirmed"},"Tasdiqlangan",-1),t("option",{value:"appealed"},"Shikoyat qilingan",-1),t("option",{value:"cancelled"},"Bekor qilingan",-1)])],544),[[h,_.value]]),u(t("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>f.value=r),onChange:q,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[(o(),d(x,null,p(12,r=>t("option",{key:r,value:r},a(B(r)),9,X)),64))],544),[[h,f.value]]),t("button",{onClick:J,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center gap-2"},[...e[11]||(e[11]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Qo'lda jarima ",-1)])])])])]),t("div",E,[t("div",Y,[e[13]||(e[13]=t("p",{class:"text-sm text-gray-500 mb-1"},"Jami jarimalar",-1)),t("p",Z,a(l.stats.total_count),1)]),t("div",G,[e[14]||(e[14]=t("p",{class:"text-sm text-gray-500 mb-1"},"Jami summa",-1)),t("p",W,a(w(l.stats.total_amount)),1)]),t("div",tt,[e[15]||(e[15]=t("p",{class:"text-sm text-gray-500 mb-1"},"Kutilmoqda",-1)),t("p",et,a(l.stats.pending_count),1)]),t("div",rt,[e[16]||(e[16]=t("p",{class:"text-sm text-gray-500 mb-1"},"Shikoyatlar",-1)),t("p",at,a(l.stats.appealed_count),1)]),t("div",st,[e[17]||(e[17]=t("p",{class:"text-sm text-gray-500 mb-1"},"Avtomatik",-1)),t("p",ot,a(l.stats.auto_count),1)])]),t("div",dt,[t("nav",lt,[t("button",{onClick:e[2]||(e[2]=r=>g.value="all"),class:y(["pb-4 px-1 font-medium text-sm border-b-2 transition-colors",g.value==="all"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700"])}," Barcha jarimalar ",2),t("button",{onClick:e[3]||(e[3]=r=>g.value="appeals"),class:y(["pb-4 px-1 font-medium text-sm border-b-2 transition-colors flex items-center gap-2",g.value==="appeals"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"])},[e[18]||(e[18]=M(" Shikoyatlar ",-1)),l.stats.appealed_count>0?(o(),d("span",nt,a(l.stats.appealed_count),1)):n("",!0)],2),t("button",{onClick:e[4]||(e[4]=r=>g.value="warnings"),class:y(["pb-4 px-1 font-medium text-sm border-b-2 transition-colors",g.value==="warnings"?"border-yellow-500 text-yellow-600":"border-transparent text-gray-500 hover:text-gray-700"])}," Ogohlantirishlar ",2)])]),g.value==="all"?(o(),d("div",it,[t("div",gt,[t("table",ut,[e[20]||(e[20]=t("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Xodim"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Sabab"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Summa"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Turi"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Holat"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Sana"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amal")])],-1)),t("tbody",xt,[(o(!0),d(x,null,p(l.penalties,r=>(o(),d("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",pt,[t("div",yt,[t("div",mt,a(C(r.user?.name)),1),t("span",ct,a(r.user?.name),1)])]),t("td",bt,[t("div",kt,a(r.penalty_rule?.name||"Qo'lda jarima"),1),t("div",ht,a(r.reason),1)]),t("td",vt," -"+a(w(r.penalty_amount)),1),t("td",ft,[t("span",{class:y(r.is_auto?"px-2 py-1 bg-purple-100 text-purple-700 rounded text-xs":"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs")},a(r.is_auto?"Avtomatik":"Qo'lda"),3)]),t("td",_t,[t("span",{class:y(A(r.status))},a(D(r.status)),3)]),t("td",wt,a(S(r.triggered_at)),1),t("td",St,[t("div",Ct,[r.status==="pending"?(o(),d("button",{key:0,onClick:k=>T(r),class:"px-2 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700"}," Tasdiqlash ",8,jt)):n("",!0),r.status==="pending"?(o(),d("button",{key:1,onClick:k=>U(r),class:"px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs hover:bg-gray-300"}," Bekor ",8,qt)):n("",!0),r.status==="appealed"?(o(),d("button",{key:2,onClick:k=>P(r),class:"px-2 py-1 bg-orange-600 text-white rounded text-xs hover:bg-orange-700"}," Ko'rib chiqish ",8,Mt)):n("",!0)])])]))),128)),l.penalties.length===0?(o(),d("tr",$t,[...e[19]||(e[19]=[t("td",{colspan:"7",class:"px-6 py-12 text-center text-gray-500"}," Jarimalar topilmadi ",-1)])])):n("",!0)])])])])):n("",!0),g.value==="appeals"?(o(),d("div",Bt,[(o(!0),d(x,null,p(j.value,r=>(o(),d("div",{key:r.id,class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-orange-200 dark:border-orange-700"},[t("div",At,[t("div",Dt,[t("div",Jt,a(C(r.user?.name)),1),t("div",null,[t("h3",Qt,a(r.user?.name),1),t("p",Tt,a(r.penalty_rule?.name||"Qo'lda jarima"),1)])]),t("div",Ut,[t("p",Vt,"-"+a(w(r.penalty_amount)),1),t("p",Nt,a(S(r.triggered_at)),1)])]),t("div",Pt,[e[21]||(e[21]=t("p",{class:"text-sm font-medium text-orange-700 dark:text-orange-400 mb-1"},"Shikoyat sababi:",-1)),t("p",Kt,a(r.appeal_reason||"Sabab ko'rsatilmagan"),1)]),t("div",zt,[t("button",{onClick:k=>N(r),class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"}," Rad etish ",8,Ft),t("button",{onClick:k=>V(r),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"}," Qabul qilish ",8,It)])]))),128)),j.value.length===0?(o(),d("div",Ot," Ko'rib chiqilishi kerak bo'lgan shikoyatlar yo'q ")):n("",!0)])):n("",!0),g.value==="warnings"?(o(),d("div",Lt,[t("div",Ht,[t("table",Rt,[e[23]||(e[23]=t("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Xodim"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Ogohlantirish"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Ketma-ketlik"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Qolgan"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Sana")])],-1)),t("tbody",Xt,[(o(!0),d(x,null,p(l.warnings,r=>(o(),d("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",Et,[t("div",Yt,[t("div",Zt,a(C(r.user?.name)),1),t("span",Gt,a(r.user?.name),1)])]),t("td",Wt,[t("div",te,a(r.penalty_rule?.name),1),t("div",ee,a(r.message),1)]),t("td",re,[t("span",ae,a(r.sequence_count),1)]),t("td",se,[t("span",{class:y(r.warnings_remaining<=1?"text-red-600 font-bold":"text-gray-600")},a(r.warnings_remaining),3)]),t("td",oe,a(S(r.created_at)),1)]))),128)),l.warnings.length===0?(o(),d("tr",de,[...e[22]||(e[22]=[t("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-500"}," Ogohlantirishlar topilmadi ",-1)])])):n("",!0)])])])])):n("",!0),b.value?(o(),d("div",le,[t("div",ne,[e[31]||(e[31]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-4"},"Qo'lda jarima berish",-1)),t("form",{onSubmit:I(Q,["prevent"]),class:"space-y-4"},[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Xodim",-1)),u(t("select",{"onUpdate:modelValue":e[5]||(e[5]=r=>i.value.user_id=r),required:"",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},[e[24]||(e[24]=t("option",{value:""},"Tanlang...",-1)),(o(!0),d(x,null,p(l.teamMembers,r=>(o(),d("option",{key:r.id,value:r.id},a(r.name),9,ie))),128))],512),[[h,i.value.user_id]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Jarima qoidasi (ixtiyoriy)",-1)),u(t("select",{"onUpdate:modelValue":e[6]||(e[6]=r=>i.value.rule_id=r),class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},[e[26]||(e[26]=t("option",{value:""},"Qoidasiz",-1)),(o(!0),d(x,null,p(l.penaltyRules,r=>(o(),d("option",{key:r.id,value:r.id},a(r.name),9,ge))),128))],512),[[h,i.value.rule_id]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Summa",-1)),u(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>i.value.amount=r),type:"number",required:"",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},null,512),[[$,i.value.amount,void 0,{number:!0}]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Sabab",-1)),u(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=r=>i.value.reason=r),rows:"2",required:"",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},null,512),[[$,i.value.reason]])]),t("div",ue,[t("button",{type:"button",onClick:e[9]||(e[9]=r=>b.value=!1),class:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}," Bekor qilish "),e[30]||(e[30]=t("button",{type:"submit",class:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700"}," Jarima berish ",-1))])],32)])])):n("",!0)]),_:1}))}};export{Pe as default};
