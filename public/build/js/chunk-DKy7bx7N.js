import{D as e,z as a,E as t,r as l,b as r,w as s,v as o,L as d,H as n,A as i,B as c,F as u,G as g,I as x,J as b,C as p,P as m,y,x as v,Q as h,T as k,R as f,o as w,e as _,M as C,K as j}from"./chunk-7Urb0kxg.js";import{h as z,l as M,a as V,r as B}from"./chunk-DKkye6wf.js";import{u as $,r as T,i as L}from"./app-DFslr8vl.js";import{_ as A}from"./chunk-BCo6x5W8.js";import{r as U,f as q,e as X,g as H,b as S,n as I}from"./chunk-Dm-LAqtr.js";import{r as D}from"./chunk-Rl16a4N0.js";import{r as O}from"./chunk-C3XJH04c.js";import{r as P}from"./chunk-IpnqR3t9.js";import{r as Y}from"./chunk-Sfe4u6kO.js";import{r as Z}from"./chunk-DUcDuGHI.js";import{r as E}from"./chunk-BscFvtBT.js";import{r as F}from"./chunk-Di_ohWeo.js";import{r as N}from"./chunk-DdK1ytni.js";import{_ as R}from"./chunk-D7wNIb_T.js";import{r as W}from"./chunk-Ywc2muow.js";import{a as Q}from"./chunk-i83483Sm.js";import{r as G}from"./chunk-DncpFozA.js";import{a as J}from"./chunk-C1ExV0Y3.js";import{a as K}from"./chunk-YGW1Cp7-.js";import{r as ee}from"./chunk-DOBCiesv.js";import{r as ae}from"./chunk-afst19KZ.js";import{a as te}from"./chunk-9PkX4iPz.js";import{r as le}from"./chunk-ab1b1Fp4.js";import{r as re}from"./chunk-D4tA7yBb.js";import{r as se}from"./chunk-DVQ2uBdT.js";import{r as oe}from"./chunk-CmlhnALp.js";import{r as de}from"./chunk-HtT6Wuc5.js";import{r as ne}from"./chunk-CrCLH5wG.js";import{r as ie}from"./chunk-ujXbNZhL.js";function ce(l,r){return t(),e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 19.5 15-15m0 0H8.25m11.25 0v11.25"})])}function ue(l,r){return t(),e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})])}function ge(l,r){return t(),e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M4.848 2.771A49.144 49.144 0 0 1 12 2.25c2.43 0 4.817.178 7.152.52 1.978.292 3.348 2.024 3.348 3.97v6.02c0 1.946-1.37 3.678-3.348 3.97a48.901 48.901 0 0 1-3.476.383.39.39 0 0 0-.297.17l-2.755 4.133a.75.75 0 0 1-1.248 0l-2.755-4.133a.39.39 0 0 0-.297-.17 48.9 48.9 0 0 1-3.476-.384c-1.978-.29-3.348-2.024-3.348-3.97V6.741c0-1.946 1.37-3.68 3.348-3.97ZM6.75 8.25a.75.75 0 0 1 .75-.75h9a.75.75 0 0 1 0 1.5h-9a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H7.5Z","clip-rule":"evenodd"})])}function xe(l,r){return t(),e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"fill-rule":"evenodd",d:"M15 3.75a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-1.5 0V5.56l-4.72 4.72a.75.75 0 1 1-1.06-1.06l4.72-4.72h-2.69a.75.75 0 0 1-.75-.75Z","clip-rule":"evenodd"}),a("path",{"fill-rule":"evenodd",d:"M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z","clip-rule":"evenodd"})])}const be={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},pe={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},me={class:"relative inline-block w-full max-w-lg px-6 py-6 overflow-hidden text-left align-bottom transition-all transform bg-slate-800 rounded-2xl shadow-xl sm:my-8 sm:align-middle border border-slate-700"},ye={class:"flex items-center justify-between mb-6"},ve={class:"flex items-center"},he={class:"text-lg font-semibold text-white"},ke={class:"text-sm text-slate-400"},fe={key:0,class:"py-12 text-center"},we={class:"mt-2 text-slate-400"},_e={key:1},Ce={class:"flex gap-2 mb-4"},je={key:0},ze={key:0,class:"mb-4 p-3 bg-green-500/20 border border-green-500/30 rounded-xl flex items-center"},Me={class:"text-green-400 text-sm"},Ve={key:1,class:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-xl flex items-center"},Be={class:"text-red-400 text-sm"},$e={key:2,class:"mb-4"},Te={class:"block text-sm font-medium text-slate-300 mb-2"},Le={class:"flex flex-wrap gap-2"},Ae=["onClick"],Ue={class:"mb-4"},qe={class:"block text-sm font-medium text-slate-300 mb-2"},Xe=["placeholder"],He={class:"flex justify-between mt-1 text-xs"},Se={class:"text-slate-500"},Ie={class:"flex justify-end gap-3"},De=["disabled"],Oe={key:0,class:"flex items-center"},Pe={key:1},Ye={key:1},Ze={key:0,class:"py-8 text-center"},Ee={class:"text-slate-400"},Fe={key:1,class:"space-y-3 max-h-80 overflow-y-auto"},Ne={class:"flex items-center justify-between mb-2"},Re={class:"text-xs text-slate-500"},We={class:"text-sm text-slate-300"},Qe={class:"flex items-center justify-between mt-2 text-xs text-slate-500"},Ge={__name:"SmsModal",props:{show:{type:Boolean,default:!1},lead:{type:Object,required:!0}},emits:["close","sent"],setup(y,{emit:v}){const{t:h}=$(),k=y,f=v,w=l(""),_=l(null),C=l([]),j=l(!1),z=l(!1),M=l([]),V=l(!1),B=l(null),A=l(null),U=r(()=>{const e=w.value,a=e.length,t=/[^\x00-\x7F]/.test(e);let l=1;l=t?a<=70?1:Math.ceil(a/67):a<=160?1:Math.ceil(a/153);return{chars:a,parts:l,isUnicode:t,maxChars:t?1===l?70:67*l:1===l?160:153*l}}),q=async()=>{try{const e=await fetch(route("business.sms.templates"),{headers:{Accept:"application/json"}});e.ok&&(C.value=await e.json())}catch(e){}},X=async()=>{if(k.lead?.id)try{const e=await fetch(route("business.sms.lead.history",k.lead.id),{headers:{Accept:"application/json"}});e.ok&&(M.value=await e.json())}catch(e){}},H=async()=>{if(w.value.trim()){z.value=!0,B.value=null,A.value=null;try{await T();const e=await window.axios.post(route("business.sms.send",k.lead.id),{message:w.value,template_id:_.value});A.value=h("components.sms.success",{parts:e.data.parts_count}),w.value="",_.value=null,f("sent"),await X(),setTimeout(()=>{f("close")},2e3)}catch(e){if(L(e))return B.value=h("common.session_expired"),void(await T());e.response?.data?.error?B.value=e.response.data.error:B.value=h("common.network_error_retry")}finally{z.value=!1}}else B.value=h("components.sms.enter_message")},S=()=>{w.value="",_.value=null,B.value=null,A.value=null,V.value=!1,f("close")};s(()=>k.show,async e=>{e&&(j.value=!0,await Promise.all([q(),X()]),j.value=!1)});const I=e=>({pending:h("components.sms.status_pending"),sent:h("components.sms.status_sent"),delivered:h("components.sms.status_delivered"),failed:h("components.sms.status_failed")}[e]||e);return(l,r)=>(t(),o(m,{to:"body"},[y.show?(t(),e("div",be,[a("div",pe,[a("div",{class:"fixed inset-0 transition-opacity bg-slate-900/75",onClick:S}),a("div",me,[a("div",ye,[a("div",ve,[r[3]||(r[3]=a("div",{class:"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-xl flex items-center justify-center mr-3"},[a("svg",{class:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})])],-1)),a("div",null,[a("h3",he,n(i(h)("components.sms.title")),1),a("p",ke,n(y.lead.name)+" - "+n(y.lead.phone),1)])]),a("button",{onClick:S,class:"text-slate-400 hover:text-white"},[...r[4]||(r[4]=[a("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),j.value?(t(),e("div",fe,[r[5]||(r[5]=a("svg",{class:"animate-spin h-8 w-8 mx-auto text-teal-500",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),a("p",we,n(i(h)("common.loading")),1)])):(t(),e("div",_e,[a("div",Ce,[a("button",{onClick:r[0]||(r[0]=e=>V.value=!1),class:c(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",V.value?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-teal-500 text-white"])},n(i(h)("components.sms.new_sms")),3),a("button",{onClick:r[1]||(r[1]=e=>V.value=!0),class:c(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",V.value?"bg-teal-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"])},n(i(h)("components.sms.history"))+" ("+n(M.value.length)+") ",3)]),V.value?(t(),e("div",Ye,[0===M.value.length?(t(),e("div",Ze,[r[9]||(r[9]=a("svg",{class:"w-12 h-12 text-slate-500 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)),a("p",Ee,n(i(h)("components.sms.no_sms_sent")),1)])):(t(),e("div",Fe,[(t(!0),e(u,null,g(M.value,l=>{return t(),e("div",{key:l.id,class:"bg-slate-700/30 rounded-xl p-3"},[a("div",Ne,[a("span",Re,n(l.created_at),1),a("span",{class:c(["text-xs font-medium",(r=l.status,{pending:"text-yellow-400",sent:"text-blue-400",delivered:"text-green-400",failed:"text-red-400"}[r]||"text-slate-400")])},n(I(l.status)),3)]),a("p",We,n(l.message),1),a("div",Qe,[a("span",null,n(l.sender),1),a("span",null,n(l.parts_count)+" qism",1)])]);var r}),128))]))])):(t(),e("div",je,[A.value?(t(),e("div",ze,[r[6]||(r[6]=a("svg",{class:"w-5 h-5 text-green-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),a("p",Me,n(A.value),1)])):d("",!0),B.value?(t(),e("div",Ve,[r[7]||(r[7]=a("svg",{class:"w-5 h-5 text-red-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),a("p",Be,n(B.value),1)])):d("",!0),C.value.length>0?(t(),e("div",$e,[a("label",Te,n(i(h)("components.sms.select_template")),1),a("div",Le,[(t(!0),e(u,null,g(C.value,a=>(t(),e("button",{key:a.id,onClick:e=>(e=>{_.value=e.id;let a=e.content;a=a.replace("{name}",k.lead?.name||""),a=a.replace("{phone}",k.lead?.phone||""),a=a.replace("{company}",k.lead?.company||""),a=a.replace("{email}",k.lead?.email||""),w.value=a})(a),class:c(["px-3 py-1.5 rounded-lg text-sm transition-colors",_.value===a.id?"bg-teal-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"])},n(a.name),11,Ae))),128))])])):d("",!0),a("div",Ue,[a("label",qe,n(i(h)("components.sms.message_text")),1),x(a("textarea",{"onUpdate:modelValue":r[2]||(r[2]=e=>w.value=e),rows:"4",placeholder:i(h)("components.sms.write_message"),class:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:border-teal-500 focus:ring-1 focus:ring-teal-500 resize-none"},null,8,Xe),[[b,w.value]]),a("div",He,[a("span",{class:c(U.value.isUnicode?"text-yellow-400":"text-slate-500")},n(U.value.isUnicode?i(h)("components.sms.unicode"):i(h)("components.sms.latin")),3),a("span",Se,n(U.value.chars)+" "+n(i(h)("components.sms.chars"))+" | "+n(U.value.parts)+" "+n(i(h)("components.sms.parts")),1)])]),a("div",Ie,[a("button",{onClick:S,class:"px-4 py-2 bg-slate-700 text-slate-300 rounded-xl hover:bg-slate-600 transition-colors"},n(i(h)("common.cancel")),1),a("button",{onClick:H,disabled:z.value||!w.value.trim(),class:"px-6 py-2 bg-gradient-to-r from-teal-500 to-cyan-600 text-white font-medium rounded-xl hover:from-teal-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[z.value?(t(),e("span",Oe,[r[8]||(r[8]=a("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),p(" "+n(i(h)("components.sms.sending")),1)])):(t(),e("span",Pe,n(i(h)("components.sms.send")),1))],8,De)])]))]))])])])):d("",!0)]))}},Je={class:"flex min-h-screen items-center justify-center p-4"},Ke={class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg mx-4 z-10"},ea={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},aa={class:"flex items-center gap-3"},ta={class:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center"},la={class:"text-sm text-gray-500 dark:text-gray-400"},ra={class:"p-6"},sa={key:0,class:"text-center py-8"},oa={key:1,class:"text-center py-8"},da=["href"],na={key:2},ia={key:0},ca={class:"mb-6"},ua={class:"relative"},ga={class:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"},xa={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},ba={class:"mb-6"},pa={class:"grid grid-cols-2 gap-3"},ma={key:0,class:"absolute top-2 right-2"},ya={key:0,class:"absolute top-2 right-2"},va={class:"mb-6"},ha={key:1},ka={class:"text-center mb-6"},fa={class:"w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4"},wa={class:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 mb-4"},_a={class:"flex items-center justify-between mb-2"},Ca={class:"font-bold text-green-600 dark:text-green-400"},ja={class:"flex items-center justify-between mb-2"},za={class:"font-medium text-gray-900 dark:text-white capitalize"},Ma={key:0,class:"flex items-center justify-between"},Va={class:"font-mono text-sm text-gray-900 dark:text-white"},Ba={class:"mb-4"},$a={class:"flex gap-2"},Ta=["value"],La={class:"flex gap-2"},Aa=["href"],Ua=["href"],qa={key:2,class:"mt-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl"},Xa={class:"flex items-start gap-3"},Ha={class:"text-sm text-red-600 dark:text-red-400 mt-1"},Sa={key:0,class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 rounded-b-2xl"},Ia=["disabled"],Da={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},Oa={__name:"PaymentModal",props:{show:{type:Boolean,default:!1},lead:{type:Object,default:null}},emits:["close","created"],setup(u,{emit:g}){const{t:f}=$(),w=u,_=g,C=l(!0),j=l(!1),z=l({payme:!1,click:!1}),M=l(1),V=l(null),B=l(""),A=l(null),q=l(null),X=l(null),H=l(!1),S=r(()=>z.value.payme||z.value.click),I=r(()=>V.value&&V.value>=1e3&&A.value),R=async()=>{if(I.value){j.value=!0,X.value=null;try{await T();const e=await window.axios.post(route("business.payments.lead.create-link",w.lead.id),{provider:A.value,amount:V.value,description:B.value||`To'lov - ${w.lead.name}`});e.data.success?(q.value=e.data,M.value=2,_("created",e.data)):X.value=e.data.error||f("components.payment.create_link_error")}catch(e){if(L(e))return X.value=f("common.session_expired"),void(await T());e.response?.data?.error?X.value=e.response.data.error:X.value=f("common.network_error")}finally{j.value=!1}}},W=async()=>{if(q.value?.payment_url)try{await navigator.clipboard.writeText(q.value.payment_url),H.value=!0,setTimeout(()=>{H.value=!1},2e3)}catch(e){}},Q=e=>e?new Intl.NumberFormat("uz-UZ").format(e)+" so'm":"0 so'm",G=()=>{M.value=1,q.value=null,X.value=null,H.value=!1},J=()=>{_("close")};return s(()=>w.show,e=>{e?((async()=>{C.value=!0,X.value=null;try{const e=await fetch(route("business.payments.providers"),{headers:{Accept:"application/json"}});if(e.ok){const a=await e.json();z.value=a.providers||{payme:!1,click:!1},z.value.payme&&!z.value.click?A.value="payme":z.value.click&&!z.value.payme&&(A.value="click")}}catch(e){X.value=f("components.payment.load_providers_error")}finally{C.value=!1}})(),w.lead?.estimated_value&&(V.value=w.lead.estimated_value)):setTimeout(()=>{G(),V.value=null,B.value=""},300)}),s(()=>w.lead,e=>{e?.estimated_value&&!V.value&&(V.value=e.estimated_value)}),(l,r)=>(t(),o(m,{to:"body"},[y(k,{name:"modal"},{default:v(()=>[u.show?(t(),e("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:h(J,["self"])},[a("div",Je,[a("div",{class:"fixed inset-0 bg-black/50",onClick:J}),a("div",Ke,[a("div",ea,[a("div",aa,[a("div",ta,[y(i(U),{class:"w-5 h-5 text-white"})]),a("div",null,[r[4]||(r[4]=a("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"To'lov qabul qilish",-1)),a("p",la,n(u.lead?.name),1)])]),a("button",{onClick:J,class:"p-2 text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[y(i(D),{class:"w-5 h-5"})])]),a("div",ra,[C.value?(t(),e("div",sa,[...r[5]||(r[5]=[a("div",{class:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"},null,-1),a("p",{class:"text-gray-500 dark:text-gray-400 mt-4"},"Yuklanmoqda...",-1)])])):S.value?(t(),e("div",na,[1===M.value?(t(),e("div",ia,[a("div",ca,[r[9]||(r[9]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," To'lov summasi (so'm) ",-1)),a("div",ua,[x(a("input",{"onUpdate:modelValue":r[0]||(r[0]=e=>V.value=e),type:"number",min:"1000",step:"1000",placeholder:"100000",class:"w-full px-4 py-3 pl-12 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[b,V.value,void 0,{number:!0}]]),a("div",ga,[y(i(Y),{class:"w-5 h-5"})])]),u.lead?.estimated_value?(t(),e("p",xa," Taxminiy qiymat: "+n(Q(u.lead.estimated_value)),1)):d("",!0)]),a("div",ba,[r[12]||(r[12]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"}," To'lov tizimini tanlang ",-1)),a("div",pa,[z.value.payme?(t(),e("button",{key:0,onClick:r[1]||(r[1]=e=>A.value="payme"),class:c(["relative p-4 rounded-xl border-2 transition-all","payme"===A.value?"border-cyan-500 bg-cyan-50 dark:bg-cyan-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"])},[r[10]||(r[10]=a("div",{class:"flex flex-col items-center gap-2"},[a("div",{class:"w-12 h-12 bg-cyan-500 rounded-xl flex items-center justify-center"},[a("svg",{class:"w-8 h-8 text-white",viewBox:"0 0 24 24",fill:"currentColor"},[a("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})])]),a("span",{class:"font-semibold text-gray-900 dark:text-white"},"Payme")],-1)),"payme"===A.value?(t(),e("div",ma,[y(i(Z),{class:"w-5 h-5 text-cyan-500"})])):d("",!0)],2)):d("",!0),z.value.click?(t(),e("button",{key:1,onClick:r[2]||(r[2]=e=>A.value="click"),class:c(["relative p-4 rounded-xl border-2 transition-all","click"===A.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"])},[r[11]||(r[11]=a("div",{class:"flex flex-col items-center gap-2"},[a("div",{class:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center"},[a("svg",{class:"w-8 h-8 text-white",viewBox:"0 0 24 24",fill:"currentColor"},[a("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})])]),a("span",{class:"font-semibold text-gray-900 dark:text-white"},"Click")],-1)),"click"===A.value?(t(),e("div",ya,[y(i(Z),{class:"w-5 h-5 text-blue-500"})])):d("",!0)],2)):d("",!0)])]),a("div",va,[r[13]||(r[13]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Tavsif (ixtiyoriy) ",-1)),x(a("input",{"onUpdate:modelValue":r[3]||(r[3]=e=>B.value=e),type:"text",placeholder:"Xizmat yoki mahsulot nomi",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[b,B.value]])])])):2===M.value?(t(),e("div",ha,[a("div",ka,[a("div",fa,[y(i(Z),{class:"w-8 h-8 text-green-600 dark:text-green-400"})]),r[14]||(r[14]=a("h4",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-1"},"To'lov havolasi tayyor!",-1)),r[15]||(r[15]=a("p",{class:"text-gray-500 dark:text-gray-400"},"Havolani mijozga yuboring",-1))]),a("div",wa,[a("div",_a,[r[16]||(r[16]=a("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Summa",-1)),a("span",Ca,n(Q(V.value)),1)]),a("div",ja,[r[17]||(r[17]=a("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"To'lov tizimi",-1)),a("span",za,n(A.value),1)]),q.value?.order_id?(t(),e("div",Ma,[r[18]||(r[18]=a("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Buyurtma ID",-1)),a("span",Va,n(q.value.order_id),1)])):d("",!0)]),a("div",Ba,[r[19]||(r[19]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," To'lov havolasi ",-1)),a("div",$a,[a("input",{value:q.value?.payment_url,readonly:"",class:"flex-1 px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white text-sm font-mono"},null,8,Ta),a("button",{onClick:W,class:c(["px-4 py-3 rounded-xl font-medium transition-colors flex items-center gap-2",H.value?"bg-green-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"])},[H.value?(t(),o(i(E),{key:1,class:"w-5 h-5"})):(t(),o(i(ue),{key:0,class:"w-5 h-5"})),p(" "+n(H.value?"Nusxalandi!":"Nusxalash"),1)],2)])]),a("div",La,[u.lead?.phone?(t(),e("a",{key:0,href:`https://wa.me/${u.lead.phone.replace(/\D/g,"")}?text=${encodeURIComponent(`Hurmatli ${w.lead?.name}!\n\nTo'lov qilish uchun havola:\n${q.value?.payment_url}\n\nSumma: ${Q(V.value)}`)}`,target:"_blank",class:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-medium rounded-xl transition-colors"},[...r[20]||(r[20]=[a("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[a("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})],-1),p(" WhatsApp ",-1)])],8,Aa)):d("",!0),u.lead?.phone?(t(),e("a",{key:1,href:`https://t.me/share/url?url=${encodeURIComponent(q.value?.payment_url)}&text=${encodeURIComponent("Tolov qilish uchun havola:")}`,target:"_blank",class:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-sky-500 hover:bg-sky-600 text-white font-medium rounded-xl transition-colors"},[y(i(F),{class:"w-5 h-5"}),r[21]||(r[21]=p(" Telegram ",-1))],8,Ua)):d("",!0)])])):d("",!0),X.value?(t(),e("div",qa,[a("div",Xa,[y(i(O),{class:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),a("div",null,[r[22]||(r[22]=a("h4",{class:"font-medium text-red-800 dark:text-red-300"},"Xatolik yuz berdi",-1)),a("p",Ha,n(X.value),1)])])])):d("",!0)])):(t(),e("div",oa,[y(i(O),{class:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),r[7]||(r[7]=a("h4",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"To'lov tizimlari sozlanmagan",-1)),r[8]||(r[8]=a("p",{class:"text-gray-500 dark:text-gray-400 mb-4"},"Payme yoki Click sozlamalarini sozlash kerak",-1)),a("a",{href:l.route("business.settings.payments"),class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors"},[y(i(P),{class:"w-4 h-4"}),r[6]||(r[6]=p(" Sozlamalarga o'tish ",-1))],8,da)]))]),S.value&&!C.value?(t(),e("div",Sa,[2===M.value?(t(),e("button",{key:0,onClick:G,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," Yangi to'lov ")):d("",!0),a("button",{onClick:J,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},n(2===M.value?"Yopish":"Bekor qilish"),1),1===M.value?(t(),e("button",{key:1,onClick:R,disabled:!I.value||j.value,class:"px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center gap-2"},[j.value?(t(),e("div",Da)):(t(),o(i(N),{key:1,class:"w-4 h-4"})),p(" "+n(j.value?"Yaratilmoqda...":"Havola yaratish"),1)],8,Ia)):d("",!0)])):d("",!0)])])])):d("",!0)]),_:1})]))}},Pa=A(Oa,[["__scopeId","data-v-31ea7bd9"]]),Ya={key:0,class:"fixed bottom-6 right-6 z-50 w-72 bg-slate-900 rounded-2xl shadow-2xl border border-slate-700/50 overflow-hidden"},Za={class:"bg-gradient-to-r from-slate-800 to-slate-700 px-4 py-3 flex items-center justify-between"},Ea={class:"text-sm font-medium text-white"},Fa={class:"p-5 text-center"},Na={class:"w-16 h-16 mx-auto mb-3 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-xl"},Ra={class:"text-base font-semibold text-white mb-1"},Wa={class:"text-slate-400 text-sm"},Qa={class:"px-5 pb-5"},Ga=["href"],Ja={class:"text-xs text-slate-500 text-center mt-3"},Ka={href:"https://www.microsip.org/downloads",target:"_blank",class:"block text-center text-xs text-slate-500 hover:text-slate-400 underline mt-2"},et={__name:"CallWidget",props:{show:{type:Boolean,default:!1},lead:{type:Object,required:!0}},emits:["close","openSoftphone"],setup(l,{emit:s}){const{t:c}=$(),u=l,g=s,x=r(()=>{if(!u.lead.phone)return"";return`sip:${u.lead.phone.replace(/\D/g,"")}`}),b=()=>{g("close")};return(r,s)=>(t(),o(m,{to:"body"},[y(k,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-4"},{default:v(()=>{return[l.show?(t(),e("div",Ya,[a("div",Za,[a("span",Ea,n(i(c)("components.call.title")),1),a("button",{onClick:b,class:"p-1 text-slate-400 hover:text-white hover:bg-slate-600 rounded-lg transition-colors"},[y(i(D),{class:"w-5 h-5"})])]),a("div",Fa,[a("div",Na,n((r=l.lead.name,r?r.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?")),1),a("h3",Ra,n(l.lead.name),1),a("p",Wa,n(l.lead.phone),1)]),a("div",Qa,[a("a",{href:x.value,onClick:s[0]||(s[0]=e=>g("openSoftphone")),class:"w-full flex items-center justify-center gap-3 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-xl transition-colors shadow-lg shadow-green-600/30"},[y(i(xe),{class:"w-5 h-5"}),p(" "+n(i(c)("components.call.make_call")),1)],8,Ga),a("p",Ja,n(i(c)("components.call.microsip_opens")),1),a("a",Ka,n(i(c)("components.call.download_microsip")),1)])])):d("",!0)];var r}),_:1})]))}},at={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},tt={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg z-10 overflow-hidden max-h-[90vh] overflow-y-auto"},lt={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800"},rt={class:"flex items-center gap-3"},st={class:"w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl flex items-center justify-center"},ot={class:"text-lg font-semibold text-gray-900 dark:text-white"},dt={class:"p-6 space-y-5"},nt={key:0,class:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},it={class:"flex items-center gap-3"},ct={class:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-lg"},ut={class:"flex-1 min-w-0"},gt={class:"font-semibold text-gray-900 dark:text-white truncate"},xt={class:"flex items-center gap-2 mt-1"},bt={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},pt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},mt={key:0,class:"flex items-center justify-center py-8"},yt={key:1,class:"text-center py-8"},vt={class:"text-gray-500 dark:text-gray-400"},ht={class:"text-sm text-gray-400 dark:text-gray-500 mt-1"},kt={key:2,class:"space-y-2"},ft={class:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center"},wt={class:"flex-1"},_t={class:"font-medium text-gray-700 dark:text-gray-300"},Ct={class:"text-xs text-gray-500 dark:text-gray-400"},jt=["onClick"],zt={class:"w-10 h-10 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white font-semibold"},Mt={class:"flex-1 min-w-0"},Vt={class:"font-medium text-gray-900 dark:text-white"},Bt={key:0,class:"flex items-center gap-3 mt-1 text-xs text-gray-500 dark:text-gray-400"},$t={key:1,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},Tt={for:"reassign-tasks",class:"text-sm text-gray-700 dark:text-gray-300"},Lt={key:2,class:"text-sm text-red-500"},At={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 sticky bottom-0"},Ut=["disabled"],qt={__name:"LeadAssignModal",props:{show:{type:Boolean,default:!1},lead:{type:Object,default:null}},emits:["close","assigned"],setup(b,{emit:p}){const{t:h}=$(),w=b,_=p,C=l([]),j=l([]),z=l(null),M=l(!0),V=l(!1),B=l(!1),A=l(""),U=r(()=>({new:h("sales.status_new"),contacted:h("sales.status_contacted"),qualified:h("sales.status_qualified"),proposal:h("sales.status_proposal"),negotiation:h("sales.status_negotiation"),won:h("sales.status_won"),lost:h("sales.status_lost")})),X={new:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",contacted:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",qualified:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",proposal:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-400",negotiation:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400",won:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",lost:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"},H=e=>j.value.find(a=>a.operator.id===e);s(()=>w.show,e=>{e&&(A.value="",z.value=w.lead?.assigned_to?.id||null,M.value=!0,(async()=>{B.value=!0;try{const[e,a]=await Promise.all([fetch(route("business.api.sales.operators")),fetch(route("business.api.sales.operator-stats"))]),t=await e.json(),l=await a.json();C.value=t.operators||[],j.value=l.stats||[]}catch(e){}finally{B.value=!1}})())});const S=async()=>{if(!V.value){V.value=!0,A.value="";try{await T();const e=await window.axios.post(route("business.api.sales.assign",{lead:w.lead.id}),{operator_id:z.value,reassign_tasks:M.value});e.data.success?(_("assigned",e.data.lead),_("close")):A.value=e.data.error||e.data.message||h("common.error_occurred")}catch(e){if(L(e))return A.value=h("common.session_expired"),void(await T());e.response?.data?.error?A.value=e.response.data.error:e.response?.data?.message?A.value=e.response.data.message:A.value=h("common.network_error")}finally{V.value=!1}}},I=()=>{_("close")};return(l,r)=>(t(),o(m,{to:"body"},[y(k,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[b.show?(t(),e("div",at,[a("div",{class:"fixed inset-0 bg-black/50",onClick:I}),y(k,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:v(()=>{return[b.show?(t(),e("div",tt,[a("div",lt,[a("div",rt,[a("div",st,[y(i(W),{class:"w-5 h-5 text-white"})]),a("h3",ot,n(i(h)("components.lead_assign.title")),1)]),a("button",{onClick:I,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[y(i(D),{class:"w-5 h-5"})])]),a("div",dt,[b.lead?(t(),e("div",nt,[a("div",it,[a("div",ct,n(b.lead.name?.charAt(0)?.toUpperCase()||"?"),1),a("div",ut,[a("h4",gt,n(b.lead.name),1),a("div",xt,[a("span",{class:c(["px-2 py-0.5 text-xs font-medium rounded-full",X[b.lead.status]||"bg-gray-100 text-gray-700"])},n(U.value[b.lead.status]||b.lead.status),3),b.lead.estimated_value?(t(),e("span",bt," $"+n((l=b.lead.estimated_value,l?new Intl.NumberFormat("uz-UZ").format(l):"0")),1)):d("",!0)])])])])):d("",!0),a("div",null,[a("label",pt,n(i(h)("components.bulk_assign.select_operator")),1),B.value?(t(),e("div",mt,[...r[2]||(r[2]=[a("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"},null,-1)])])):0===C.value.length?(t(),e("div",yt,[y(i(q),{class:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600 mb-3"}),a("p",vt,n(i(h)("components.bulk_assign.no_operators")),1),a("p",ht,n(i(h)("components.bulk_assign.add_operator_hint")),1)])):(t(),e("div",kt,[a("button",{onClick:r[0]||(r[0]=e=>z.value=null),class:c(["w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left",null===z.value?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[a("div",ft,[y(i(D),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"})]),a("div",wt,[a("span",_t,n(i(h)("components.bulk_assign.unassigned")),1),a("p",Ct,n(i(h)("components.bulk_assign.leave_without_operator")),1)]),null===z.value?(t(),o(i(Z),{key:0,class:"w-5 h-5 text-orange-500"})):d("",!0)],2),(t(!0),e(u,null,g(C.value,l=>(t(),e("button",{key:l.id,onClick:e=>z.value=l.id,class:c(["w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left",z.value===l.id?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[a("div",zt,n(l.name?.charAt(0)?.toUpperCase()||"?"),1),a("div",Mt,[a("span",Vt,n(l.name),1),H(l.id)?(t(),e("div",Bt,[a("span",null,n(H(l.id).leads.total)+" lid",1),a("span",null,n(H(l.id).leads.conversion_rate)+"% conversion",1)])):d("",!0)]),z.value===l.id?(t(),o(i(Z),{key:0,class:"w-5 h-5 text-orange-500"})):d("",!0)],10,jt))),128))]))]),C.value.length>0?(t(),e("div",$t,[x(a("input",{type:"checkbox",id:"reassign-tasks","onUpdate:modelValue":r[1]||(r[1]=e=>M.value=e),class:"w-4 h-4 text-orange-500 border-gray-300 rounded focus:ring-orange-500"},null,512),[[f,M.value]]),a("label",Tt,n(i(h)("components.bulk_assign.reassign_tasks")),1)])):d("",!0),A.value?(t(),e("p",Lt,n(A.value),1)):d("",!0)]),a("div",At,[a("button",{onClick:I,class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 font-medium rounded-xl transition-colors"},n(i(h)("common.cancel")),1),a("button",{onClick:S,disabled:V.value,class:c(["px-6 py-2 font-medium rounded-xl transition-colors",V.value?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600 text-white"])},n(V.value?i(h)("common.saving"):i(h)("components.lead_assign.assign")),11,Ut)])])):d("",!0)];var l}),_:1})])):d("",!0)]),_:1})]))}},Xt={class:"font-medium"},Ht={class:"h-full flex flex-col -m-4 sm:-m-6 lg:-m-8"},St={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 lg:px-8 py-3"},It={class:"flex items-center justify-between"},Dt={class:"flex items-center gap-4"},Ot={class:"flex items-center gap-3"},Pt={class:"text-lg font-bold text-gray-900 dark:text-white"},Yt={class:"text-sm text-gray-500 dark:text-gray-400"},Zt={class:"flex items-center gap-2"},Et=["title"],Ft=["href"],Nt=["title"],Rt={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 lg:px-8 py-3"},Wt={class:"flex items-center gap-2"},Qt=["onClick","title"],Gt={class:"flex-1 overflow-auto"},Jt={class:"h-full flex"},Kt={class:"w-80 flex-shrink-0 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 overflow-y-auto"},el={class:"p-6 border-b border-gray-200 dark:border-gray-700"},al={class:"flex flex-col items-center text-center mb-6"},tl={class:"text-xl font-bold text-gray-900 dark:text-white"},ll={key:0,class:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1 mt-1"},rl={class:"space-y-3"},sl={class:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center group-hover:bg-green-200 dark:group-hover:bg-green-800/30 transition-colors"},ol={class:"min-w-0 flex-1 text-left"},dl={class:"text-xs text-gray-500 dark:text-gray-400"},nl={class:"text-sm font-medium text-gray-900 dark:text-white"},il=["href"],cl={class:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center group-hover:bg-blue-200 dark:group-hover:bg-blue-800/30 transition-colors"},ul={class:"min-w-0 flex-1"},gl={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},xl={class:"p-6 border-b border-gray-200 dark:border-gray-700"},bl={class:"text-sm font-semibold text-gray-900 dark:text-white mb-4"},pl={key:0,class:"relative assign-dropdown"},ml={class:"w-10 h-10 rounded-lg bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white font-semibold"},yl={class:"min-w-0 flex-1 text-left"},vl={class:"text-xs text-gray-500 dark:text-gray-400"},hl={class:"text-sm font-medium text-gray-900 dark:text-white"},kl={class:"w-10 h-10 rounded-lg bg-gray-200 dark:bg-gray-600 flex items-center justify-center"},fl={class:"min-w-0 flex-1 text-left"},wl={class:"text-xs text-gray-500 dark:text-gray-400"},_l={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Cl={key:0,class:"absolute z-10 mt-2 w-full bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 py-1 max-h-60 overflow-auto"},jl={class:"w-8 h-8 rounded-lg bg-gray-200 dark:bg-gray-600 flex items-center justify-center"},zl=["onClick"],Ml={class:"w-8 h-8 rounded-lg bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white text-xs font-semibold"},Vl={key:1,class:"flex items-center justify-between"},Bl={class:"text-sm text-gray-500 dark:text-gray-400"},$l={class:"w-5 h-5 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white text-xs font-semibold"},Tl={class:"w-5 h-5 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white text-xs font-semibold"},Ll={key:0,class:"p-6 border-b border-gray-200 dark:border-gray-700"},Al={class:"text-sm font-semibold text-gray-900 dark:text-white mb-4"},Ul={class:"space-y-4"},ql={class:"flex items-center justify-between"},Xl={class:"text-sm text-gray-500 dark:text-gray-400"},Hl={class:"text-sm font-semibold text-green-600 dark:text-green-400"},Sl={class:"flex items-center justify-between"},Il={class:"text-sm text-gray-500 dark:text-gray-400"},Dl={class:"text-sm font-medium text-gray-900 dark:text-white"},Ol={class:"p-6 border-b border-gray-200 dark:border-gray-700"},Pl={class:"text-sm font-semibold text-gray-900 dark:text-white mb-4"},Yl={class:"grid grid-cols-2 gap-2"},Zl=["href"],El=["href"],Fl={class:"text-xs font-medium"},Nl={class:"text-xs font-medium"},Rl={class:"text-xs font-medium"},Wl={class:"text-xs font-medium"},Ql={class:"p-6"},Gl={class:"text-sm font-semibold text-gray-900 dark:text-white mb-4"},Jl={class:"space-y-4"},Kl={class:"flex gap-3"},er={class:"w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center flex-shrink-0"},ar={class:"text-sm font-medium text-gray-900 dark:text-white"},tr={class:"text-xs text-gray-500 dark:text-gray-400"},lr={key:0,class:"flex gap-3"},rr={class:"w-8 h-8 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center flex-shrink-0"},sr={class:"text-sm font-medium text-gray-900 dark:text-white"},or={class:"text-xs text-gray-500 dark:text-gray-400"},dr={class:"flex-1 flex flex-col bg-gray-50 dark:bg-gray-900"},nr={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6"},ir={class:"flex gap-1"},cr=["onClick"],ur={class:"flex-1 overflow-y-auto p-6"},gr={key:0,class:"max-w-3xl mx-auto"},xr={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 mb-6"},br={class:"flex items-start gap-4"},pr={class:"flex-1"},mr={key:0},yr=["placeholder"],vr={key:1},hr=["placeholder"],kr={class:"flex items-center justify-between mt-3"},fr={class:"flex items-center gap-2"},wr=["title"],_r=["title"],Cr={class:"flex items-center gap-2"},jr=["disabled"],zr=["disabled"],Mr={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},Vr={key:0,class:"text-center py-12"},Br={class:"text-gray-500 dark:text-gray-400 mt-4"},$r={key:1,class:"space-y-4"},Tr={class:"flex items-start gap-4"},Lr={class:"flex-1 min-w-0"},Ar={class:"flex items-center justify-between mb-1"},Ur={class:"flex items-center gap-2"},qr={class:"text-sm font-semibold text-gray-900 dark:text-white"},Xr={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},Hr=["title"],Sr={class:"text-sm text-gray-600 dark:text-gray-400"},Ir={key:2,class:"text-center py-12"},Dr={class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},Or={class:"text-gray-500 dark:text-gray-400"},Pr={key:1,class:"max-w-3xl mx-auto"},Yr={class:"space-y-6"},Zr={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},Er={class:c(["text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center gap-2"])},Fr={class:"grid grid-cols-2 gap-4"},Nr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Rr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Wr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 flex items-center justify-between"},Qr={key:0,class:"flex gap-2"},Gr={key:1,class:"text-sm text-gray-400 dark:text-gray-500 mt-1"},Jr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Kr=["placeholder"],es={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},as={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ts={value:""},ls={value:"male"},rs={value:"female"},ss={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},os={class:c(["text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center gap-2"])},ds={class:"grid grid-cols-2 gap-4"},ns={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},is={value:""},cs=["value"],us={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},gs={value:""},xs=["value"],bs=["placeholder","disabled"],ps={class:"col-span-2"},ms={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ys=["placeholder"],vs={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},hs={class:c(["text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center gap-2"])},ks={class:"space-y-4"},fs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ws={value:""},_s=["value"],Cs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},js=["placeholder"],zs={class:"flex justify-end"},Ms=["disabled"],Vs={key:0,class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},Bs={key:2,class:"space-y-4"},$s={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-sm"},Ts={class:"flex items-center justify-between flex-wrap gap-4"},Ls={class:"flex items-center gap-6 flex-wrap"},As={class:"flex items-center gap-3"},Us={class:"text-xl font-bold text-gray-900 dark:text-white"},qs={class:"text-xs text-gray-500 dark:text-gray-400"},Xs={class:"flex items-center gap-3"},Hs={class:"text-xl font-bold text-gray-900 dark:text-white"},Ss={class:"text-xs text-gray-500 dark:text-gray-400"},Is={class:"flex items-center gap-3"},Ds={class:"text-xl font-bold text-gray-900 dark:text-white"},Os={class:"text-xs text-gray-500 dark:text-gray-400"},Ps={class:"flex items-center gap-2"},Ys={class:"flex items-center gap-1.5 px-2.5 py-1.5 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},Zs={class:"text-sm font-bold text-blue-700 dark:text-blue-400"},Es={class:"flex items-center gap-1.5 px-2.5 py-1.5 bg-orange-50 dark:bg-orange-900/20 rounded-lg"},Fs={class:"text-sm font-bold text-orange-700 dark:text-orange-400"},Ns=["disabled"],Rs={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Ws={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qs={key:0,class:"text-center py-12"},Gs={class:"text-gray-500 dark:text-gray-400 mt-4 text-sm"},Js={key:1,class:"space-y-2"},Ks={class:"relative flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 hover:shadow-md shadow-sm transition-all duration-200"},eo={class:"relative flex-shrink-0"},ao={key:0,class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},to={key:1,class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},lo={key:0,class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},ro={key:1,class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},so={class:"flex-1 min-w-0"},oo={class:"flex items-center gap-2 flex-wrap"},no={key:0,class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},io={key:1,class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},co=["onClick","disabled","title"],uo={key:0,class:"w-3.5 h-3.5 animate-spin",fill:"none",viewBox:"0 0 24 24"},go={key:1,class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xo={class:"text-xs text-gray-500 dark:text-gray-400"},bo={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},po={class:"flex items-center gap-2"},mo={key:0,class:"flex items-center gap-1.5 px-2.5 py-1.5 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},yo={class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},vo=["onClick","disabled"],ho={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},ko={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},fo={key:2,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},wo=["title"],_o={key:2,class:"text-center py-12 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-dashed border-gray-300 dark:border-gray-600"},Co={class:"text-lg font-bold text-gray-900 dark:text-white mb-2"},jo={class:"text-gray-500 dark:text-gray-400 mb-6 max-w-sm mx-auto text-sm"},zo={class:"flex items-center justify-center gap-3"},Mo=["disabled"],Vo={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Bo={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},$o={key:3,class:"h-full"},To={key:0,class:"text-center py-12"},Lo={class:"text-gray-500 dark:text-gray-400 mt-4"},Ao={key:1,class:"grid grid-cols-4 gap-4 h-full"},Uo={class:"flex flex-col bg-red-50/50 dark:bg-red-900/10 rounded-xl border border-red-200 dark:border-red-800/30 overflow-hidden"},qo={class:"p-3 bg-red-100 dark:bg-red-900/30 border-b border-red-200 dark:border-red-800/30"},Xo={class:"flex items-center justify-between"},Ho={class:"flex items-center gap-2"},So={class:"font-semibold text-red-700 dark:text-red-400"},Io={class:"text-xs font-bold px-2 py-0.5 bg-red-200 dark:bg-red-800/50 text-red-700 dark:text-red-300 rounded-full"},Do={class:"flex-1 overflow-y-auto p-2 space-y-2"},Oo={class:"flex items-center justify-between mb-2"},Po={class:"text-lg font-bold text-red-600 dark:text-red-400"},Yo={class:"font-medium text-gray-900 dark:text-white text-sm mb-1"},Zo={class:"text-xs text-red-500 dark:text-red-400 mb-2"},Eo={class:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700"},Fo=["onClick"],No={class:"flex gap-1"},Ro=["onClick"],Wo=["onClick"],Qo={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},Go={class:"text-xs"},Jo={class:"flex flex-col bg-blue-50/50 dark:bg-blue-900/10 rounded-xl border border-blue-200 dark:border-blue-800/30 overflow-hidden"},Ko={class:"p-3 bg-blue-100 dark:bg-blue-900/30 border-b border-blue-200 dark:border-blue-800/30"},ed={class:"flex items-center justify-between"},ad={class:"flex items-center gap-2"},td={class:"font-semibold text-blue-700 dark:text-blue-400"},ld={class:"text-xs font-bold px-2 py-0.5 bg-blue-200 dark:bg-blue-800/50 text-blue-700 dark:text-blue-300 rounded-full"},rd={class:"flex-1 overflow-y-auto p-2 space-y-2"},sd={class:"flex items-center justify-between mb-2"},od={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},dd={class:"font-medium text-gray-900 dark:text-white text-sm mb-1"},nd={key:0,class:"mb-2"},id={class:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700"},cd=["onClick"],ud={class:"flex gap-1"},gd=["onClick"],xd=["onClick"],bd={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},pd={class:"text-xs"},md={class:"p-2 border-t border-blue-200 dark:border-blue-800/30"},yd={class:"flex flex-col bg-indigo-50/50 dark:bg-indigo-900/10 rounded-xl border border-indigo-200 dark:border-indigo-800/30 overflow-hidden"},vd={class:"p-3 bg-indigo-100 dark:bg-indigo-900/30 border-b border-indigo-200 dark:border-indigo-800/30"},hd={class:"flex items-center justify-between"},kd={class:"flex items-center gap-2"},fd={class:"font-semibold text-indigo-700 dark:text-indigo-400"},wd={class:"text-xs font-bold px-2 py-0.5 bg-indigo-200 dark:bg-indigo-800/50 text-indigo-700 dark:text-indigo-300 rounded-full"},_d={class:"flex-1 overflow-y-auto p-2 space-y-2"},Cd={class:"flex items-center justify-between mb-2"},jd={class:"text-lg font-bold text-indigo-600 dark:text-indigo-400"},zd={class:"font-medium text-gray-900 dark:text-white text-sm mb-1"},Md={key:0,class:"mb-2"},Vd={class:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700"},Bd=["onClick"],$d={class:"flex gap-1"},Td=["onClick"],Ld=["onClick"],Ad={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},Ud={class:"text-xs"},qd={class:"flex flex-col bg-purple-50/50 dark:bg-purple-900/10 rounded-xl border border-purple-200 dark:border-purple-800/30 overflow-hidden"},Xd={class:"p-3 bg-purple-100 dark:bg-purple-900/30 border-b border-purple-200 dark:border-purple-800/30"},Hd={class:"flex items-center justify-between"},Sd={class:"flex items-center gap-2"},Id={class:"font-semibold text-purple-700 dark:text-purple-400"},Dd={class:"text-xs font-bold px-2 py-0.5 bg-purple-200 dark:bg-purple-800/50 text-purple-700 dark:text-purple-300 rounded-full"},Od={class:"flex-1 overflow-y-auto p-2 space-y-2"},Pd={class:"flex items-center justify-between mb-2"},Yd={class:"text-lg font-bold text-purple-600 dark:text-purple-400"},Zd={class:"font-medium text-gray-900 dark:text-white text-sm mb-1"},Ed={class:"text-xs text-purple-500 dark:text-purple-400 mb-2"},Fd={class:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700"},Nd=["onClick"],Rd={class:"flex gap-1"},Wd=["onClick"],Qd=["onClick"],Gd={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},Jd={class:"text-xs"},Kd={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},en={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md mx-4 shadow-xl z-10"},an={class:"text-center"},tn={class:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4"},ln={class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},rn={class:"text-gray-500 dark:text-gray-400 mb-6"},sn={class:"flex gap-3"},on=A({__name:"LeadShow",props:{lead:{type:Object,required:!0},operators:{type:Array,default:()=>[]},sources:{type:Array,default:()=>[]},regions:{type:Object,default:()=>({})},districts:{type:Object,default:()=>({})},canAssignLeads:{type:Boolean,default:!1},panelType:{type:String,required:!0,validator:e=>["saleshead","business","operator"].includes(e)}},setup(s){const{t:f}=$(),T=s;r(()=>"saleshead"===T.panelType?"/sales-head":"operator"===T.panelType?"/operator/leads":"/business/api/sales"),r(()=>"saleshead"===T.panelType?"/sales-head/leads":"operator"===T.panelType?"/operator/leads":route("business.sales.index"));const L=r(()=>"saleshead"===T.panelType?"/sales-head/leads":"operator"===T.panelType?"/operator/leads":route("business.sales.index")),A=r(()=>"saleshead"===T.panelType?{primary:"emerald",gradient:"from-emerald-500 to-teal-600",ring:"focus:ring-emerald-500",bg:"bg-emerald-600 hover:bg-emerald-700",bgDisabled:"disabled:bg-emerald-400",border:"border-emerald-500",text:"text-emerald-600 dark:text-emerald-400",bgLight:"bg-emerald-50 dark:bg-emerald-900/20",spinner:"border-emerald-500"}:{primary:"blue",gradient:"from-blue-500 to-purple-600",ring:"focus:ring-blue-500",bg:"bg-blue-600 hover:bg-blue-700",bgDisabled:"disabled:bg-blue-400",border:"border-blue-500",text:"text-blue-600 dark:text-blue-400",bgLight:"bg-blue-50 dark:bg-blue-900/20",spinner:"border-blue-500"}),U=l(!1),P=l(!1),E=l(!1),N=l(!1),ue=l(!1),xe=l(null),be=l({name:T.lead.name||"",phone:T.lead.phone||"",phone2:T.lead.phone2||"",email:T.lead.email||"",company:T.lead.company||"",birth_date:T.lead.birth_date||"",gender:T.lead.gender||"",region:T.lead.region||"",district:T.lead.district||"",address:T.lead.address||"",source_id:T.lead.source_id||"",notes:T.lead.notes||""}),pe=l(!1),me=l(!!T.lead.phone2),ye=r(()=>be.value.region&&T.districts[be.value.region]?T.districts[be.value.region]:{}),ve=()=>{be.value.district&&T.districts[be.value.region]&&T.districts[be.value.region][be.value.district]||(be.value.district="")},he=l(!1),ke=l(null),fe=l({overdue:[],today:[],tomorrow:[],this_week:[],later:[],completed:[]}),we=l(!1),_e=l([]),Ce=l({total_calls:0,outbound_calls:0,inbound_calls:0,answered_calls:0,missed_calls:0,total_duration:0,avg_duration:0,answer_rate:0,total_duration_formatted:"0:00"}),je=l(!1),ze=l(null),Me=l(null),Ve=l(null),Be=(e,a)=>{Ve.value&&Ve.value.pause(),Ve.value=new Audio(a),Ve.value.play().catch(e=>{He("error","Audio ijro etishda xatolik"),ze.value=null}),Ve.value.onended=()=>{ze.value=null,Ve.value=null},Ve.value.onerror=()=>{He("error","Audio faylni yuklab bo'lmadi"),ze.value=null,Ve.value=null},ze.value=e.id},$e=l(null),Te=l(""),Le=l(!1),Ae=l(!1),Ue=l([]),qe=l(!1),Xe=l({show:!1,type:"success",message:""}),He=(e,a)=>{Xe.value={show:!0,type:e,message:a},setTimeout(()=>{Xe.value.show=!1},3e3)},Se=e=>{const a="saleshead"===T.panelType?"/sales-head/leads":"/business/api/sales/leads";return{activities:`${a}/${T.lead.id}/activities`,notes:`${a}/${T.lead.id}/notes`,status:`${a}/${T.lead.id}/status`,assign:`${a}/${T.lead.id}/assign`,update:`${a}/${T.lead.id}`,delete:`${a}/${T.lead.id}`,calls:`${a}/${T.lead.id}/calls`,tasks:"saleshead"===T.panelType?`/sales-head/leads/${T.lead.id}/tasks`:route("business.tasks.lead",T.lead.id)}[e]},Ie=async()=>{qe.value=!0;try{const e=await V.get(Se("activities"));Ue.value=e.data.activities||[]}catch(e){}finally{qe.value=!1}},De=e=>({created:ie,updated:ne,status_changed:S,note_added:ee,assigned:W,contacted:te,task_created:I,task_completed:Z}[e]||ae),Oe=l(!1),Pe=l("activity"),Ye=l(!1),Ze=l(!1);l({title:"",type:"task",priority:"normal",due_date:"",due_time:"",description:""}),l({}),l(!1);const Ee=r(()=>({new:{label:f("leads.pipeline.new"),color:"bg-blue-500",bgLight:"bg-blue-50 dark:bg-blue-900/20",text:"text-blue-600 dark:text-blue-400",icon:le},contacted:{label:f("leads.pipeline.contacted"),color:"bg-indigo-500",bgLight:"bg-indigo-50 dark:bg-indigo-900/20",text:"text-indigo-600 dark:text-indigo-400",icon:te},callback:{label:f("leads.pipeline.callback"),color:"bg-purple-500",bgLight:"bg-purple-50 dark:bg-purple-900/20",text:"text-purple-600 dark:text-purple-400",icon:ae},considering:{label:f("leads.pipeline.considering"),color:"bg-orange-500",bgLight:"bg-orange-50 dark:bg-orange-900/20",text:"text-orange-600 dark:text-orange-400",icon:ee},meeting_scheduled:{label:f("leads.pipeline.meeting_scheduled"),color:"bg-yellow-500",bgLight:"bg-yellow-50 dark:bg-yellow-900/20",text:"text-yellow-600 dark:text-yellow-400",icon:K},meeting_attended:{label:f("leads.pipeline.meeting_attended"),color:"bg-teal-500",bgLight:"bg-teal-50 dark:bg-teal-900/20",text:"text-teal-600 dark:text-teal-400",icon:J},won:{label:f("leads.pipeline.won"),color:"bg-green-500",bgLight:"bg-green-50 dark:bg-green-900/20",text:"text-green-600 dark:text-green-400",icon:Z},lost:{label:f("leads.pipeline.lost"),color:"bg-red-500",bgLight:"bg-red-50 dark:bg-red-900/20",text:"text-red-600 dark:text-red-400",icon:G}})),Fe=["new","contacted","callback","considering","meeting_scheduled","meeting_attended","won"],Ne=r(()=>Ee.value[T.lead.status]||Ee.value.new),Re=r(()=>Fe.indexOf(T.lead.status)),We=async()=>{pe.value=!0;try{const e=await V.put(Se("update"),be.value);He("success",e.data.message||"Ma'lumotlar saqlandi"),B.reload({only:["lead"]}),Ie()}catch(e){He("error",e.response?.data?.message||"Xatolik yuz berdi")}finally{pe.value=!1}},Qe=async()=>{if(Te.value.trim()){Ae.value=!0;try{await V.post(Se("notes"),{note:Te.value.trim()}),Te.value="",Le.value=!1,He("success","Izoh qo'shildi"),Ie()}catch(e){He("error","Izoh qo'shishda xatolik")}finally{Ae.value=!1}}},Je=async()=>{je.value=!0;try{const e=await V.get(Se("calls"));_e.value=e.data.calls||[],Ce.value=e.data.stats||{total_calls:0,outbound_calls:0,inbound_calls:0,answered_calls:0,missed_calls:0,total_duration:0,avg_duration:0,answer_rate:0,total_duration_formatted:"0:00"}}catch(e){}finally{je.value=!1}},Ke=l(!1),ea=async()=>{Ke.value=!0;try{const e="saleshead"===T.panelType?"/sales-head/leads":"/business/api/sales/leads",a=await V.post(`${e}/${T.lead.id}/sync-calls`);if(a.data.success)if(_e.value=a.data.calls||[],Ce.value=a.data.stats||Ce.value,a.data.warning)He("warning",a.data.message);else{const e=a.data.synced||0,t=a.data.linked||0;let l=`Sinxronlandi: ${e} ta yangi`;t>0&&(l+=`, ${t} ta ulandi`),He("success",l)}else He("error",a.data.error||"Sinxronlash xatosi")}catch(e){const a=e.response?.data?.error;a&&(a.includes("autentifikatsiya")||a.includes("key_id"))?He("error","PBX sozlamalari xato. Telefoniya sozlamalarini tekshiring."):404===e.response?.status?He("error","PBX ulangan emas"):He("error",a||"Sinxronlash xatosi")}finally{Ke.value=!1}},aa=async()=>{we.value=!0;try{const e=await V.get(Se("tasks"));fe.value=e.data.tasks||{overdue:[],today:[],tomorrow:[],this_week:[],later:[],completed:[]}}catch(e){}finally{we.value=!1}},ta=(e=null)=>{ke.value=e,he.value=!0},la=()=>{he.value=!1,ke.value=null},ra=()=>{aa()},sa=async e=>{try{const a="saleshead"===T.panelType?`/sales-head/tasks/${e.id}/complete`:route("business.tasks.complete",e.id);await V.post(a),aa()}catch(a){}},oa=async e=>{if(confirm("Vazifani o'chirmoqchimisiz?"))try{const a="saleshead"===T.panelType?`/sales-head/tasks/${e.id}`:route("business.tasks.destroy",e.id);await V.delete(a),aa()}catch(a){}},da=e=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"??",na=async()=>{try{"saleshead"===T.panelType?(await V.delete(Se("delete")),B.visit("/sales-head/leads")):B.delete(route("business.sales.destroy",T.lead.id),{onSuccess:()=>{Oe.value=!1}})}catch(e){}},ia=async e=>{Ze.value=!0;try{await V.post(Se("assign"),{assigned_to:e}),Ye.value=!1,B.reload({only:["lead"]}),Ie()}catch(a){}finally{Ze.value=!1}},ca=()=>{xe.value={...T.lead},ue.value=!0},ua=e=>{xe.value&&(xe.value.assigned_to=e.assigned_to),B.reload({only:["lead"]}),Ie()},ga=()=>{E.value=!0},xa=()=>{E.value=!1},ba=r(()=>[{id:"activity",label:f("leads.show.tab_activity"),icon:ae},{id:"info",label:f("leads.show.tab_info"),icon:q},{id:"calls",label:f("leads.show.tab_calls"),icon:te},{id:"tasks",label:f("leads.show.tab_tasks"),icon:Z}]),pa=e=>{e.target.closest(".assign-dropdown")||(Ye.value=!1)};return w(()=>{document.addEventListener("click",pa),aa(),Ie(),Je(),(async()=>{try{const e="saleshead"===T.panelType?"/business/sms/status":route("business.sms.status"),a=await V.get(e);P.value=a.data.connected}catch(e){}})()}),_(()=>{document.removeEventListener("click",pa)}),(l,r)=>{return t(),e("div",null,[y(i(z),{title:s.lead.name},null,8,["title"]),(t(),o(m,{to:"body"},[y(k,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform translate-y-2 opacity-0","enter-to-class":"transform translate-y-0 opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform translate-y-0 opacity-100","leave-to-class":"transform translate-y-2 opacity-0"},{default:v(()=>[Xe.value.show?(t(),e("div",{key:0,class:c(["fixed top-4 right-4 z-[100] flex items-center gap-3 px-4 py-3 rounded-xl shadow-lg",{"bg-emerald-500 text-white":"success"===Xe.value.type,"bg-amber-500 text-white":"warning"===Xe.value.type,"bg-red-500 text-white":"error"===Xe.value.type}])},["success"===Xe.value.type?(t(),o(i(Z),{key:0,class:"w-5 h-5"})):"warning"===Xe.value.type?(t(),o(i(O),{key:1,class:"w-5 h-5"})):(t(),o(i(G),{key:2,class:"w-5 h-5"})),a("span",Xt,n(Xe.value.message),1),a("button",{onClick:r[0]||(r[0]=e=>Xe.value.show=!1),class:"ml-2 p-1 hover:bg-white/20 rounded-lg transition-colors"},[y(i(D),{class:"w-4 h-4"})])],2)):d("",!0)]),_:1})])),a("div",Ht,[a("div",St,[a("div",It,[a("div",Dt,[y(i(M),{href:L.value,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},{default:v(()=>[y(i(re),{class:"w-5 h-5"})]),_:1},8,["href"]),a("div",Ot,[a("div",{class:c(["w-10 h-10 rounded-full bg-gradient-to-br flex items-center justify-center text-white font-semibold text-sm shadow-lg",A.value.gradient])},n(da(s.lead.name)),3),a("div",null,[a("h1",Pt,n(s.lead.name),1),a("p",Yt,n(s.lead.company||s.lead.phone),1)])])]),a("div",Zt,[s.lead.phone?(t(),e("button",{key:0,onClick:ga,class:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition-colors",title:i(f)("leads.show.call")},[y(i(te),{class:"w-5 h-5"})],8,Et)):d("",!0),s.lead.email?(t(),e("a",{key:1,href:`mailto:${s.lead.email}`,class:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Email"},[y(i(se),{class:"w-5 h-5"})],8,Ft)):d("",!0),a("button",{onClick:r[1]||(r[1]=e=>Oe.value=!0),class:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:i(f)("leads.show.delete")},[y(i(X),{class:"w-5 h-5"})],8,Nt)])])]),a("div",Rt,[a("div",Wt,[(t(),e(u,null,g(Fe,(e,t)=>a("button",{key:e,onClick:a=>(async e=>{try{await V.post(Se("status"),{status:e}),B.reload({only:["lead"]}),Ie()}catch(a){}})(e),class:c(["flex-1 h-2 rounded-full transition-all duration-300 hover:opacity-80",t<=Re.value?Ee.value[s.lead.status].color:"bg-gray-200 dark:bg-gray-700"]),title:Ee.value[e].label},null,10,Qt)),64)),a("span",{class:c(["ml-4 inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium",Ne.value.bgLight,Ne.value.text])},[(t(),o(C(Ne.value.icon),{class:"w-4 h-4"})),p(" "+n(Ne.value.label),1)],2)])]),a("div",Gt,[a("div",Jt,[a("div",Kt,[a("div",el,[a("div",al,[a("div",{class:c(["w-24 h-24 rounded-2xl bg-gradient-to-br flex items-center justify-center text-white font-bold text-3xl shadow-xl mb-4",A.value.gradient])},n(da(s.lead.name)),3),a("h2",tl,n(s.lead.name),1),s.lead.company?(t(),e("p",ll,[y(i(H),{class:"w-4 h-4"}),p(" "+n(s.lead.company),1)])):d("",!0)]),a("div",rl,[s.lead.phone?(t(),e("button",{key:0,onClick:ga,class:"w-full flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors group cursor-pointer"},[a("div",sl,[y(i(te),{class:"w-5 h-5 text-green-600 dark:text-green-400"})]),a("div",ol,[a("p",dl,n(i(f)("leads.show.phone")),1),a("p",nl,n(s.lead.phone),1)]),y(i(oe),{class:"w-5 h-5 text-green-500 opacity-0 group-hover:opacity-100 transition-opacity"})])):d("",!0),s.lead.email?(t(),e("a",{key:1,href:`mailto:${s.lead.email}`,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors group"},[a("div",cl,[y(i(se),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),a("div",ul,[r[37]||(r[37]=a("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Email",-1)),a("p",gl,n(s.lead.email),1)]),y(i(ce),{class:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})],8,il)):d("",!0)])]),a("div",xl,[a("h3",bl,n(i(f)("leads.show.operator")),1),"saleshead"===s.panelType?(t(),e("div",pl,[a("button",{onClick:r[2]||(r[2]=h(e=>Ye.value=!Ye.value,["stop"])),class:"w-full flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[s.lead.assigned_to?(t(),e(u,{key:0},[a("span",ml,n(s.lead.assigned_to.name?.charAt(0)?.toUpperCase()),1),a("div",yl,[a("p",vl,n(i(f)("leads.show.assigned")),1),a("p",hl,n(s.lead.assigned_to.name),1)])],64)):(t(),e(u,{key:1},[a("span",kl,[y(i(W),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"})]),a("div",fl,[a("p",wl,n(i(f)("leads.show.operator")),1),a("p",_l,n(i(f)("leads.show.not_assigned")),1)])],64)),Ze.value?(t(),o(i(S),{key:2,class:"w-5 h-5 text-gray-400 animate-spin"})):d("",!0)]),y(k,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:v(()=>[Ye.value?(t(),e("div",Cl,[a("button",{onClick:r[3]||(r[3]=e=>ia(null)),class:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},[a("span",jl,[y(i(D),{class:"w-4 h-4"})]),p(" "+n(i(f)("leads.show.remove_assignment")),1)]),(t(!0),e(u,null,g(s.operators,l=>(t(),e("button",{key:l.id,onClick:e=>ia(l.id),class:c(["w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",{"bg-emerald-50 dark:bg-emerald-900/20":s.lead.assigned_to?.id===l.id}])},[a("span",Ml,n(l.name?.charAt(0)?.toUpperCase()),1),p(" "+n(l.name),1)],10,zl))),128))])):d("",!0)]),_:1})])):(t(),e("div",Vl,[a("span",Bl,n(i(f)("leads.show.operator")),1),s.canAssignLeads?(t(),e("button",{key:0,onClick:ca,class:c(["flex items-center gap-2 text-sm font-medium hover:text-orange-600 dark:hover:text-orange-400 transition-colors",s.lead.assigned_to?"text-gray-900 dark:text-white":"text-gray-400 dark:text-gray-500"])},[s.lead.assigned_to?(t(),e(u,{key:0},[a("span",$l,n(s.lead.assigned_to.name?.charAt(0)?.toUpperCase()),1),p(" "+n(s.lead.assigned_to.name),1)],64)):(t(),e(u,{key:1},[p(n(i(f)("leads.show.not_assigned")),1)],64))],2)):(t(),e("span",{key:1,class:c(["flex items-center gap-2 text-sm font-medium",s.lead.assigned_to?"text-gray-900 dark:text-white":"text-gray-400 dark:text-gray-500"])},[s.lead.assigned_to?(t(),e(u,{key:0},[a("span",Tl,n(s.lead.assigned_to.name?.charAt(0)?.toUpperCase()),1),p(" "+n(s.lead.assigned_to.name),1)],64)):(t(),e(u,{key:1},[p(n(i(f)("leads.show.not_assigned")),1)],64))],2))]))]),"business"===s.panelType?(t(),e("div",Ll,[a("h3",Al,n(i(f)("leads.show.deal_info")),1),a("div",Ul,[a("div",ql,[a("span",Xl,n(i(f)("leads.show.estimated_value")),1),a("span",Hl,n((w=s.lead.estimated_value,w?Q(w):f("leads.show.not_specified"))),1)]),a("div",Sl,[a("span",Il,n(i(f)("leads.show.source")),1),a("span",Dl,n(s.lead.source?.name||i(f)("leads.show.not_specified")),1)])])])):d("",!0),a("div",Ol,[a("h3",Pl,n(i(f)("leads.show.quick_actions")),1),a("div",Yl,[s.lead.phone?(t(),e("a",{key:0,href:`https://wa.me/${s.lead.phone.replace(/\D/g,"")}`,target:"_blank",class:"flex flex-col items-center gap-2 p-3 bg-emerald-50 dark:bg-emerald-900/20 hover:bg-emerald-100 dark:hover:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 rounded-xl transition-colors"},[...r[38]||(r[38]=[a("svg",{class:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor"},[a("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})],-1),a("span",{class:"text-xs font-medium"},"WhatsApp",-1)])],8,Zl)):d("",!0),s.lead.phone?(t(),e("a",{key:1,href:`https://t.me/${s.lead.phone.replace(/\D/g,"")}`,target:"_blank",class:"flex flex-col items-center gap-2 p-3 bg-sky-50 dark:bg-sky-900/20 hover:bg-sky-100 dark:hover:bg-sky-900/30 text-sky-700 dark:text-sky-400 rounded-xl transition-colors"},[y(i(F),{class:"w-6 h-6"}),r[39]||(r[39]=a("span",{class:"text-xs font-medium"},"Telegram",-1))],8,El)):d("",!0),s.lead.phone&&P.value?(t(),e("button",{key:2,onClick:r[4]||(r[4]=e=>U.value=!0),class:"flex flex-col items-center gap-2 p-3 bg-teal-50 dark:bg-teal-900/20 hover:bg-teal-100 dark:hover:bg-teal-900/30 text-teal-700 dark:text-teal-400 rounded-xl transition-colors"},[...r[40]||(r[40]=[a("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1),a("span",{class:"text-xs font-medium"},"SMS",-1)])])):d("",!0),s.lead.phone?(t(),e("button",{key:3,onClick:ga,class:"flex flex-col items-center gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-400 rounded-xl transition-colors"},[y(i(oe),{class:"w-6 h-6"}),a("span",Fl,n(i(f)("leads.show.call")),1)])):d("",!0),a("button",{onClick:r[5]||(r[5]=e=>ta()),class:"flex flex-col items-center gap-2 p-3 bg-purple-50 dark:bg-purple-900/20 hover:bg-purple-100 dark:hover:bg-purple-900/30 text-purple-700 dark:text-purple-400 rounded-xl transition-colors"},[y(i(I),{class:"w-6 h-6"}),a("span",Nl,n(i(f)("leads.show.task")),1)]),a("button",{onClick:r[6]||(r[6]=e=>N.value=!0),class:"flex flex-col items-center gap-2 p-3 bg-green-50 dark:bg-green-900/20 hover:bg-green-100 dark:hover:bg-green-900/30 text-green-700 dark:text-green-400 rounded-xl transition-colors"},[y(i(Y),{class:"w-6 h-6"}),a("span",Rl,n(i(f)("leads.show.payment")),1)]),s.canAssignLeads&&"business"===s.panelType?(t(),e("button",{key:4,onClick:ca,class:"flex flex-col items-center gap-2 p-3 bg-orange-50 dark:bg-orange-900/20 hover:bg-orange-100 dark:hover:bg-orange-900/30 text-orange-700 dark:text-orange-400 rounded-xl transition-colors"},[y(i(W),{class:"w-6 h-6"}),a("span",Wl,n(i(f)("leads.show.assign")),1)])):d("",!0)])]),a("div",Ql,[a("h3",Gl,n(i(f)("leads.show.timeline")),1),a("div",Jl,[a("div",Kl,[a("div",er,[y(i(K),{class:"w-4 h-4 text-blue-600 dark:text-blue-400"})]),a("div",null,[a("p",ar,n(i(f)("leads.show.created")),1),a("p",tr,n(s.lead.created_at),1)])]),s.lead.last_contacted_at?(t(),e("div",lr,[a("div",rr,[y(i(te),{class:"w-4 h-4 text-green-600 dark:text-green-400"})]),a("div",null,[a("p",sr,n(i(f)("leads.show.last_contact")),1),a("p",or,n(s.lead.last_contacted_at),1)])])):d("",!0)])])]),a("div",dr,[a("div",nr,[a("nav",ir,[(t(!0),e(u,null,g(ba.value,a=>(t(),e("button",{key:a.id,onClick:e=>Pe.value=a.id,class:c(["flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 -mb-px transition-colors",Pe.value===a.id?`${A.value.border} ${A.value.text}`:"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"])},[(t(),o(C(a.icon),{class:"w-4 h-4"})),p(" "+n(a.label),1)],10,cr))),128))])]),a("div",ur,["activity"===Pe.value?(t(),e("div",gr,[a("div",xr,[a("div",br,[a("div",{class:c(["w-10 h-10 rounded-full bg-gradient-to-br flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",A.value.gradient])},n(da(s.lead.name)),3),a("div",pr,[Le.value?(t(),e("div",vr,[x(a("textarea",{"onUpdate:modelValue":r[8]||(r[8]=e=>Te.value=e),rows:"3",class:c(["w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 resize-none",A.value.ring,"focus:ring-2 focus:border-transparent"]),placeholder:i(f)("leads.show.add_note_placeholder"),autofocus:""},null,10,hr),[[b,Te.value]]),a("div",kr,[a("div",fr,[a("button",{onClick:r[9]||(r[9]=e=>ta()),class:c(["p-2 text-gray-400 rounded-lg transition-colors",`hover:${A.value.text} hover:${A.value.bgLight}`]),title:i(f)("leads.show.add_task")},[y(i(I),{class:"w-5 h-5"})],10,wr),s.lead.phone?(t(),e("button",{key:0,onClick:r[10]||(r[10]=e=>U.value=!0),class:"p-2 text-gray-400 hover:text-teal-600 dark:hover:text-teal-400 hover:bg-teal-50 dark:hover:bg-teal-900/20 rounded-lg transition-colors",title:i(f)("leads.show.send_sms")},[y(i(ge),{class:"w-5 h-5"})],8,_r)):d("",!0)]),a("div",Cr,[a("button",{onClick:r[11]||(r[11]=e=>{Le.value=!1,Te.value=""}),disabled:Ae.value,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50"},n(i(f)("common.cancel")),9,jr),a("button",{onClick:Qe,disabled:!Te.value.trim()||Ae.value,class:c(["px-4 py-2 text-white font-medium rounded-lg transition-colors flex items-center gap-2",A.value.bg,A.value.bgDisabled,"disabled:cursor-not-allowed"])},[Ae.value?(t(),e("span",Mr)):d("",!0),p(" "+n(Ae.value?i(f)("common.saving"):i(f)("common.save")),1)],10,zr)])])])):(t(),e("div",mr,[a("input",{type:"text",onFocus:r[7]||(r[7]=e=>Le.value=!0),class:c(["w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 cursor-text",A.value.ring,"focus:ring-2 focus:border-transparent"]),placeholder:i(f)("leads.show.add_note_placeholder")},null,42,yr)]))])])]),qe.value?(t(),e("div",Vr,[a("div",{class:c(["w-8 h-8 border-4 border-t-transparent rounded-full animate-spin mx-auto",A.value.spinner])},null,2),a("p",Br,n(i(f)("common.loading")),1)])):Ue.value.length>0?(t(),e("div",$r,[(t(!0),e(u,null,g(Ue.value,l=>{return t(),e("div",{key:l.id,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},[a("div",Tr,[a("div",{class:c(["w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0",(r=l.type,{created:"bg-emerald-500",updated:"bg-blue-500",status_changed:"bg-purple-500",note_added:"bg-teal-500",assigned:"bg-orange-500",contacted:"bg-green-500",task_created:"bg-indigo-500",task_completed:"bg-green-600"}[r]||"bg-gray-500")])},[(t(),o(C(De(l.type)),{class:"w-5 h-5 text-white"}))],2),a("div",Lr,[a("div",Ar,[a("div",Ur,[a("h4",qr,n(l.title),1),l.user?(t(),e("span",Xr," - "+n(l.user.name),1)):d("",!0)]),a("span",{class:"text-xs text-gray-500 dark:text-gray-400",title:l.created_at},n(l.created_at_human),9,Hr)]),a("p",Sr,n(l.description),1)])])]);var r}),128))])):(t(),e("div",Ir,[y(i(ae),{class:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),a("h3",Dr,n(i(f)("leads.show.no_activity")),1),a("p",Or,n(i(f)("leads.show.no_activity_desc")),1)]))])):d("",!0),"info"===Pe.value?(t(),e("div",Pr,[a("div",Yr,[a("div",Zr,[a("h3",Er,[y(i(q),{class:c(["w-5 h-5",A.value.text])},null,8,["class"]),p(" "+n(i(f)("leads.show.personal_info")),1)]),a("div",Fr,[a("div",null,[a("label",Nr,n(i(f)("leads.show.full_name"))+" *",1),x(a("input",{"onUpdate:modelValue":r[12]||(r[12]=e=>be.value.name=e),type:"text",class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[b,be.value.name]])]),a("div",null,[a("label",Rr,n(i(f)("leads.show.phone_number")),1),x(a("input",{"onUpdate:modelValue":r[13]||(r[13]=e=>be.value.phone=e),type:"text",placeholder:"+998 XX XXX XX XX",class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[b,be.value.phone]])]),a("div",null,[a("label",Wr,[a("span",null,n(i(f)("leads.show.additional_phone")),1),me.value?d("",!0):(t(),e("button",{key:0,onClick:r[14]||(r[14]=e=>me.value=!0),type:"button",class:c(["text-xs font-medium",A.value.text])}," + "+n(i(f)("common.add")),3))]),me.value?(t(),e("div",Qr,[x(a("input",{"onUpdate:modelValue":r[15]||(r[15]=e=>be.value.phone2=e),type:"text",placeholder:"+998 XX XXX XX XX",class:c(["flex-1 px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[b,be.value.phone2]]),a("button",{onClick:r[16]||(r[16]=e=>{me.value=!1,be.value.phone2=""}),type:"button",class:"px-3 py-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"},[y(i(D),{class:"w-5 h-5"})])])):(t(),e("p",Gr,n(i(f)("common.none")),1))]),a("div",null,[r[41]||(r[41]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Email",-1)),x(a("input",{"onUpdate:modelValue":r[17]||(r[17]=e=>be.value.email=e),type:"email",placeholder:"email@example.com",class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[b,be.value.email]])]),a("div",null,[a("label",Jr,n(i(f)("leads.show.company")),1),x(a("input",{"onUpdate:modelValue":r[18]||(r[18]=e=>be.value.company=e),type:"text",placeholder:i(f)("leads.show.company_placeholder"),class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},null,10,Kr),[[b,be.value.company]])]),a("div",null,[a("label",es,n(i(f)("leads.show.birth_date")),1),x(a("input",{"onUpdate:modelValue":r[19]||(r[19]=e=>be.value.birth_date=e),type:"date",class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[b,be.value.birth_date]])]),a("div",null,[a("label",as,n(i(f)("leads.show.gender")),1),x(a("select",{"onUpdate:modelValue":r[20]||(r[20]=e=>be.value.gender=e),class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},[a("option",ts,n(i(f)("common.select")),1),a("option",ls,n(i(f)("leads.show.gender_male")),1),a("option",rs,n(i(f)("leads.show.gender_female")),1)],2),[[j,be.value.gender]])])])]),a("div",ss,[a("h3",os,[y(i(de),{class:c(["w-5 h-5",A.value.text])},null,8,["class"]),p(" "+n(i(f)("leads.show.address_info")),1)]),a("div",ds,[a("div",null,[a("label",ns,n(i(f)("leads.show.region")),1),x(a("select",{"onUpdate:modelValue":r[21]||(r[21]=e=>be.value.region=e),onChange:ve,class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},[a("option",is,n(i(f)("common.select")),1),(t(!0),e(u,null,g(s.regions,(a,l)=>(t(),e("option",{key:l,value:l},n(a),9,cs))),128))],34),[[j,be.value.region]])]),a("div",null,[a("label",us,n(i(f)("leads.show.district")),1),be.value.region&&Object.keys(ye.value).length>0?x((t(),e("select",{key:0,"onUpdate:modelValue":r[22]||(r[22]=e=>be.value.district=e),class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},[a("option",gs,n(i(f)("common.select")),1),(t(!0),e(u,null,g(ye.value,(a,l)=>(t(),e("option",{key:l,value:l},n(a),9,xs))),128))],2)),[[j,be.value.district]]):x((t(),e("input",{key:1,"onUpdate:modelValue":r[23]||(r[23]=e=>be.value.district=e),type:"text",placeholder:i(f)("leads.show.select_region_first"),disabled:!be.value.region,class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed",A.value.ring,"focus:ring-2 focus:border-transparent"])},null,10,bs)),[[b,be.value.district]])]),a("div",ps,[a("label",ms,n(i(f)("leads.show.full_address")),1),x(a("input",{"onUpdate:modelValue":r[24]||(r[24]=e=>be.value.address=e),type:"text",placeholder:i(f)("leads.show.address_placeholder"),class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},null,10,ys),[[b,be.value.address]])])])]),a("div",vs,[a("h3",hs,[y(i(ee),{class:c(["w-5 h-5",A.value.text])},null,8,["class"]),p(" "+n(i(f)("leads.show.additional_info")),1)]),a("div",ks,[a("div",null,[a("label",fs,n(i(f)("leads.show.lead_source")),1),x(a("select",{"onUpdate:modelValue":r[25]||(r[25]=e=>be.value.source_id=e),class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",A.value.ring,"focus:ring-2 focus:border-transparent"])},[a("option",ws,n(i(f)("common.select")),1),(t(!0),e(u,null,g(s.sources,a=>(t(),e("option",{key:a.id,value:a.id},n(a.name),9,_s))),128))],2),[[j,be.value.source_id]])]),a("div",null,[a("label",Cs,n(i(f)("leads.show.notes")),1),x(a("textarea",{"onUpdate:modelValue":r[26]||(r[26]=e=>be.value.notes=e),rows:"4",placeholder:i(f)("leads.show.notes_placeholder"),class:c(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white resize-none",A.value.ring,"focus:ring-2 focus:border-transparent"])},null,10,js),[[b,be.value.notes]])])])]),a("div",zs,[a("button",{onClick:We,disabled:pe.value,class:c(["px-6 py-3 text-white font-medium rounded-xl transition-colors flex items-center gap-2 shadow-lg",A.value.bg,A.value.bgDisabled,"disabled:cursor-not-allowed"])},[pe.value?(t(),e("span",Vs)):(t(),o(i(Z),{key:1,class:"w-5 h-5"})),p(" "+n(pe.value?i(f)("common.saving"):i(f)("common.save")),1)],10,Ms)])])])):d("",!0),"calls"===Pe.value?(t(),e("div",Bs,[a("div",$s,[a("div",Ts,[a("div",Ls,[a("div",As,[r[42]||(r[42]=a("div",{class:"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-md shadow-blue-500/25"},[a("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1)),a("div",null,[a("p",Us,n(Ce.value.total_calls),1),a("p",qs,n(i(f)("leads.show.total")),1)])]),r[48]||(r[48]=a("div",{class:"w-px h-8 bg-gray-200 dark:bg-gray-700"},null,-1)),a("div",Xs,[r[44]||(r[44]=a("div",{class:"w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center shadow-md shadow-emerald-500/25"},[a("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),a("div",null,[a("p",Hs,[p(n(Ce.value.answer_rate),1),r[43]||(r[43]=a("span",{class:"text-sm text-gray-400"},"%",-1))]),a("p",Ss,n(i(f)("leads.show.answered")),1)])]),r[49]||(r[49]=a("div",{class:"w-px h-8 bg-gray-200 dark:bg-gray-700"},null,-1)),a("div",Is,[r[45]||(r[45]=a("div",{class:"w-10 h-10 rounded-xl bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center shadow-md shadow-violet-500/25"},[a("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),a("div",null,[a("p",Ds,n(Ce.value.total_duration_formatted||"0:00"),1),a("p",Os,n(i(f)("leads.show.duration")),1)])]),r[50]||(r[50]=a("div",{class:"w-px h-8 bg-gray-200 dark:bg-gray-700"},null,-1)),a("div",Ps,[a("div",Ys,[r[46]||(r[46]=a("svg",{class:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})],-1)),a("span",Zs,n(Ce.value.inbound_calls||0),1)]),a("div",Es,[r[47]||(r[47]=a("svg",{class:"w-4 h-4 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 10l7-7m0 0l7 7m-7-7v18"})],-1)),a("span",Fs,n(Ce.value.outbound_calls||0),1)])])]),a("button",{onClick:ea,disabled:Ke.value,class:"flex items-center gap-2 px-4 py-2 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200 text-sm font-medium rounded-lg transition-all disabled:opacity-50"},[Ke.value?(t(),e("svg",Rs,[...r[51]||(r[51]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(t(),e("svg",Ws,[...r[52]||(r[52]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),p(" "+n(Ke.value?i(f)("leads.show.syncing"):i(f)("leads.show.sync")),1)],8,Ns)])]),je.value?(t(),e("div",Qs,[r[53]||(r[53]=a("div",{class:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"},null,-1)),a("p",Gs,n(i(f)("leads.show.loading_calls")),1)])):_e.value.length>0?(t(),e("div",Js,[(t(!0),e(u,null,g(_e.value,l=>(t(),e("div",{key:l.id,class:"group"},[a("div",Ks,[a("div",eo,[a("div",{class:c(["w-10 h-10 rounded-xl flex items-center justify-center shadow-md","inbound"===l.direction?"bg-gradient-to-br from-blue-500 to-indigo-600 shadow-blue-500/20":"bg-gradient-to-br from-orange-500 to-amber-600 shadow-orange-500/20"])},["inbound"===l.direction?(t(),e("svg",ao,[...r[54]||(r[54]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"},null,-1)])])):(t(),e("svg",to,[...r[55]||(r[55]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"},null,-1)])]))],2),a("div",{class:c(["absolute -bottom-0.5 -right-0.5 w-4 h-4 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center","completed"===l.status||"answered"===l.status?"bg-emerald-500":"missed"===l.status||"no_answer"===l.status||"failed"===l.status||"cancelled"===l.status?"bg-red-500":"busy"===l.status?"bg-amber-500":"ringing"===l.status||"initiated"===l.status?"bg-blue-500":"bg-gray-400"])},["completed"===l.status||"answered"===l.status?(t(),e("svg",lo,[...r[56]||(r[56]=[a("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):"missed"===l.status||"no_answer"===l.status||"failed"===l.status||"cancelled"===l.status?(t(),e("svg",ro,[...r[57]||(r[57]=[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)])])):d("",!0)],2)]),a("div",so,[a("div",oo,[a("span",{class:c(["inline-flex items-center text-xs font-semibold px-2 py-0.5 rounded","inbound"===l.direction?"bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300":"bg-orange-100 text-orange-700 dark:bg-orange-900/40 dark:text-orange-300"])},n("inbound"===l.direction?i(f)("leads.show.inbound"):i(f)("leads.show.outbound")),3),a("span",{class:c(["inline-flex items-center gap-1 text-xs font-medium px-2 py-0.5 rounded","completed"===l.status||"answered"===l.status?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300":"missed"===l.status||"no_answer"===l.status||"failed"===l.status||"cancelled"===l.status?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-300":"busy"===l.status?"bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-300":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300"])},["completed"===l.status||"answered"===l.status?(t(),e("svg",no,[...r[58]||(r[58]=[a("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):"missed"===l.status||"no_answer"===l.status||"failed"===l.status||"cancelled"===l.status?(t(),e("svg",io,[...r[59]||(r[59]=[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)])])):d("",!0),p(" "+n("completed"===l.status||"answered"===l.status?i(f)("leads.show.call_answered"):"missed"===l.status||"no_answer"===l.status||"failed"===l.status||"cancelled"===l.status?i(f)("leads.show.call_missed"):"busy"===l.status?i(f)("leads.show.call_busy"):"ringing"===l.status?i(f)("leads.show.call_ringing"):l.status),1)],2),a("button",{onClick:e=>(async(e,a)=>{if($e.value!==e.id){$e.value=e.id;try{const t=await V.patch(`/business/api/sales/calls/${e.id}/status`,{status:a});if(t.data.success){const a=_e.value.findIndex(a=>a.id===e.id);-1!==a&&(_e.value[a]={..._e.value[a],status:t.data.call.status,full_label:t.data.call.full_label,duration:t.data.call.duration,duration_formatted:t.data.call.duration_formatted}),He("success",t.data.message),Je()}}catch(t){He("error",t.response?.data?.error||"Statusni yangilashda xatolik")}finally{$e.value=null}}})(l,"completed"===l.status||"answered"===l.status?"missed":"completed"),disabled:$e.value===l.id,class:c(["p-1 rounded transition-all","completed"===l.status||"answered"===l.status?"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20":"text-gray-400 hover:text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/20"]),title:"completed"===l.status||"answered"===l.status?i(f)("leads.show.mark_missed"):i(f)("leads.show.mark_answered")},[$e.value===l.id?(t(),e("svg",uo,[...r[60]||(r[60]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(t(),e("svg",go,[...r[61]||(r[61]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"},null,-1)])]))],10,co),r[62]||(r[62]=a("span",{class:"text-gray-300 dark:text-gray-600"},"",-1)),a("span",xo,n(l.created_at),1),l.operator_name?(t(),e("span",bo,"  "+n(l.operator_name),1)):d("",!0)])]),a("div",po,[l.duration>0?(t(),e("div",mo,[r[63]||(r[63]=a("svg",{class:"w-3.5 h-3.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),a("span",yo,n(l.duration_formatted),1)])):d("",!0),"completed"===l.status||"answered"===l.status||l.recording_url?(t(),e("button",{key:1,onClick:e=>(async e=>{if(ze.value===e.id)return Ve.value&&(Ve.value.pause(),Ve.value=null),void(ze.value=null);if(e.recording_url)Be(e,e.recording_url);else{Me.value=e.id;try{const a="saleshead"===T.panelType?"/sales-head":"/business/api/sales",t=await V.get(`${a}/calls/${e.id}/recording`);if(t.data.success&&t.data.recording_url){const a=_e.value.findIndex(a=>a.id===e.id);-1!==a&&(_e.value[a].recording_url=t.data.recording_url),Be(e,t.data.recording_url)}else He("error",t.data.error||"Yozuv topilmadi")}catch(a){He("error","Yozuvni yuklashda xatolik")}finally{Me.value=null}}})(l),disabled:Me.value===l.id,class:c(["flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all",ze.value===l.id?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-md shadow-blue-500/25":Me.value===l.id?"bg-gray-100 text-gray-400 dark:bg-gray-700 dark:text-gray-500 cursor-wait":"bg-blue-50 text-blue-600 hover:bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50"])},[Me.value===l.id?(t(),e("svg",ho,[...r[64]||(r[64]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):ze.value===l.id?(t(),e("svg",ko,[...r[65]||(r[65]=[a("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)])])):(t(),e("svg",fo,[...r[66]||(r[66]=[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1)])])),p(" "+n(Me.value===l.id?i(f)("common.loading"):ze.value===l.id?i(f)("common.stop"):i(f)("leads.show.recording")),1)],10,vo)):d("",!0),a("button",{onClick:r[27]||(r[27]=e=>E.value=!0),class:"p-2 text-gray-400 hover:text-green-600 dark:hover:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition-all opacity-0 group-hover:opacity-100",title:i(f)("leads.show.callback")},[...r[67]||(r[67]=[a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)])],8,wo)])])]))),128))])):(t(),e("div",_o,[r[71]||(r[71]=a("div",{class:"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-2xl flex items-center justify-center mx-auto mb-4"},[a("svg",{class:"w-8 h-8 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1)),a("h3",Co,n(i(f)("leads.show.no_calls")),1),a("p",jo,n(i(f)("leads.show.no_calls_desc")),1),a("div",zo,[a("button",{onClick:ea,disabled:Ke.value,class:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200 text-sm font-medium rounded-lg transition-all disabled:opacity-50"},[Ke.value?(t(),e("svg",Vo,[...r[68]||(r[68]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(t(),e("svg",Bo,[...r[69]||(r[69]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),p(" "+n(i(f)("leads.show.sync")),1)],8,Mo),a("button",{onClick:r[28]||(r[28]=e=>E.value=!0),class:c(["flex items-center gap-2 px-4 py-2 text-white text-sm font-medium rounded-lg transition-all shadow-md",A.value.bg])},[r[70]||(r[70]=a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),p(" "+n(i(f)("leads.show.make_call")),1)],2)])]))])):d("",!0),"tasks"===Pe.value?(t(),e("div",$o,[we.value?(t(),e("div",To,[a("div",{class:c(["w-8 h-8 border-4 border-t-transparent rounded-full animate-spin mx-auto",A.value.spinner])},null,2),a("p",Lo,n(i(f)("common.loading")),1)])):(t(),e("div",Ao,[a("div",Uo,[a("div",qo,[a("div",Xo,[a("div",Ho,[r[72]||(r[72]=a("div",{class:"w-3 h-3 rounded-full bg-red-500"},null,-1)),a("span",So,n(i(f)("leads.show.tasks_overdue")),1)]),a("span",Io,n(fe.value.overdue?.length||0),1)])]),a("div",Do,[(t(!0),e(u,null,g(fe.value.overdue,l=>(t(),e("div",{key:l.id,class:"bg-white dark:bg-gray-800 rounded-lg border border-red-200 dark:border-red-700/50 p-3 shadow-sm hover:shadow-md transition-shadow"},[a("div",Oo,[a("span",Po,n(l.due_date_human),1),a("span",{class:c(["text-xs px-2 py-0.5 rounded font-medium","call"===l.type?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":"meeting"===l.type?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"])},n(l.type_label),3)]),a("h4",Yo,n(l.title),1),a("p",Zo,n(l.due_date_full?.split(" ")[0]),1),a("div",Eo,[a("button",{onClick:e=>sa(l),class:"text-xs text-green-600 hover:text-green-700 font-medium"},n(i(f)("leads.show.task_done")),9,Fo),a("div",No,[a("button",{onClick:e=>ta(l),class:"p-1 text-gray-400 hover:text-blue-600"},[y(i(ne),{class:"w-4 h-4"})],8,Ro),a("button",{onClick:e=>oa(l),class:"p-1 text-gray-400 hover:text-red-600"},[y(i(X),{class:"w-4 h-4"})],8,Wo)])])]))),128)),fe.value.overdue?.length?d("",!0):(t(),e("div",Qo,[y(i(Z),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),a("p",Go,n(i(f)("common.none")),1)]))])]),a("div",Jo,[a("div",Ko,[a("div",ed,[a("div",ad,[r[73]||(r[73]=a("div",{class:"w-3 h-3 rounded-full bg-blue-500"},null,-1)),a("span",td,n(i(f)("leads.show.tasks_today")),1)]),a("span",ld,n(fe.value.today?.length||0),1)])]),a("div",rd,[(t(!0),e(u,null,g(fe.value.today,l=>(t(),e("div",{key:l.id,class:"bg-white dark:bg-gray-800 rounded-lg border border-blue-200 dark:border-blue-700/50 p-3 shadow-sm hover:shadow-md transition-shadow"},[a("div",sd,[a("span",od,n(l.due_date_human),1),a("span",{class:c(["text-xs px-2 py-0.5 rounded font-medium","call"===l.type?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":"meeting"===l.type?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"])},n(l.type_label),3)]),a("h4",dd,n(l.title),1),"urgent"===l.priority||"high"===l.priority?(t(),e("div",nd,[a("span",{class:c(["text-xs px-2 py-0.5 rounded font-bold","urgent"===l.priority?"bg-red-100 text-red-700 animate-pulse":"bg-orange-100 text-orange-700"])},n(l.priority_label),3)])):d("",!0),a("div",id,[a("button",{onClick:e=>sa(l),class:"text-xs text-green-600 hover:text-green-700 font-medium"},n(i(f)("leads.show.task_done")),9,cd),a("div",ud,[a("button",{onClick:e=>ta(l),class:"p-1 text-gray-400 hover:text-blue-600"},[y(i(ne),{class:"w-4 h-4"})],8,gd),a("button",{onClick:e=>oa(l),class:"p-1 text-gray-400 hover:text-red-600"},[y(i(X),{class:"w-4 h-4"})],8,xd)])])]))),128)),fe.value.today?.length?d("",!0):(t(),e("div",bd,[y(i(K),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),a("p",pd,n(i(f)("common.none")),1)]))]),a("div",md,[a("button",{onClick:r[29]||(r[29]=e=>ta()),class:"w-full py-2 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg transition-colors flex items-center justify-center gap-1"},[y(i(ie),{class:"w-4 h-4"}),p(" "+n(i(f)("leads.show.add_task_btn")),1)])])]),a("div",yd,[a("div",vd,[a("div",hd,[a("div",kd,[r[74]||(r[74]=a("div",{class:"w-3 h-3 rounded-full bg-indigo-500"},null,-1)),a("span",fd,n(i(f)("leads.show.tasks_tomorrow")),1)]),a("span",wd,n(fe.value.tomorrow?.length||0),1)])]),a("div",_d,[(t(!0),e(u,null,g(fe.value.tomorrow,l=>(t(),e("div",{key:l.id,class:"bg-white dark:bg-gray-800 rounded-lg border border-indigo-200 dark:border-indigo-700/50 p-3 shadow-sm hover:shadow-md transition-shadow"},[a("div",Cd,[a("span",jd,n(l.due_date_human),1),a("span",{class:c(["text-xs px-2 py-0.5 rounded font-medium","call"===l.type?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":"meeting"===l.type?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"])},n(l.type_label),3)]),a("h4",zd,n(l.title),1),"urgent"===l.priority||"high"===l.priority?(t(),e("div",Md,[a("span",{class:c(["text-xs px-2 py-0.5 rounded font-bold","urgent"===l.priority?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"])},n(l.priority_label),3)])):d("",!0),a("div",Vd,[a("button",{onClick:e=>sa(l),class:"text-xs text-green-600 hover:text-green-700 font-medium"},n(i(f)("leads.show.task_done")),9,Bd),a("div",$d,[a("button",{onClick:e=>ta(l),class:"p-1 text-gray-400 hover:text-blue-600"},[y(i(ne),{class:"w-4 h-4"})],8,Td),a("button",{onClick:e=>oa(l),class:"p-1 text-gray-400 hover:text-red-600"},[y(i(X),{class:"w-4 h-4"})],8,Ld)])])]))),128)),fe.value.tomorrow?.length?d("",!0):(t(),e("div",Ad,[y(i(K),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),a("p",Ud,n(i(f)("common.none")),1)]))])]),a("div",qd,[a("div",Xd,[a("div",Hd,[a("div",Sd,[r[75]||(r[75]=a("div",{class:"w-3 h-3 rounded-full bg-purple-500"},null,-1)),a("span",Id,n(i(f)("leads.show.tasks_this_week")),1)]),a("span",Dd,n(fe.value.this_week?.length||0),1)])]),a("div",Od,[(t(!0),e(u,null,g(fe.value.this_week,l=>(t(),e("div",{key:l.id,class:"bg-white dark:bg-gray-800 rounded-lg border border-purple-200 dark:border-purple-700/50 p-3 shadow-sm hover:shadow-md transition-shadow"},[a("div",Pd,[a("span",Yd,n(l.due_date_human),1),a("span",{class:c(["text-xs px-2 py-0.5 rounded font-medium","call"===l.type?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":"meeting"===l.type?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"])},n(l.type_label),3)]),a("h4",Zd,n(l.title),1),a("p",Ed,n(l.due_date_full?.split(" ")[0]),1),a("div",Fd,[a("button",{onClick:e=>sa(l),class:"text-xs text-green-600 hover:text-green-700 font-medium"},n(i(f)("leads.show.task_done")),9,Nd),a("div",Rd,[a("button",{onClick:e=>ta(l),class:"p-1 text-gray-400 hover:text-blue-600"},[y(i(ne),{class:"w-4 h-4"})],8,Wd),a("button",{onClick:e=>oa(l),class:"p-1 text-gray-400 hover:text-red-600"},[y(i(X),{class:"w-4 h-4"})],8,Qd)])])]))),128)),fe.value.this_week?.length?d("",!0):(t(),e("div",Gd,[y(i(K),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),a("p",Jd,n(i(f)("common.none")),1)]))])])]))])):d("",!0)])])])])]),(t(),o(m,{to:"body"},[y(k,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[Oe.value?(t(),e("div",Kd,[a("div",{class:"fixed inset-0 bg-black/50",onClick:r[30]||(r[30]=e=>Oe.value=!1)}),y(k,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:v(()=>[Oe.value?(t(),e("div",en,[a("div",an,[a("div",tn,[y(i(X),{class:"w-8 h-8 text-red-600 dark:text-red-400"})]),a("h3",ln,n(i(f)("leads.show.delete_lead")),1),a("p",rn,n(i(f)("leads.show.delete_confirm",{name:s.lead.name})),1),a("div",sn,[a("button",{onClick:r[31]||(r[31]=e=>Oe.value=!1),class:"flex-1 px-4 py-2.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-medium rounded-xl transition-colors"},n(i(f)("common.cancel")),1),a("button",{onClick:na,class:"flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white font-medium rounded-xl transition-colors"},n(i(f)("common.delete")),1)])])])):d("",!0)]),_:1})])):d("",!0)]),_:1})])),y(Ge,{show:U.value,lead:s.lead,onClose:r[32]||(r[32]=e=>U.value=!1),onSent:r[33]||(r[33]=()=>{Ie()})},null,8,["show","lead"]),y(Pa,{show:N.value,lead:s.lead,onClose:r[34]||(r[34]=e=>N.value=!1),onCreated:r[35]||(r[35]=()=>{Ie()})},null,8,["show","lead"]),y(et,{show:E.value,lead:s.lead,onClose:xa},null,8,["show","lead"]),y(R,{show:he.value,lead:s.lead,task:ke.value,onClose:la,onSaved:ra},null,8,["show","lead","task"]),"business"===s.panelType?(t(),o(qt,{key:0,show:ue.value,lead:xe.value||s.lead,onClose:r[36]||(r[36]=e=>ue.value=!1),onAssigned:ua},null,8,["show","lead"])):d("",!0)]);var w}}},[["__scopeId","data-v-2360f64f"]]);export{on as L};
