import{r as e,w as t,C as s,L as l,A as o,x as a,y as r,I as n,z as i,F as u,G as d,D as c,J as m,K as b,H as p,B as g,v as y,N as x,P as k}from"./chunk-CpmtkKLp.js";import{u as h,h as v,l as f,r as w}from"./chunk-BhZp3z4u.js";import{_}from"./chunk-DbFbpSR2.js";import{u as j}from"./app-C-ZlocOh.js";import"./chunk-D7SyfRoT.js";import"./chunk-CouA7u-j.js";import"./chunk-DmrwHl-6.js";import"./chunk-De_qwhex.js";import"./chunk-eMHYSAeQ.js";import"./chunk-beXL1A--.js";import"./chunk-CAoK8Mdm.js";import"./chunk-BiBvtcLb.js";import"./chunk-DNKDGYPp.js";import"./chunk-BiW1c8q7.js";import"./chunk-CTIk0k8a.js";import"./chunk-dqIIyBTR.js";import"./chunk-CvscUVdi.js";import"./chunk-BvbZUszZ.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-DCXiFUg-.js";import"./chunk-Bsc1JRL5.js";import"./chunk-BuJDoypK.js";import"./chunk-BWiubfpN.js";const q={class:"py-12"},C={class:"max-w-8xl mx-auto sm:px-6 lg:px-8"},z={class:"mb-8 flex items-center justify-between"},V={class:"text-3xl font-bold text-gray-900"},M={class:"mt-2 text-gray-600"},S={class:"bg-white rounded-lg shadow-sm p-6 mb-6"},U={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},B={class:"block text-sm font-medium text-gray-700 mb-1"},K={class:"block text-sm font-medium text-gray-700 mb-1"},H={value:"all"},L=["value"],P={class:"bg-white rounded-lg shadow-sm overflow-hidden"},A={class:"divide-y divide-gray-200"},D={class:"flex items-start justify-between"},O={class:"flex-1"},Y={class:"flex items-center gap-3 mb-2"},F={class:"text-lg font-semibold text-gray-900"},J={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},G={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},I={class:"text-gray-600 mb-3"},N={key:0,class:"flex flex-wrap gap-2 mb-2"},Z={class:"flex items-center gap-4 text-sm text-gray-500"},$={class:"flex gap-2 ml-4"},E=["onClick"],Q=["onClick"],R={key:0,class:"p-12 text-center text-gray-500"},T={class:"mt-4"},W={key:0,class:"bg-white px-6 py-4 border-t border-gray-200"},X={class:"flex items-center justify-between"},ee={class:"text-sm text-gray-700"},te={class:"font-medium"},se={class:"font-medium"},le={class:"font-medium"},oe={class:"flex gap-2"},ae={class:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6"},re={class:"flex items-center justify-between mb-6"},ne={class:"text-2xl font-bold text-gray-900"},ie={key:0,class:"mt-1 text-sm text-red-600"},ue={key:0,class:"mt-1 text-sm text-red-600"},de={id:"category-suggestions"},ce=["value"],me={class:"flex flex-wrap gap-2 mb-2"},be=["onClick"],pe={for:"priority",class:"block text-sm font-medium text-gray-700 mb-1"},ge={class:"flex items-center"},ye={class:"flex justify-end gap-3 pt-4 border-t"},xe=["disabled"],ke={key:0},he={key:1},ve={__name:"KnowledgeBase",props:{knowledge_base:Object,categories:Array,filters:Object},setup(ve){const{t:fe}=j(),we=ve,_e=e({search:we.filters.search||"",category:we.filters.category||"all"}),je=e(!1),qe=e(null),Ce=h({question:"",answer:"",category:"",keywords:[],priority:50,is_active:!0}),ze=()=>{w.get(route("business.customer-bot.knowledge-base"),_e.value,{preserveState:!0,preserveScroll:!0})};t(()=>_e.value.search,e=>{(0===e.length||e.length>=3)&&ze()});const Ve=(e=null)=>{e?(qe.value=e,Ce.question=e.question,Ce.answer=e.answer,Ce.category=e.category||"",Ce.keywords=e.keywords||[],Ce.priority=e.priority||50,Ce.is_active=e.is_active):(qe.value=null,Ce.reset()),je.value=!0},Me=()=>{je.value=!1,qe.value=null,Ce.reset()},Se=()=>{qe.value?Ce.put(route("business.customer-bot.knowledge-base.update",qe.value.id),{onSuccess:()=>Me()}):Ce.post(route("business.customer-bot.knowledge-base.store"),{onSuccess:()=>Me()})},Ue=()=>{const e=prompt("Kalit so'z kiriting:");e&&!Ce.keywords.includes(e)&&Ce.keywords.push(e)};return(e,t)=>(c(),s(m,null,[l(o(v),{title:o(fe)("chatbot.knowledge_base")},null,8,["title"]),l(_,{title:o(fe)("chatbot.knowledge_base")},{default:a(()=>[r("div",q,[r("div",C,[r("div",z,[r("div",null,[r("h1",V,i(o(fe)("chatbot.knowledge_base")),1),r("p",M,i(o(fe)("chatbot.knowledge_base_desc")),1)]),r("button",{onClick:t[0]||(t[0]=e=>Ve()),class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," + "+i(o(fe)("chatbot.new_qa")),1)]),r("div",S,[r("div",U,[r("div",null,[r("label",B,i(o(fe)("common.search")),1),u(r("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>_e.value.search=e),placeholder:"Savol, javob yoki kategoriya...",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[d,_e.value.search]])]),r("div",null,[r("label",K,i(o(fe)("common.category")),1),u(r("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>_e.value.category=e),onChange:ze,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[r("option",H,i(o(fe)("common.all")),1),(c(!0),s(m,null,b(ve.categories,e=>(c(),s("option",{key:e,value:e},i(e),9,L))),128))],544),[[p,_e.value.category]])])])]),r("div",P,[r("ul",A,[(c(!0),s(m,null,b(ve.knowledge_base.data,e=>(c(),s("li",{key:e.id,class:"p-6 hover:bg-gray-50 transition-colors"},[r("div",D,[r("div",O,[r("div",Y,[r("h3",F,i(e.question),1),e.category?(c(),s("span",J,i(e.category),1)):n("",!0),e.is_active?n("",!0):(c(),s("span",G," O'chirilgan "))]),r("p",I,i(e.answer),1),e.keywords&&e.keywords.length>0?(c(),s("div",N,[(c(!0),s(m,null,b(e.keywords,(e,t)=>(c(),s("span",{key:t,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-gray-100 text-gray-700"},i(e),1))),128))])):n("",!0),r("div",Z,[r("span",null,"Prioritet: "+i(e.priority),1),r("span",null,i(new Date(e.created_at).toLocaleDateString("uz-UZ")),1)])]),r("div",$,[r("button",{onClick:t=>Ve(e),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-md"},[...t[8]||(t[8]=[r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,E),r("button",{onClick:t=>{return s=e,void(confirm(fe("common.confirm_delete"))&&w.delete(route("business.customer-bot.knowledge-base.destroy",s.id)));var s},class:"p-2 text-red-600 hover:bg-red-50 rounded-md"},[...t[9]||(t[9]=[r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Q)])])]))),128)),0===ve.knowledge_base.data.length?(c(),s("li",R,[t[10]||(t[10]=r("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),r("p",T,i(o(fe)("reports.no_data")),1)])):n("",!0)]),ve.knowledge_base.data.length>0?(c(),s("div",W,[r("div",X,[r("div",ee,[r("span",te,i(ve.knowledge_base.from),1),t[11]||(t[11]=g(" - ",-1)),r("span",se,i(ve.knowledge_base.to),1),t[12]||(t[12]=g(" dan ",-1)),r("span",le,i(ve.knowledge_base.total),1),t[13]||(t[13]=g(" ta ",-1))]),r("div",oe,[ve.knowledge_base.prev_page_url?(c(),y(o(f),{key:0,href:ve.knowledge_base.prev_page_url,class:"px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50","preserve-state":""},{default:a(()=>[g(i(o(fe)("common.previous")),1)]),_:1},8,["href"])):n("",!0),ve.knowledge_base.next_page_url?(c(),y(o(f),{key:1,href:ve.knowledge_base.next_page_url,class:"px-3 py-2 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50","preserve-state":""},{default:a(()=>[g(i(o(fe)("common.next")),1)]),_:1},8,["href"])):n("",!0)])])])):n("",!0)])])]),je.value?(c(),s("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:x(Me,["self"])},[r("div",ae,[r("div",re,[r("h2",ne,i(qe.value?o(fe)("common.edit"):o(fe)("chatbot.new_qa")),1),r("button",{onClick:Me,class:"p-2 hover:bg-gray-100 rounded-md"},[...t[14]||(t[14]=[r("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),r("form",{onSubmit:x(Se,["prevent"]),class:"space-y-4"},[r("div",null,[t[15]||(t[15]=r("label",{for:"question",class:"block text-sm font-medium text-gray-700 mb-1"},"Savol *",-1)),u(r("input",{type:"text",id:"question","onUpdate:modelValue":t[3]||(t[3]=e=>o(Ce).question=e),required:"",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Masalan: Yetkazib berish narxi qancha?"},null,512),[[d,o(Ce).question]]),o(Ce).errors.question?(c(),s("p",ie,i(o(Ce).errors.question),1)):n("",!0)]),r("div",null,[t[16]||(t[16]=r("label",{for:"answer",class:"block text-sm font-medium text-gray-700 mb-1"},"Javob *",-1)),u(r("textarea",{id:"answer","onUpdate:modelValue":t[4]||(t[4]=e=>o(Ce).answer=e),required:"",rows:"4",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Bu savolga javob..."},null,512),[[d,o(Ce).answer]]),o(Ce).errors.answer?(c(),s("p",ue,i(o(Ce).errors.answer),1)):n("",!0)]),r("div",null,[t[17]||(t[17]=r("label",{for:"category",class:"block text-sm font-medium text-gray-700 mb-1"},"Kategoriya",-1)),u(r("input",{type:"text",id:"category","onUpdate:modelValue":t[5]||(t[5]=e=>o(Ce).category=e),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Masalan: Yetkazib berish",list:"category-suggestions"},null,512),[[d,o(Ce).category]]),r("datalist",de,[(c(!0),s(m,null,b(ve.categories,e=>(c(),s("option",{key:e,value:e},null,8,ce))),128))])]),r("div",null,[t[18]||(t[18]=r("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Kalit so'zlar",-1)),r("div",me,[(c(!0),s(m,null,b(o(Ce).keywords,(e,t)=>(c(),s("span",{key:t,class:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800"},[g(i(e)+" ",1),r("button",{type:"button",onClick:e=>(e=>{Ce.keywords.splice(e,1)})(t),class:"ml-2 hover:text-blue-600"}," Ã— ",8,be)]))),128))]),r("button",{type:"button",onClick:Ue,class:"text-sm text-blue-600 hover:text-blue-700"}," + Kalit so'z qo'shish ")]),r("div",null,[r("label",pe," Prioritet: "+i(o(Ce).priority),1),u(r("input",{type:"range",id:"priority","onUpdate:modelValue":t[6]||(t[6]=e=>o(Ce).priority=e),min:"0",max:"100",class:"w-full"},null,512),[[d,o(Ce).priority]]),t[19]||(t[19]=r("div",{class:"flex justify-between text-xs text-gray-500"},[r("span",null,"Past"),r("span",null,"Yuqori")],-1))]),r("div",ge,[u(r("input",{type:"checkbox",id:"is_active","onUpdate:modelValue":t[7]||(t[7]=e=>o(Ce).is_active=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[k,o(Ce).is_active]]),t[20]||(t[20]=r("label",{for:"is_active",class:"ml-2 block text-sm text-gray-900"}," Faol ",-1))]),r("div",ye,[r("button",{type:"button",onClick:Me,class:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"},i(o(fe)("common.cancel")),1),r("button",{type:"submit",disabled:o(Ce).processing,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},[o(Ce).processing?(c(),s("span",ke,i(o(fe)("common.saving")),1)):(c(),s("span",he,i(qe.value?o(fe)("common.update"):o(fe)("common.add")),1))],8,xe)])],32)])])):n("",!0)]),_:1},8,["title"])],64))}};export{ve as default};
