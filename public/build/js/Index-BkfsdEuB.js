import{D as e,z as a,E as r,r as t,b as s,v as l,x as o,y as i,A as d,C as n,B as c,F as g,G as u,H as y,S as b,M as x,L as m,Q as p,I as h,J as k,K as v}from"./chunk-7Urb0kxg.js";import{u as f,h as w,r as j}from"./chunk-DKkye6wf.js";import{_ as q}from"./chunk-k4W8urQJ.js";import{b as _,A as S,e as C}from"./chunk-Dm-LAqtr.js";import{r as z}from"./chunk-ujXbNZhL.js";import{r as B}from"./chunk-ab1b1Fp4.js";import{a as L,r as Q}from"./chunk-DUcDuGHI.js";import{r as V}from"./chunk-BugzYCIx.js";import{r as U}from"./chunk-iVGhU8RF.js";import{r as A}from"./chunk-Rl16a4N0.js";import{S as M,Y as H,h as O,G as T,V as F}from"./chunk-BWNgHGSI.js";import"./chunk-DmCyVuil.js";import"./chunk-Be6I8nOg.js";import"./chunk-DpGbuIFK.js";import"./chunk-78n7fhob.js";import"./chunk-C3XJH04c.js";import"./app-DFslr8vl.js";import"./chunk-Di7Oc7TS.js";import"./chunk-Dg8ilgYs.js";import"./chunk-C1ExV0Y3.js";import"./chunk-D2XW56yD.js";import"./chunk-DS-Zp4Qb.js";import"./chunk-Sfe4u6kO.js";import"./chunk-BAC6lhkp.js";import"./chunk-DhwSyUm1.js";import"./chunk-9PkX4iPz.js";import"./chunk-DOBCiesv.js";import"./chunk-YGW1Cp7-.js";import"./chunk-afst19KZ.js";import"./chunk-D4tA7yBb.js";function I(t,s){return r(),e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 15a4.5 4.5 0 0 0 4.5 4.5H18a3.75 3.75 0 0 0 1.332-7.257 3 3 0 0 0-3.758-3.848 5.25 5.25 0 0 0-10.233 2.33A4.502 4.502 0 0 0 2.25 15Z"})])}const Y={class:"py-6"},K={class:"w-full px-4 sm:px-6 lg:px-8 space-y-6"},D={class:"flex items-center justify-between"},E={class:"flex items-center space-x-3"},G=["disabled"],J={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},$={class:"flex items-center justify-between"},R={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Z={class:"text-xs text-gray-400 mt-1"},N={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},P={class:"lg:col-span-2 space-y-4"},W={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},X={key:0,class:"p-6 text-center text-gray-500 dark:text-gray-400"},ee={key:1,class:"divide-y divide-gray-200 dark:divide-gray-700"},ae={class:"flex items-start justify-between"},re={class:"flex-1"},te={class:"flex items-center space-x-3"},se={class:"font-medium text-gray-900 dark:text-white"},le={key:0,class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},oe={class:"mt-1 text-xs text-gray-400"},ie={class:"flex items-center space-x-2 ml-4"},de=["onClick"],ne=["onClick"],ce=["onClick"],ge={class:"space-y-4"},ue={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},ye={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},be={class:"flex items-center space-x-2"},xe={key:0,class:"p-6 text-center text-gray-500 dark:text-gray-400"},me={key:1,class:"divide-y divide-gray-200 dark:divide-gray-700"},pe={class:"flex items-center justify-between"},he={class:"font-medium text-gray-900 dark:text-white"},ke={class:"text-sm text-gray-500 dark:text-gray-400"},ve={class:"text-right"},fe={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"},we={class:"space-y-3"},je={class:"flex justify-between"},qe={class:"font-medium text-gray-900 dark:text-white"},_e={class:"flex justify-between"},Se={class:"font-medium text-gray-900 dark:text-white"},Ce={class:"flex justify-between"},ze={class:"font-medium text-gray-900 dark:text-white"},Be={class:"fixed inset-0 overflow-y-auto"},Le={class:"flex min-h-full items-center justify-center p-4"},Qe={class:"flex items-center justify-between mb-6"},Ve=["value"],Ue=["value"],Ae={class:"grid grid-cols-2 gap-4"},Me=["value"],He={class:"grid grid-cols-2 gap-4"},Oe={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"},Te=["disabled"],Fe={__name:"Index",props:{rules:Array,distribution:Object,hotLeads:Array,categories:Object,conditions:Object,scoringCategories:Object},setup(Fe){const Ie=Fe,Ye=t(!1),Ke=t(null),De=t(!1),Ee=f({name:"",description:"",field:"",condition:"not_null",value:"",value_type:"string",points:10,category:"completeness",priority:0}),Ge=[{value:"phone",label:"Telefon raqami"},{value:"email",label:"Email manzili"},{value:"company",label:"Kompaniya nomi"},{value:"region",label:"Viloyat"},{value:"estimated_value",label:"Taxminiy qiymat"},{value:"source.code",label:"Manba kodi"},{value:"activities_count",label:"Faoliyatlar soni"},{value:"days_without_contact",label:"Aloqasiz kunlar"},{value:"lost_reason",label:"Yo'qotilgan sabab"}],Je={hot:L,warm:S,cool:B,cold:I,frozen:B},$e=()=>{Ee.reset(),Ke.value=null,Ye.value=!0},Re=()=>{Ye.value=!1,Ke.value=null,Ee.reset()},Ze=()=>{Ke.value?Ee.put(route("sales-head.lead-scoring.update",Ke.value.id),{preserveScroll:!0,onSuccess:()=>Re()}):Ee.post(route("sales-head.lead-scoring.store"),{preserveScroll:!0,onSuccess:()=>Re()})},Ne=()=>{confirm("Barcha leadlarni qayta baholashni xohlaysizmi? Bu biroz vaqt olishi mumkin.")&&(De.value=!0,j.post(route("sales-head.lead-scoring.recalculate-all"),{},{preserveScroll:!0,onFinish:()=>{De.value=!1}}))},Pe=()=>{confirm("Barcha qoidalar o'chiriladi va standart qoidalar tiklanadi. Davom etasizmi?")&&j.post(route("sales-head.lead-scoring.reset"),{},{preserveScroll:!0})},We=s(()=>Ie.distribution?.total||0),Xe=e=>{const a={hot:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",warm:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",cool:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",cold:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",frozen:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"};return a[e]||a.frozen};return(t,s)=>(r(),l(q,{title:"Lead Scoring"},{default:o(()=>[i(d(w),{title:"Lead Scoring - Lidlar Ballari"}),a("div",Y,[a("div",K,[a("div",D,[s[10]||(s[10]=a("div",null,[a("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Lead Scoring"),a("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Lidlarni avtomatik baholash va kategoriyalash ")],-1)),a("div",E,[a("button",{onClick:Ne,disabled:De.value,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50"},[i(d(_),{class:c(["w-4 h-4 mr-2",{"animate-spin":De.value}])},null,8,["class"]),s[8]||(s[8]=n(" Qayta baholash ",-1))],8,G),a("button",{onClick:$e,class:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700"},[i(d(z),{class:"w-4 h-4 mr-2"}),s[9]||(s[9]=n(" Qoida qo'shish ",-1))])])]),a("div",J,[(r(!0),e(g,null,u(Fe.scoringCategories,(t,s)=>(r(),e("div",{key:s,class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},[a("div",$,[a("div",null,[a("p",R,y(t.name),1),a("p",{class:"text-2xl font-bold mt-1",style:b({color:t.color})},y(Fe.distribution?.categories?.[s]?.count||0),5),a("p",Z,y(t.min)+"-"+y(t.max)+" ball",1)]),a("div",{class:"w-12 h-12 rounded-full flex items-center justify-center",style:b({backgroundColor:t.color+"20"})},[(r(),l(x(Je[s]),{class:"w-6 h-6",style:b({color:t.color})},null,8,["style"]))],4)])]))),128))]),a("div",N,[a("div",P,[a("div",W,[a("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},[s[11]||(s[11]=a("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Scoring Qoidalari",-1)),a("button",{onClick:Pe,class:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}," Standartga tiklash ")]),0===Fe.rules.length?(r(),e("div",X,[i(d(V),{class:"w-12 h-12 mx-auto mb-3 text-gray-300 dark:text-gray-600"}),s[12]||(s[12]=a("p",null,"Hozircha qoidalar yo'q",-1)),a("button",{onClick:$e,class:"mt-2 text-indigo-600 hover:text-indigo-700"}," Birinchi qoida qo'shing ")])):(r(),e("div",ee,[(r(!0),e(g,null,u(Fe.rules,t=>{return r(),e("div",{key:t.id,class:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[a("div",ae,[a("div",re,[a("div",te,[a("h3",se,y(t.name),1),a("span",{class:c(["px-2 py-0.5 text-xs rounded-full",Xe(t.category)])},y(t.category_info?.name||t.category),3),a("span",{class:c(["px-2 py-0.5 text-xs font-bold rounded",(s=t.points,s>0?"text-green-600 dark:text-green-400":s<0?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400")])},y(t.points>0?"+":"")+y(t.points)+" ball ",3)]),t.description?(r(),e("p",le,y(t.description),1)):m("",!0),a("p",oe,y(t.field)+" "+y(t.condition_label)+" "+y(t.value||""),1)]),a("div",ie,[a("button",{onClick:e=>(e=>{j.post(route("sales-head.lead-scoring.toggle",e.id),{},{preserveScroll:!0})})(t),class:c(["p-1.5 rounded-lg transition-colors",t.is_active?"text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30":"text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"])},[i(d(Q),{class:"w-5 h-5"})],10,de),a("button",{onClick:e=>(e=>{Ke.value=e,Ee.name=e.name,Ee.description=e.description||"",Ee.field=e.field,Ee.condition=e.condition,Ee.value=e.value||"",Ee.value_type=e.value_type,Ee.points=e.points,Ee.category=e.category,Ee.priority=e.priority,Ye.value=!0})(t),class:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[i(d(U),{class:"w-5 h-5"})],8,ne),a("button",{onClick:e=>(e=>{confirm(`"${e.name}" qoidasini o'chirishni xohlaysizmi?`)&&j.delete(route("sales-head.lead-scoring.destroy",e.id),{preserveScroll:!0})})(t),class:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors"},[i(d(C),{class:"w-5 h-5"})],8,ce)])])]);var s}),128))]))])]),a("div",ge,[a("div",ue,[a("div",ye,[a("div",be,[i(d(L),{class:"w-5 h-5 text-red-500"}),s[13]||(s[13]=a("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Issiq Lidlar",-1))]),s[14]||(s[14]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Top 10 yuqori balli lidlar",-1))]),0===Fe.hotLeads.length?(r(),e("div",xe,[...s[15]||(s[15]=[a("p",null,"Hozircha issiq lidlar yo'q",-1)])])):(r(),e("div",me,[(r(!0),e(g,null,u(Fe.hotLeads,t=>(r(),e("div",{key:t.id,class:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[a("div",pe,[a("div",null,[a("p",he,y(t.name),1),a("p",ke,y(t.company||t.phone),1)]),a("div",ve,[a("div",{class:c(["inline-flex items-center px-2.5 py-1 rounded-full text-sm font-bold",Xe(t.score_category)])},y(t.score),3)])])]))),128))]))]),a("div",fe,[s[19]||(s[19]=a("h3",{class:"font-semibold text-gray-900 dark:text-white mb-4"},"Statistika",-1)),a("dl",we,[a("div",je,[s[16]||(s[16]=a("dt",{class:"text-gray-500 dark:text-gray-400"},"Jami lidlar",-1)),a("dd",qe,y(We.value),1)]),a("div",_e,[s[17]||(s[17]=a("dt",{class:"text-gray-500 dark:text-gray-400"},"O'rtacha ball",-1)),a("dd",Se,y(Fe.distribution?.average_score||0),1)]),a("div",Ce,[s[18]||(s[18]=a("dt",{class:"text-gray-500 dark:text-gray-400"},"Faol qoidalar",-1)),a("dd",ze,y(Fe.rules.filter(e=>e.is_active).length)+" / "+y(Fe.rules.length),1)])])])])]),i(d(M),{appear:"",show:Ye.value,as:"template"},{default:o(()=>[i(d(H),{as:"div",onClose:Re,class:"relative z-50"},{default:o(()=>[i(d(O),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:o(()=>[...s[20]||(s[20]=[a("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm"},null,-1)])]),_:1}),a("div",Be,[a("div",Le,[i(d(O),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:o(()=>[i(d(T),{class:"w-full max-w-lg transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 shadow-xl transition-all"},{default:o(()=>[a("div",Qe,[i(d(F),{class:"text-lg font-semibold text-gray-900 dark:text-white"},{default:o(()=>[n(y(Ke.value?"Qoidani tahrirlash":"Yangi qoida qo'shish"),1)]),_:1}),a("button",{onClick:Re,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[i(d(A),{class:"w-5 h-5"})])]),a("form",{onSubmit:p(Ze,["prevent"]),class:"space-y-4"},[a("div",null,[s[21]||(s[21]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Qoida nomi * ",-1)),h(a("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>d(Ee).name=e),type:"text",required:"",placeholder:"Masalan: Telefon raqami mavjud",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[k,d(Ee).name]])]),a("div",null,[s[22]||(s[22]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Kategoriya * ",-1)),h(a("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>d(Ee).category=e),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},[(r(!0),e(g,null,u(Fe.categories,(a,t)=>(r(),e("option",{key:t,value:t},y(a.name),9,Ve))),128))],512),[[v,d(Ee).category]])]),a("div",null,[s[24]||(s[24]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Maydon * ",-1)),h(a("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>d(Ee).field=e),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},[s[23]||(s[23]=a("option",{value:""},"Maydonni tanlang",-1)),(r(),e(g,null,u(Ge,e=>a("option",{key:e.value,value:e.value},y(e.label),9,Ue)),64))],512),[[v,d(Ee).field]])]),a("div",Ae,[a("div",null,[s[25]||(s[25]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Shart * ",-1)),h(a("select",{"onUpdate:modelValue":s[3]||(s[3]=e=>d(Ee).condition=e),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},[(r(!0),e(g,null,u(Fe.conditions,(a,t)=>(r(),e("option",{key:t,value:t},y(a),9,Me))),128))],512),[[v,d(Ee).condition]])]),a("div",null,[s[26]||(s[26]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Qiymat ",-1)),h(a("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>d(Ee).value=e),type:"text",placeholder:"Shart qiymati",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[k,d(Ee).value]])])]),a("div",He,[a("div",null,[s[27]||(s[27]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Ball * ",-1)),h(a("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>d(Ee).points=e),type:"number",required:"",min:"-50",max:"50",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[k,d(Ee).points,void 0,{number:!0}]]),s[28]||(s[28]=a("p",{class:"text-xs text-gray-500 mt-1"},"Ijobiy yoki salbiy (-50 dan +50 gacha)",-1))]),a("div",null,[s[30]||(s[30]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Qiymat turi ",-1)),h(a("select",{"onUpdate:modelValue":s[6]||(s[6]=e=>d(Ee).value_type=e),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},[...s[29]||(s[29]=[a("option",{value:"string"},"Matn",-1),a("option",{value:"number"},"Raqam",-1),a("option",{value:"boolean"},"Ha/Yo'q",-1)])],512),[[v,d(Ee).value_type]])])]),a("div",null,[s[31]||(s[31]=a("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Tavsif ",-1)),h(a("textarea",{"onUpdate:modelValue":s[7]||(s[7]=e=>d(Ee).description=e),rows:"2",placeholder:"Qoida haqida qisqacha ma'lumot",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[k,d(Ee).description]])]),a("div",Oe,[a("button",{type:"button",onClick:Re,class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," Bekor qilish "),a("button",{type:"submit",disabled:d(Ee).processing,class:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors"},y(Ke.value?"Saqlash":"Qo'shish"),9,Te)])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])])]),_:1}))}};export{Fe as default};
