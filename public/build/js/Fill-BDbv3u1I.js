import{r as e,b as a,o as r,v as t,x as l,L as s,y as u,A as n,C as o,I as i,D as d,z as v,B as p,Q as c,J as g,K as y,E as b,F as x,G as m}from"./chunk-CpmtkKLp.js";import{h as k,a as h}from"./chunk-BhZp3z4u.js";import{_ as f}from"./chunk-BDBDdGhv.js";import{a as w}from"./chunk-D7SyfRoT.js";import{r as j}from"./chunk-DvBKKKMs.js";import{r as _}from"./chunk-eMHYSAeQ.js";import{r as q}from"./chunk-BRViKyUS.js";import{r as A}from"./chunk-SzhoqsJO.js";import{r as C}from"./chunk-BeDuKP2K.js";import"./app-C-ZlocOh.js";import"./chunk-BWiubfpN.js";import"./chunk-CouA7u-j.js";import"./chunk-DmrwHl-6.js";import"./chunk-De_qwhex.js";import"./chunk-beXL1A--.js";import"./chunk-CAoK8Mdm.js";import"./chunk-BiBvtcLb.js";import"./chunk-DNKDGYPp.js";import"./chunk-BiW1c8q7.js";import"./chunk-CTIk0k8a.js";import"./chunk-dqIIyBTR.js";import"./chunk-CvscUVdi.js";import"./chunk-BvbZUszZ.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-DCXiFUg-.js";import"./chunk-Bsc1JRL5.js";import"./chunk-BuJDoypK.js";const B={class:"max-w-3xl mx-auto"},$={key:0,class:"flex items-center justify-center py-24"},z={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-8 text-center"},I={class:"text-red-600 dark:text-red-300"},S={key:2,class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-12 text-center"},J={class:"w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-6"},K={class:"text-gray-600 dark:text-gray-400 mb-8"},O={href:"/hr/surveys",class:"inline-flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},D={key:3,class:"space-y-6"},Y={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm"},E={class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},F={key:0,class:"text-gray-600 dark:text-gray-400 text-sm mb-4"},M={key:1,class:"flex items-center gap-2 text-sm text-purple-600 dark:text-purple-400"},G={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm"},H={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-2"},L={class:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Q={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"},R={class:"p-6"},U={class:"mb-6"},V={class:"flex items-start gap-4"},W={class:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center shrink-0"},X={class:"text-lg font-bold text-purple-600 dark:text-purple-400"},N={class:"text-lg font-medium text-gray-900 dark:text-white pt-2"},P={key:0,class:"mt-6"},T={class:"flex items-center justify-center gap-3"},Z=["onClick"],ee={key:1,class:"mt-6 space-y-3"},ae=["onClick"],re={key:2,class:"mt-6 space-y-3"},te=["onClick"],le={key:3,class:"mt-6 flex items-center justify-center gap-4"},se={key:4,class:"mt-6"},ue={key:5,class:"mt-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"},ne={class:"text-red-600 dark:text-red-400 text-sm"},oe={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700/50 flex items-center justify-between"},ie=["disabled"],de=["disabled"],ve=["disabled"],pe={__name:"Fill",props:{currentBusiness:Object,surveyId:String},setup(pe){const ce=pe,ge=e(!0),ye=e(!1),be=e(!1),xe=e(null),me=e({}),ke=e(0),he=e(""),fe=e(null),we=a(()=>xe.value?.questions?.[ke.value]||null),je=a(()=>xe.value?.questions?.length||0),_e=a(()=>0===je.value?0:Math.round((ke.value+1)/je.value*100)),qe=a({get:()=>me.value[`q_${ke.value}`],set(e){me.value[`q_${ke.value}`]=e}}),Ae=e=>null!==e&&""!==e&&void 0!==e&&(!Array.isArray(e)||0!==e.length),Ce=a(()=>{const e=xe.value?.settings?.allow_skip;return!!e||Ae(qe.value)}),Be=a(()=>{const e=xe.value?.settings?.allow_skip;return!!e||Object.values(me.value).every(Ae)}),$e=()=>{ke.value<je.value-1&&ke.value++},ze=()=>{ke.value>0&&ke.value--},Ie=e=>{qe.value=e},Se=async()=>{if(!ce.currentBusiness?.id||!ce.surveyId)return;ye.value=!0,he.value="";const e=Math.round((Date.now()-fe.value)/1e3);try{await h.post(`/api/v1/businesses/${ce.currentBusiness.id}/hr/surveys/${ce.surveyId}/respond`,{answers:me.value,time_spent_seconds:e}),be.value=!0}catch(a){he.value=a.response?.data?.message||"Javoblarni yuborishda xatolik"}finally{ye.value=!1}};return r(async()=>{if(!ce.currentBusiness?.id||!ce.surveyId)return he.value="Biznes yoki so'rovnoma tanlanmagan",void(ge.value=!1);ge.value=!0,he.value="";try{const e=await h.get(`/api/v1/businesses/${ce.currentBusiness.id}/hr/surveys/${ce.surveyId}`);xe.value=e.data.data,fe.value=Date.now(),xe.value?.questions&&xe.value.questions.forEach((e,a)=>{me.value[`q_${a}`]=null})}catch(e){he.value=e.response?.data?.message||"So'rovnomani yuklashda xatolik"}finally{ge.value=!1}}),(e,a)=>(d(),t(f,{title:xe.value?.title||"So'rovnoma"},{default:l(()=>[s(n(k),{title:xe.value?.title||"So'rovnoma to'ldirish"},null,8,["title"]),u("div",B,[ge.value?(d(),o("div",$,[s(n(w),{class:"w-10 h-10 animate-spin text-purple-600"})])):he.value&&!xe.value?(d(),o("div",z,[s(n(j),{class:"w-16 h-16 mx-auto text-red-400 mb-4"}),a[3]||(a[3]=u("h2",{class:"text-xl font-semibold text-red-800 dark:text-red-400 mb-2"},"Xatolik",-1)),u("p",I,v(he.value),1)])):be.value?(d(),o("div",S,[u("div",J,[s(n(_),{class:"w-12 h-12 text-green-600"})]),a[5]||(a[5]=u("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-4"}," Rahmat! ",-1)),u("p",K," Javoblaringiz muvaffaqiyatli qabul qilindi. "+v(xe.value?.is_anonymous?"Javoblaringiz anonim saqlanadi.":""),1),u("a",O,[s(n(q),{class:"w-5 h-5"}),a[4]||(a[4]=p(" So'rovnomalarga qaytish ",-1))])])):xe.value?(d(),o("div",D,[u("div",Y,[u("h1",E,v(xe.value.title),1),xe.value.description?(d(),o("p",F,v(xe.value.description),1)):i("",!0),xe.value.is_anonymous?(d(),o("div",M,[s(n(_),{class:"w-4 h-4"}),a[6]||(a[6]=p(" Bu so'rovnoma anonim - javoblaringiz maxfiy saqlanadi ",-1))])):i("",!0)]),u("div",G,[u("div",H,[u("span",null,"Savol "+v(ke.value+1)+" / "+v(je.value),1),u("span",null,v(_e.value)+"%",1)]),u("div",L,[u("div",{class:"h-full bg-purple-600 transition-all duration-300",style:c({width:`${_e.value}%`})},null,4)])]),u("div",Q,[u("div",R,[u("div",U,[u("div",V,[u("div",W,[u("span",X,v(ke.value+1),1)]),u("h2",N,v(we.value?.text),1)])]),"scale"===we.value?.type||"rating"===we.value?.type?(d(),o("div",P,[u("div",T,[(d(!0),o(g,null,y((we.value.scale_max||5)-(we.value.scale_min||1)+1,e=>(d(),o("button",{key:e,onClick:a=>{return r=(we.value.scale_min||1)+e-1,void(qe.value=r);var r},class:b(["w-14 h-14 rounded-xl font-bold text-lg transition-all",qe.value===(we.value.scale_min||1)+e-1?"bg-purple-600 text-white scale-110 shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-purple-100 dark:hover:bg-purple-900/30"])},v((we.value.scale_min||1)+e-1),11,Z))),128))]),a[7]||(a[7]=u("div",{class:"flex justify-between text-sm text-gray-500 mt-4 px-2"},[u("span",null,"Kam"),u("span",null,"Ko'p")],-1))])):"choice"===we.value?.type?(d(),o("div",ee,[(d(!0),o(g,null,y(we.value.options,(e,a)=>(d(),o("button",{key:a,onClick:a=>Ie(e),class:b(["w-full p-4 text-left rounded-xl border-2 transition-all",qe.value===e?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-700"])},[u("span",{class:b(["font-medium",qe.value===e?"text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300"])},v(e),3)],10,ae))),128))])):"multiple_choice"===we.value?.type?(d(),o("div",re,[(d(!0),o(g,null,y(we.value.options,(e,a)=>(d(),o("button",{key:a,onClick:a=>(e=>{const a=Array.isArray(qe.value)?[...qe.value]:[],r=a.indexOf(e);r>-1?a.splice(r,1):a.push(e),qe.value=a})(e),class:b(["w-full p-4 text-left rounded-xl border-2 transition-all flex items-center gap-3",Array.isArray(qe.value)&&qe.value.includes(e)?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-700"])},[u("div",{class:b(["w-5 h-5 rounded border-2 flex items-center justify-center",Array.isArray(qe.value)&&qe.value.includes(e)?"border-purple-500 bg-purple-500":"border-gray-300 dark:border-gray-600"])},[Array.isArray(qe.value)&&qe.value.includes(e)?(d(),t(n(_),{key:0,class:"w-3 h-3 text-white"})):i("",!0)],2),u("span",{class:b(["font-medium",Array.isArray(qe.value)&&qe.value.includes(e)?"text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300"])},v(e),3)],10,te))),128))])):"yes_no"===we.value?.type?(d(),o("div",le,[u("button",{onClick:a[0]||(a[0]=e=>Ie("yes")),class:b(["px-12 py-4 rounded-xl font-bold text-lg transition-all","yes"===qe.value?"bg-green-600 text-white scale-105 shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900/30"])}," Ha ",2),u("button",{onClick:a[1]||(a[1]=e=>Ie("no")),class:b(["px-12 py-4 rounded-xl font-bold text-lg transition-all","no"===qe.value?"bg-red-600 text-white scale-105 shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-red-100 dark:hover:bg-red-900/30"])}," Yo'q ",2)])):"text"===we.value?.type?(d(),o("div",se,[x(u("textarea",{"onUpdate:modelValue":a[2]||(a[2]=e=>qe.value=e),rows:"4",class:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"Javobingizni yozing..."},null,512),[[m,qe.value]])])):i("",!0),he.value?(d(),o("div",ue,[u("p",ne,v(he.value),1)])):i("",!0)]),u("div",oe,[u("button",{onClick:ze,disabled:0===ke.value,class:b(["flex items-center gap-2 px-4 py-2 rounded-lg transition-colors",0===ke.value?"text-gray-400 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},[s(n(A),{class:"w-5 h-5"}),a[8]||(a[8]=p(" Oldingi ",-1))],10,ie),ke.value<je.value-1?(d(),o("button",{key:0,onClick:$e,disabled:!Ce.value,class:b(["flex items-center gap-2 px-6 py-2 rounded-lg font-medium transition-colors",Ce.value?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-300 dark:bg-gray-600 text-gray-500 cursor-not-allowed"])},[a[9]||(a[9]=p(" Keyingi ",-1)),s(n(C),{class:"w-5 h-5"})],10,de)):(d(),o("button",{key:1,onClick:Se,disabled:!Be.value||ye.value,class:b(["flex items-center gap-2 px-6 py-2 rounded-lg font-medium transition-colors",Be.value&&!ye.value?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 dark:bg-gray-600 text-gray-500 cursor-not-allowed"])},[ye.value?(d(),t(n(w),{key:0,class:"w-5 h-5 animate-spin"})):(d(),t(n(_),{key:1,class:"w-5 h-5"})),p(" "+v(ye.value?"Yuborilmoqda...":"Yuborish"),1)],10,ve))])])])):i("",!0)])]),_:1},8,["title"]))}};export{pe as default};
