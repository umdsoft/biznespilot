import{h as B,l as L}from"./chunk-BYRtWSr0.js";import{_ as S}from"./chunk-Dd--AZOj.js";import{u as T}from"./app-DWC75jbx.js";import{C as k,r as j}from"./chunk-CHxAOWeL.js";import{r as F}from"./chunk-qVc0_oyq.js";import{r as U}from"./chunk-I93QdGKi.js";import{r as w}from"./chunk-lFe4J5iC.js";import{a as $}from"./chunk-D58UsNjm.js";import{r as N}from"./chunk-aL39oRCf.js";import{r as P}from"./chunk-DNp5bQOL.js";import{r as _,b as C,v as z,x as O,y as c,z as t,A as r,D as v,L as V,C as m,H as a,B as p,E as h,F as I,G as q}from"./chunk-BcTZxe-J.js";import"./chunk-CYarSvys.js";import"./chunk-BVYwhYNk.js";import"./chunk-BqueMrU7.js";import"./chunk-_yYzsx_i.js";import"./chunk-Rs1WNzbn.js";import"./chunk-CJsSO8V8.js";import"./chunk-CrR1zWIb.js";import"./chunk-CQoMtUf7.js";import"./chunk-LBbTbQSS.js";import"./chunk-CG0drqHE.js";import"./chunk-CklLzvQL.js";import"./chunk-CnrLL2pV.js";import"./chunk-Ba8J67bG.js";import"./chunk-BHX0ueEB.js";import"./chunk-C1xeNfMu.js";const A={class:"py-12"},J={class:"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8"},K={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4"},X={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-3"},G={class:"mt-2 text-gray-600 dark:text-gray-400"},H={class:"flex gap-2"},Z=["disabled"],M=["disabled"],Q={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-8"},W={class:"flex items-center gap-2"},Y={class:"text-sm font-medium text-gray-700 dark:text-gray-300 mr-4"},tt={class:"flex gap-2"},et={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 mb-8"},rt={class:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-4 flex items-center gap-2"},at={key:0,class:"bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-xl shadow-md p-6 mb-8"},ot={class:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-6 flex items-center gap-2"},st={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},nt={class:"bg-white dark:bg-gray-800 rounded-lg p-4"},dt={class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},lt={class:"text-xl font-bold text-gray-900 dark:text-gray-100"},it={class:"bg-white dark:bg-gray-800 rounded-lg p-4"},ct={class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},gt={class:"text-xl font-bold text-gray-900 dark:text-gray-100"},mt={class:"bg-white dark:bg-gray-800 rounded-lg p-4"},yt={class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},xt={class:"text-xl font-bold text-green-600 dark:text-green-400"},bt={class:"bg-white dark:bg-gray-800 rounded-lg p-4"},ut={class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},pt={class:"text-xl font-bold text-indigo-600 dark:text-indigo-400"},ht={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},ft={class:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-4"},_t={class:"overflow-x-auto"},vt={class:"w-full"},kt={class:"border-b border-gray-200 dark:border-gray-700"},wt={class:"text-left py-3 px-4 font-semibold text-gray-700 dark:text-gray-300"},Ct={class:"py-3 px-4 font-medium text-gray-900 dark:text-gray-100"},Ot={class:"py-3 px-4 text-right font-semibold text-green-600 dark:text-green-400"},Dt={class:"py-3 px-4 text-right text-gray-700 dark:text-gray-300"},Et={class:"py-3 px-4 text-right text-gray-700 dark:text-gray-300"};k.register(...j);const Rt={mounted(){this.$nextTick(()=>{this.initializeCharts()})},methods:{initializeCharts(){if(this.revenueChartData){const l=document.getElementById("revenueTrendsChart");l&&new k(l,{type:"line",data:this.revenueChartData,options:this.chartOptions})}if(this.forecastChartData){const l=document.getElementById("forecastChart");l&&new k(l,{type:"line",data:this.forecastChartData,options:this.chartOptions})}}}},ee=Object.assign(Rt,{__name:"Revenue",props:{trends:{type:Object,default:()=>({chart_data:{labels:[],datasets:[]},trends:[]})},forecast:{type:Object,default:()=>({forecast:[],summary:{avg_daily_revenue:0,recent_avg:0,growth_rate:0,forecast_total:0}})},period:String},setup(l){const{t:s}=T(),i=l,x=_(i.period||"daily"),b=_(!1),u=_(!1),y=o=>new Intl.NumberFormat("uz-UZ").format(o)+" so'm",D=o=>o?.toFixed(1)||"0",f=o=>{x.value=o,window.location.href=route("business.analytics.revenue",{period:o})},E=async()=>{b.value=!0;try{const o=await fetch(route("business.analytics.export.pdf"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({report_type:"revenue"})});if(o.ok){const e=await o.blob(),n=window.URL.createObjectURL(e),d=document.createElement("a");d.href=n,d.download="revenue_report.pdf",document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(n),document.body.removeChild(d)}else alert(s("common.error"))}catch(o){console.error("Export error:",o),alert(s("common.error"))}finally{b.value=!1}},R=async()=>{u.value=!0;try{const o=await fetch(route("business.analytics.export.excel"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({report_type:"revenue"})});if(o.ok){const e=await o.blob(),n=window.URL.createObjectURL(e),d=document.createElement("a");d.href=n,d.download="revenue_report.xlsx",document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(n),document.body.removeChild(d)}else alert(s("common.error"))}catch(o){console.error("Export error:",o),alert(s("common.error"))}finally{u.value=!1}};return C(()=>i.trends?.chart_data?{labels:i.trends.chart_data.labels,datasets:i.trends.chart_data.datasets.map(o=>({...o,fill:!0}))}:null),C(()=>{if(!i.forecast?.forecast)return null;const o=i.forecast.forecast.map(g=>g.label),e=i.forecast.forecast.map(g=>g.forecast_revenue),n=i.forecast.forecast.map(g=>g.lower_bound),d=i.forecast.forecast.map(g=>g.upper_bound);return{labels:o,datasets:[{label:"Forecast",data:e,borderColor:"rgb(99, 102, 241)",backgroundColor:"rgba(99, 102, 241, 0.1)",fill:!0},{label:"Upper Bound",data:d,borderColor:"rgb(239, 68, 68)",borderDash:[5,5],fill:!1},{label:"Lower Bound",data:n,borderColor:"rgb(34, 197, 94)",borderDash:[5,5],fill:!1}]}}),(o,e)=>(h(),z(S,{title:r(s)("analytics.revenue_analytics")},{default:O(()=>[c(r(B),{title:r(s)("analytics.revenue_analytics")},null,8,["title"]),t("div",A,[t("div",J,[t("div",K,[t("div",null,[t("h1",X,[c(r(F),{class:"w-10 h-10 text-green-600 dark:text-green-400"}),m(" "+a(r(s)("analytics.revenue_analytics")),1)]),t("p",G,a(r(s)("analytics.revenue_desc")),1)]),t("div",H,[c(r(L),{href:o.route("business.analytics.index"),class:"inline-flex items-center px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium rounded-lg transition-colors gap-2"},{default:O(()=>[c(r(U),{class:"w-4 h-4"}),e[3]||(e[3]=m(" Dashboard ",-1))]),_:1},8,["href"]),t("button",{onClick:E,disabled:b.value,class:"inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-red-400 text-white font-medium rounded-lg transition-colors gap-2"},[c(r(w),{class:"w-4 h-4"}),m(" "+a(b.value?r(s)("common.loading"):"PDF"),1)],8,Z),t("button",{onClick:R,disabled:u.value,class:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white font-medium rounded-lg transition-colors gap-2"},[c(r(w),{class:"w-4 h-4"}),m(" "+a(u.value?r(s)("common.loading"):"Excel"),1)],8,M)])]),t("div",Q,[t("div",W,[c(r($),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"}),t("span",Y,a(r(s)("analytics.period"))+":",1),t("div",tt,[t("button",{onClick:e[0]||(e[0]=n=>f("daily")),class:p([x.value==="daily"?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600","px-4 py-2 rounded-lg font-medium transition-colors"])},a(r(s)("analytics.daily")),3),t("button",{onClick:e[1]||(e[1]=n=>f("weekly")),class:p([x.value==="weekly"?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600","px-4 py-2 rounded-lg font-medium transition-colors"])},a(r(s)("analytics.weekly")),3),t("button",{onClick:e[2]||(e[2]=n=>f("monthly")),class:p([x.value==="monthly"?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600","px-4 py-2 rounded-lg font-medium transition-colors"])},a(r(s)("analytics.monthly")),3)])])]),t("div",et,[t("h3",rt,[c(r(N),{class:"w-6 h-6 text-green-600 dark:text-green-400"}),e[4]||(e[4]=m(" Revenue Trends ",-1))]),e[5]||(e[5]=t("div",{class:"h-80"},[t("canvas",{id:"revenueTrendsChart"})],-1))]),l.forecast&&l.forecast.forecast?(h(),v("div",at,[t("h3",ot,[c(r(P),{class:"w-6 h-6 text-indigo-600 dark:text-indigo-400"}),m(" "+a(r(s)("analytics.revenue_forecast")),1)]),t("div",st,[t("div",nt,[t("p",dt,a(r(s)("analytics.avg_daily")),1),t("p",lt,a(y(l.forecast.summary.avg_daily_revenue)),1)]),t("div",it,[t("p",ct,a(r(s)("analytics.recent_avg")),1),t("p",gt,a(y(l.forecast.summary.recent_avg)),1)]),t("div",mt,[t("p",yt,a(r(s)("analytics.growth_rate")),1),t("p",xt,a(D(l.forecast.summary.growth_rate))+"%",1)]),t("div",bt,[t("p",ut,a(r(s)("analytics.forecast_total")),1),t("p",pt,a(y(l.forecast.summary.forecast_total)),1)])]),e[6]||(e[6]=t("div",{class:"bg-white dark:bg-gray-800 rounded-lg p-4"},[t("div",{class:"h-80"},[t("canvas",{id:"forecastChart"})])],-1))])):V("",!0),t("div",ht,[t("h3",ft,a(r(s)("analytics.revenue_details")),1),t("div",_t,[t("table",vt,[t("thead",null,[t("tr",kt,[t("th",wt,a(r(s)("common.date")),1),e[7]||(e[7]=t("th",{class:"text-right py-3 px-4 font-semibold text-gray-700 dark:text-gray-300"},"Revenue",-1)),e[8]||(e[8]=t("th",{class:"text-right py-3 px-4 font-semibold text-gray-700 dark:text-gray-300"},"Deals",-1)),e[9]||(e[9]=t("th",{class:"text-right py-3 px-4 font-semibold text-gray-700 dark:text-gray-300"},"Avg Deal Size",-1))])]),t("tbody",null,[(h(!0),v(I,null,q(l.trends.trends,(n,d)=>(h(),v("tr",{key:n.date,class:p([d%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700/50","hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors"])},[t("td",Ct,a(n.label),1),t("td",Ot,a(y(n.revenue)),1),t("td",Dt,a(n.deal_count),1),t("td",Et,a(y(n.avg_deal_size)),1)],2))),128))])])])])])])]),_:1},8,["title"]))}});export{ee as default};
