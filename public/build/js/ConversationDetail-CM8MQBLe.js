import{h as T,l as h,r as g}from"./chunk-BVrjkT6E.js";import{_ as E}from"./chunk-BDCgzsM6.js";import{r as N,o as _,C as n,y as m,A as v,x as f,z as t,H as o,D as i,F as a,G as p,I,B as u,E as z,p as A}from"./chunk-KPSVwAyv.js";import"./chunk-Qa9RIO0M.js";import"./app-BtfI-58n.js";import"./chunk-BvkwlYlD.js";import"./chunk-BgShz32H.js";import"./chunk-Qe-_4ASA.js";import"./chunk-Ch0Q6XPl.js";import"./chunk-Dfha1x8d.js";import"./chunk-BgOPVSvg.js";import"./chunk-CYw1XsNK.js";import"./chunk-qku2UxUN.js";import"./chunk-D5sR6A8B.js";import"./chunk-Dems4pAU.js";import"./chunk-D59q4lxq.js";import"./chunk-Cw_2vanC.js";import"./chunk-14qmXdHo.js";import"./chunk-DN454CZt.js";import"./chunk-CYZ54WJE.js";import"./chunk-D-7B8ZCD.js";import"./chunk-J14gS6og.js";const B={class:"py-12"},j={class:"max-w-8xl mx-auto sm:px-6 lg:px-8"},H={class:"mb-6 flex items-center justify-between"},M={class:"flex items-center gap-4"},q={class:"text-2xl font-bold text-gray-900"},D={class:"text-sm text-gray-600"},L={class:"flex gap-2"},O={class:"grid grid-cols-3 gap-6"},R={class:"col-span-2"},F={class:"bg-white rounded-lg shadow-sm overflow-hidden flex flex-col",style:{height:"calc(100vh - 250px)"}},U={class:"text-sm whitespace-pre-wrap"},V={key:0,class:"px-2 py-0.5 bg-white/20 rounded"},P={key:0,class:"flex items-center justify-center h-full text-gray-500"},X={class:"col-span-1 space-y-6"},Q={class:"bg-white rounded-lg shadow-sm p-6"},Y={class:"space-y-3"},$={key:0},G={class:"mt-1 text-sm text-gray-900"},K={key:1},W={class:"mt-1 text-sm text-gray-900"},Z={key:2},J={class:"mt-1 text-sm text-gray-900"},tt={class:"mt-1 text-sm text-gray-900"},et={class:"mt-1 text-sm text-gray-900 font-mono text-xs"},st={class:"bg-white rounded-lg shadow-sm p-6"},ot={class:"space-y-3"},nt={class:"mt-1"},at={class:"mt-1 text-sm text-gray-900"},it={key:0},rt={class:"mt-1 text-sm text-gray-900"},lt={key:1},dt={class:"mt-1 text-sm text-gray-900"},ct={class:"mt-1 text-sm text-gray-900"},mt={class:"mt-1 text-sm text-gray-900"},ut={key:0,class:"bg-white rounded-lg shadow-sm p-6"},xt={class:"space-y-3"},gt={class:"mt-1 text-sm text-gray-900"},vt={class:"mt-1"},ft={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Ot={__name:"ConversationDetail",props:{conversation:Object},setup(s){const x=s,d=N(null),y={telegram:"ðŸ“± Telegram",instagram:"ðŸ“· Instagram",facebook:"ðŸ‘¥ Facebook"},b={AWARENESS:"Xabardorlik",INTEREST:"Qiziqish",CONSIDERATION:"Mulohaza",INTENT:"Niyat",PURCHASE:"Xarid",POST_PURCHASE:"Xariddan keyin"},l=c=>new Date(c).toLocaleString("uz-UZ",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=()=>{A(()=>{d.value&&(d.value.scrollTop=d.value.scrollHeight)})};_(()=>{k()});const w=()=>{confirm("Suhbatni yopmoqchimisiz?")&&g.post(route("business.customer-bot.conversation.close",x.conversation.id),{},{preserveScroll:!0})},C=()=>{g.post(route("business.customer-bot.conversation.reopen",x.conversation.id),{},{preserveScroll:!0})},S=()=>{confirm("Suhbatni operatorga topshirmoqchimisiz?")&&g.post(route("business.customer-bot.conversation.handoff",x.conversation.id),{},{preserveScroll:!0})};return(c,e)=>(a(),n(p,null,[m(v(T),{title:`Suhbat - ${s.conversation.customer_name||"Anonim"}`},null,8,["title"]),m(E,null,{default:f(()=>[t("div",B,[t("div",j,[t("div",H,[t("div",M,[m(v(h),{href:c.route("business.customer-bot.conversations"),class:"p-2 hover:bg-gray-100 rounded-md"},{default:f(()=>[...e[0]||(e[0]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1},8,["href"]),t("div",null,[t("h1",q,o(s.conversation.customer_name||"Anonim"),1),t("p",D,o(y[s.conversation.channel]||"ðŸ’¬"),1)])]),t("div",L,[s.conversation.handed_off?i("",!0):(a(),n("button",{key:0,onClick:S,class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm"}," Operatorga topshirish ")),s.conversation.status==="active"?(a(),n("button",{key:1,onClick:w,class:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm"}," Suhbatni yopish ")):s.conversation.status==="closed"?(a(),n("button",{key:2,onClick:C,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm"}," Qayta ochish ")):i("",!0)])]),t("div",O,[t("div",R,[t("div",F,[t("div",{ref_key:"messagesContainer",ref:d,class:"flex-1 overflow-y-auto p-6 space-y-4"},[(a(!0),n(p,null,I(s.conversation.messages,r=>(a(),n("div",{key:r.id,class:u(["flex",r.role==="bot"?"justify-start":"justify-end"])},[t("div",{class:u(["max-w-md px-4 py-3 rounded-lg",r.role==="bot"?"bg-gray-100 text-gray-900":"bg-blue-600 text-white"])},[t("p",U,o(r.content),1),t("div",{class:u(["mt-1 text-xs flex items-center gap-2",r.role==="bot"?"text-gray-500":"text-blue-100"])},[t("span",null,o(l(r.created_at)),1),r.detected_intent?(a(),n("span",V,o(r.detected_intent),1)):i("",!0)],2)],2)],2))),128)),s.conversation.messages.length===0?(a(),n("div",P,[...e[1]||(e[1]=[t("div",{class:"text-center"},[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})]),t("p",{class:"mt-2"},"Hech qanday xabar yo'q")],-1)])])):i("",!0)],512)])]),t("div",X,[t("div",Q,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Mijoz ma'lumotlari",-1)),t("dl",Y,[s.conversation.customer_name?(a(),n("div",$,[e[2]||(e[2]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Ism",-1)),t("dd",G,o(s.conversation.customer_name),1)])):i("",!0),s.conversation.customer_email?(a(),n("div",K,[e[3]||(e[3]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Email",-1)),t("dd",W,o(s.conversation.customer_email),1)])):i("",!0),s.conversation.customer_phone?(a(),n("div",Z,[e[4]||(e[4]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Telefon",-1)),t("dd",J,o(s.conversation.customer_phone),1)])):i("",!0),t("div",null,[e[5]||(e[5]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Kanal",-1)),t("dd",tt,o(y[s.conversation.channel]||s.conversation.channel),1)]),t("div",null,[e[6]||(e[6]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Channel User ID",-1)),t("dd",et,o(s.conversation.channel_user_id),1)])])]),t("div",st,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Holat",-1)),t("dl",ot,[t("div",null,[e[8]||(e[8]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Status",-1)),t("dd",nt,[t("span",{class:u(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",s.conversation.status==="active"?"bg-green-100 text-green-800":s.conversation.status==="closed"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"])},o(s.conversation.status==="active"?"Faol":s.conversation.status==="closed"?"Yopilgan":"Arxiv"),3)])]),t("div",null,[e[9]||(e[9]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Bosqich",-1)),t("dd",at,o(b[s.conversation.current_stage]||s.conversation.current_stage),1)]),s.conversation.handed_off?(a(),n("div",it,[e[10]||(e[10]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Operatorga topshirilgan",-1)),t("dd",rt,o(l(s.conversation.handed_off_at)),1)])):i("",!0),s.conversation.closed_at?(a(),n("div",lt,[e[11]||(e[11]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Yopilgan vaqti",-1)),t("dd",dt,o(l(s.conversation.closed_at)),1)])):i("",!0),t("div",null,[e[12]||(e[12]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Boshlangan",-1)),t("dd",ct,o(l(s.conversation.created_at)),1)]),t("div",null,[e[13]||(e[13]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Oxirgi faollik",-1)),t("dd",mt,o(l(s.conversation.updated_at)),1)])])]),s.conversation.lead?(a(),n("div",ut,[e[18]||(e[18]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Lid",-1)),t("dl",xt,[t("div",null,[e[15]||(e[15]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Lid ID",-1)),t("dd",gt,o(s.conversation.lead.id),1)]),t("div",null,[e[16]||(e[16]=t("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Holat",-1)),t("dd",vt,[t("span",ft,o(s.conversation.lead.status),1)])]),t("div",null,[m(v(h),{href:c.route("business.sales.show",s.conversation.lead.id),class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:f(()=>[...e[17]||(e[17]=[z(" Lidni ko'rish ",-1)])]),_:1},8,["href"])])])])):i("",!0)])])])])]),_:1})],64))}};export{Ot as default};
