import{r as e,o as r,b as a,C as l,L as t,y as o,A as d,E as s,I as i,Q as n,z as c,N as u,J as p,K as m,B as g,D as b,F as y,Z as v,G as h,H as f,P as x}from"./chunk-CpmtkKLp.js";import{h as k}from"./chunk-BhZp3z4u.js";import{u as w}from"./app-C-ZlocOh.js";import{u as _,t as C}from"./chunk-NGwI6zqp.js";import{_ as j}from"./chunk-BCo6x5W8.js";import"./chunk-BWiubfpN.js";const F={key:0,class:"bg-white dark:bg-gray-800 rounded-3xl shadow-2xl overflow-hidden border border-gray-100 dark:border-gray-700"},z={class:"text-2xl font-bold leading-tight"},V={key:0,class:"mt-3 text-white/90 text-base"},U={key:1,class:"mt-5 inline-flex items-center gap-2 px-5 py-2.5 bg-white/20 backdrop-blur-sm rounded-full text-sm font-medium"},B={key:0,class:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl text-red-700 dark:text-red-400 text-sm"},E={class:"block text-sm font-semibold text-gray-700 dark:text-gray-200"},S={key:0,class:"text-red-500 ml-0.5"},A=["onUpdate:modelValue","type","placeholder"],P=["value","onInput","placeholder"],$=["onUpdate:modelValue","placeholder"],M=["onUpdate:modelValue"],L={value:""},H=["value"],I={key:4,class:"flex items-center gap-3 cursor-pointer p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl border border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},O=["onUpdate:modelValue"],q={class:"text-gray-700 dark:text-gray-200"},T={key:5,class:"text-red-500 text-xs mt-1"},Z=["disabled"],D={key:0,class:"flex items-center justify-center gap-2"},J={key:1},N={key:1,class:"bg-white dark:bg-gray-800 rounded-3xl shadow-2xl overflow-hidden border border-gray-100 dark:border-gray-700"},W={class:"p-10 text-center"},G={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-3"},K={class:"text-gray-600 dark:text-gray-300 mb-8 text-lg"},Q={key:0,class:"mb-8"},R={class:"text-sm font-medium text-gray-600 dark:text-gray-300 mb-4"},X=["href"],Y=["href"],ee={key:2,class:"w-full"},re={class:"relative w-full rounded-xl overflow-hidden shadow-lg",style:{"padding-bottom":"56.25%"}},ae=["src"],le={class:"mt-3 text-xs text-gray-400 dark:text-gray-500 text-center"},te={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},oe={key:2,class:"mt-8 text-center"},de=j({__name:"LeadForm",props:{leadForm:Object,isEmbed:Boolean,slug:String,trackingScripts:{type:Object,default:()=>({})}},setup(j){const{t:de}=w(),se=j;_(se.trackingScripts);const ie=e({}),ne=e(!1),ce=e(!1),ue=e(null),pe=e({});r(()=>{se.leadForm.fields.forEach(e=>{ie.value[e.id]=""});const e=new URLSearchParams(window.location.search);window.utmParams={utm_source:e.get("utm_source"),utm_medium:e.get("utm_medium"),utm_campaign:e.get("utm_campaign"),utm_term:e.get("utm_term"),utm_content:e.get("utm_content")}});const me=()=>{pe.value={};let e=!0;return se.leadForm.fields.forEach(r=>{const a=(e=>{const r=ie.value[e.id];if(e.required&&!r)return de("public_form.required_field");if(r)switch(e.type){case"email":if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r))return de("public_form.invalid_email");break;case"phone":if(!/^\+?[0-9\s\-()]{7,20}$/.test(r.replace(/\s/g,"")))return de("public_form.invalid_phone")}return null})(r);a&&(pe.value[r.id]=a,e=!1)}),e},ge=async()=>{if(me()){ne.value=!0;try{const e=await fetch(`/f/${se.slug}/submit`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({...ie.value,...window.utmParams})}),r=await e.json();r.success?(ue.value=r,ce.value=!0,C("lead_form",se.leadForm.title||se.slug),r.redirect_url&&setTimeout(()=>{window.location.href=r.redirect_url},3e3)):pe.value={form:r.error||de("public_form.error")}}catch(e){pe.value={form:de("public_form.network_error")}}finally{ne.value=!1}}},be=e=>{if(!e)return"";const r=e.match(/(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);if(r)return`https://www.youtube.com/embed/${r[1]}?rel=0&modestbranding=1`;const a=e.match(/vimeo\.com\/(?:video\/)?(\d+)/);if(a)return`https://player.vimeo.com/video/${a[1]}?dnt=1`;const l=e.match(/kinescope\.io\/(?:embed\/)?([a-zA-Z0-9]+)/);return l?`https://kinescope.io/embed/${l[1]}`:(e.includes("/embed/")||e.includes("player.vimeo.com"),e)},ye=a(()=>se.leadForm.theme_color||"#6366f1");return(e,r)=>(b(),l("div",{class:s(["min-h-screen",j.isEmbed?"bg-transparent":"bg-gray-50 dark:bg-gray-900"])},[t(d(k),{title:j.leadForm.title},null,8,["title"]),o("div",{class:s(["w-full",j.isEmbed?"":"min-h-screen flex items-center justify-center p-4"])},[o("div",{class:s(["w-full",j.isEmbed?"":"max-w-md"])},[ce.value?(b(),l("div",N,[o("div",W,[o("div",{class:"w-24 h-24 mx-auto rounded-full flex items-center justify-center mb-6 shadow-lg",style:n({backgroundColor:ye.value+"15"})},[(b(),l("svg",{class:"w-12 h-12",style:n({color:ye.value}),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[2]||(r[2]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M5 13l4 4L19 7"},null,-1)])],4))],4),o("h2",G,c(d(de)("public_form.thank_you")),1),o("p",K,c(ue.value?.message||d(de)("public_form.success_message")),1),ue.value?.lead_magnet?(b(),l("div",Q,[o("div",{class:"p-6 rounded-2xl border-2 border-dashed",style:n({backgroundColor:ye.value+"08",borderColor:ye.value+"30"})},[o("p",R,c(ue.value.lead_magnet.title||d(de)("public_form.your_gift")),1),"file"===ue.value.lead_magnet.type?(b(),l("a",{key:0,href:ue.value.lead_magnet.download_url,class:"inline-flex items-center gap-2 px-6 py-3 text-white font-semibold rounded-xl transition-all",style:n({backgroundColor:ye.value})},[r[3]||(r[3]=o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),g(" "+c(d(de)("public_form.download")),1)],12,X)):"link"===ue.value.lead_magnet.type?(b(),l("a",{key:1,href:ue.value.lead_magnet.link,target:"_blank",class:"inline-flex items-center gap-2 px-6 py-3 text-white font-semibold rounded-xl transition-all",style:n({backgroundColor:ye.value})},[r[4]||(r[4]=o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)),g(" "+c(d(de)("public_form.open")),1)],12,Y)):"video"===ue.value.lead_magnet.type?(b(),l("div",ee,[o("div",re,[o("iframe",{src:be(ue.value.lead_magnet.link),class:"absolute inset-0 w-full h-full",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,ae)]),o("p",le,c(d(de)("public_form.video_notice")),1)])):"coupon"===ue.value.lead_magnet.type||"text"===ue.value.lead_magnet.type?(b(),l("div",{key:3,class:"p-4 bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed",style:n({borderColor:ye.value})},[o("p",{class:"text-xl font-bold",style:n({color:ye.value})},c(ue.value.lead_magnet.text),5)],4)):i("",!0)],4)])):i("",!0),ue.value?.redirect_url?(b(),l("p",te,c(d(de)("public_form.redirect_notice")),1)):i("",!0)])])):(b(),l("div",F,[o("div",{class:"px-8 py-10 text-center text-white",style:n({backgroundColor:ye.value})},[o("h1",z,c(j.leadForm.title),1),j.leadForm.description?(b(),l("p",V,c(j.leadForm.description),1)):i("",!0),j.leadForm.has_lead_magnet&&j.leadForm.lead_magnet_title?(b(),l("div",U,[r[0]||(r[0]=o("span",null,"ðŸŽ",-1)),o("span",null,c(j.leadForm.lead_magnet_title),1)])):i("",!0)],4),o("form",{onSubmit:u(ge,["prevent"]),class:"p-8 space-y-5"},[pe.value.form?(b(),l("div",B,c(pe.value.form),1)):i("",!0),(b(!0),l(p,null,m(j.leadForm.fields,e=>{return b(),l("div",{key:e.id,class:"space-y-2"},[o("label",E,[g(c(e.label)+" ",1),e.required?(b(),l("span",S,"*")):i("",!0)]),["text","email","number"].includes(e.type)?y((b(),l("input",{key:0,"onUpdate:modelValue":r=>ie.value[e.id]=r,type:(r=e.type,{text:"text",email:"email",phone:"tel",number:"number"}[r]||"text"),placeholder:e.placeholder,class:s(["w-full px-4 py-3.5 bg-white dark:bg-gray-700 border-2 rounded-xl focus:ring-2 focus:border-transparent transition-all text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500",pe.value[e.id]?"border-red-300 dark:border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-opacity-50"]),style:n({"--tw-ring-color":ye.value})},null,14,A)),[[v,ie.value[e.id]]]):"phone"===e.type?(b(),l("input",{key:1,value:ie.value[e.id],onInput:r=>((e,r)=>{let a=e.target.value.replace(/\D/g,"");a.startsWith("998")?a="+"+a:a.startsWith("+")||a.length>0&&(a="+998"+a),a.length>4&&(a=a.slice(0,4)+" "+a.slice(4)),a.length>7&&(a=a.slice(0,7)+" "+a.slice(7)),a.length>11&&(a=a.slice(0,11)+" "+a.slice(11)),a.length>14&&(a=a.slice(0,14)+" "+a.slice(14)),ie.value[r]=a.slice(0,17)})(r,e.id),type:"tel",placeholder:e.placeholder||"+998 90 123 45 67",class:s(["w-full px-4 py-3.5 bg-white dark:bg-gray-700 border-2 rounded-xl focus:ring-2 focus:border-transparent transition-all text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500",pe.value[e.id]?"border-red-300 dark:border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-opacity-50"]),style:n({"--tw-ring-color":ye.value})},null,46,P)):"textarea"===e.type?y((b(),l("textarea",{key:2,"onUpdate:modelValue":r=>ie.value[e.id]=r,placeholder:e.placeholder,rows:"3",class:s(["w-full px-4 py-3.5 bg-white dark:bg-gray-700 border-2 rounded-xl focus:ring-2 focus:border-transparent transition-all resize-none text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500",pe.value[e.id]?"border-red-300 dark:border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-opacity-50"]),style:n({"--tw-ring-color":ye.value})},null,14,$)),[[h,ie.value[e.id]]]):"select"===e.type?y((b(),l("select",{key:3,"onUpdate:modelValue":r=>ie.value[e.id]=r,class:s(["w-full px-4 py-3.5 bg-white dark:bg-gray-700 border-2 rounded-xl focus:ring-2 focus:border-transparent transition-all text-gray-900 dark:text-gray-100",pe.value[e.id]?"border-red-300 dark:border-red-500 focus:ring-red-500":"border-gray-200 dark:border-gray-600 focus:ring-opacity-50"]),style:n({"--tw-ring-color":ye.value})},[o("option",L,c(e.placeholder||d(de)("public_form.select_placeholder")),1),(b(!0),l(p,null,m(e.options,e=>(b(),l("option",{key:e,value:e},c(e),9,H))),128))],14,M)),[[f,ie.value[e.id]]]):"checkbox"===e.type?(b(),l("label",I,[y(o("input",{"onUpdate:modelValue":r=>ie.value[e.id]=r,type:"checkbox",class:"w-5 h-5 rounded border-gray-300 dark:border-gray-500",style:n({accentColor:ye.value})},null,12,O),[[x,ie.value[e.id]]]),o("span",q,c(e.placeholder||e.label),1)])):i("",!0),pe.value[e.id]?(b(),l("p",T,c(pe.value[e.id]),1)):i("",!0)]);var r}),128)),o("button",{type:"submit",disabled:ne.value,class:"w-full py-4 mt-2 text-white text-lg font-bold rounded-xl shadow-lg transition-all transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",style:n({backgroundColor:ye.value,boxShadow:`0 10px 30px -5px ${ye.value}50`})},[ne.value?(b(),l("span",D,[r[1]||(r[1]=o("svg",{class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),g(" "+c(d(de)("public_form.submitting")),1)])):(b(),l("span",J,c(j.leadForm.submit_button_text||d(de)("public_form.submit")),1))],12,Z)],32)])),j.isEmbed?i("",!0):(b(),l("div",oe,[...r[5]||(r[5]=[o("a",{href:"https://biznespilot.uz",target:"_blank",class:"inline-flex items-center gap-1.5 text-xs text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors"},[o("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20"},[o("path",{"fill-rule":"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z","clip-rule":"evenodd"})]),g(" Powered by BiznesPilot ")],-1)])]))],2)],2)],2))}},[["__scopeId","data-v-294a41db"]]);export{de as default};
