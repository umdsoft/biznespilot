import{r as e,v as t,x as r,y as a,z as s,F as l,H as n,G as d,C as o,I as i,D as g,E as c,J as x,K as u,Q as p}from"./chunk-CpmtkKLp.js";import{r as m}from"./chunk-BhZp3z4u.js";import{_ as y}from"./chunk-BHCorYK2.js";import"./chunk-D7SyfRoT.js";import"./app-C-ZlocOh.js";import"./chunk-BWiubfpN.js";import"./chunk-CouA7u-j.js";import"./chunk-DmrwHl-6.js";import"./chunk-De_qwhex.js";import"./chunk-eMHYSAeQ.js";import"./chunk-beXL1A--.js";import"./chunk-CAoK8Mdm.js";import"./chunk-BiBvtcLb.js";import"./chunk-DNKDGYPp.js";import"./chunk-BiW1c8q7.js";import"./chunk-CTIk0k8a.js";import"./chunk-dqIIyBTR.js";import"./chunk-CvscUVdi.js";import"./chunk-BvbZUszZ.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-DCXiFUg-.js";import"./chunk-Bsc1JRL5.js";import"./chunk-BuJDoypK.js";import"./chunk-3cs9K1fB.js";import"./chunk-BG5DB3cD.js";import"./chunk-CdKrFGoA.js";import"./chunk-DvBKKKMs.js";const b={class:"mb-8"},k={class:"flex items-center gap-4 mb-4"},h={class:"flex items-center gap-4"},f={class:"w-16 h-16 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-emerald-700 dark:text-emerald-400 font-bold text-xl"},v={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},w={class:"text-gray-600 dark:text-gray-400"},j={class:"flex items-center gap-3"},_={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8"},B={class:"bg-gradient-to-r from-emerald-500 to-green-500 rounded-xl p-6 text-white"},q={class:"text-3xl font-bold"},S={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},D={class:"flex items-center gap-2"},C={class:"text-2xl font-bold text-gray-900 dark:text-white"},K={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},A={class:"text-2xl font-bold text-yellow-600"},I={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},O={class:"text-2xl font-bold text-purple-600"},T={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},z={class:"text-2xl font-bold text-orange-600"},M={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8"},U={class:"lg:col-span-2 space-y-4"},H={class:"flex items-center justify-between mb-4"},J={class:"font-bold text-gray-900 dark:text-white"},P={class:"text-sm text-gray-500"},N={class:"flex items-center justify-between text-sm mb-2"},R={class:"text-gray-500"},V={class:"text-gray-500"},F={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3"},Y={class:"mt-3 flex items-center justify-between text-sm"},Z={class:"text-gray-500"},$={key:0,class:"bg-white dark:bg-gray-800 rounded-xl p-12 text-center text-gray-500 border border-gray-200 dark:border-gray-700"},E={class:"space-y-6"},G={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},L={class:"space-y-3"},Q={class:"flex-1 min-w-0"},W={class:"font-medium text-gray-900 dark:text-white truncate"},X={class:"text-xs text-gray-500"},ee={key:0,class:"text-center text-gray-500 text-sm py-4"},te={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},re={class:"space-y-3"},ae={class:"font-medium text-gray-900 dark:text-white text-sm"},se={class:"text-xs text-gray-500"},le={class:"text-red-600 font-bold text-sm"},ne={key:0,class:"text-center text-green-600 text-sm py-4"},de={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},oe={key:0,class:"space-y-3"},ie={class:"flex justify-between"},ge={class:"flex justify-between"},ce={class:"flex justify-between"},xe={class:"font-bold text-green-600"},ue={class:"flex justify-between"},pe={class:"font-bold text-red-600"},me={class:"pt-3 border-t border-gray-200 dark:border-gray-700 flex justify-between"},ye={class:"text-xl font-bold text-emerald-600"},be={class:"pt-2"},ke={key:1,class:"text-center text-gray-500 py-4"},he={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},fe={class:"overflow-x-auto"},ve={class:"w-full"},we={class:"divide-y divide-gray-200 dark:divide-gray-700"},je={class:"px-4 py-3 text-sm text-gray-900 dark:text-white"},_e={class:"px-4 py-3 text-center"},Be={class:"px-4 py-3 text-center"},qe={class:"font-medium"},Se={class:"px-4 py-3 text-center"},De={key:0},Ce={__name:"OperatorKpi",props:{user:Object,summary:Object,kpiDetails:Array,userStats:Object,recentAchievements:Array,penalties:Array,currentBonus:Object,historicalData:Array,scoreChange:Number,period:String,date:String,panelType:String},setup(Ce){const Ke=Ce,Ae=e(Ke.period||"monthly"),Ie=e(Ke.date||(new Date).toISOString().split("T")[0]),Oe=()=>{m.get("/sales-head/sales-kpi/leaderboard")},Te=()=>{m.get(`/sales-head/sales-kpi/operator/${Ke.user.id}`,{period:Ae.value,date:Ie.value},{preserveState:!0})},ze=e=>e?new Intl.NumberFormat("uz-UZ").format(e)+" so'm":"0 so'm",Me=e=>e?new Date(e).toLocaleDateString("uz-UZ",{day:"numeric",month:"short"}):"-",Ue=e=>e>=100?"text-green-600":e>=80?"text-blue-600":e>=60?"text-yellow-600":"text-red-600",He=e=>e>0?"text-green-600 text-sm":e<0?"text-red-600 text-sm":"text-gray-500 text-sm",Je=e=>{const t={bronze:"bg-orange-100 dark:bg-orange-900/30",silver:"bg-gray-200 dark:bg-gray-700",gold:"bg-yellow-100 dark:bg-yellow-900/30",platinum:"bg-blue-100 dark:bg-blue-900/30",diamond:"bg-purple-100 dark:bg-purple-900/30"};return t[e]||t.bronze},Pe=e=>{const t={standard:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700",excellent:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700",accelerator:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700"};return t[e]||t.standard},Ne=e=>{const t={pending:"px-3 py-2 rounded-lg text-sm font-medium bg-yellow-100 text-yellow-700",approved:"px-3 py-2 rounded-lg text-sm font-medium bg-green-100 text-green-700",rejected:"px-3 py-2 rounded-lg text-sm font-medium bg-red-100 text-red-700"};return t[e]||t.pending};return(e,m)=>(g(),t(y,{title:Ce.user?.name+" - KPI"},{default:r(()=>{return[a("div",b,[a("div",k,[a("button",{onClick:Oe,class:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"},[...m[2]||(m[2]=[a("svg",{class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),a("div",h,[a("div",f,s((r=Ce.user?.name,r?r.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?")),1),a("div",null,[a("h2",v,s(Ce.user?.name),1),a("p",w,s(Ce.user?.position||"Sotuv operatori"),1)])])]),a("div",j,[l(a("select",{"onUpdate:modelValue":m[0]||(m[0]=e=>Ae.value=e),onChange:Te,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[...m[3]||(m[3]=[a("option",{value:"daily"},"Kunlik",-1),a("option",{value:"weekly"},"Haftalik",-1),a("option",{value:"monthly"},"Oylik",-1)])],544),[[n,Ae.value]]),l(a("input",{"onUpdate:modelValue":m[1]||(m[1]=e=>Ie.value=e),type:"date",onChange:Te,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},null,544),[[d,Ie.value]])])]),a("div",_,[a("div",B,[m[4]||(m[4]=a("p",{class:"text-sm text-emerald-100 mb-1"},"Umumiy ball",-1)),a("p",q,s(Ce.summary?.overall_score||0)+"%",1),Ce.scoreChange?(g(),o("p",{key:0,class:c([Ce.scoreChange>0?"text-emerald-200":"text-red-200","text-sm mt-1"])},s(Ce.scoreChange>0?"+":"")+s(Ce.scoreChange)+"% oldingi davrdan ",3)):i("",!0)]),a("div",S,[m[5]||(m[5]=a("p",{class:"text-sm text-gray-500 mb-1"},"Reyting",-1)),a("div",D,[a("p",C,"#"+s(Ce.summary?.rank_in_team||"-"),1),Ce.summary?.rank_change?(g(),o("span",{key:0,class:c(He(Ce.summary.rank_change))},s(Ce.summary.rank_change>0?"â†‘":"â†“")+" "+s(Math.abs(Ce.summary.rank_change)),3)):i("",!0)])]),a("div",K,[m[6]||(m[6]=a("p",{class:"text-sm text-gray-500 mb-1"},"Yutuqlar",-1)),a("p",A,s(Ce.userStats?.achievements_count||0),1)]),a("div",I,[m[7]||(m[7]=a("p",{class:"text-sm text-gray-500 mb-1"},"Ballar",-1)),a("p",O,s(Ce.userStats?.total_points||0),1)]),a("div",T,[m[8]||(m[8]=a("p",{class:"text-sm text-gray-500 mb-1"},"Streak",-1)),a("p",z,s(Ce.userStats?.current_streak||0)+" kun",1)])]),a("div",M,[a("div",U,[m[9]||(m[9]=a("h3",{class:"font-bold text-gray-900 dark:text-white"},"KPI ko'rsatkichlari",-1)),(g(!0),o(x,null,u(Ce.kpiDetails,e=>{return g(),o("div",{key:e.kpi_setting_id,class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},[a("div",H,[a("div",null,[a("h4",J,s(e.name),1),a("p",P,s(e.description),1)]),a("span",{class:c([Ue(e.score),"text-lg font-bold"])},s(e.score)+"%",3)]),a("div",N,[a("span",R,"Haqiqiy: "+s(e.actual)+" "+s(e.unit),1),a("span",V,"Maqsad: "+s(e.target)+" "+s(e.unit),1)]),a("div",F,[a("div",{class:c([(t=e.score,t>=100?"bg-green-500":t>=80?"bg-blue-500":t>=60?"bg-yellow-500":"bg-red-500"),"h-3 rounded-full transition-all duration-500"]),style:p({width:Math.min(e.score,100)+"%"})},null,6)]),a("div",Y,[a("span",Z,"Vazn: "+s(e.weight)+"%",1),a("span",{class:c([e.score>=100?"text-green-600":"text-gray-600","font-medium"])},s(e.score>=100?"Maqsadga yetdi âœ“":"Davom etilmoqda"),3)])]);var t}),128)),0===Ce.kpiDetails.length?(g(),o("div",$," Bu davr uchun KPI ma'lumotlari yo'q ")):i("",!0)]),a("div",E,[a("div",G,[m[10]||(m[10]=a("h3",{class:"font-bold text-gray-900 dark:text-white mb-4"},"So'nggi yutuqlar",-1)),a("div",L,[(g(!0),o(x,null,u(Ce.recentAchievements,e=>(g(),o("div",{key:e.id,class:"flex items-center gap-3"},[a("div",{class:c(["w-10 h-10 rounded-lg flex items-center justify-center text-lg",Je(e.achievement?.tier)])},s(e.achievement?.icon||"ðŸ†"),3),a("div",Q,[a("p",W,s(e.achievement?.name),1),a("p",X,s(Me(e.earned_at)),1)])]))),128)),0===Ce.recentAchievements.length?(g(),o("div",ee," Yutuqlar yo'q ")):i("",!0)])]),a("div",te,[m[11]||(m[11]=a("h3",{class:"font-bold text-gray-900 dark:text-white mb-4"},"Bu oylik jarimalar",-1)),a("div",re,[(g(!0),o(x,null,u(Ce.penalties,e=>(g(),o("div",{key:e.id,class:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg"},[a("div",null,[a("p",ae,s(e.penalty_rule?.name||e.reason),1),a("p",se,s(Me(e.triggered_at)),1)]),a("span",le,"-"+s(ze(e.penalty_amount)),1)]))),128)),0===Ce.penalties.length?(g(),o("div",ne," Jarimalar yo'q âœ“ ")):i("",!0)])]),a("div",de,[m[17]||(m[17]=a("h3",{class:"font-bold text-gray-900 dark:text-white mb-4"},"Bonus holati",-1)),Ce.currentBonus?(g(),o("div",oe,[a("div",ie,[m[12]||(m[12]=a("span",{class:"text-gray-500"},"KPI ball:",-1)),a("span",{class:c(["font-bold",(t=Ce.currentBonus.kpi_score,t>=100?"text-green-600":t>=80?"text-blue-600":"text-yellow-600")])},s(Ce.currentBonus.kpi_score)+"%",3)]),a("div",ge,[m[13]||(m[13]=a("span",{class:"text-gray-500"},"Tier:",-1)),a("span",{class:c(Pe(Ce.currentBonus.applied_tier))},s(Ce.currentBonus.applied_tier),3)]),a("div",ce,[m[14]||(m[14]=a("span",{class:"text-gray-500"},"Hisoblangan bonus:",-1)),a("span",xe,s(ze(Ce.currentBonus.base_amount)),1)]),a("div",ue,[m[15]||(m[15]=a("span",{class:"text-gray-500"},"Jarimalar:",-1)),a("span",pe,"-"+s(ze(Ce.currentBonus.total_penalties||0)),1)]),a("div",me,[m[16]||(m[16]=a("span",{class:"font-medium text-gray-900 dark:text-white"},"Jami:",-1)),a("span",ye,s(ze(Ce.currentBonus.final_amount)),1)]),a("div",be,[a("span",{class:c([Ne(Ce.currentBonus.status),"w-full flex justify-center"])},s((e=Ce.currentBonus.status,{pending:"Kutilmoqda",approved:"Tasdiqlangan",rejected:"Rad etilgan"}[e]||e)),3)])])):(g(),o("div",ke," Bu oy uchun bonus hali hisoblanmagan "))])])]),a("div",he,[m[20]||(m[20]=a("h3",{class:"font-bold text-gray-900 dark:text-white mb-4"},"Tarixiy natijalar",-1)),a("div",fe,[a("table",ve,[m[19]||(m[19]=a("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[a("tr",null,[a("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Davr"),a("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Ball"),a("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Reyting"),a("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Tier")])],-1)),a("tbody",we,[(g(!0),o(x,null,u(Ce.historicalData,e=>{return g(),o("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[a("td",je,s(e.period_label),1),a("td",_e,[a("span",{class:c(Ue(e.overall_score))},s(e.overall_score)+"%",3)]),a("td",Be,[a("span",qe,"#"+s(e.rank_in_team),1),e.rank_change?(g(),o("span",{key:0,class:c([He(e.rank_change),"ml-1 text-xs"])},s(e.rank_change>0?"â†‘":"â†“")+s(Math.abs(e.rank_change)),3)):i("",!0)]),a("td",Se,[a("span",{class:c((t=e.performance_tier,{exceptional:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700",excellent:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700",good:"px-2 py-1 rounded text-xs font-medium bg-teal-100 text-teal-700",meets:"px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-700",developing:"px-2 py-1 rounded text-xs font-medium bg-orange-100 text-orange-700",needs_improvement:"px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-700"}[t]||"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700"))},s(e.tier_label),3)])]);var t}),128)),0===Ce.historicalData.length?(g(),o("tr",De,[...m[18]||(m[18]=[a("td",{colspan:"4",class:"px-4 py-8 text-center text-gray-500"}," Tarixiy ma'lumotlar yo'q ",-1)])])):i("",!0)])])])])];var e,t,r}),_:1},8,["title"]))}};export{Ce as default};
