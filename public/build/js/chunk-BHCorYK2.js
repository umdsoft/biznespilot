import{a as e,r as a,b as t,o as l,e as s,v as r,x as n,U as u,C as o,D as d,J as i,K as c,A as m,I as f,z as x,y as b,F as v,E as h,L as p,O as y,V as k}from"./chunk-CpmtkKLp.js";import{b as g,a as w}from"./chunk-BhZp3z4u.js";import{A as j,p as C,k as _,_ as I}from"./chunk-D7SyfRoT.js";import{_ as E}from"./chunk-3cs9K1fB.js";import{u as W}from"./app-C-ZlocOh.js";const $={key:0,class:"pt-3 mt-3 border-t border-gray-200 dark:border-gray-700"},q={key:0,class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},z={key:1,class:"mb-2"},A={class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},F={key:0,class:"mb-1"},L=["onClick"],M={class:"flex-1 text-left"},S={class:"mt-1 ml-4 pl-4 border-l-2 border-gray-200 dark:border-gray-700 space-y-1"},U={class:"flex-1"},D={key:0,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-emerald-500 text-white rounded-full"},H={key:1,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},J={key:2,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-orange-500 text-white rounded-full"},K={key:3,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},N={__name:"SalesHeadLayout",props:{title:{type:String,default:""}},setup(N){const{t:O}=W(),V=g(),Z=j,B=e({}),G=a({new:0,total:0}),P=a({total:0,overdue:0}),Q=a({missed:0,total:0}),R=a({unread:0,total:0}),T=a({deals:0,revenue:0});let X=null;const Y=t(()=>{return[{label:O("layout.today"),value:`${T.value.deals} ${O("layout.deals")}`,bgClass:"bg-emerald-50 dark:bg-emerald-900/30",labelClass:"text-emerald-600 dark:text-emerald-400",valueClass:"text-emerald-700 dark:text-emerald-300"},{label:O("layout.amount"),value:(e=T.value.revenue,e?new Intl.NumberFormat("uz-UZ").format(e)+" "+O("common.currency"):"0 "+O("common.currency")),bgClass:"bg-blue-50 dark:bg-blue-900/30",labelClass:"text-blue-600 dark:text-blue-400",valueClass:"text-blue-700 dark:text-blue-300"}];var e}),ee=async()=>{try{const e=await w.get("/sales-head/api/stats");e.data&&(G.value=e.data.leads||{new:0,total:0},P.value=e.data.tasks||{total:0,overdue:0},Q.value=e.data.calls||{missed:0,total:0},R.value=e.data.inbox||{unread:0,total:0},T.value=e.data.today||{deals:0,revenue:0})}catch(e){}},ae=e=>{const a=V.url;return e.exact?a===e.href||a===e.href+"/":e.activeMatch?e.activeMatch(a):a.startsWith(e.href)};return l(()=>{Z.navigation.forEach(e=>{e.items.forEach(e=>{if(e.children){const a=e.children.some(e=>V.url.startsWith(e.href));B[e.label]=a}})}),ee(),X=setInterval(ee,3e4)}),s(()=>{X&&(clearInterval(X),X=null)}),(e,a)=>(d(),r(I,{title:N.title||m(O)("layout.home"),config:m(Z),"quick-stats":Y.value},{notifications:n(()=>[p(E)]),navigation:n(()=>[(d(!0),o(i,null,c(m(Z).navigation,(e,a)=>(d(),o(i,{key:a},[a>0?(d(),o("div",$,[e.title?(d(),o("p",q,x(e.title),1)):f("",!0)])):e.title?(d(),o("div",z,[b("p",A,x(e.title),1)])):f("",!0),(d(!0),o(i,null,c(e.items,e=>{return d(),o(i,{key:e.href||e.label},[e.children?(d(),o("div",F,[b("button",{onClick:a=>{return t=e.label,void(B[t]=!B[t]);var t},class:h(["w-full flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors",(a=e.children,a.some(e=>V.url.startsWith(e.href))?"bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700/50")])},[(d(),r(y(e.icon),{class:"w-5 h-5 mr-3"})),b("span",M,x(e.label),1),p(m(C),{class:h(["w-4 h-4 transition-transform duration-200",B[e.label]?"rotate-180":""])},null,8,["class"])],10,L),v(b("div",S,[(d(!0),o(i,null,c(e.children,e=>(d(),r(_,{key:e.href,href:e.href,active:ae(e),class:"!py-1.5 !text-sm"},{default:n(()=>[b("span",null,x(e.label),1)]),_:2},1032,["href","active"]))),128))],512),[[k,B[e.label]]])])):(d(),r(_,{key:1,href:e.href,active:ae(e)},{default:n(()=>[(d(),r(y(e.icon),{class:"w-5 h-5 mr-3"})),b("span",U,x(e.label),1),"/sales-head/leads"===e.href&&G.value.new>0?(d(),o("span",D,x(G.value.new>99?"99+":G.value.new),1)):f("",!0),"/sales-head/tasks"===e.href&&P.value.overdue>0?(d(),o("span",H,x(P.value.overdue>99?"99+":P.value.overdue),1)):f("",!0),"/sales-head/calls"===e.href&&Q.value.missed>0?(d(),o("span",J,x(Q.value.missed>99?"99+":Q.value.missed),1)):f("",!0),"/sales-head/inbox"===e.href&&R.value.unread>0?(d(),o("span",K,x(R.value.unread>99?"99+":R.value.unread),1)):f("",!0)]),_:2},1032,["href","active"]))],64);var a}),128))],64))),128))]),default:n(()=>[u(e.$slots,"default")]),_:3},8,["title","config","quick-stats"]))}};export{N as _};
