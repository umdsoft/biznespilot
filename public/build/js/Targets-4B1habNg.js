import{r as e,b as a,v as t,x as r,y as l,C as s,I as d,F as i,D as n,J as o,K as g,z as u,H as m,A as p,N as c,G as x}from"./chunk-CpmtkKLp.js";import{r as b}from"./chunk-BhZp3z4u.js";import{_ as y}from"./chunk-BHCorYK2.js";import"./chunk-D7SyfRoT.js";import"./app-C-ZlocOh.js";import"./chunk-BWiubfpN.js";import"./chunk-CouA7u-j.js";import"./chunk-DmrwHl-6.js";import"./chunk-De_qwhex.js";import"./chunk-eMHYSAeQ.js";import"./chunk-beXL1A--.js";import"./chunk-CAoK8Mdm.js";import"./chunk-BiBvtcLb.js";import"./chunk-DNKDGYPp.js";import"./chunk-BiW1c8q7.js";import"./chunk-CTIk0k8a.js";import"./chunk-dqIIyBTR.js";import"./chunk-CvscUVdi.js";import"./chunk-BvbZUszZ.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-DCXiFUg-.js";import"./chunk-Bsc1JRL5.js";import"./chunk-BuJDoypK.js";import"./chunk-3cs9K1fB.js";import"./chunk-BG5DB3cD.js";import"./chunk-CdKrFGoA.js";import"./chunk-DvBKKKMs.js";const h={class:"mb-8"},v={class:"flex items-center justify-between flex-wrap gap-4"},k={class:"flex items-center gap-3"},f=["value"],w=["value"],j=["value"],_=["value"],S={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8"},M={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},q={class:"text-2xl font-bold text-gray-900 dark:text-white"},C={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},z={class:"text-2xl font-bold text-green-600"},A={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},U={class:"text-2xl font-bold text-yellow-600"},V={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},J={class:"text-2xl font-bold text-emerald-600"},N={class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},B={class:"overflow-x-auto"},D={class:"w-full"},F={class:"bg-gray-50 dark:bg-gray-700/50"},I={class:"divide-y divide-gray-200 dark:divide-gray-700"},H={class:"px-6 py-4 whitespace-nowrap"},O={class:"flex items-center"},T={class:"w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-emerald-700 dark:text-emerald-400 font-medium"},E={class:"ml-3"},K={class:"font-medium text-gray-900 dark:text-white"},Y={class:"text-sm text-gray-500"},G={class:"flex flex-col items-center"},P={class:"font-medium text-gray-900 dark:text-white"},X={class:"text-xs text-gray-500"},$={class:"px-6 py-4 text-center"},L=["onClick"],Q={key:0},R=["colspan"],W={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Z={class:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto"},ee={class:"text-gray-500 mb-4"},ae={class:"flex-1"},te={class:"font-medium text-gray-900 dark:text-white"},re={class:"text-sm text-gray-500"},le={class:"w-32"},se=["onUpdate:modelValue","placeholder"],de={class:"text-sm text-gray-500 w-12"},ie={class:"flex justify-end gap-3 pt-4"},ne={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},oe={class:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto"},ge={class:"flex-1"},ue={class:"font-medium text-gray-900 dark:text-white"},me={class:"text-sm text-gray-500"},pe={class:"w-32"},ce=["onUpdate:modelValue","placeholder"],xe={class:"text-sm text-gray-500 w-12"},be={class:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg"},ye={class:"text-sm text-yellow-700 dark:text-yellow-400"},he={class:"flex justify-end gap-3 pt-4"},ve={__name:"Targets",props:{teamMembers:Array,kpiSettings:Array,targets:Array,month:Number,year:Number,panelType:String},setup(ve){const ke=ve,fe=(new Date).getFullYear(),we=e(ke.month||(new Date).getMonth()+1),je=e(ke.year||fe),_e=e(!1),Se=e(!1),Me=e(null),qe=e({}),Ce=e({}),ze=a(()=>new Set(ke.targets.map(e=>e.user_id)).size),Ae=e=>["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentabr","Oktabr","Noyabr","Dekabr"][e-1],Ue=(e,a)=>ke.targets.find(t=>t.user_id===e&&t.kpi_setting_id===a),Ve=()=>{b.get("/sales-head/sales-kpi/targets",{month:we.value,year:je.value},{preserveState:!0})},Je=()=>{Ce.value={},ke.kpiSettings.forEach(e=>{Ce.value[e.id]=e.target_value}),Se.value=!0},Ne=()=>{b.post("/sales-head/sales-kpi/targets",{user_id:Me.value.id,month:we.value,year:je.value,targets:qe.value},{onSuccess:()=>{_e.value=!1}})},Be=()=>{b.post("/sales-head/sales-kpi/targets/bulk",{month:we.value,year:je.value,targets:Ce.value},{onSuccess:()=>{Se.value=!1}})};return(e,a)=>(n(),t(y,{title:"Maqsadlar"},{default:r(()=>[l("div",h,[l("div",v,[a[4]||(a[4]=l("div",null,[l("h2",{class:"text-3xl font-bold text-gray-900 dark:text-gray-100"},"Maqsadlar"),l("p",{class:"mt-2 text-gray-600 dark:text-gray-400"},"Jamoa a'zolari uchun individual maqsadlarni belgilash")],-1)),l("div",k,[i(l("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>we.value=e),onChange:Ve,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[(n(),s(o,null,g(12,e=>l("option",{key:e,value:e},u(Ae(e)),9,f)),64))],544),[[m,we.value]]),i(l("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>je.value=e),onChange:Ve,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[l("option",{value:p(fe)-1},u(p(fe)-1),9,w),l("option",{value:p(fe)},u(p(fe)),9,j),l("option",{value:p(fe)+1},u(p(fe)+1),9,_)],544),[[m,je.value]])])])]),l("div",S,[l("div",M,[a[5]||(a[5]=l("p",{class:"text-sm text-gray-500 mb-1"},"Jami xodimlar",-1)),l("p",q,u(ve.teamMembers.length),1)]),l("div",C,[a[6]||(a[6]=l("p",{class:"text-sm text-gray-500 mb-1"},"Maqsad belgilangan",-1)),l("p",z,u(ze.value),1)]),l("div",A,[a[7]||(a[7]=l("p",{class:"text-sm text-gray-500 mb-1"},"Maqsad belgilanmagan",-1)),l("p",U,u(ve.teamMembers.length-ze.value),1)]),l("div",V,[a[8]||(a[8]=l("p",{class:"text-sm text-gray-500 mb-1"},"Faol KPIlar",-1)),l("p",J,u(ve.kpiSettings.length),1)])]),l("div",N,[l("div",{class:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},[a[9]||(a[9]=l("h3",{class:"font-semibold text-gray-900 dark:text-white"},"Jamoa maqsadlari",-1)),l("button",{onClick:Je,class:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm"}," Hammaga birdan belgilash ")]),l("div",B,[l("table",D,[l("thead",F,[l("tr",null,[a[10]||(a[10]=l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Xodim",-1)),(n(!0),s(o,null,g(ve.kpiSettings,e=>(n(),s("th",{key:e.id,class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},u(e.name),1))),128)),a[11]||(a[11]=l("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amal",-1))])]),l("tbody",I,[(n(!0),s(o,null,g(ve.teamMembers,e=>{return n(),s("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[l("td",H,[l("div",O,[l("div",T,u((a=e.name,a?a.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?")),1),l("div",E,[l("p",K,u(e.name),1),l("p",Y,u(e.position||"Operator"),1)])])]),(n(!0),s(o,null,g(ve.kpiSettings,a=>(n(),s("td",{key:a.id,class:"px-4 py-4 text-center"},[l("div",G,[l("span",P,u(Ue(e.id,a.id)?.target_value||"-"),1),l("span",X,u(a.measurement_unit),1)])]))),128)),l("td",$,[l("button",{onClick:a=>(e=>{Me.value=e,qe.value={},ke.kpiSettings.forEach(a=>{const t=Ue(e.id,a.id);qe.value[a.id]=t?.target_value||a.target_value}),_e.value=!0})(e),class:"px-3 py-1 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700"}," Tahrirlash ",8,L)])]);var a}),128)),0===ve.teamMembers.length?(n(),s("tr",Q,[l("td",{colspan:ve.kpiSettings.length+2,class:"px-6 py-12 text-center text-gray-500"}," Jamoa a'zolari topilmadi ",8,R)])):d("",!0)])])])]),_e.value?(n(),s("div",W,[l("div",Z,[a[13]||(a[13]=l("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},"Maqsadlarni tahrirlash",-1)),l("p",ee,u(Me.value?.name)+" uchun "+u(Ae(we.value))+" "+u(je.value),1),l("form",{onSubmit:c(Ne,["prevent"]),class:"space-y-4"},[(n(!0),s(o,null,g(ve.kpiSettings,e=>(n(),s("div",{key:e.id,class:"flex items-center gap-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[l("div",ae,[l("p",te,u(e.name),1),l("p",re,"Standart: "+u(e.target_value)+" "+u(e.measurement_unit),1)]),l("div",le,[i(l("input",{"onUpdate:modelValue":a=>qe.value[e.id]=a,type:"number",placeholder:e.target_value,class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-center"},null,8,se),[[x,qe.value[e.id],void 0,{number:!0}]])]),l("span",de,u(e.measurement_unit),1)]))),128)),l("div",ie,[l("button",{type:"button",onClick:a[2]||(a[2]=e=>_e.value=!1),class:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}," Bekor qilish "),a[12]||(a[12]=l("button",{type:"submit",class:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700"}," Saqlash ",-1))])],32)])])):d("",!0),Se.value?(n(),s("div",ne,[l("div",oe,[a[15]||(a[15]=l("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},"Ommaviy maqsad belgilash",-1)),a[16]||(a[16]=l("p",{class:"text-gray-500 mb-4"},"Barcha jamoa a'zolariga bir xil maqsadlarni belgilash",-1)),l("form",{onSubmit:c(Be,["prevent"]),class:"space-y-4"},[(n(!0),s(o,null,g(ve.kpiSettings,e=>(n(),s("div",{key:e.id,class:"flex items-center gap-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[l("div",ge,[l("p",ue,u(e.name),1),l("p",me,"Standart: "+u(e.target_value)+" "+u(e.measurement_unit),1)]),l("div",pe,[i(l("input",{"onUpdate:modelValue":a=>Ce.value[e.id]=a,type:"number",placeholder:e.target_value,class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-center"},null,8,ce),[[x,Ce.value[e.id],void 0,{number:!0}]])]),l("span",xe,u(e.measurement_unit),1)]))),128)),l("div",be,[l("p",ye," Bu amal "+u(ve.teamMembers.length)+" ta xodimning "+u(Ae(we.value))+" "+u(je.value)+" uchun maqsadlarini yangilaydi. ",1)]),l("div",he,[l("button",{type:"button",onClick:a[3]||(a[3]=e=>Se.value=!1),class:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}," Bekor qilish "),a[14]||(a[14]=l("button",{type:"submit",class:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700"}," Hammaga belgilash ",-1))])],32)])])):d("",!0)]),_:1}))}};export{ve as default};
