import{r as p,v as F,x as U,z as t,C as l,D as k,J as u,F as o,G as _,I as w,H as a,L as B,A as m,B as h,E as z,K as q}from"./chunk-KPSVwAyv.js";import{r as C}from"./chunk-BVrjkT6E.js";import{_ as D}from"./chunk-Dpr7eH3O.js";import"./chunk-C_PbB7ed.js";import"./app-DMGwzSHW.js";import"./chunk-BvkwlYlD.js";import"./chunk-BgShz32H.js";import"./chunk-Qe-_4ASA.js";import"./chunk-Ch0Q6XPl.js";import"./chunk-Dfha1x8d.js";import"./chunk-BgOPVSvg.js";import"./chunk-CYw1XsNK.js";import"./chunk-qku2UxUN.js";import"./chunk-D5sR6A8B.js";import"./chunk-Dems4pAU.js";import"./chunk-D59q4lxq.js";import"./chunk-Cw_2vanC.js";import"./chunk-14qmXdHo.js";import"./chunk-DN454CZt.js";import"./chunk-CYZ54WJE.js";import"./chunk-D-7B8ZCD.js";import"./chunk-J14gS6og.js";import"./chunk-B1Yis8U5.js";import"./chunk-CXygRKxK.js";import"./chunk-31-ywezX.js";import"./chunk-CQ-EgyBm.js";const J={class:"mb-8"},K={class:"flex items-center justify-between flex-wrap gap-4"},Y={class:"flex items-center gap-3"},$=["value"],L=["value"],O=["value"],E={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8"},H={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},G={class:"text-2xl font-bold text-gray-900 dark:text-white"},P={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},R={class:"text-2xl font-bold text-green-600"},X={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},Z={class:"text-2xl font-bold text-yellow-600"},Q={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},W={class:"text-2xl font-bold text-emerald-600"},tt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},et={class:"overflow-x-auto"},rt={class:"w-full"},st={class:"divide-y divide-gray-200 dark:divide-gray-700"},at={class:"px-6 py-4 whitespace-nowrap"},ot={class:"flex items-center"},dt={class:"w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-emerald-700 dark:text-emerald-400 font-medium"},lt={class:"ml-3 font-medium text-gray-900 dark:text-white"},nt={class:"px-6 py-4 text-center"},it={class:"px-6 py-4 text-center"},pt={class:"px-6 py-4 text-right font-medium text-green-600"},xt={class:"px-6 py-4 text-right font-medium text-red-600"},gt={class:"px-6 py-4 text-right font-bold text-gray-900 dark:text-white"},ut={class:"px-6 py-4 text-center"},mt={class:"px-6 py-4 text-center"},yt=["onClick"],ct={key:1,class:"text-gray-400 text-sm"},bt={key:0},ht={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},vt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6"},ft={class:"text-gray-600 dark:text-gray-400 mb-4"},kt={class:"mb-4"},_t={class:"mb-4"},wt={class:"flex justify-end gap-3"},Zt={__name:"Bonuses",props:{bonuses:Array,stats:Object,month:Number,year:Number,currentStatus:String,panelType:String},setup(d){const v=d,x=new Date().getFullYear(),y=p(v.month),c=p(v.year),g=p(!1),b=p(null),n=p({approved_bonus:0,notes:""}),S=s=>["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentabr","Oktabr","Noyabr","Dekabr"][s-1],f=()=>{C.get("/sales-head/sales-kpi/bonuses",{month:y.value,year:c.value},{preserveState:!0})},i=s=>s?new Intl.NumberFormat("uz-UZ").format(s)+" so'm":"0 so'm",T=s=>s?s.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?",M=s=>s>=100?"text-green-600":s>=80?"text-blue-600":"text-yellow-600",j=s=>{const e={standard:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700",excellent:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700",accelerator:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700"};return e[s]||e.standard},N=s=>{const e={pending:"px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-700",approved:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700",rejected:"px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-700"};return e[s]||e.pending},I=s=>({pending:"Kutilmoqda",approved:"Tasdiqlangan",rejected:"Rad etilgan"})[s]||s,V=s=>{b.value=s,n.value={approved_bonus:s.final_amount,notes:""},g.value=!0},A=()=>{C.post(`/sales-head/sales-kpi/bonuses/${b.value.id}/approve`,n.value,{onSuccess:()=>{g.value=!1}})};return(s,e)=>(o(),F(D,{title:"Bonuslar"},{default:U(()=>[t("div",J,[t("div",K,[e[5]||(e[5]=t("div",null,[t("h2",{class:"text-3xl font-bold text-gray-900 dark:text-gray-100"},"Bonuslar"),t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"},"Oylik bonuslarni ko'rish va tasdiqlash")],-1)),t("div",Y,[u(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>y.value=r),onChange:f,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[(o(),l(_,null,w(12,r=>t("option",{key:r,value:r},a(S(r)),9,$)),64))],544),[[B,y.value]]),u(t("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>c.value=r),onChange:f,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[t("option",{value:m(x)-1},a(m(x)-1),9,L),t("option",{value:m(x)},a(m(x)),9,O)],544),[[B,c.value]])])])]),t("div",E,[t("div",H,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500 mb-1"},"Jami hisoblangan",-1)),t("p",G,a(i(d.stats.total_calculated)),1)]),t("div",P,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-500 mb-1"},"Tasdiqlangan",-1)),t("p",R,a(i(d.stats.total_approved)),1)]),t("div",X,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-500 mb-1"},"Kutilmoqda",-1)),t("p",Z,a(d.stats.pending_count),1)]),t("div",Q,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-500 mb-1"},"Tasdiqlangan soni",-1)),t("p",W,a(d.stats.approved_count),1)])]),t("div",tt,[t("div",et,[t("table",rt,[e[11]||(e[11]=t("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Xodim"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"KPI Ball"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Tier"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Bonus"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Jarimalar"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Jami"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Holat"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amal")])],-1)),t("tbody",st,[(o(!0),l(_,null,w(d.bonuses,r=>(o(),l("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",at,[t("div",ot,[t("div",dt,a(T(r.user?.name)),1),t("span",lt,a(r.user?.name),1)])]),t("td",nt,[t("span",{class:h(["text-lg font-bold",M(r.kpi_score)])},a(r.kpi_score)+"%",3)]),t("td",it,[t("span",{class:h(j(r.applied_tier))},a(r.applied_tier),3)]),t("td",pt," +"+a(i(r.base_amount)),1),t("td",xt," -"+a(i(r.total_penalties||0)),1),t("td",gt,a(i(r.final_amount)),1),t("td",ut,[t("span",{class:h(N(r.status))},a(I(r.status)),3)]),t("td",mt,[r.status==="pending"?(o(),l("button",{key:0,onClick:Bt=>V(r),class:"px-3 py-1 bg-emerald-600 text-white rounded-lg text-sm hover:bg-emerald-700"}," Tasdiqlash ",8,yt)):(o(),l("span",ct,"-"))])]))),128)),d.bonuses.length===0?(o(),l("tr",bt,[...e[10]||(e[10]=[t("td",{colspan:"8",class:"px-6 py-12 text-center text-gray-500"}," Bu oy uchun bonus ma'lumotlari yo'q ",-1)])])):k("",!0)])])])]),g.value?(o(),l("div",ht,[t("div",vt,[e[15]||(e[15]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-4"},"Bonusni tasdiqlash",-1)),t("p",ft,[t("strong",null,a(b.value?.user?.name),1),e[12]||(e[12]=z(" uchun bonus tasdiqlash ",-1))]),t("div",kt,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Tasdiqlangan summa",-1)),u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>n.value.approved_bonus=r),type:"number",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},null,512),[[q,n.value.approved_bonus,void 0,{number:!0}]])]),t("div",_t,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Izoh (ixtiyoriy)",-1)),u(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=r=>n.value.notes=r),rows:"2",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},null,512),[[q,n.value.notes]])]),t("div",wt,[t("button",{onClick:e[4]||(e[4]=r=>g.value=!1),class:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}," Bekor qilish "),t("button",{onClick:A,class:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700"}," Tasdiqlash ")])])])):k("",!0)]),_:1}))}};export{Zt as default};
