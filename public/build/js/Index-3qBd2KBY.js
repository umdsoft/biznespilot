import{r as k,h as O,l as R}from"./chunk-BVrjkT6E.js";import{_ as S}from"./chunk-Cy19HSui.js";import{_ as I}from"./chunk-DjNoE40N.js";import{_ as N}from"./chunk-DmWz40qF.js";import{b as l,C as c,F as o,z as e,B as $,v as C,M as j,D as h,H as g,y as f,E as M,A as b,r as V,J as E,L as F,G as D,I as q,x as B,ar as H}from"./chunk-KPSVwAyv.js";import{r as J}from"./chunk-CmNfLjGq.js";import{a as K}from"./chunk-Dfha1x8d.js";import{r as G}from"./chunk-Db7_HC3e.js";import{a as T}from"./chunk-D-7B8ZCD.js";import{r as U}from"./chunk-BgOPVSvg.js";import{r as Y}from"./chunk-D59q4lxq.js";import{r as P}from"./chunk-CPI6G2q3.js";import{q as X}from"./chunk-S7b6IQvx.js";import{r as Z}from"./chunk-CYw1XsNK.js";import{r as Q}from"./chunk-Cwn-ie4q.js";import{r as W}from"./chunk-Qe-_4ASA.js";import{r as ee}from"./chunk-DRZjuALB.js";import{_ as te}from"./chunk-DlAUqK2U.js";import{r as re}from"./chunk-gMRH-wg7.js";import{A as ae}from"./chunk-DkqGvkTH.js";import{r as se}from"./chunk-B0ddnyT4.js";import"./chunk-B1Yis8U5.js";import"./chunk-CXygRKxK.js";import"./chunk-31-ywezX.js";import"./chunk-CQ-EgyBm.js";import"./app-906_W7J6.js";import"./chunk-BvkwlYlD.js";import"./chunk-BgShz32H.js";import"./chunk-Ch0Q6XPl.js";import"./chunk-qku2UxUN.js";import"./chunk-D5sR6A8B.js";import"./chunk-Dems4pAU.js";import"./chunk-Cw_2vanC.js";import"./chunk-14qmXdHo.js";import"./chunk-DN454CZt.js";import"./chunk-CYZ54WJE.js";import"./chunk-J14gS6og.js";const le={class:"flex items-start gap-3 pl-2"},oe={class:"flex-1 min-w-0"},ne={class:"flex items-start justify-between gap-2"},ie={class:"flex-1"},de={class:"font-medium text-white text-sm"},ue={class:"text-gray-400 text-sm mt-1"},me={class:"flex items-center gap-3 mt-2 text-xs text-gray-500"},ge={class:"flex items-center gap-1"},ce={class:"flex items-center gap-1"},pe={key:0,class:"mt-3"},ye={__name:"AlertCard",props:{alert:{type:Object,required:!0}},emits:["mark-read","dismiss","action"],setup(s,{emit:x}){const t=s,p=x,_=l(()=>{const d={low:"bg-gray-500",medium:"bg-blue-500",high:"bg-orange-500",urgent:"bg-red-500"};return d[t.alert.priority]||d.medium}),v=l(()=>t.alert.priority==="urgent"?"bg-red-500/10 border-red-500/30":t.alert.priority==="high"?"bg-orange-500/10 border-orange-500/30":"bg-gray-800 border-gray-700"),n=l(()=>({lead_followup:P,kpi_warning:Y,target_reminder:T,penalty_warning:U,daily_summary:T,achievement:G,streak_warning:K,leaderboard_change:J})[t.alert.type]||X),r=l(()=>({lead_followup:"bg-purple-500/20",kpi_warning:"bg-orange-500/20",target_reminder:"bg-blue-500/20",penalty_warning:"bg-red-500/20",daily_summary:"bg-green-500/20",achievement:"bg-yellow-500/20",streak_warning:"bg-orange-500/20",leaderboard_change:"bg-blue-500/20"})[t.alert.type]||"bg-gray-500/20"),u=l(()=>({lead_followup:"text-purple-400",kpi_warning:"text-orange-400",target_reminder:"text-blue-400",penalty_warning:"text-red-400",daily_summary:"text-green-400",achievement:"text-yellow-400",streak_warning:"text-orange-400",leaderboard_change:"text-blue-400"})[t.alert.type]||"text-gray-400"),m=l(()=>({lead_followup:"bg-purple-500/20 text-purple-400",kpi_warning:"bg-orange-500/20 text-orange-400",target_reminder:"bg-blue-500/20 text-blue-400",penalty_warning:"bg-red-500/20 text-red-400",daily_summary:"bg-green-500/20 text-green-400",achievement:"bg-yellow-500/20 text-yellow-400",streak_warning:"bg-orange-500/20 text-orange-400",leaderboard_change:"bg-blue-500/20 text-blue-400"})[t.alert.type]||"bg-gray-500/20 text-gray-400"),A=l(()=>({lead_followup:"Follow-up",kpi_warning:"KPI",target_reminder:"Eslatma",penalty_warning:"Jarima",daily_summary:"Xulosa",achievement:"Yutuq",streak_warning:"Streak",leaderboard_change:"Reyting"})[t.alert.type]||t.alert.type),a=l(()=>{const d=new Date(t.alert.created_at),y=Math.floor((new Date-d)/1e3);return y<60?"Hozirgina":y<3600?`${Math.floor(y/60)} daqiqa oldin`:y<86400?`${Math.floor(y/3600)} soat oldin`:y<604800?`${Math.floor(y/86400)} kun oldin`:d.toLocaleDateString("uz-UZ")}),i=l(()=>["lead_followup","penalty_warning","streak_warning"].includes(t.alert.type)),L=l(()=>({lead_followup:"Lidga o'tish",penalty_warning:"Tafsilotlar",streak_warning:"Davom etish"})[t.alert.type]||"Ko'rish"),z=()=>{p("action",t.alert),t.alert.type==="lead_followup"&&t.alert.data?.lead_id?k.visit(route("sales-head.leads.show",t.alert.data.lead_id)):t.alert.type==="penalty_warning"&&k.visit(route("sales-head.sales-kpi.penalties"))};return(d,w)=>(o(),c("div",{class:$(["relative rounded-lg border p-4 transition-all duration-200",[v.value,{"opacity-60":s.alert.status==="read"}]])},[e("div",{class:$(["absolute left-0 top-0 bottom-0 w-1 rounded-l-lg",_.value])},null,2),e("div",le,[e("div",{class:$(["flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center",r.value])},[(o(),C(j(n.value),{class:$(["w-5 h-5",u.value])},null,8,["class"]))],2),e("div",oe,[e("div",ne,[e("div",ie,[e("h4",de,g(s.alert.title),1),e("p",ue,g(s.alert.message),1),e("div",me,[e("span",ge,[f(b(Z),{class:"w-3.5 h-3.5"}),M(" "+g(a.value),1)]),e("span",{class:$(["px-2 py-0.5 rounded-full text-xs",m.value])},g(A.value),3)])]),e("div",ce,[s.alert.status==="unread"?(o(),c("button",{key:0,onClick:w[0]||(w[0]=y=>d.$emit("mark-read",s.alert)),class:"p-1.5 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white transition-colors",title:"O'qilgan deb belgilash"},[f(b(Q),{class:"w-4 h-4"})])):h("",!0),e("button",{onClick:w[1]||(w[1]=y=>d.$emit("dismiss",s.alert)),class:"p-1.5 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-red-400 transition-colors",title:"Yopish"},[f(b(W),{class:"w-4 h-4"})])])]),i.value?(o(),c("div",pe,[e("button",{onClick:z,class:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 transition-colors"},[M(g(L.value)+" ",1),f(b(ee),{class:"w-3.5 h-3.5"})])])):h("",!0)])])],2))}},fe={class:"space-y-3"},xe={class:"flex items-center justify-between mb-4"},he={class:"flex items-center gap-2"},be={key:0,class:"px-2 py-0.5 text-xs font-medium bg-red-500 text-white rounded-full"},ve={class:"flex items-center gap-2"},_e=["value"],we={key:0,class:"text-center py-12 bg-gray-800 rounded-xl"},$e={class:"text-gray-400"},ke={key:1,class:"text-center pt-4"},Ce={__name:"AlertList",props:{alerts:{type:Array,default:()=>[]},alertTypes:{type:Object,default:()=>({})},hasMore:{type:Boolean,default:!1}},emits:["mark-read","dismiss","action","mark-all-read","load-more"],setup(s,{emit:x}){const t=s,p=V("all"),_=l(()=>p.value==="all"?t.alerts:t.alerts.filter(n=>n.type===p.value)),v=l(()=>t.alerts.filter(n=>n.status==="unread").length);return(n,r)=>(o(),c("div",fe,[e("div",xe,[e("div",he,[r[6]||(r[6]=e("h3",{class:"text-lg font-semibold text-white"},"Bildirishnomalar",-1)),v.value>0?(o(),c("span",be,g(v.value),1)):h("",!0)]),e("div",ve,[E(e("select",{"onUpdate:modelValue":r[0]||(r[0]=u=>p.value=u),class:"text-sm bg-gray-700 border-gray-600 text-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[r[7]||(r[7]=e("option",{value:"all"},"Barchasi",-1)),(o(!0),c(D,null,q(s.alertTypes,(u,m)=>(o(),c("option",{key:m,value:m},g(u.name),9,_e))),128))],512),[[F,p.value]]),v.value>0?(o(),c("button",{key:0,onClick:r[1]||(r[1]=u=>n.$emit("mark-all-read")),class:"text-sm text-gray-400 hover:text-white transition-colors"}," Barchasini o'qish ")):h("",!0)])]),_.value.length===0?(o(),c("div",we,[f(b(re),{class:"w-12 h-12 mx-auto text-gray-600 mb-3"}),e("p",$e,g(p.value==="all"?"Hozircha bildirishnomalar yo'q":"Bu turda bildirishnomalar yo'q"),1)])):h("",!0),f(H,{name:"list",tag:"div",class:"space-y-3"},{default:B(()=>[(o(!0),c(D,null,q(_.value,u=>(o(),C(ye,{key:u.id,alert:u,onMarkRead:r[2]||(r[2]=m=>n.$emit("mark-read",m)),onDismiss:r[3]||(r[3]=m=>n.$emit("dismiss",m)),onAction:r[4]||(r[4]=m=>n.$emit("action",m))},null,8,["alert"]))),128))]),_:1}),s.hasMore?(o(),c("div",ke,[e("button",{onClick:r[5]||(r[5]=u=>n.$emit("load-more")),class:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors"}," Ko'proq yuklash... ")])):h("",!0)]))}},Ae=te(Ce,[["__scopeId","data-v-284d023a"]]),Me={class:"py-6"},Be={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},Se={class:"mb-6"},De={class:"flex items-center justify-between"},qe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},Te={class:"bg-gray-800 rounded-xl p-4"},je={class:"text-2xl font-bold text-white"},Le={class:"bg-gray-800 rounded-xl p-4"},ze={class:"text-2xl font-bold text-red-400"},Oe={class:"bg-gray-800 rounded-xl p-4"},Re={class:"text-2xl font-bold text-orange-400"},Ie={class:"bg-gray-800 rounded-xl p-4"},Ne={class:"text-2xl font-bold text-gray-300"},Ve={class:"bg-gray-800/50 rounded-xl p-6"},kt={__name:"Index",props:{alerts:{type:Array,default:()=>[]},role:{type:String,default:"sales_operator"},unreadCount:{type:Number,default:0},alertTypes:{type:Object,default:()=>({})},priorities:{type:Object,default:()=>({})}},setup(s){const x=s,t=l(()=>({owner:I,sales_head:S,sales_operator:N})[x.role]||S),p=l(()=>["owner","sales_head"].includes(x.role)),_=l(()=>x.alerts.filter(a=>a.priority==="urgent"&&a.status==="unread").length),v=l(()=>x.alerts.filter(a=>a.priority==="high"&&a.status==="unread").length),n=l(()=>x.alerts.filter(a=>["urgent","high"].includes(a.priority)&&a.status==="unread").slice(0,3)),r=a=>{k.post(route("sales-head.alerts.read",a.id),{},{preserveScroll:!0,preserveState:!0})},u=a=>{k.post(route("sales-head.alerts.dismiss",a.id),{},{preserveScroll:!0,preserveState:!0})},m=()=>{k.post(route("sales-head.alerts.mark-all-read"),{},{preserveScroll:!0,preserveState:!0})},A=a=>{r(a)};return(a,i)=>(o(),C(j(t.value),null,{default:B(()=>[f(b(O),{title:"Bildirishnomalar"}),e("div",Me,[e("div",Be,[e("div",Se,[e("div",De,[i[1]||(i[1]=e("div",null,[e("h1",{class:"text-2xl font-bold text-white"},"Bildirishnomalar"),e("p",{class:"text-gray-400 mt-1"}," Muhim xabarlar va ogohlantirishlar ")],-1)),p.value?(o(),C(b(R),{key:0,href:a.route("sales-head.alerts.settings"),class:"inline-flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors"},{default:B(()=>[f(b(se),{class:"w-5 h-5"}),i[0]||(i[0]=M(" Sozlamalar ",-1))]),_:1},8,["href"])):h("",!0)])]),e("div",qe,[e("div",Te,[e("div",je,g(s.unreadCount),1),i[2]||(i[2]=e("div",{class:"text-sm text-gray-400"},"O'qilmagan",-1))]),e("div",Le,[e("div",ze,g(_.value),1),i[3]||(i[3]=e("div",{class:"text-sm text-gray-400"},"Shoshilinch",-1))]),e("div",Oe,[e("div",Re,g(v.value),1),i[4]||(i[4]=e("div",{class:"text-sm text-gray-400"},"Muhim",-1))]),e("div",Ie,[e("div",Ne,g(s.alerts.length),1),i[5]||(i[5]=e("div",{class:"text-sm text-gray-400"},"Jami",-1))])]),n.value.length>0?(o(),C(ae,{key:0,alerts:n.value,onDismiss:u,class:"mb-6"},null,8,["alerts"])):h("",!0),e("div",Ve,[f(Ae,{alerts:s.alerts,"alert-types":s.alertTypes,onMarkRead:r,onDismiss:u,onMarkAllRead:m,onAction:A},null,8,["alerts","alert-types"])])])])]),_:1}))}};export{kt as default};
