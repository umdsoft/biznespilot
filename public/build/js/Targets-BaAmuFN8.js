import{r as m,b as N,v as I,x as J,z as t,C as o,D as M,J as f,F as r,G as x,I as y,H as s,L as j,A as b,Q as T,K as U}from"./chunk-KPSVwAyv.js";import{r as S}from"./chunk-BVrjkT6E.js";import{_ as E}from"./chunk-g3cLJu39.js";import"./chunk-DMP3tXW5.js";import"./app-Bx12lrZQ.js";import"./chunk-BvkwlYlD.js";import"./chunk-BgShz32H.js";import"./chunk-Qe-_4ASA.js";import"./chunk-Ch0Q6XPl.js";import"./chunk-Dfha1x8d.js";import"./chunk-BgOPVSvg.js";import"./chunk-CYw1XsNK.js";import"./chunk-qku2UxUN.js";import"./chunk-D5sR6A8B.js";import"./chunk-Dems4pAU.js";import"./chunk-D59q4lxq.js";import"./chunk-Cw_2vanC.js";import"./chunk-14qmXdHo.js";import"./chunk-DN454CZt.js";import"./chunk-CYZ54WJE.js";import"./chunk-D-7B8ZCD.js";import"./chunk-J14gS6og.js";import"./chunk-B1Yis8U5.js";import"./chunk-CXygRKxK.js";import"./chunk-31-ywezX.js";import"./chunk-CQ-EgyBm.js";const Y={class:"mb-8"},$={class:"flex items-center justify-between flex-wrap gap-4"},H={class:"flex items-center gap-3"},O=["value"],K=["value"],L=["value"],P=["value"],W={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8"},G={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},Q={class:"text-2xl font-bold text-gray-900 dark:text-white"},X={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},R={class:"text-2xl font-bold text-green-600"},Z={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},tt={class:"text-2xl font-bold text-yellow-600"},et={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},at={class:"text-2xl font-bold text-emerald-600"},st={class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},rt={class:"overflow-x-auto"},lt={class:"w-full"},ot={class:"bg-gray-50 dark:bg-gray-700/50"},dt={class:"divide-y divide-gray-200 dark:divide-gray-700"},nt={class:"px-6 py-4 whitespace-nowrap"},it={class:"flex items-center"},gt={class:"w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-emerald-700 dark:text-emerald-400 font-medium"},ut={class:"ml-3"},mt={class:"font-medium text-gray-900 dark:text-white"},ct={class:"text-sm text-gray-500"},xt={class:"flex flex-col items-center"},yt={class:"font-medium text-gray-900 dark:text-white"},bt={class:"text-xs text-gray-500"},pt={class:"px-6 py-4 text-center"},ht=["onClick"],vt={key:0},_t=["colspan"],ft={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},kt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto"},wt={class:"text-gray-500 mb-4"},Mt={class:"flex-1"},St={class:"font-medium text-gray-900 dark:text-white"},qt={class:"text-sm text-gray-500"},Ct={class:"w-32"},Bt=["onUpdate:modelValue","placeholder"],jt={class:"text-sm text-gray-500 w-12"},Tt={class:"flex justify-end gap-3 pt-4"},Ut={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Vt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto"},zt={class:"flex-1"},At={class:"font-medium text-gray-900 dark:text-white"},Ft={class:"text-sm text-gray-500"},Dt={class:"w-32"},Nt=["onUpdate:modelValue","placeholder"],It={class:"text-sm text-gray-500 w-12"},Jt={class:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg"},Et={class:"text-sm text-yellow-700 dark:text-yellow-400"},Yt={class:"flex justify-end gap-3 pt-4"},xe={__name:"Targets",props:{teamMembers:Array,kpiSettings:Array,targets:Array,month:Number,year:Number,panelType:String},setup(d){const c=d,i=new Date().getFullYear(),g=m(c.month||new Date().getMonth()+1),u=m(c.year||i),v=m(!1),_=m(!1),k=m(null),p=m({}),h=m({}),q=N(()=>new Set(c.targets.map(e=>e.user_id)).size),w=l=>["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentabr","Oktabr","Noyabr","Dekabr"][l-1],V=l=>l?l.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?",C=(l,e)=>c.targets.find(a=>a.user_id===l&&a.kpi_setting_id===e),B=()=>{S.get("/sales-head/sales-kpi/targets",{month:g.value,year:u.value},{preserveState:!0})},z=l=>{k.value=l,p.value={},c.kpiSettings.forEach(e=>{const a=C(l.id,e.id);p.value[e.id]=a?.target_value||e.target_value}),v.value=!0},A=()=>{h.value={},c.kpiSettings.forEach(l=>{h.value[l.id]=l.target_value}),_.value=!0},F=()=>{S.post("/sales-head/sales-kpi/targets",{user_id:k.value.id,month:g.value,year:u.value,targets:p.value},{onSuccess:()=>{v.value=!1}})},D=()=>{S.post("/sales-head/sales-kpi/targets/bulk",{month:g.value,year:u.value,targets:h.value},{onSuccess:()=>{_.value=!1}})};return(l,e)=>(r(),I(E,{title:"Maqsadlar"},{default:J(()=>[t("div",Y,[t("div",$,[e[4]||(e[4]=t("div",null,[t("h2",{class:"text-3xl font-bold text-gray-900 dark:text-gray-100"},"Maqsadlar"),t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"},"Jamoa a'zolari uchun individual maqsadlarni belgilash")],-1)),t("div",H,[f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),onChange:B,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[(r(),o(x,null,y(12,a=>t("option",{key:a,value:a},s(w(a)),9,O)),64))],544),[[j,g.value]]),f(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>u.value=a),onChange:B,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[t("option",{value:b(i)-1},s(b(i)-1),9,K),t("option",{value:b(i)},s(b(i)),9,L),t("option",{value:b(i)+1},s(b(i)+1),9,P)],544),[[j,u.value]])])])]),t("div",W,[t("div",G,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-500 mb-1"},"Jami xodimlar",-1)),t("p",Q,s(d.teamMembers.length),1)]),t("div",X,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500 mb-1"},"Maqsad belgilangan",-1)),t("p",R,s(q.value),1)]),t("div",Z,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-500 mb-1"},"Maqsad belgilanmagan",-1)),t("p",tt,s(d.teamMembers.length-q.value),1)]),t("div",et,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-500 mb-1"},"Faol KPIlar",-1)),t("p",at,s(d.kpiSettings.length),1)])]),t("div",st,[t("div",{class:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},[e[9]||(e[9]=t("h3",{class:"font-semibold text-gray-900 dark:text-white"},"Jamoa maqsadlari",-1)),t("button",{onClick:A,class:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm"}," Hammaga birdan belgilash ")]),t("div",rt,[t("table",lt,[t("thead",ot,[t("tr",null,[e[10]||(e[10]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Xodim",-1)),(r(!0),o(x,null,y(d.kpiSettings,a=>(r(),o("th",{key:a.id,class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},s(a.name),1))),128)),e[11]||(e[11]=t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amal",-1))])]),t("tbody",dt,[(r(!0),o(x,null,y(d.teamMembers,a=>(r(),o("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",nt,[t("div",it,[t("div",gt,s(V(a.name)),1),t("div",ut,[t("p",mt,s(a.name),1),t("p",ct,s(a.position||"Operator"),1)])])]),(r(!0),o(x,null,y(d.kpiSettings,n=>(r(),o("td",{key:n.id,class:"px-4 py-4 text-center"},[t("div",xt,[t("span",yt,s(C(a.id,n.id)?.target_value||"-"),1),t("span",bt,s(n.measurement_unit),1)])]))),128)),t("td",pt,[t("button",{onClick:n=>z(a),class:"px-3 py-1 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700"}," Tahrirlash ",8,ht)])]))),128)),d.teamMembers.length===0?(r(),o("tr",vt,[t("td",{colspan:d.kpiSettings.length+2,class:"px-6 py-12 text-center text-gray-500"}," Jamoa a'zolari topilmadi ",8,_t)])):M("",!0)])])])]),v.value?(r(),o("div",ft,[t("div",kt,[e[13]||(e[13]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},"Maqsadlarni tahrirlash",-1)),t("p",wt,s(k.value?.name)+" uchun "+s(w(g.value))+" "+s(u.value),1),t("form",{onSubmit:T(F,["prevent"]),class:"space-y-4"},[(r(!0),o(x,null,y(d.kpiSettings,a=>(r(),o("div",{key:a.id,class:"flex items-center gap-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[t("div",Mt,[t("p",St,s(a.name),1),t("p",qt,"Standart: "+s(a.target_value)+" "+s(a.measurement_unit),1)]),t("div",Ct,[f(t("input",{"onUpdate:modelValue":n=>p.value[a.id]=n,type:"number",placeholder:a.target_value,class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-center"},null,8,Bt),[[U,p.value[a.id],void 0,{number:!0}]])]),t("span",jt,s(a.measurement_unit),1)]))),128)),t("div",Tt,[t("button",{type:"button",onClick:e[2]||(e[2]=a=>v.value=!1),class:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}," Bekor qilish "),e[12]||(e[12]=t("button",{type:"submit",class:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700"}," Saqlash ",-1))])],32)])])):M("",!0),_.value?(r(),o("div",Ut,[t("div",Vt,[e[15]||(e[15]=t("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},"Ommaviy maqsad belgilash",-1)),e[16]||(e[16]=t("p",{class:"text-gray-500 mb-4"},"Barcha jamoa a'zolariga bir xil maqsadlarni belgilash",-1)),t("form",{onSubmit:T(D,["prevent"]),class:"space-y-4"},[(r(!0),o(x,null,y(d.kpiSettings,a=>(r(),o("div",{key:a.id,class:"flex items-center gap-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[t("div",zt,[t("p",At,s(a.name),1),t("p",Ft,"Standart: "+s(a.target_value)+" "+s(a.measurement_unit),1)]),t("div",Dt,[f(t("input",{"onUpdate:modelValue":n=>h.value[a.id]=n,type:"number",placeholder:a.target_value,class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-center"},null,8,Nt),[[U,h.value[a.id],void 0,{number:!0}]])]),t("span",It,s(a.measurement_unit),1)]))),128)),t("div",Jt,[t("p",Et," Bu amal "+s(d.teamMembers.length)+" ta xodimning "+s(w(g.value))+" "+s(u.value)+" uchun maqsadlarini yangilaydi. ",1)]),t("div",Yt,[t("button",{type:"button",onClick:e[3]||(e[3]=a=>_.value=!1),class:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}," Bekor qilish "),e[14]||(e[14]=t("button",{type:"submit",class:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700"}," Hammaga belgilash ",-1))])],32)])])):M("",!0)]),_:1}))}};export{xe as default};
