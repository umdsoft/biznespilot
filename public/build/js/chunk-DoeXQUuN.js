import{D as l,z as e,E as o,r as h,b as E,w as ze,v as U,L as b,H as r,A as a,B as m,F as S,G as D,I as X,J as N,C as j,P as ge,y as g,x as J,Q as Je,T as ee,R as yt,o as pt,e as vt,M as Se,K as Ce}from"./chunk-BcTZxe-J.js";import{h as ft,l as kt,a as P,r as ie}from"./chunk-BYRtWSr0.js";import{u as pe,r as xe,i as qe}from"./app-CncQRLgv.js";import{_ as Ke}from"./chunk-DlAUqK2U.js";import{r as wt,f as Fe,e as ce,g as _t,b as Re,n as Ue}from"./chunk-BnC_-OK6.js";import{r as oe}from"./chunk-BqueMrU7.js";import{r as Xe}from"./chunk-CJsSO8V8.js";import{r as $t}from"./chunk-BfUzJLaZ.js";import{r as Qe}from"./chunk-qVc0_oyq.js";import{r as R}from"./chunk-Rs1WNzbn.js";import{r as Ct}from"./chunk-TdbA8O2H.js";import{r as et}from"./chunk-TBIYSmbo.js";import{r as jt}from"./chunk-4iV7JvLR.js";import{_ as Mt}from"./chunk-EPBWbUak.js";import{r as Me}from"./chunk-BFec1c2B.js";import{a as zt}from"./chunk-6yb70bcY.js";import{r as We}from"./chunk-L32cCIyO.js";import{a as Tt}from"./chunk-_yYzsx_i.js";import{a as he}from"./chunk-D58UsNjm.js";import{r as He}from"./chunk-CnrLL2pV.js";import{r as je}from"./chunk-Ba8J67bG.js";import{a as ue}from"./chunk-CklLzvQL.js";import{r as Vt}from"./chunk-DNp5bQOL.js";import{r as Bt}from"./chunk-BHX0ueEB.js";import{r as Ze}from"./chunk-zLGxu1Jg.js";import{r as Ye}from"./chunk-CzEpYekH.js";import{r as Lt}from"./chunk-DZS9ctBD.js";import{r as ye}from"./chunk-DlCydy0c.js";import{r as Ge}from"./chunk-gCWBLgcy.js";function At(i,n){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 19.5 15-15m0 0H8.25m11.25 0v11.25"})])}function St(i,n){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})])}function Ut(i,n){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M4.848 2.771A49.144 49.144 0 0 1 12 2.25c2.43 0 4.817.178 7.152.52 1.978.292 3.348 2.024 3.348 3.97v6.02c0 1.946-1.37 3.678-3.348 3.97a48.901 48.901 0 0 1-3.476.383.39.39 0 0 0-.297.17l-2.755 4.133a.75.75 0 0 1-1.248 0l-2.755-4.133a.39.39 0 0 0-.297-.17 48.9 48.9 0 0 1-3.476-.384c-1.978-.29-3.348-2.024-3.348-3.97V6.741c0-1.946 1.37-3.68 3.348-3.97ZM6.75 8.25a.75.75 0 0 1 .75-.75h9a.75.75 0 0 1 0 1.5h-9a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H7.5Z","clip-rule":"evenodd"})])}function Ht(i,n){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M15 3.75a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-1.5 0V5.56l-4.72 4.72a.75.75 0 1 1-1.06-1.06l4.72-4.72h-2.69a.75.75 0 0 1-.75-.75Z","clip-rule":"evenodd"}),e("path",{"fill-rule":"evenodd",d:"M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z","clip-rule":"evenodd"})])}const Ft={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Xt={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},qt={class:"relative inline-block w-full max-w-lg px-6 py-6 overflow-hidden text-left align-bottom transition-all transform bg-slate-800 rounded-2xl shadow-xl sm:my-8 sm:align-middle border border-slate-700"},It={class:"flex items-center justify-between mb-6"},Dt={class:"flex items-center"},Pt={class:"text-lg font-semibold text-white"},Et={class:"text-sm text-slate-400"},Nt={key:0,class:"py-12 text-center"},Ot={class:"mt-2 text-slate-400"},Rt={key:1},Wt={class:"flex gap-2 mb-4"},Zt={key:0},Yt={key:0,class:"mb-4 p-3 bg-green-500/20 border border-green-500/30 rounded-xl flex items-center"},Gt={class:"text-green-400 text-sm"},Jt={key:1,class:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-xl flex items-center"},Kt={class:"text-red-400 text-sm"},Qt={key:2,class:"mb-4"},es={class:"block text-sm font-medium text-slate-300 mb-2"},ts={class:"flex flex-wrap gap-2"},ss=["onClick"],as={class:"mb-4"},rs={class:"block text-sm font-medium text-slate-300 mb-2"},os=["placeholder"],ls={class:"flex justify-between mt-1 text-xs"},ns={class:"text-slate-500"},ds={class:"flex justify-end gap-3"},is=["disabled"],cs={key:0,class:"flex items-center"},us={key:1},gs={key:1},xs={key:0,class:"py-8 text-center"},bs={class:"text-slate-400"},ms={key:1,class:"space-y-3 max-h-80 overflow-y-auto"},hs={class:"flex items-center justify-between mb-2"},ys={class:"text-xs text-slate-500"},ps={class:"text-sm text-slate-300"},vs={class:"flex items-center justify-between mt-2 text-xs text-slate-500"},fs={__name:"SmsModal",props:{show:{type:Boolean,default:!1},lead:{type:Object,required:!0}},emits:["close","sent"],setup(i,{emit:n}){const{t:d}=pe(),T=i,v=n,M=h(""),H=h(null),$=h([]),V=h(!1),_=h(!1),F=h([]),x=h(!1),z=h(null),L=h(null),q=E(()=>{const f=M.value,p=f.length,y=/[^\x00-\x7F]/.test(f);let u=1;y?p<=70?u=1:u=Math.ceil(p/67):p<=160?u=1:u=Math.ceil(p/153);const Z=y?u===1?70:67*u:u===1?160:153*u;return{chars:p,parts:u,isUnicode:y,maxChars:Z}}),W=async()=>{try{const f=await fetch(route("business.sms.templates"),{headers:{Accept:"application/json"}});f.ok&&($.value=await f.json())}catch(f){console.error("Failed to fetch templates:",f)}},O=async()=>{if(T.lead?.id)try{const f=await fetch(route("business.sms.lead.history",T.lead.id),{headers:{Accept:"application/json"}});f.ok&&(F.value=await f.json())}catch(f){console.error("Failed to fetch SMS history:",f)}},G=f=>{H.value=f.id;let p=f.content;p=p.replace("{name}",T.lead?.name||""),p=p.replace("{phone}",T.lead?.phone||""),p=p.replace("{company}",T.lead?.company||""),p=p.replace("{email}",T.lead?.email||""),M.value=p},A=async()=>{if(!M.value.trim()){z.value=d("components.sms.enter_message");return}_.value=!0,z.value=null,L.value=null;try{await xe();const f=await window.axios.post(route("business.sms.send",T.lead.id),{message:M.value,template_id:H.value});L.value=d("components.sms.success",{parts:f.data.parts_count}),M.value="",H.value=null,v("sent"),await O(),setTimeout(()=>{v("close")},2e3)}catch(f){if(console.error("SMS send error:",f),qe(f)){z.value=d("common.session_expired"),await xe();return}f.response?.data?.error?z.value=f.response.data.error:z.value=d("common.network_error_retry")}finally{_.value=!1}},w=()=>{M.value="",H.value=null,z.value=null,L.value=null,x.value=!1,v("close")};ze(()=>T.show,async f=>{f&&(V.value=!0,await Promise.all([W(),O()]),V.value=!1)});const B=f=>({pending:"text-yellow-400",sent:"text-blue-400",delivered:"text-green-400",failed:"text-red-400"})[f]||"text-slate-400",C=f=>({pending:d("components.sms.status_pending"),sent:d("components.sms.status_sent"),delivered:d("components.sms.status_delivered"),failed:d("components.sms.status_failed")})[f]||f;return(f,p)=>(o(),U(ge,{to:"body"},[i.show?(o(),l("div",Ft,[e("div",Xt,[e("div",{class:"fixed inset-0 transition-opacity bg-slate-900/75",onClick:w}),e("div",qt,[e("div",It,[e("div",Dt,[p[3]||(p[3]=e("div",{class:"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-xl flex items-center justify-center mr-3"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})])],-1)),e("div",null,[e("h3",Pt,r(a(d)("components.sms.title")),1),e("p",Et,r(i.lead.name)+" - "+r(i.lead.phone),1)])]),e("button",{onClick:w,class:"text-slate-400 hover:text-white"},[...p[4]||(p[4]=[e("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),V.value?(o(),l("div",Nt,[p[5]||(p[5]=e("svg",{class:"animate-spin h-8 w-8 mx-auto text-teal-500",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),e("p",Ot,r(a(d)("common.loading")),1)])):(o(),l("div",Rt,[e("div",Wt,[e("button",{onClick:p[0]||(p[0]=y=>x.value=!1),class:m(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",x.value?"bg-slate-700 text-slate-300 hover:bg-slate-600":"bg-teal-500 text-white"])},r(a(d)("components.sms.new_sms")),3),e("button",{onClick:p[1]||(p[1]=y=>x.value=!0),class:m(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",x.value?"bg-teal-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"])},r(a(d)("components.sms.history"))+" ("+r(F.value.length)+") ",3)]),x.value?(o(),l("div",gs,[F.value.length===0?(o(),l("div",xs,[p[9]||(p[9]=e("svg",{class:"w-12 h-12 text-slate-500 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)),e("p",bs,r(a(d)("components.sms.no_sms_sent")),1)])):(o(),l("div",ms,[(o(!0),l(S,null,D(F.value,y=>(o(),l("div",{key:y.id,class:"bg-slate-700/30 rounded-xl p-3"},[e("div",hs,[e("span",ys,r(y.created_at),1),e("span",{class:m(["text-xs font-medium",B(y.status)])},r(C(y.status)),3)]),e("p",ps,r(y.message),1),e("div",vs,[e("span",null,r(y.sender),1),e("span",null,r(y.parts_count)+" qism",1)])]))),128))]))])):(o(),l("div",Zt,[L.value?(o(),l("div",Yt,[p[6]||(p[6]=e("svg",{class:"w-5 h-5 text-green-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),e("p",Gt,r(L.value),1)])):b("",!0),z.value?(o(),l("div",Jt,[p[7]||(p[7]=e("svg",{class:"w-5 h-5 text-red-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",Kt,r(z.value),1)])):b("",!0),$.value.length>0?(o(),l("div",Qt,[e("label",es,r(a(d)("components.sms.select_template")),1),e("div",ts,[(o(!0),l(S,null,D($.value,y=>(o(),l("button",{key:y.id,onClick:u=>G(y),class:m(["px-3 py-1.5 rounded-lg text-sm transition-colors",H.value===y.id?"bg-teal-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"])},r(y.name),11,ss))),128))])])):b("",!0),e("div",as,[e("label",rs,r(a(d)("components.sms.message_text")),1),X(e("textarea",{"onUpdate:modelValue":p[2]||(p[2]=y=>M.value=y),rows:"4",placeholder:a(d)("components.sms.write_message"),class:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:border-teal-500 focus:ring-1 focus:ring-teal-500 resize-none"},null,8,os),[[N,M.value]]),e("div",ls,[e("span",{class:m(q.value.isUnicode?"text-yellow-400":"text-slate-500")},r(q.value.isUnicode?a(d)("components.sms.unicode"):a(d)("components.sms.latin")),3),e("span",ns,r(q.value.chars)+" "+r(a(d)("components.sms.chars"))+" | "+r(q.value.parts)+" "+r(a(d)("components.sms.parts")),1)])]),e("div",ds,[e("button",{onClick:w,class:"px-4 py-2 bg-slate-700 text-slate-300 rounded-xl hover:bg-slate-600 transition-colors"},r(a(d)("common.cancel")),1),e("button",{onClick:A,disabled:_.value||!M.value.trim(),class:"px-6 py-2 bg-gradient-to-r from-teal-500 to-cyan-600 text-white font-medium rounded-xl hover:from-teal-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[_.value?(o(),l("span",cs,[p[8]||(p[8]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),j(" "+r(a(d)("components.sms.sending")),1)])):(o(),l("span",us,r(a(d)("components.sms.send")),1))],8,is)])]))]))])])])):b("",!0)]))}},ks={class:"flex min-h-screen items-center justify-center p-4"},ws={class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg mx-4 z-10"},_s={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},$s={class:"flex items-center gap-3"},Cs={class:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center"},js={class:"text-sm text-gray-500 dark:text-gray-400"},Ms={class:"p-6"},zs={key:0,class:"text-center py-8"},Ts={key:1,class:"text-center py-8"},Vs=["href"],Bs={key:2},Ls={key:0},As={class:"mb-6"},Ss={class:"relative"},Us={class:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"},Hs={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},Fs={class:"mb-6"},Xs={class:"grid grid-cols-2 gap-3"},qs={key:0,class:"absolute top-2 right-2"},Is={key:0,class:"absolute top-2 right-2"},Ds={class:"mb-6"},Ps={key:1},Es={class:"text-center mb-6"},Ns={class:"w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4"},Os={class:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 mb-4"},Rs={class:"flex items-center justify-between mb-2"},Ws={class:"font-bold text-green-600 dark:text-green-400"},Zs={class:"flex items-center justify-between mb-2"},Ys={class:"font-medium text-gray-900 dark:text-white capitalize"},Gs={key:0,class:"flex items-center justify-between"},Js={class:"font-mono text-sm text-gray-900 dark:text-white"},Ks={class:"mb-4"},Qs={class:"flex gap-2"},ea=["value"],ta={class:"flex gap-2"},sa=["href"],aa=["href"],ra={key:2,class:"mt-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl"},oa={class:"flex items-start gap-3"},la={class:"text-sm text-red-600 dark:text-red-400 mt-1"},na={key:0,class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50 rounded-b-2xl"},da=["disabled"],ia={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},ca={__name:"PaymentModal",props:{show:{type:Boolean,default:!1},lead:{type:Object,default:null}},emits:["close","created"],setup(i,{emit:n}){const{t:d}=pe(),T=i,v=n,M=h(!0),H=h(!1),$=h({payme:!1,click:!1}),V=h(1),_=h(null),F=h(""),x=h(null),z=h(null),L=h(null),q=h(!1),W=E(()=>$.value.payme||$.value.click),O=E(()=>_.value&&_.value>=1e3&&x.value),G=async()=>{M.value=!0,L.value=null;try{const y=await fetch(route("business.payments.providers"),{headers:{Accept:"application/json"}});if(y.ok){const u=await y.json();$.value=u.providers||{payme:!1,click:!1},$.value.payme&&!$.value.click?x.value="payme":$.value.click&&!$.value.payme&&(x.value="click")}}catch(y){console.error("Failed to load providers:",y),L.value=d("components.payment.load_providers_error")}finally{M.value=!1}},A=async()=>{if(O.value){H.value=!0,L.value=null;try{await xe();const y=await window.axios.post(route("business.payments.lead.create-link",T.lead.id),{provider:x.value,amount:_.value,description:F.value||`To'lov - ${T.lead.name}`});y.data.success?(z.value=y.data,V.value=2,v("created",y.data)):L.value=y.data.error||d("components.payment.create_link_error")}catch(y){if(console.error("Failed to create payment link:",y),qe(y)){L.value=d("common.session_expired"),await xe();return}y.response?.data?.error?L.value=y.response.data.error:L.value=d("common.network_error")}finally{H.value=!1}}},w=async()=>{if(z.value?.payment_url)try{await navigator.clipboard.writeText(z.value.payment_url),q.value=!0,setTimeout(()=>{q.value=!1},2e3)}catch(y){console.error("Failed to copy:",y)}},B=()=>`Hurmatli ${T.lead?.name}!

To'lov qilish uchun havola:
${z.value?.payment_url}

Summa: ${C(_.value)}`,C=y=>y?new Intl.NumberFormat("uz-UZ").format(y)+" so'm":"0 so'm",f=()=>{V.value=1,z.value=null,L.value=null,q.value=!1},p=()=>{v("close")};return ze(()=>T.show,y=>{y?(G(),T.lead?.estimated_value&&(_.value=T.lead.estimated_value)):setTimeout(()=>{f(),_.value=null,F.value=""},300)}),ze(()=>T.lead,y=>{y?.estimated_value&&!_.value&&(_.value=y.estimated_value)}),(y,u)=>(o(),U(ge,{to:"body"},[g(ee,{name:"modal"},{default:J(()=>[i.show?(o(),l("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:Je(p,["self"])},[e("div",ks,[e("div",{class:"fixed inset-0 bg-black/50",onClick:p}),e("div",ws,[e("div",_s,[e("div",$s,[e("div",Cs,[g(a(wt),{class:"w-5 h-5 text-white"})]),e("div",null,[u[4]||(u[4]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"To'lov qabul qilish",-1)),e("p",js,r(i.lead?.name),1)])]),e("button",{onClick:p,class:"p-2 text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[g(a(oe),{class:"w-5 h-5"})])]),e("div",Ms,[M.value?(o(),l("div",zs,[...u[5]||(u[5]=[e("div",{class:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"},null,-1),e("p",{class:"text-gray-500 dark:text-gray-400 mt-4"},"Yuklanmoqda...",-1)])])):W.value?(o(),l("div",Bs,[V.value===1?(o(),l("div",Ls,[e("div",As,[u[9]||(u[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," To'lov summasi (so'm) ",-1)),e("div",Ss,[X(e("input",{"onUpdate:modelValue":u[0]||(u[0]=Z=>_.value=Z),type:"number",min:"1000",step:"1000",placeholder:"100000",class:"w-full px-4 py-3 pl-12 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[N,_.value,void 0,{number:!0}]]),e("div",Us,[g(a(Qe),{class:"w-5 h-5"})])]),i.lead?.estimated_value?(o(),l("p",Hs," Taxminiy qiymat: "+r(C(i.lead.estimated_value)),1)):b("",!0)]),e("div",Fs,[u[12]||(u[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"}," To'lov tizimini tanlang ",-1)),e("div",Xs,[$.value.payme?(o(),l("button",{key:0,onClick:u[1]||(u[1]=Z=>x.value="payme"),class:m(["relative p-4 rounded-xl border-2 transition-all",x.value==="payme"?"border-cyan-500 bg-cyan-50 dark:bg-cyan-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"])},[u[10]||(u[10]=e("div",{class:"flex flex-col items-center gap-2"},[e("div",{class:"w-12 h-12 bg-cyan-500 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-8 h-8 text-white",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})])]),e("span",{class:"font-semibold text-gray-900 dark:text-white"},"Payme")],-1)),x.value==="payme"?(o(),l("div",qs,[g(a(R),{class:"w-5 h-5 text-cyan-500"})])):b("",!0)],2)):b("",!0),$.value.click?(o(),l("button",{key:1,onClick:u[2]||(u[2]=Z=>x.value="click"),class:m(["relative p-4 rounded-xl border-2 transition-all",x.value==="click"?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"])},[u[11]||(u[11]=e("div",{class:"flex flex-col items-center gap-2"},[e("div",{class:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-8 h-8 text-white",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})])]),e("span",{class:"font-semibold text-gray-900 dark:text-white"},"Click")],-1)),x.value==="click"?(o(),l("div",Is,[g(a(R),{class:"w-5 h-5 text-blue-500"})])):b("",!0)],2)):b("",!0)])]),e("div",Ds,[u[13]||(u[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Tavsif (ixtiyoriy) ",-1)),X(e("input",{"onUpdate:modelValue":u[3]||(u[3]=Z=>F.value=Z),type:"text",placeholder:"Xizmat yoki mahsulot nomi",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[N,F.value]])])])):V.value===2?(o(),l("div",Ps,[e("div",Es,[e("div",Ns,[g(a(R),{class:"w-8 h-8 text-green-600 dark:text-green-400"})]),u[14]||(u[14]=e("h4",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-1"},"To'lov havolasi tayyor!",-1)),u[15]||(u[15]=e("p",{class:"text-gray-500 dark:text-gray-400"},"Havolani mijozga yuboring",-1))]),e("div",Os,[e("div",Rs,[u[16]||(u[16]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Summa",-1)),e("span",Ws,r(C(_.value)),1)]),e("div",Zs,[u[17]||(u[17]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"To'lov tizimi",-1)),e("span",Ys,r(x.value),1)]),z.value?.order_id?(o(),l("div",Gs,[u[18]||(u[18]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Buyurtma ID",-1)),e("span",Js,r(z.value.order_id),1)])):b("",!0)]),e("div",Ks,[u[19]||(u[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," To'lov havolasi ",-1)),e("div",Qs,[e("input",{value:z.value?.payment_url,readonly:"",class:"flex-1 px-4 py-3 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white text-sm font-mono"},null,8,ea),e("button",{onClick:w,class:m(["px-4 py-3 rounded-xl font-medium transition-colors flex items-center gap-2",q.value?"bg-green-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"])},[q.value?(o(),U(a(Ct),{key:1,class:"w-5 h-5"})):(o(),U(a(St),{key:0,class:"w-5 h-5"})),j(" "+r(q.value?"Nusxalandi!":"Nusxalash"),1)],2)])]),e("div",ta,[i.lead?.phone?(o(),l("a",{key:0,href:`https://wa.me/${i.lead.phone.replace(/\D/g,"")}?text=${encodeURIComponent(B())}`,target:"_blank",class:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-medium rounded-xl transition-colors"},[...u[20]||(u[20]=[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})],-1),j(" WhatsApp ",-1)])],8,sa)):b("",!0),i.lead?.phone?(o(),l("a",{key:1,href:`https://t.me/share/url?url=${encodeURIComponent(z.value?.payment_url)}&text=${encodeURIComponent("Tolov qilish uchun havola:")}`,target:"_blank",class:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-sky-500 hover:bg-sky-600 text-white font-medium rounded-xl transition-colors"},[g(a(et),{class:"w-5 h-5"}),u[21]||(u[21]=j(" Telegram ",-1))],8,aa)):b("",!0)])])):b("",!0),L.value?(o(),l("div",ra,[e("div",oa,[g(a(Xe),{class:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),e("div",null,[u[22]||(u[22]=e("h4",{class:"font-medium text-red-800 dark:text-red-300"},"Xatolik yuz berdi",-1)),e("p",la,r(L.value),1)])])])):b("",!0)])):(o(),l("div",Ts,[g(a(Xe),{class:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),u[7]||(u[7]=e("h4",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"To'lov tizimlari sozlanmagan",-1)),u[8]||(u[8]=e("p",{class:"text-gray-500 dark:text-gray-400 mb-4"},"Payme yoki Click sozlamalarini sozlash kerak",-1)),e("a",{href:y.route("business.settings.payments"),class:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors"},[g(a($t),{class:"w-4 h-4"}),u[6]||(u[6]=j(" Sozlamalarga o'tish ",-1))],8,Vs)]))]),W.value&&!M.value?(o(),l("div",na,[V.value===2?(o(),l("button",{key:0,onClick:f,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," Yangi to'lov ")):b("",!0),e("button",{onClick:p,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},r(V.value===2?"Yopish":"Bekor qilish"),1),V.value===1?(o(),l("button",{key:1,onClick:A,disabled:!O.value||H.value,class:"px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center gap-2"},[H.value?(o(),l("div",ia)):(o(),U(a(jt),{key:1,class:"w-4 h-4"})),j(" "+r(H.value?"Yaratilmoqda...":"Havola yaratish"),1)],8,da)):b("",!0)])):b("",!0)])])])):b("",!0)]),_:1})]))}},ua=Ke(ca,[["__scopeId","data-v-31ea7bd9"]]),ga={key:0,class:"fixed bottom-6 right-6 z-50 w-72 bg-slate-900 rounded-2xl shadow-2xl border border-slate-700/50 overflow-hidden"},xa={class:"bg-gradient-to-r from-slate-800 to-slate-700 px-4 py-3 flex items-center justify-between"},ba={class:"text-sm font-medium text-white"},ma={class:"p-5 text-center"},ha={class:"w-16 h-16 mx-auto mb-3 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-xl"},ya={class:"text-base font-semibold text-white mb-1"},pa={class:"text-slate-400 text-sm"},va={class:"px-5 pb-5"},fa=["href"],ka={class:"text-xs text-slate-500 text-center mt-3"},wa={href:"https://www.microsip.org/downloads",target:"_blank",class:"block text-center text-xs text-slate-500 hover:text-slate-400 underline mt-2"},_a={__name:"CallWidget",props:{show:{type:Boolean,default:!1},lead:{type:Object,required:!0}},emits:["close","openSoftphone"],setup(i,{emit:n}){const{t:d}=pe(),T=i,v=n,M=V=>V?V.split(" ").map(_=>_[0]).join("").toUpperCase().slice(0,2):"?",H=E(()=>T.lead.phone?`sip:${T.lead.phone.replace(/\D/g,"")}`:""),$=()=>{v("close")};return(V,_)=>(o(),U(ge,{to:"body"},[g(ee,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-4"},{default:J(()=>[i.show?(o(),l("div",ga,[e("div",xa,[e("span",ba,r(a(d)("components.call.title")),1),e("button",{onClick:$,class:"p-1 text-slate-400 hover:text-white hover:bg-slate-600 rounded-lg transition-colors"},[g(a(oe),{class:"w-5 h-5"})])]),e("div",ma,[e("div",ha,r(M(i.lead.name)),1),e("h3",ya,r(i.lead.name),1),e("p",pa,r(i.lead.phone),1)]),e("div",va,[e("a",{href:H.value,onClick:_[0]||(_[0]=F=>v("openSoftphone")),class:"w-full flex items-center justify-center gap-3 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-xl transition-colors shadow-lg shadow-green-600/30"},[g(a(Ht),{class:"w-5 h-5"}),j(" "+r(a(d)("components.call.make_call")),1)],8,fa),e("p",ka,r(a(d)("components.call.microsip_opens")),1),e("a",wa,r(a(d)("components.call.download_microsip")),1)])])):b("",!0)]),_:1})]))}},$a={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Ca={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg z-10 overflow-hidden max-h-[90vh] overflow-y-auto"},ja={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800"},Ma={class:"flex items-center gap-3"},za={class:"w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl flex items-center justify-center"},Ta={class:"text-lg font-semibold text-gray-900 dark:text-white"},Va={class:"p-6 space-y-5"},Ba={key:0,class:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},La={class:"flex items-center gap-3"},Aa={class:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-lg"},Sa={class:"flex-1 min-w-0"},Ua={class:"font-semibold text-gray-900 dark:text-white truncate"},Ha={class:"flex items-center gap-2 mt-1"},Fa={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Xa={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},qa={key:0,class:"flex items-center justify-center py-8"},Ia={key:1,class:"text-center py-8"},Da={class:"text-gray-500 dark:text-gray-400"},Pa={class:"text-sm text-gray-400 dark:text-gray-500 mt-1"},Ea={key:2,class:"space-y-2"},Na={class:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center"},Oa={class:"flex-1"},Ra={class:"font-medium text-gray-700 dark:text-gray-300"},Wa={class:"text-xs text-gray-500 dark:text-gray-400"},Za=["onClick"],Ya={class:"w-10 h-10 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white font-semibold"},Ga={class:"flex-1 min-w-0"},Ja={class:"font-medium text-gray-900 dark:text-white"},Ka={key:0,class:"flex items-center gap-3 mt-1 text-xs text-gray-500 dark:text-gray-400"},Qa={key:1,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},er={for:"reassign-tasks",class:"text-sm text-gray-700 dark:text-gray-300"},tr={key:2,class:"text-sm text-red-500"},sr={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 sticky bottom-0"},ar=["disabled"],rr={__name:"LeadAssignModal",props:{show:{type:Boolean,default:!1},lead:{type:Object,default:null}},emits:["close","assigned"],setup(i,{emit:n}){const{t:d}=pe(),T=i,v=n,M=h([]),H=h([]),$=h(null),V=h(!0),_=h(!1),F=h(!1),x=h(""),z=E(()=>({new:d("sales.status_new"),contacted:d("sales.status_contacted"),qualified:d("sales.status_qualified"),proposal:d("sales.status_proposal"),negotiation:d("sales.status_negotiation"),won:d("sales.status_won"),lost:d("sales.status_lost")})),L={new:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",contacted:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",qualified:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",proposal:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-400",negotiation:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400",won:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",lost:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"},q=async()=>{F.value=!0;try{const[w,B]=await Promise.all([fetch(route("business.api.sales.operators")),fetch(route("business.api.sales.operator-stats"))]),C=await w.json(),f=await B.json();M.value=C.operators||[],H.value=f.stats||[]}catch(w){console.error("Failed to load operators:",w)}finally{F.value=!1}},W=w=>H.value.find(B=>B.operator.id===w);ze(()=>T.show,w=>{w&&(x.value="",$.value=T.lead?.assigned_to?.id||null,V.value=!0,q())});const O=async()=>{if(!_.value){_.value=!0,x.value="";try{await xe();const w=await window.axios.post(route("business.api.sales.assign",{lead:T.lead.id}),{operator_id:$.value,reassign_tasks:V.value});w.data.success?(v("assigned",w.data.lead),v("close")):x.value=w.data.error||w.data.message||d("common.error_occurred")}catch(w){if(console.error("Failed to assign lead:",w),qe(w)){x.value=d("common.session_expired"),await xe();return}w.response?.data?.error?x.value=w.response.data.error:w.response?.data?.message?x.value=w.response.data.message:x.value=d("common.network_error")}finally{_.value=!1}}},G=w=>w?new Intl.NumberFormat("uz-UZ").format(w):"0",A=()=>{v("close")};return(w,B)=>(o(),U(ge,{to:"body"},[g(ee,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:J(()=>[i.show?(o(),l("div",$a,[e("div",{class:"fixed inset-0 bg-black/50",onClick:A}),g(ee,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:J(()=>[i.show?(o(),l("div",Ca,[e("div",ja,[e("div",Ma,[e("div",za,[g(a(Me),{class:"w-5 h-5 text-white"})]),e("h3",Ta,r(a(d)("components.lead_assign.title")),1)]),e("button",{onClick:A,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[g(a(oe),{class:"w-5 h-5"})])]),e("div",Va,[i.lead?(o(),l("div",Ba,[e("div",La,[e("div",Aa,r(i.lead.name?.charAt(0)?.toUpperCase()||"?"),1),e("div",Sa,[e("h4",Ua,r(i.lead.name),1),e("div",Ha,[e("span",{class:m(["px-2 py-0.5 text-xs font-medium rounded-full",L[i.lead.status]||"bg-gray-100 text-gray-700"])},r(z.value[i.lead.status]||i.lead.status),3),i.lead.estimated_value?(o(),l("span",Fa," $"+r(G(i.lead.estimated_value)),1)):b("",!0)])])])])):b("",!0),e("div",null,[e("label",Xa,r(a(d)("components.bulk_assign.select_operator")),1),F.value?(o(),l("div",qa,[...B[2]||(B[2]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"},null,-1)])])):M.value.length===0?(o(),l("div",Ia,[g(a(Fe),{class:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600 mb-3"}),e("p",Da,r(a(d)("components.bulk_assign.no_operators")),1),e("p",Pa,r(a(d)("components.bulk_assign.add_operator_hint")),1)])):(o(),l("div",Ea,[e("button",{onClick:B[0]||(B[0]=C=>$.value=null),class:m(["w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left",$.value===null?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[e("div",Na,[g(a(oe),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"})]),e("div",Oa,[e("span",Ra,r(a(d)("components.bulk_assign.unassigned")),1),e("p",Wa,r(a(d)("components.bulk_assign.leave_without_operator")),1)]),$.value===null?(o(),U(a(R),{key:0,class:"w-5 h-5 text-orange-500"})):b("",!0)],2),(o(!0),l(S,null,D(M.value,C=>(o(),l("button",{key:C.id,onClick:f=>$.value=C.id,class:m(["w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left",$.value===C.id?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[e("div",Ya,r(C.name?.charAt(0)?.toUpperCase()||"?"),1),e("div",Ga,[e("span",Ja,r(C.name),1),W(C.id)?(o(),l("div",Ka,[e("span",null,r(W(C.id).leads.total)+" lid",1),e("span",null,r(W(C.id).leads.conversion_rate)+"% conversion",1)])):b("",!0)]),$.value===C.id?(o(),U(a(R),{key:0,class:"w-5 h-5 text-orange-500"})):b("",!0)],10,Za))),128))]))]),M.value.length>0?(o(),l("div",Qa,[X(e("input",{type:"checkbox",id:"reassign-tasks","onUpdate:modelValue":B[1]||(B[1]=C=>V.value=C),class:"w-4 h-4 text-orange-500 border-gray-300 rounded focus:ring-orange-500"},null,512),[[yt,V.value]]),e("label",er,r(a(d)("components.bulk_assign.reassign_tasks")),1)])):b("",!0),x.value?(o(),l("p",tr,r(x.value),1)):b("",!0)]),e("div",sr,[e("button",{onClick:A,class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 font-medium rounded-xl transition-colors"},r(a(d)("common.cancel")),1),e("button",{onClick:O,disabled:_.value,class:m(["px-6 py-2 font-medium rounded-xl transition-colors",_.value?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600 text-white"])},r(_.value?a(d)("common.saving"):a(d)("components.lead_assign.assign")),11,ar)])])):b("",!0)]),_:1})])):b("",!0)]),_:1})]))}},or={class:"font-medium"},lr={class:"h-full flex flex-col -m-4 sm:-m-6 lg:-m-8"},nr={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 lg:px-8 py-3"},dr={class:"flex items-center justify-between"},ir={class:"flex items-center gap-4"},cr={class:"flex items-center gap-3"},ur={class:"text-lg font-bold text-gray-900 dark:text-white"},gr={class:"text-sm text-gray-500 dark:text-gray-400"},xr={class:"flex items-center gap-2"},br=["title"],mr=["href"],hr=["title"],yr={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 lg:px-8 py-3"},pr={class:"flex items-center gap-2"},vr=["onClick","title"],fr={class:"flex-1 overflow-auto"},kr={class:"h-full flex"},wr={class:"w-80 flex-shrink-0 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 overflow-y-auto"},_r={class:"p-6 border-b border-gray-200 dark:border-gray-700"},$r={class:"flex flex-col items-center text-center mb-6"},Cr={class:"text-xl font-bold text-gray-900 dark:text-white"},jr={key:0,class:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1 mt-1"},Mr={class:"space-y-3"},zr={class:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center group-hover:bg-green-200 dark:group-hover:bg-green-800/30 transition-colors"},Tr={class:"min-w-0 flex-1 text-left"},Vr={class:"text-xs text-gray-500 dark:text-gray-400"},Br={class:"text-sm font-medium text-gray-900 dark:text-white"},Lr=["href"],Ar={class:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center group-hover:bg-blue-200 dark:group-hover:bg-blue-800/30 transition-colors"},Sr={class:"min-w-0 flex-1"},Ur={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},Hr={class:"p-6 border-b border-gray-200 dark:border-gray-700"},Fr={class:"text-sm font-semibold text-gray-900 dark:text-white mb-4"},Xr={key:0,class:"relative assign-dropdown"},qr={class:"w-10 h-10 rounded-lg bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white font-semibold"},Ir={class:"min-w-0 flex-1 text-left"},Dr={class:"text-xs text-gray-500 dark:text-gray-400"},Pr={class:"text-sm font-medium text-gray-900 dark:text-white"},Er={class:"w-10 h-10 rounded-lg bg-gray-200 dark:bg-gray-600 flex items-center justify-center"},Nr={class:"min-w-0 flex-1 text-left"},Or={class:"text-xs text-gray-500 dark:text-gray-400"},Rr={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Wr={key:0,class:"absolute z-10 mt-2 w-full bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 py-1 max-h-60 overflow-auto"},Zr={class:"w-8 h-8 rounded-lg bg-gray-200 dark:bg-gray-600 flex items-center justify-center"},Yr=["onClick"],Gr={class:"w-8 h-8 rounded-lg bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white text-xs font-semibold"},Jr={key:1,class:"flex items-center justify-between"},Kr={class:"text-sm text-gray-500 dark:text-gray-400"},Qr={class:"w-5 h-5 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white text-xs font-semibold"},eo={class:"w-5 h-5 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white text-xs font-semibold"},to={key:0,class:"p-6 border-b border-gray-200 dark:border-gray-700"},so={class:"text-sm font-semibold text-gray-900 dark:text-white mb-4"},ao={class:"space-y-4"},ro={class:"flex items-center justify-between"},oo={class:"text-sm text-gray-500 dark:text-gray-400"},lo={class:"text-sm font-semibold text-green-600 dark:text-green-400"},no={class:"flex items-center justify-between"},io={class:"text-sm text-gray-500 dark:text-gray-400"},co={class:"text-sm font-medium text-gray-900 dark:text-white"},uo={class:"p-6 border-b border-gray-200 dark:border-gray-700"},go={class:"text-sm font-semibold text-gray-900 dark:text-white mb-4"},xo={class:"grid grid-cols-2 gap-2"},bo=["href"],mo=["href"],ho={class:"text-xs font-medium"},yo={class:"text-xs font-medium"},po={class:"text-xs font-medium"},vo={class:"text-xs font-medium"},fo={class:"p-6"},ko={class:"text-sm font-semibold text-gray-900 dark:text-white mb-4"},wo={class:"space-y-4"},_o={class:"flex gap-3"},$o={class:"w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center flex-shrink-0"},Co={class:"text-sm font-medium text-gray-900 dark:text-white"},jo={class:"text-xs text-gray-500 dark:text-gray-400"},Mo={key:0,class:"flex gap-3"},zo={class:"w-8 h-8 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center flex-shrink-0"},To={class:"text-sm font-medium text-gray-900 dark:text-white"},Vo={class:"text-xs text-gray-500 dark:text-gray-400"},Bo={class:"flex-1 flex flex-col bg-gray-50 dark:bg-gray-900"},Lo={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6"},Ao={class:"flex gap-1"},So=["onClick"],Uo={class:"flex-1 overflow-y-auto p-6"},Ho={key:0,class:"max-w-3xl mx-auto"},Fo={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 mb-6"},Xo={class:"flex items-start gap-4"},qo={class:"flex-1"},Io={key:0},Do=["placeholder"],Po={key:1},Eo=["placeholder"],No={class:"flex items-center justify-between mt-3"},Oo={class:"flex items-center gap-2"},Ro=["title"],Wo=["title"],Zo={class:"flex items-center gap-2"},Yo=["disabled"],Go=["disabled"],Jo={key:0,class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},Ko={key:0,class:"text-center py-12"},Qo={class:"text-gray-500 dark:text-gray-400 mt-4"},el={key:1,class:"space-y-4"},tl={class:"flex items-start gap-4"},sl={class:"flex-1 min-w-0"},al={class:"flex items-center justify-between mb-1"},rl={class:"flex items-center gap-2"},ol={class:"text-sm font-semibold text-gray-900 dark:text-white"},ll={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},nl=["title"],dl={class:"text-sm text-gray-600 dark:text-gray-400"},il={key:2,class:"text-center py-12"},cl={class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},ul={class:"text-gray-500 dark:text-gray-400"},gl={key:1,class:"max-w-3xl mx-auto"},xl={class:"space-y-6"},bl={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},ml={class:m(["text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center gap-2"])},hl={class:"grid grid-cols-2 gap-4"},yl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},pl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},vl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 flex items-center justify-between"},fl={key:0,class:"flex gap-2"},kl={key:1,class:"text-sm text-gray-400 dark:text-gray-500 mt-1"},wl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},_l=["placeholder"],$l={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Cl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},jl={value:""},Ml={value:"male"},zl={value:"female"},Tl={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},Vl={class:m(["text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center gap-2"])},Bl={class:"grid grid-cols-2 gap-4"},Ll={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Al={value:""},Sl=["value"],Ul={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Hl={value:""},Fl=["value"],Xl=["placeholder","disabled"],ql={class:"col-span-2"},Il={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Dl=["placeholder"],Pl={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},El={class:m(["text-lg font-semibold text-gray-900 dark:text-white mb-6 flex items-center gap-2"])},Nl={class:"space-y-4"},Ol={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Rl={value:""},Wl=["value"],Zl={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Yl=["placeholder"],Gl={class:"flex justify-end"},Jl=["disabled"],Kl={key:0,class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"},Ql={key:2,class:"space-y-4"},en={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-sm"},tn={class:"flex items-center justify-between flex-wrap gap-4"},sn={class:"flex items-center gap-6 flex-wrap"},an={class:"flex items-center gap-3"},rn={class:"text-xl font-bold text-gray-900 dark:text-white"},on={class:"text-xs text-gray-500 dark:text-gray-400"},ln={class:"flex items-center gap-3"},nn={class:"text-xl font-bold text-gray-900 dark:text-white"},dn={class:"text-xs text-gray-500 dark:text-gray-400"},cn={class:"flex items-center gap-3"},un={class:"text-xl font-bold text-gray-900 dark:text-white"},gn={class:"text-xs text-gray-500 dark:text-gray-400"},xn={class:"flex items-center gap-2"},bn={class:"flex items-center gap-1.5 px-2.5 py-1.5 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},mn={class:"text-sm font-bold text-blue-700 dark:text-blue-400"},hn={class:"flex items-center gap-1.5 px-2.5 py-1.5 bg-orange-50 dark:bg-orange-900/20 rounded-lg"},yn={class:"text-sm font-bold text-orange-700 dark:text-orange-400"},pn=["disabled"],vn={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},fn={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},kn={key:0,class:"text-center py-12"},wn={class:"text-gray-500 dark:text-gray-400 mt-4 text-sm"},_n={key:1,class:"space-y-2"},$n={class:"relative flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 hover:shadow-md shadow-sm transition-all duration-200"},Cn={class:"relative flex-shrink-0"},jn={key:0,class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Mn={key:1,class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},zn={key:0,class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},Tn={key:1,class:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},Vn={class:"flex-1 min-w-0"},Bn={class:"flex items-center gap-2 flex-wrap"},Ln={key:0,class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},An={key:1,class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},Sn=["onClick","disabled","title"],Un={key:0,class:"w-3.5 h-3.5 animate-spin",fill:"none",viewBox:"0 0 24 24"},Hn={key:1,class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Fn={class:"text-xs text-gray-500 dark:text-gray-400"},Xn={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},qn={class:"flex items-center gap-2"},In={key:0,class:"flex items-center gap-1.5 px-2.5 py-1.5 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},Dn={class:"text-sm font-semibold text-gray-700 dark:text-gray-300"},Pn=["onClick","disabled"],En={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Nn={key:1,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},On={key:2,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},Rn=["title"],Wn={key:2,class:"text-center py-12 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-dashed border-gray-300 dark:border-gray-600"},Zn={class:"text-lg font-bold text-gray-900 dark:text-white mb-2"},Yn={class:"text-gray-500 dark:text-gray-400 mb-6 max-w-sm mx-auto text-sm"},Gn={class:"flex items-center justify-center gap-3"},Jn=["disabled"],Kn={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},Qn={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ed={key:3,class:"h-full"},td={key:0,class:"text-center py-12"},sd={class:"text-gray-500 dark:text-gray-400 mt-4"},ad={key:1,class:"grid grid-cols-4 gap-4 h-full"},rd={class:"flex flex-col bg-red-50/50 dark:bg-red-900/10 rounded-xl border border-red-200 dark:border-red-800/30 overflow-hidden"},od={class:"p-3 bg-red-100 dark:bg-red-900/30 border-b border-red-200 dark:border-red-800/30"},ld={class:"flex items-center justify-between"},nd={class:"flex items-center gap-2"},dd={class:"font-semibold text-red-700 dark:text-red-400"},id={class:"text-xs font-bold px-2 py-0.5 bg-red-200 dark:bg-red-800/50 text-red-700 dark:text-red-300 rounded-full"},cd={class:"flex-1 overflow-y-auto p-2 space-y-2"},ud={class:"flex items-center justify-between mb-2"},gd={class:"text-lg font-bold text-red-600 dark:text-red-400"},xd={class:"font-medium text-gray-900 dark:text-white text-sm mb-1"},bd={class:"text-xs text-red-500 dark:text-red-400 mb-2"},md={class:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700"},hd=["onClick"],yd={class:"flex gap-1"},pd=["onClick"],vd=["onClick"],fd={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},kd={class:"text-xs"},wd={class:"flex flex-col bg-blue-50/50 dark:bg-blue-900/10 rounded-xl border border-blue-200 dark:border-blue-800/30 overflow-hidden"},_d={class:"p-3 bg-blue-100 dark:bg-blue-900/30 border-b border-blue-200 dark:border-blue-800/30"},$d={class:"flex items-center justify-between"},Cd={class:"flex items-center gap-2"},jd={class:"font-semibold text-blue-700 dark:text-blue-400"},Md={class:"text-xs font-bold px-2 py-0.5 bg-blue-200 dark:bg-blue-800/50 text-blue-700 dark:text-blue-300 rounded-full"},zd={class:"flex-1 overflow-y-auto p-2 space-y-2"},Td={class:"flex items-center justify-between mb-2"},Vd={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},Bd={class:"font-medium text-gray-900 dark:text-white text-sm mb-1"},Ld={key:0,class:"mb-2"},Ad={class:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700"},Sd=["onClick"],Ud={class:"flex gap-1"},Hd=["onClick"],Fd=["onClick"],Xd={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},qd={class:"text-xs"},Id={class:"p-2 border-t border-blue-200 dark:border-blue-800/30"},Dd={class:"flex flex-col bg-indigo-50/50 dark:bg-indigo-900/10 rounded-xl border border-indigo-200 dark:border-indigo-800/30 overflow-hidden"},Pd={class:"p-3 bg-indigo-100 dark:bg-indigo-900/30 border-b border-indigo-200 dark:border-indigo-800/30"},Ed={class:"flex items-center justify-between"},Nd={class:"flex items-center gap-2"},Od={class:"font-semibold text-indigo-700 dark:text-indigo-400"},Rd={class:"text-xs font-bold px-2 py-0.5 bg-indigo-200 dark:bg-indigo-800/50 text-indigo-700 dark:text-indigo-300 rounded-full"},Wd={class:"flex-1 overflow-y-auto p-2 space-y-2"},Zd={class:"flex items-center justify-between mb-2"},Yd={class:"text-lg font-bold text-indigo-600 dark:text-indigo-400"},Gd={class:"font-medium text-gray-900 dark:text-white text-sm mb-1"},Jd={key:0,class:"mb-2"},Kd={class:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700"},Qd=["onClick"],e0={class:"flex gap-1"},t0=["onClick"],s0=["onClick"],a0={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},r0={class:"text-xs"},o0={class:"flex flex-col bg-purple-50/50 dark:bg-purple-900/10 rounded-xl border border-purple-200 dark:border-purple-800/30 overflow-hidden"},l0={class:"p-3 bg-purple-100 dark:bg-purple-900/30 border-b border-purple-200 dark:border-purple-800/30"},n0={class:"flex items-center justify-between"},d0={class:"flex items-center gap-2"},i0={class:"font-semibold text-purple-700 dark:text-purple-400"},c0={class:"text-xs font-bold px-2 py-0.5 bg-purple-200 dark:bg-purple-800/50 text-purple-700 dark:text-purple-300 rounded-full"},u0={class:"flex-1 overflow-y-auto p-2 space-y-2"},g0={class:"flex items-center justify-between mb-2"},x0={class:"text-lg font-bold text-purple-600 dark:text-purple-400"},b0={class:"font-medium text-gray-900 dark:text-white text-sm mb-1"},m0={class:"text-xs text-purple-500 dark:text-purple-400 mb-2"},h0={class:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700"},y0=["onClick"],p0={class:"flex gap-1"},v0=["onClick"],f0=["onClick"],k0={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},w0={class:"text-xs"},_0={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},$0={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md mx-4 shadow-xl z-10"},C0={class:"text-center"},j0={class:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4"},M0={class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},z0={class:"text-gray-500 dark:text-gray-400 mb-6"},T0={class:"flex gap-3"},V0={__name:"LeadShow",props:{lead:{type:Object,required:!0},operators:{type:Array,default:()=>[]},sources:{type:Array,default:()=>[]},regions:{type:Object,default:()=>({})},districts:{type:Object,default:()=>({})},canAssignLeads:{type:Boolean,default:!1},panelType:{type:String,required:!0,validator:i=>["saleshead","business","operator"].includes(i)}},setup(i){const{t:n}=pe(),d=i;E(()=>d.panelType==="saleshead"?"/sales-head":d.panelType==="operator"?"/operator/leads":"/business/api/sales"),E(()=>d.panelType==="saleshead"?"/sales-head/leads":d.panelType==="operator"?"/operator/leads":route("business.sales.index"));const T=E(()=>d.panelType==="saleshead"?"/sales-head/leads":d.panelType==="operator"?"/operator/leads":route("business.sales.index")),v=E(()=>d.panelType==="saleshead"?{primary:"emerald",gradient:"from-emerald-500 to-teal-600",ring:"focus:ring-emerald-500",bg:"bg-emerald-600 hover:bg-emerald-700",bgDisabled:"disabled:bg-emerald-400",border:"border-emerald-500",text:"text-emerald-600 dark:text-emerald-400",bgLight:"bg-emerald-50 dark:bg-emerald-900/20",spinner:"border-emerald-500"}:{primary:"blue",gradient:"from-blue-500 to-purple-600",ring:"focus:ring-blue-500",bg:"bg-blue-600 hover:bg-blue-700",bgDisabled:"disabled:bg-blue-400",border:"border-blue-500",text:"text-blue-600 dark:text-blue-400",bgLight:"bg-blue-50 dark:bg-blue-900/20",spinner:"border-blue-500"}),M=h(!1),H=h(!1),$=h(!1),V=h(!1),_=h(!1),F=h(null),x=h({name:d.lead.name||"",phone:d.lead.phone||"",phone2:d.lead.phone2||"",email:d.lead.email||"",company:d.lead.company||"",birth_date:d.lead.birth_date||"",gender:d.lead.gender||"",region:d.lead.region||"",district:d.lead.district||"",address:d.lead.address||"",source_id:d.lead.source_id||"",notes:d.lead.notes||""}),z=h(!1),L=h(!!d.lead.phone2),q=E(()=>!x.value.region||!d.districts[x.value.region]?{}:d.districts[x.value.region]),W=()=>{x.value.district&&d.districts[x.value.region]&&d.districts[x.value.region][x.value.district]||(x.value.district="")},O=h(!1),G=h(null),A=h({overdue:[],today:[],tomorrow:[],this_week:[],later:[],completed:[]}),w=h(!1),B=h([]),C=h({total_calls:0,outbound_calls:0,inbound_calls:0,answered_calls:0,missed_calls:0,total_duration:0,avg_duration:0,answer_rate:0,total_duration_formatted:"0:00"}),f=h(!1),p=h(null),y=h(null),u=h(null),Z=(c,s)=>{u.value&&u.value.pause(),u.value=new Audio(s),u.value.play().catch(t=>{console.error("Audio playback error:",t),I("error","Audio ijro etishda xatolik"),p.value=null}),u.value.onended=()=>{p.value=null,u.value=null},u.value.onerror=()=>{I("error","Audio faylni yuklab bo'lmadi"),p.value=null,u.value=null},p.value=c.id},tt=async c=>{if(p.value===c.id){u.value&&(u.value.pause(),u.value=null),p.value=null;return}if(c.recording_url){Z(c,c.recording_url);return}y.value=c.id;try{const s=d.panelType==="saleshead"?"/sales-head":"/business/api/sales",t=await P.get(`${s}/calls/${c.id}/recording`);if(t.data.success&&t.data.recording_url){const k=B.value.findIndex(re=>re.id===c.id);k!==-1&&(B.value[k].recording_url=t.data.recording_url),Z(c,t.data.recording_url)}else I("error",t.data.error||"Yozuv topilmadi")}catch(s){console.error("Failed to fetch recording:",s),I("error","Yozuvni yuklashda xatolik")}finally{y.value=null}},be=h(null),st=async(c,s)=>{if(be.value!==c.id){be.value=c.id;try{const t=await P.patch(`/business/api/sales/calls/${c.id}/status`,{status:s});if(t.data.success){const k=B.value.findIndex(re=>re.id===c.id);k!==-1&&(B.value[k]={...B.value[k],status:t.data.call.status,full_label:t.data.call.full_label,duration:t.data.call.duration,duration_formatted:t.data.call.duration_formatted}),I("success",t.data.message),De()}}catch(t){console.error("Failed to update call status:",t),I("error",t.response?.data?.error||"Statusni yangilashda xatolik")}finally{be.value=null}}},te=h(""),ve=h(!1),le=h(!1),Te=h([]),Ve=h(!1),Y=h({show:!1,type:"success",message:""}),I=(c,s)=>{Y.value={show:!0,type:c,message:s},setTimeout(()=>{Y.value.show=!1},3e3)},K=c=>{const s=d.panelType==="saleshead"?"/sales-head/leads":"/business/api/sales/leads";return{activities:`${s}/${d.lead.id}/activities`,notes:`${s}/${d.lead.id}/notes`,status:`${s}/${d.lead.id}/status`,assign:`${s}/${d.lead.id}/assign`,update:`${s}/${d.lead.id}`,delete:`${s}/${d.lead.id}`,calls:`${s}/${d.lead.id}/calls`,tasks:d.panelType==="saleshead"?`/sales-head/leads/${d.lead.id}/tasks`:route("business.tasks.lead",d.lead.id)}[c]},Q=async()=>{Ve.value=!0;try{const c=await P.get(K("activities"));Te.value=c.data.activities||[]}catch(c){console.error("Failed to load activities:",c)}finally{Ve.value=!1}},at=c=>({created:Ge,updated:ye,status_changed:Re,note_added:He,assigned:Me,contacted:ue,task_created:Ue,task_completed:R})[c]||je,rt=c=>({created:"bg-emerald-500",updated:"bg-blue-500",status_changed:"bg-purple-500",note_added:"bg-teal-500",assigned:"bg-orange-500",contacted:"bg-green-500",task_created:"bg-indigo-500",task_completed:"bg-green-600"})[c]||"bg-gray-500",ne=h(!1),de=h("activity"),me=h(!1),Be=h(!1);h({title:"",type:"task",priority:"normal",due_date:"",due_time:"",description:""}),h({}),h(!1);const ot=async()=>{try{const c=d.panelType==="saleshead"?"/business/sms/status":route("business.sms.status"),s=await P.get(c);H.value=s.data.connected}catch(c){console.error("Failed to check SMS status:",c)}},fe=E(()=>({new:{label:n("leads.pipeline.new"),color:"bg-blue-500",bgLight:"bg-blue-50 dark:bg-blue-900/20",text:"text-blue-600 dark:text-blue-400",icon:Vt},contacted:{label:n("leads.pipeline.contacted"),color:"bg-indigo-500",bgLight:"bg-indigo-50 dark:bg-indigo-900/20",text:"text-indigo-600 dark:text-indigo-400",icon:ue},callback:{label:n("leads.pipeline.callback"),color:"bg-purple-500",bgLight:"bg-purple-50 dark:bg-purple-900/20",text:"text-purple-600 dark:text-purple-400",icon:je},considering:{label:n("leads.pipeline.considering"),color:"bg-orange-500",bgLight:"bg-orange-50 dark:bg-orange-900/20",text:"text-orange-600 dark:text-orange-400",icon:He},meeting_scheduled:{label:n("leads.pipeline.meeting_scheduled"),color:"bg-yellow-500",bgLight:"bg-yellow-50 dark:bg-yellow-900/20",text:"text-yellow-600 dark:text-yellow-400",icon:he},meeting_attended:{label:n("leads.pipeline.meeting_attended"),color:"bg-teal-500",bgLight:"bg-teal-50 dark:bg-teal-900/20",text:"text-teal-600 dark:text-teal-400",icon:Tt},won:{label:n("leads.pipeline.won"),color:"bg-green-500",bgLight:"bg-green-50 dark:bg-green-900/20",text:"text-green-600 dark:text-green-400",icon:R},lost:{label:n("leads.pipeline.lost"),color:"bg-red-500",bgLight:"bg-red-50 dark:bg-red-900/20",text:"text-red-600 dark:text-red-400",icon:We}})),Ie=["new","contacted","callback","considering","meeting_scheduled","meeting_attended","won"],ke=E(()=>fe.value[d.lead.status]||fe.value.new),lt=E(()=>Ie.indexOf(d.lead.status)),nt=c=>c?zt(c):n("leads.show.not_specified"),dt=async()=>{z.value=!0;try{const c=await P.put(K("update"),x.value);I("success",c.data.message||"Ma'lumotlar saqlandi"),ie.reload({only:["lead"]}),Q()}catch(c){console.error("Error saving lead:",c),I("error",c.response?.data?.message||"Xatolik yuz berdi")}finally{z.value=!1}},it=async()=>{if(te.value.trim()){le.value=!0;try{await P.post(K("notes"),{note:te.value.trim()}),te.value="",ve.value=!1,I("success","Izoh qo'shildi"),Q()}catch(c){console.error("Error adding note:",c),I("error","Izoh qo'shishda xatolik")}finally{le.value=!1}}},De=async()=>{f.value=!0;try{const c=await P.get(K("calls"));B.value=c.data.calls||[],C.value=c.data.stats||{total_calls:0,outbound_calls:0,inbound_calls:0,answered_calls:0,missed_calls:0,total_duration:0,avg_duration:0,answer_rate:0,total_duration_formatted:"0:00"}}catch(c){console.error("Failed to load calls:",c)}finally{f.value=!1}},se=h(!1),Pe=async()=>{se.value=!0;try{const c=d.panelType==="saleshead"?"/sales-head/leads":"/business/api/sales/leads",s=await P.post(`${c}/${d.lead.id}/sync-calls`);if(s.data.success)if(B.value=s.data.calls||[],C.value=s.data.stats||C.value,s.data.warning)I("warning",s.data.message);else{const t=s.data.synced||0,k=s.data.linked||0;let re=`Sinxronlandi: ${t} ta yangi`;k>0&&(re+=`, ${k} ta ulandi`),I("success",re)}else I("error",s.data.error||"Sinxronlash xatosi")}catch(c){console.error("Failed to sync calls:",c);const s=c.response?.data?.error;s&&(s.includes("autentifikatsiya")||s.includes("key_id"))?I("error","PBX sozlamalari xato. Telefoniya sozlamalarini tekshiring."):c.response?.status===404?I("error","PBX ulangan emas"):I("error",s||"Sinxronlash xatosi")}finally{se.value=!1}},we=async()=>{w.value=!0;try{const c=await P.get(K("tasks"));A.value=c.data.tasks||{overdue:[],today:[],tomorrow:[],this_week:[],later:[],completed:[]}}catch(c){console.error("Failed to load tasks:",c)}finally{w.value=!1}},ae=(c=null)=>{G.value=c,O.value=!0},ct=()=>{O.value=!1,G.value=null},ut=()=>{we()},_e=async c=>{try{const s=d.panelType==="saleshead"?`/sales-head/tasks/${c.id}/complete`:route("business.tasks.complete",c.id);await P.post(s),we()}catch(s){console.error("Failed to complete task:",s)}},$e=async c=>{if(confirm("Vazifani o'chirmoqchimisiz?"))try{const s=d.panelType==="saleshead"?`/sales-head/tasks/${c.id}`:route("business.tasks.destroy",c.id);await P.delete(s),we()}catch(s){console.error("Failed to delete task:",s)}},Le=c=>c?c.split(" ").map(s=>s[0]).join("").toUpperCase().slice(0,2):"??",gt=async()=>{try{d.panelType==="saleshead"?(await P.delete(K("delete")),ie.visit("/sales-head/leads")):ie.delete(route("business.sales.destroy",d.lead.id),{onSuccess:()=>{ne.value=!1}})}catch(c){console.error("Error deleting lead:",c)}},xt=async c=>{try{await P.post(K("status"),{status:c}),ie.reload({only:["lead"]}),Q()}catch(s){console.error("Error updating status:",s)}},Ee=async c=>{Be.value=!0;try{await P.post(K("assign"),{assigned_to:c}),me.value=!1,ie.reload({only:["lead"]}),Q()}catch(s){console.error("Error assigning lead:",s)}finally{Be.value=!1}},Ne=()=>{F.value={...d.lead},_.value=!0},bt=c=>{F.value&&(F.value.assigned_to=c.assigned_to),ie.reload({only:["lead"]}),Q()},Ae=()=>{$.value=!0},mt=()=>{$.value=!1},ht=E(()=>[{id:"activity",label:n("leads.show.tab_activity"),icon:je},{id:"info",label:n("leads.show.tab_info"),icon:Fe},{id:"calls",label:n("leads.show.tab_calls"),icon:ue},{id:"tasks",label:n("leads.show.tab_tasks"),icon:R}]),Oe=c=>{c.target.closest(".assign-dropdown")||(me.value=!1)};return pt(()=>{document.addEventListener("click",Oe),we(),Q(),De(),ot()}),vt(()=>{document.removeEventListener("click",Oe)}),(c,s)=>(o(),l("div",null,[g(a(ft),{title:i.lead.name},null,8,["title"]),(o(),U(ge,{to:"body"},[g(ee,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform translate-y-2 opacity-0","enter-to-class":"transform translate-y-0 opacity-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform translate-y-0 opacity-100","leave-to-class":"transform translate-y-2 opacity-0"},{default:J(()=>[Y.value.show?(o(),l("div",{key:0,class:m(["fixed top-4 right-4 z-[100] flex items-center gap-3 px-4 py-3 rounded-xl shadow-lg",{"bg-emerald-500 text-white":Y.value.type==="success","bg-amber-500 text-white":Y.value.type==="warning","bg-red-500 text-white":Y.value.type==="error"}])},[Y.value.type==="success"?(o(),U(a(R),{key:0,class:"w-5 h-5"})):Y.value.type==="warning"?(o(),U(a(Xe),{key:1,class:"w-5 h-5"})):(o(),U(a(We),{key:2,class:"w-5 h-5"})),e("span",or,r(Y.value.message),1),e("button",{onClick:s[0]||(s[0]=t=>Y.value.show=!1),class:"ml-2 p-1 hover:bg-white/20 rounded-lg transition-colors"},[g(a(oe),{class:"w-4 h-4"})])],2)):b("",!0)]),_:1})])),e("div",lr,[e("div",nr,[e("div",dr,[e("div",ir,[g(a(kt),{href:T.value,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},{default:J(()=>[g(a(Bt),{class:"w-5 h-5"})]),_:1},8,["href"]),e("div",cr,[e("div",{class:m(["w-10 h-10 rounded-full bg-gradient-to-br flex items-center justify-center text-white font-semibold text-sm shadow-lg",v.value.gradient])},r(Le(i.lead.name)),3),e("div",null,[e("h1",ur,r(i.lead.name),1),e("p",gr,r(i.lead.company||i.lead.phone),1)])])]),e("div",xr,[i.lead.phone?(o(),l("button",{key:0,onClick:Ae,class:"p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition-colors",title:a(n)("leads.show.call")},[g(a(ue),{class:"w-5 h-5"})],8,br)):b("",!0),i.lead.email?(o(),l("a",{key:1,href:`mailto:${i.lead.email}`,class:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Email"},[g(a(Ze),{class:"w-5 h-5"})],8,mr)):b("",!0),e("button",{onClick:s[1]||(s[1]=t=>ne.value=!0),class:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:a(n)("leads.show.delete")},[g(a(ce),{class:"w-5 h-5"})],8,hr)])])]),e("div",yr,[e("div",pr,[(o(),l(S,null,D(Ie,(t,k)=>e("button",{key:t,onClick:re=>xt(t),class:m(["flex-1 h-2 rounded-full transition-all duration-300 hover:opacity-80",k<=lt.value?fe.value[i.lead.status].color:"bg-gray-200 dark:bg-gray-700"]),title:fe.value[t].label},null,10,vr)),64)),e("span",{class:m(["ml-4 inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium",ke.value.bgLight,ke.value.text])},[(o(),U(Se(ke.value.icon),{class:"w-4 h-4"})),j(" "+r(ke.value.label),1)],2)])]),e("div",fr,[e("div",kr,[e("div",wr,[e("div",_r,[e("div",$r,[e("div",{class:m(["w-24 h-24 rounded-2xl bg-gradient-to-br flex items-center justify-center text-white font-bold text-3xl shadow-xl mb-4",v.value.gradient])},r(Le(i.lead.name)),3),e("h2",Cr,r(i.lead.name),1),i.lead.company?(o(),l("p",jr,[g(a(_t),{class:"w-4 h-4"}),j(" "+r(i.lead.company),1)])):b("",!0)]),e("div",Mr,[i.lead.phone?(o(),l("button",{key:0,onClick:Ae,class:"w-full flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors group cursor-pointer"},[e("div",zr,[g(a(ue),{class:"w-5 h-5 text-green-600 dark:text-green-400"})]),e("div",Tr,[e("p",Vr,r(a(n)("leads.show.phone")),1),e("p",Br,r(i.lead.phone),1)]),g(a(Ye),{class:"w-5 h-5 text-green-500 opacity-0 group-hover:opacity-100 transition-opacity"})])):b("",!0),i.lead.email?(o(),l("a",{key:1,href:`mailto:${i.lead.email}`,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors group"},[e("div",Ar,[g(a(Ze),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),e("div",Sr,[s[37]||(s[37]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Email",-1)),e("p",Ur,r(i.lead.email),1)]),g(a(At),{class:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})],8,Lr)):b("",!0)])]),e("div",Hr,[e("h3",Fr,r(a(n)("leads.show.operator")),1),i.panelType==="saleshead"?(o(),l("div",Xr,[e("button",{onClick:s[2]||(s[2]=Je(t=>me.value=!me.value,["stop"])),class:"w-full flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[i.lead.assigned_to?(o(),l(S,{key:0},[e("span",qr,r(i.lead.assigned_to.name?.charAt(0)?.toUpperCase()),1),e("div",Ir,[e("p",Dr,r(a(n)("leads.show.assigned")),1),e("p",Pr,r(i.lead.assigned_to.name),1)])],64)):(o(),l(S,{key:1},[e("span",Er,[g(a(Me),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"})]),e("div",Nr,[e("p",Or,r(a(n)("leads.show.operator")),1),e("p",Rr,r(a(n)("leads.show.not_assigned")),1)])],64)),Be.value?(o(),U(a(Re),{key:2,class:"w-5 h-5 text-gray-400 animate-spin"})):b("",!0)]),g(ee,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:J(()=>[me.value?(o(),l("div",Wr,[e("button",{onClick:s[3]||(s[3]=t=>Ee(null)),class:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},[e("span",Zr,[g(a(oe),{class:"w-4 h-4"})]),j(" "+r(a(n)("leads.show.remove_assignment")),1)]),(o(!0),l(S,null,D(i.operators,t=>(o(),l("button",{key:t.id,onClick:k=>Ee(t.id),class:m(["w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",{"bg-emerald-50 dark:bg-emerald-900/20":i.lead.assigned_to?.id===t.id}])},[e("span",Gr,r(t.name?.charAt(0)?.toUpperCase()),1),j(" "+r(t.name),1)],10,Yr))),128))])):b("",!0)]),_:1})])):(o(),l("div",Jr,[e("span",Kr,r(a(n)("leads.show.operator")),1),i.canAssignLeads?(o(),l("button",{key:0,onClick:Ne,class:m(["flex items-center gap-2 text-sm font-medium hover:text-orange-600 dark:hover:text-orange-400 transition-colors",i.lead.assigned_to?"text-gray-900 dark:text-white":"text-gray-400 dark:text-gray-500"])},[i.lead.assigned_to?(o(),l(S,{key:0},[e("span",Qr,r(i.lead.assigned_to.name?.charAt(0)?.toUpperCase()),1),j(" "+r(i.lead.assigned_to.name),1)],64)):(o(),l(S,{key:1},[j(r(a(n)("leads.show.not_assigned")),1)],64))],2)):(o(),l("span",{key:1,class:m(["flex items-center gap-2 text-sm font-medium",i.lead.assigned_to?"text-gray-900 dark:text-white":"text-gray-400 dark:text-gray-500"])},[i.lead.assigned_to?(o(),l(S,{key:0},[e("span",eo,r(i.lead.assigned_to.name?.charAt(0)?.toUpperCase()),1),j(" "+r(i.lead.assigned_to.name),1)],64)):(o(),l(S,{key:1},[j(r(a(n)("leads.show.not_assigned")),1)],64))],2))]))]),i.panelType==="business"?(o(),l("div",to,[e("h3",so,r(a(n)("leads.show.deal_info")),1),e("div",ao,[e("div",ro,[e("span",oo,r(a(n)("leads.show.estimated_value")),1),e("span",lo,r(nt(i.lead.estimated_value)),1)]),e("div",no,[e("span",io,r(a(n)("leads.show.source")),1),e("span",co,r(i.lead.source?.name||a(n)("leads.show.not_specified")),1)])])])):b("",!0),e("div",uo,[e("h3",go,r(a(n)("leads.show.quick_actions")),1),e("div",xo,[i.lead.phone?(o(),l("a",{key:0,href:`https://wa.me/${i.lead.phone.replace(/\D/g,"")}`,target:"_blank",class:"flex flex-col items-center gap-2 p-3 bg-emerald-50 dark:bg-emerald-900/20 hover:bg-emerald-100 dark:hover:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 rounded-xl transition-colors"},[...s[38]||(s[38]=[e("svg",{class:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})],-1),e("span",{class:"text-xs font-medium"},"WhatsApp",-1)])],8,bo)):b("",!0),i.lead.phone?(o(),l("a",{key:1,href:`https://t.me/${i.lead.phone.replace(/\D/g,"")}`,target:"_blank",class:"flex flex-col items-center gap-2 p-3 bg-sky-50 dark:bg-sky-900/20 hover:bg-sky-100 dark:hover:bg-sky-900/30 text-sky-700 dark:text-sky-400 rounded-xl transition-colors"},[g(a(et),{class:"w-6 h-6"}),s[39]||(s[39]=e("span",{class:"text-xs font-medium"},"Telegram",-1))],8,mo)):b("",!0),i.lead.phone&&H.value?(o(),l("button",{key:2,onClick:s[4]||(s[4]=t=>M.value=!0),class:"flex flex-col items-center gap-2 p-3 bg-teal-50 dark:bg-teal-900/20 hover:bg-teal-100 dark:hover:bg-teal-900/30 text-teal-700 dark:text-teal-400 rounded-xl transition-colors"},[...s[40]||(s[40]=[e("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1),e("span",{class:"text-xs font-medium"},"SMS",-1)])])):b("",!0),i.lead.phone?(o(),l("button",{key:3,onClick:Ae,class:"flex flex-col items-center gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-400 rounded-xl transition-colors"},[g(a(Ye),{class:"w-6 h-6"}),e("span",ho,r(a(n)("leads.show.call")),1)])):b("",!0),e("button",{onClick:s[5]||(s[5]=t=>ae()),class:"flex flex-col items-center gap-2 p-3 bg-purple-50 dark:bg-purple-900/20 hover:bg-purple-100 dark:hover:bg-purple-900/30 text-purple-700 dark:text-purple-400 rounded-xl transition-colors"},[g(a(Ue),{class:"w-6 h-6"}),e("span",yo,r(a(n)("leads.show.task")),1)]),e("button",{onClick:s[6]||(s[6]=t=>V.value=!0),class:"flex flex-col items-center gap-2 p-3 bg-green-50 dark:bg-green-900/20 hover:bg-green-100 dark:hover:bg-green-900/30 text-green-700 dark:text-green-400 rounded-xl transition-colors"},[g(a(Qe),{class:"w-6 h-6"}),e("span",po,r(a(n)("leads.show.payment")),1)]),i.canAssignLeads&&i.panelType==="business"?(o(),l("button",{key:4,onClick:Ne,class:"flex flex-col items-center gap-2 p-3 bg-orange-50 dark:bg-orange-900/20 hover:bg-orange-100 dark:hover:bg-orange-900/30 text-orange-700 dark:text-orange-400 rounded-xl transition-colors"},[g(a(Me),{class:"w-6 h-6"}),e("span",vo,r(a(n)("leads.show.assign")),1)])):b("",!0)])]),e("div",fo,[e("h3",ko,r(a(n)("leads.show.timeline")),1),e("div",wo,[e("div",_o,[e("div",$o,[g(a(he),{class:"w-4 h-4 text-blue-600 dark:text-blue-400"})]),e("div",null,[e("p",Co,r(a(n)("leads.show.created")),1),e("p",jo,r(i.lead.created_at),1)])]),i.lead.last_contacted_at?(o(),l("div",Mo,[e("div",zo,[g(a(ue),{class:"w-4 h-4 text-green-600 dark:text-green-400"})]),e("div",null,[e("p",To,r(a(n)("leads.show.last_contact")),1),e("p",Vo,r(i.lead.last_contacted_at),1)])])):b("",!0)])])]),e("div",Bo,[e("div",Lo,[e("nav",Ao,[(o(!0),l(S,null,D(ht.value,t=>(o(),l("button",{key:t.id,onClick:k=>de.value=t.id,class:m(["flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 -mb-px transition-colors",de.value===t.id?`${v.value.border} ${v.value.text}`:"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"])},[(o(),U(Se(t.icon),{class:"w-4 h-4"})),j(" "+r(t.label),1)],10,So))),128))])]),e("div",Uo,[de.value==="activity"?(o(),l("div",Ho,[e("div",Fo,[e("div",Xo,[e("div",{class:m(["w-10 h-10 rounded-full bg-gradient-to-br flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",v.value.gradient])},r(Le(i.lead.name)),3),e("div",qo,[ve.value?(o(),l("div",Po,[X(e("textarea",{"onUpdate:modelValue":s[8]||(s[8]=t=>te.value=t),rows:"3",class:m(["w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 resize-none",v.value.ring,"focus:ring-2 focus:border-transparent"]),placeholder:a(n)("leads.show.add_note_placeholder"),autofocus:""},null,10,Eo),[[N,te.value]]),e("div",No,[e("div",Oo,[e("button",{onClick:s[9]||(s[9]=t=>ae()),class:m(["p-2 text-gray-400 rounded-lg transition-colors",`hover:${v.value.text} hover:${v.value.bgLight}`]),title:a(n)("leads.show.add_task")},[g(a(Ue),{class:"w-5 h-5"})],10,Ro),i.lead.phone?(o(),l("button",{key:0,onClick:s[10]||(s[10]=t=>M.value=!0),class:"p-2 text-gray-400 hover:text-teal-600 dark:hover:text-teal-400 hover:bg-teal-50 dark:hover:bg-teal-900/20 rounded-lg transition-colors",title:a(n)("leads.show.send_sms")},[g(a(Ut),{class:"w-5 h-5"})],8,Wo)):b("",!0)]),e("div",Zo,[e("button",{onClick:s[11]||(s[11]=t=>{ve.value=!1,te.value=""}),disabled:le.value,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50"},r(a(n)("common.cancel")),9,Yo),e("button",{onClick:it,disabled:!te.value.trim()||le.value,class:m(["px-4 py-2 text-white font-medium rounded-lg transition-colors flex items-center gap-2",v.value.bg,v.value.bgDisabled,"disabled:cursor-not-allowed"])},[le.value?(o(),l("span",Jo)):b("",!0),j(" "+r(le.value?a(n)("common.saving"):a(n)("common.save")),1)],10,Go)])])])):(o(),l("div",Io,[e("input",{type:"text",onFocus:s[7]||(s[7]=t=>ve.value=!0),class:m(["w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 cursor-text",v.value.ring,"focus:ring-2 focus:border-transparent"]),placeholder:a(n)("leads.show.add_note_placeholder")},null,42,Do)]))])])]),Ve.value?(o(),l("div",Ko,[e("div",{class:m(["w-8 h-8 border-4 border-t-transparent rounded-full animate-spin mx-auto",v.value.spinner])},null,2),e("p",Qo,r(a(n)("common.loading")),1)])):Te.value.length>0?(o(),l("div",el,[(o(!0),l(S,null,D(Te.value,t=>(o(),l("div",{key:t.id,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},[e("div",tl,[e("div",{class:m(["w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0",rt(t.type)])},[(o(),U(Se(at(t.type)),{class:"w-5 h-5 text-white"}))],2),e("div",sl,[e("div",al,[e("div",rl,[e("h4",ol,r(t.title),1),t.user?(o(),l("span",ll," - "+r(t.user.name),1)):b("",!0)]),e("span",{class:"text-xs text-gray-500 dark:text-gray-400",title:t.created_at},r(t.created_at_human),9,nl)]),e("p",dl,r(t.description),1)])])]))),128))])):(o(),l("div",il,[g(a(je),{class:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),e("h3",cl,r(a(n)("leads.show.no_activity")),1),e("p",ul,r(a(n)("leads.show.no_activity_desc")),1)]))])):b("",!0),de.value==="info"?(o(),l("div",gl,[e("div",xl,[e("div",bl,[e("h3",ml,[g(a(Fe),{class:m(["w-5 h-5",v.value.text])},null,8,["class"]),j(" "+r(a(n)("leads.show.personal_info")),1)]),e("div",hl,[e("div",null,[e("label",yl,r(a(n)("leads.show.full_name"))+" *",1),X(e("input",{"onUpdate:modelValue":s[12]||(s[12]=t=>x.value.name=t),type:"text",class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[N,x.value.name]])]),e("div",null,[e("label",pl,r(a(n)("leads.show.phone_number")),1),X(e("input",{"onUpdate:modelValue":s[13]||(s[13]=t=>x.value.phone=t),type:"text",placeholder:"+998 XX XXX XX XX",class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[N,x.value.phone]])]),e("div",null,[e("label",vl,[e("span",null,r(a(n)("leads.show.additional_phone")),1),L.value?b("",!0):(o(),l("button",{key:0,onClick:s[14]||(s[14]=t=>L.value=!0),type:"button",class:m(["text-xs font-medium",v.value.text])}," + "+r(a(n)("common.add")),3))]),L.value?(o(),l("div",fl,[X(e("input",{"onUpdate:modelValue":s[15]||(s[15]=t=>x.value.phone2=t),type:"text",placeholder:"+998 XX XXX XX XX",class:m(["flex-1 px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[N,x.value.phone2]]),e("button",{onClick:s[16]||(s[16]=t=>{L.value=!1,x.value.phone2=""}),type:"button",class:"px-3 py-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"},[g(a(oe),{class:"w-5 h-5"})])])):(o(),l("p",kl,r(a(n)("common.none")),1))]),e("div",null,[s[41]||(s[41]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Email",-1)),X(e("input",{"onUpdate:modelValue":s[17]||(s[17]=t=>x.value.email=t),type:"email",placeholder:"email@example.com",class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[N,x.value.email]])]),e("div",null,[e("label",wl,r(a(n)("leads.show.company")),1),X(e("input",{"onUpdate:modelValue":s[18]||(s[18]=t=>x.value.company=t),type:"text",placeholder:a(n)("leads.show.company_placeholder"),class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},null,10,_l),[[N,x.value.company]])]),e("div",null,[e("label",$l,r(a(n)("leads.show.birth_date")),1),X(e("input",{"onUpdate:modelValue":s[19]||(s[19]=t=>x.value.birth_date=t),type:"date",class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},null,2),[[N,x.value.birth_date]])]),e("div",null,[e("label",Cl,r(a(n)("leads.show.gender")),1),X(e("select",{"onUpdate:modelValue":s[20]||(s[20]=t=>x.value.gender=t),class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},[e("option",jl,r(a(n)("common.select")),1),e("option",Ml,r(a(n)("leads.show.gender_male")),1),e("option",zl,r(a(n)("leads.show.gender_female")),1)],2),[[Ce,x.value.gender]])])])]),e("div",Tl,[e("h3",Vl,[g(a(Lt),{class:m(["w-5 h-5",v.value.text])},null,8,["class"]),j(" "+r(a(n)("leads.show.address_info")),1)]),e("div",Bl,[e("div",null,[e("label",Ll,r(a(n)("leads.show.region")),1),X(e("select",{"onUpdate:modelValue":s[21]||(s[21]=t=>x.value.region=t),onChange:W,class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},[e("option",Al,r(a(n)("common.select")),1),(o(!0),l(S,null,D(i.regions,(t,k)=>(o(),l("option",{key:k,value:k},r(t),9,Sl))),128))],34),[[Ce,x.value.region]])]),e("div",null,[e("label",Ul,r(a(n)("leads.show.district")),1),x.value.region&&Object.keys(q.value).length>0?X((o(),l("select",{key:0,"onUpdate:modelValue":s[22]||(s[22]=t=>x.value.district=t),class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},[e("option",Hl,r(a(n)("common.select")),1),(o(!0),l(S,null,D(q.value,(t,k)=>(o(),l("option",{key:k,value:k},r(t),9,Fl))),128))],2)),[[Ce,x.value.district]]):X((o(),l("input",{key:1,"onUpdate:modelValue":s[23]||(s[23]=t=>x.value.district=t),type:"text",placeholder:a(n)("leads.show.select_region_first"),disabled:!x.value.region,class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed",v.value.ring,"focus:ring-2 focus:border-transparent"])},null,10,Xl)),[[N,x.value.district]])]),e("div",ql,[e("label",Il,r(a(n)("leads.show.full_address")),1),X(e("input",{"onUpdate:modelValue":s[24]||(s[24]=t=>x.value.address=t),type:"text",placeholder:a(n)("leads.show.address_placeholder"),class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},null,10,Dl),[[N,x.value.address]])])])]),e("div",Pl,[e("h3",El,[g(a(He),{class:m(["w-5 h-5",v.value.text])},null,8,["class"]),j(" "+r(a(n)("leads.show.additional_info")),1)]),e("div",Nl,[e("div",null,[e("label",Ol,r(a(n)("leads.show.lead_source")),1),X(e("select",{"onUpdate:modelValue":s[25]||(s[25]=t=>x.value.source_id=t),class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white",v.value.ring,"focus:ring-2 focus:border-transparent"])},[e("option",Rl,r(a(n)("common.select")),1),(o(!0),l(S,null,D(i.sources,t=>(o(),l("option",{key:t.id,value:t.id},r(t.name),9,Wl))),128))],2),[[Ce,x.value.source_id]])]),e("div",null,[e("label",Zl,r(a(n)("leads.show.notes")),1),X(e("textarea",{"onUpdate:modelValue":s[26]||(s[26]=t=>x.value.notes=t),rows:"4",placeholder:a(n)("leads.show.notes_placeholder"),class:m(["w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white resize-none",v.value.ring,"focus:ring-2 focus:border-transparent"])},null,10,Yl),[[N,x.value.notes]])])])]),e("div",Gl,[e("button",{onClick:dt,disabled:z.value,class:m(["px-6 py-3 text-white font-medium rounded-xl transition-colors flex items-center gap-2 shadow-lg",v.value.bg,v.value.bgDisabled,"disabled:cursor-not-allowed"])},[z.value?(o(),l("span",Kl)):(o(),U(a(R),{key:1,class:"w-5 h-5"})),j(" "+r(z.value?a(n)("common.saving"):a(n)("common.save")),1)],10,Jl)])])])):b("",!0),de.value==="calls"?(o(),l("div",Ql,[e("div",en,[e("div",tn,[e("div",sn,[e("div",an,[s[42]||(s[42]=e("div",{class:"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-md shadow-blue-500/25"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1)),e("div",null,[e("p",rn,r(C.value.total_calls),1),e("p",on,r(a(n)("leads.show.total")),1)])]),s[48]||(s[48]=e("div",{class:"w-px h-8 bg-gray-200 dark:bg-gray-700"},null,-1)),e("div",ln,[s[44]||(s[44]=e("div",{class:"w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center shadow-md shadow-emerald-500/25"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",null,[e("p",nn,[j(r(C.value.answer_rate),1),s[43]||(s[43]=e("span",{class:"text-sm text-gray-400"},"%",-1))]),e("p",dn,r(a(n)("leads.show.answered")),1)])]),s[49]||(s[49]=e("div",{class:"w-px h-8 bg-gray-200 dark:bg-gray-700"},null,-1)),e("div",cn,[s[45]||(s[45]=e("div",{class:"w-10 h-10 rounded-xl bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center shadow-md shadow-violet-500/25"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",null,[e("p",un,r(C.value.total_duration_formatted||"0:00"),1),e("p",gn,r(a(n)("leads.show.duration")),1)])]),s[50]||(s[50]=e("div",{class:"w-px h-8 bg-gray-200 dark:bg-gray-700"},null,-1)),e("div",xn,[e("div",bn,[s[46]||(s[46]=e("svg",{class:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})],-1)),e("span",mn,r(C.value.inbound_calls||0),1)]),e("div",hn,[s[47]||(s[47]=e("svg",{class:"w-4 h-4 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 10l7-7m0 0l7 7m-7-7v18"})],-1)),e("span",yn,r(C.value.outbound_calls||0),1)])])]),e("button",{onClick:Pe,disabled:se.value,class:"flex items-center gap-2 px-4 py-2 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200 text-sm font-medium rounded-lg transition-all disabled:opacity-50"},[se.value?(o(),l("svg",vn,[...s[51]||(s[51]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(o(),l("svg",fn,[...s[52]||(s[52]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),j(" "+r(se.value?a(n)("leads.show.syncing"):a(n)("leads.show.sync")),1)],8,pn)])]),f.value?(o(),l("div",kn,[s[53]||(s[53]=e("div",{class:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"},null,-1)),e("p",wn,r(a(n)("leads.show.loading_calls")),1)])):B.value.length>0?(o(),l("div",_n,[(o(!0),l(S,null,D(B.value,t=>(o(),l("div",{key:t.id,class:"group"},[e("div",$n,[e("div",Cn,[e("div",{class:m(["w-10 h-10 rounded-xl flex items-center justify-center shadow-md",t.direction==="inbound"?"bg-gradient-to-br from-blue-500 to-indigo-600 shadow-blue-500/20":"bg-gradient-to-br from-orange-500 to-amber-600 shadow-orange-500/20"])},[t.direction==="inbound"?(o(),l("svg",jn,[...s[54]||(s[54]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"},null,-1)])])):(o(),l("svg",Mn,[...s[55]||(s[55]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"},null,-1)])]))],2),e("div",{class:m(["absolute -bottom-0.5 -right-0.5 w-4 h-4 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center",t.status==="completed"||t.status==="answered"?"bg-emerald-500":t.status==="missed"||t.status==="no_answer"||t.status==="failed"||t.status==="cancelled"?"bg-red-500":t.status==="busy"?"bg-amber-500":t.status==="ringing"||t.status==="initiated"?"bg-blue-500":"bg-gray-400"])},[t.status==="completed"||t.status==="answered"?(o(),l("svg",zn,[...s[56]||(s[56]=[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):t.status==="missed"||t.status==="no_answer"||t.status==="failed"||t.status==="cancelled"?(o(),l("svg",Tn,[...s[57]||(s[57]=[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)])])):b("",!0)],2)]),e("div",Vn,[e("div",Bn,[e("span",{class:m(["inline-flex items-center text-xs font-semibold px-2 py-0.5 rounded",t.direction==="inbound"?"bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300":"bg-orange-100 text-orange-700 dark:bg-orange-900/40 dark:text-orange-300"])},r(t.direction==="inbound"?a(n)("leads.show.inbound"):a(n)("leads.show.outbound")),3),e("span",{class:m(["inline-flex items-center gap-1 text-xs font-medium px-2 py-0.5 rounded",t.status==="completed"||t.status==="answered"?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300":t.status==="missed"||t.status==="no_answer"||t.status==="failed"||t.status==="cancelled"?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-300":t.status==="busy"?"bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-300":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300"])},[t.status==="completed"||t.status==="answered"?(o(),l("svg",Ln,[...s[58]||(s[58]=[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):t.status==="missed"||t.status==="no_answer"||t.status==="failed"||t.status==="cancelled"?(o(),l("svg",An,[...s[59]||(s[59]=[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)])])):b("",!0),j(" "+r(t.status==="completed"||t.status==="answered"?a(n)("leads.show.call_answered"):t.status==="missed"||t.status==="no_answer"||t.status==="failed"||t.status==="cancelled"?a(n)("leads.show.call_missed"):t.status==="busy"?a(n)("leads.show.call_busy"):t.status==="ringing"?a(n)("leads.show.call_ringing"):t.status),1)],2),e("button",{onClick:k=>st(t,t.status==="completed"||t.status==="answered"?"missed":"completed"),disabled:be.value===t.id,class:m(["p-1 rounded transition-all",t.status==="completed"||t.status==="answered"?"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20":"text-gray-400 hover:text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/20"]),title:t.status==="completed"||t.status==="answered"?a(n)("leads.show.mark_missed"):a(n)("leads.show.mark_answered")},[be.value===t.id?(o(),l("svg",Un,[...s[60]||(s[60]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(o(),l("svg",Hn,[...s[61]||(s[61]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"},null,-1)])]))],10,Sn),s[62]||(s[62]=e("span",{class:"text-gray-300 dark:text-gray-600"},"",-1)),e("span",Fn,r(t.created_at),1),t.operator_name?(o(),l("span",Xn,"  "+r(t.operator_name),1)):b("",!0)])]),e("div",qn,[t.duration>0?(o(),l("div",In,[s[63]||(s[63]=e("svg",{class:"w-3.5 h-3.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Dn,r(t.duration_formatted),1)])):b("",!0),t.status==="completed"||t.status==="answered"||t.recording_url?(o(),l("button",{key:1,onClick:k=>tt(t),disabled:y.value===t.id,class:m(["flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all",p.value===t.id?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-md shadow-blue-500/25":y.value===t.id?"bg-gray-100 text-gray-400 dark:bg-gray-700 dark:text-gray-500 cursor-wait":"bg-blue-50 text-blue-600 hover:bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400 dark:hover:bg-blue-900/50"])},[y.value===t.id?(o(),l("svg",En,[...s[64]||(s[64]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):p.value===t.id?(o(),l("svg",Nn,[...s[65]||(s[65]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)])])):(o(),l("svg",On,[...s[66]||(s[66]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1)])])),j(" "+r(y.value===t.id?a(n)("common.loading"):p.value===t.id?a(n)("common.stop"):a(n)("leads.show.recording")),1)],10,Pn)):b("",!0),e("button",{onClick:s[27]||(s[27]=k=>$.value=!0),class:"p-2 text-gray-400 hover:text-green-600 dark:hover:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition-all opacity-0 group-hover:opacity-100",title:a(n)("leads.show.callback")},[...s[67]||(s[67]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)])],8,Rn)])])]))),128))])):(o(),l("div",Wn,[s[71]||(s[71]=e("div",{class:"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-2xl flex items-center justify-center mx-auto mb-4"},[e("svg",{class:"w-8 h-8 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1)),e("h3",Zn,r(a(n)("leads.show.no_calls")),1),e("p",Yn,r(a(n)("leads.show.no_calls_desc")),1),e("div",Gn,[e("button",{onClick:Pe,disabled:se.value,class:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200 text-sm font-medium rounded-lg transition-all disabled:opacity-50"},[se.value?(o(),l("svg",Kn,[...s[68]||(s[68]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(o(),l("svg",Qn,[...s[69]||(s[69]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),j(" "+r(a(n)("leads.show.sync")),1)],8,Jn),e("button",{onClick:s[28]||(s[28]=t=>$.value=!0),class:m(["flex items-center gap-2 px-4 py-2 text-white text-sm font-medium rounded-lg transition-all shadow-md",v.value.bg])},[s[70]||(s[70]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),j(" "+r(a(n)("leads.show.make_call")),1)],2)])]))])):b("",!0),de.value==="tasks"?(o(),l("div",ed,[w.value?(o(),l("div",td,[e("div",{class:m(["w-8 h-8 border-4 border-t-transparent rounded-full animate-spin mx-auto",v.value.spinner])},null,2),e("p",sd,r(a(n)("common.loading")),1)])):(o(),l("div",ad,[e("div",rd,[e("div",od,[e("div",ld,[e("div",nd,[s[72]||(s[72]=e("div",{class:"w-3 h-3 rounded-full bg-red-500"},null,-1)),e("span",dd,r(a(n)("leads.show.tasks_overdue")),1)]),e("span",id,r(A.value.overdue?.length||0),1)])]),e("div",cd,[(o(!0),l(S,null,D(A.value.overdue,t=>(o(),l("div",{key:t.id,class:"bg-white dark:bg-gray-800 rounded-lg border border-red-200 dark:border-red-700/50 p-3 shadow-sm hover:shadow-md transition-shadow"},[e("div",ud,[e("span",gd,r(t.due_date_human),1),e("span",{class:m(["text-xs px-2 py-0.5 rounded font-medium",t.type==="call"?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":t.type==="meeting"?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"])},r(t.type_label),3)]),e("h4",xd,r(t.title),1),e("p",bd,r(t.due_date_full?.split(" ")[0]),1),e("div",md,[e("button",{onClick:k=>_e(t),class:"text-xs text-green-600 hover:text-green-700 font-medium"},r(a(n)("leads.show.task_done")),9,hd),e("div",yd,[e("button",{onClick:k=>ae(t),class:"p-1 text-gray-400 hover:text-blue-600"},[g(a(ye),{class:"w-4 h-4"})],8,pd),e("button",{onClick:k=>$e(t),class:"p-1 text-gray-400 hover:text-red-600"},[g(a(ce),{class:"w-4 h-4"})],8,vd)])])]))),128)),A.value.overdue?.length?b("",!0):(o(),l("div",fd,[g(a(R),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),e("p",kd,r(a(n)("common.none")),1)]))])]),e("div",wd,[e("div",_d,[e("div",$d,[e("div",Cd,[s[73]||(s[73]=e("div",{class:"w-3 h-3 rounded-full bg-blue-500"},null,-1)),e("span",jd,r(a(n)("leads.show.tasks_today")),1)]),e("span",Md,r(A.value.today?.length||0),1)])]),e("div",zd,[(o(!0),l(S,null,D(A.value.today,t=>(o(),l("div",{key:t.id,class:"bg-white dark:bg-gray-800 rounded-lg border border-blue-200 dark:border-blue-700/50 p-3 shadow-sm hover:shadow-md transition-shadow"},[e("div",Td,[e("span",Vd,r(t.due_date_human),1),e("span",{class:m(["text-xs px-2 py-0.5 rounded font-medium",t.type==="call"?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":t.type==="meeting"?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"])},r(t.type_label),3)]),e("h4",Bd,r(t.title),1),t.priority==="urgent"||t.priority==="high"?(o(),l("div",Ld,[e("span",{class:m(["text-xs px-2 py-0.5 rounded font-bold",t.priority==="urgent"?"bg-red-100 text-red-700 animate-pulse":"bg-orange-100 text-orange-700"])},r(t.priority_label),3)])):b("",!0),e("div",Ad,[e("button",{onClick:k=>_e(t),class:"text-xs text-green-600 hover:text-green-700 font-medium"},r(a(n)("leads.show.task_done")),9,Sd),e("div",Ud,[e("button",{onClick:k=>ae(t),class:"p-1 text-gray-400 hover:text-blue-600"},[g(a(ye),{class:"w-4 h-4"})],8,Hd),e("button",{onClick:k=>$e(t),class:"p-1 text-gray-400 hover:text-red-600"},[g(a(ce),{class:"w-4 h-4"})],8,Fd)])])]))),128)),A.value.today?.length?b("",!0):(o(),l("div",Xd,[g(a(he),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),e("p",qd,r(a(n)("common.none")),1)]))]),e("div",Id,[e("button",{onClick:s[29]||(s[29]=t=>ae()),class:"w-full py-2 text-sm text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg transition-colors flex items-center justify-center gap-1"},[g(a(Ge),{class:"w-4 h-4"}),j(" "+r(a(n)("leads.show.add_task_btn")),1)])])]),e("div",Dd,[e("div",Pd,[e("div",Ed,[e("div",Nd,[s[74]||(s[74]=e("div",{class:"w-3 h-3 rounded-full bg-indigo-500"},null,-1)),e("span",Od,r(a(n)("leads.show.tasks_tomorrow")),1)]),e("span",Rd,r(A.value.tomorrow?.length||0),1)])]),e("div",Wd,[(o(!0),l(S,null,D(A.value.tomorrow,t=>(o(),l("div",{key:t.id,class:"bg-white dark:bg-gray-800 rounded-lg border border-indigo-200 dark:border-indigo-700/50 p-3 shadow-sm hover:shadow-md transition-shadow"},[e("div",Zd,[e("span",Yd,r(t.due_date_human),1),e("span",{class:m(["text-xs px-2 py-0.5 rounded font-medium",t.type==="call"?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":t.type==="meeting"?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"])},r(t.type_label),3)]),e("h4",Gd,r(t.title),1),t.priority==="urgent"||t.priority==="high"?(o(),l("div",Jd,[e("span",{class:m(["text-xs px-2 py-0.5 rounded font-bold",t.priority==="urgent"?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"])},r(t.priority_label),3)])):b("",!0),e("div",Kd,[e("button",{onClick:k=>_e(t),class:"text-xs text-green-600 hover:text-green-700 font-medium"},r(a(n)("leads.show.task_done")),9,Qd),e("div",e0,[e("button",{onClick:k=>ae(t),class:"p-1 text-gray-400 hover:text-blue-600"},[g(a(ye),{class:"w-4 h-4"})],8,t0),e("button",{onClick:k=>$e(t),class:"p-1 text-gray-400 hover:text-red-600"},[g(a(ce),{class:"w-4 h-4"})],8,s0)])])]))),128)),A.value.tomorrow?.length?b("",!0):(o(),l("div",a0,[g(a(he),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),e("p",r0,r(a(n)("common.none")),1)]))])]),e("div",o0,[e("div",l0,[e("div",n0,[e("div",d0,[s[75]||(s[75]=e("div",{class:"w-3 h-3 rounded-full bg-purple-500"},null,-1)),e("span",i0,r(a(n)("leads.show.tasks_this_week")),1)]),e("span",c0,r(A.value.this_week?.length||0),1)])]),e("div",u0,[(o(!0),l(S,null,D(A.value.this_week,t=>(o(),l("div",{key:t.id,class:"bg-white dark:bg-gray-800 rounded-lg border border-purple-200 dark:border-purple-700/50 p-3 shadow-sm hover:shadow-md transition-shadow"},[e("div",g0,[e("span",x0,r(t.due_date_human),1),e("span",{class:m(["text-xs px-2 py-0.5 rounded font-medium",t.type==="call"?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":t.type==="meeting"?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"])},r(t.type_label),3)]),e("h4",b0,r(t.title),1),e("p",m0,r(t.due_date_full?.split(" ")[0]),1),e("div",h0,[e("button",{onClick:k=>_e(t),class:"text-xs text-green-600 hover:text-green-700 font-medium"},r(a(n)("leads.show.task_done")),9,y0),e("div",p0,[e("button",{onClick:k=>ae(t),class:"p-1 text-gray-400 hover:text-blue-600"},[g(a(ye),{class:"w-4 h-4"})],8,v0),e("button",{onClick:k=>$e(t),class:"p-1 text-gray-400 hover:text-red-600"},[g(a(ce),{class:"w-4 h-4"})],8,f0)])])]))),128)),A.value.this_week?.length?b("",!0):(o(),l("div",k0,[g(a(he),{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),e("p",w0,r(a(n)("common.none")),1)]))])])]))])):b("",!0)])])])])]),(o(),U(ge,{to:"body"},[g(ee,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:J(()=>[ne.value?(o(),l("div",_0,[e("div",{class:"fixed inset-0 bg-black/50",onClick:s[30]||(s[30]=t=>ne.value=!1)}),g(ee,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:J(()=>[ne.value?(o(),l("div",$0,[e("div",C0,[e("div",j0,[g(a(ce),{class:"w-8 h-8 text-red-600 dark:text-red-400"})]),e("h3",M0,r(a(n)("leads.show.delete_lead")),1),e("p",z0,r(a(n)("leads.show.delete_confirm",{name:i.lead.name})),1),e("div",T0,[e("button",{onClick:s[31]||(s[31]=t=>ne.value=!1),class:"flex-1 px-4 py-2.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-medium rounded-xl transition-colors"},r(a(n)("common.cancel")),1),e("button",{onClick:gt,class:"flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white font-medium rounded-xl transition-colors"},r(a(n)("common.delete")),1)])])])):b("",!0)]),_:1})])):b("",!0)]),_:1})])),g(fs,{show:M.value,lead:i.lead,onClose:s[32]||(s[32]=t=>M.value=!1),onSent:s[33]||(s[33]=()=>{Q()})},null,8,["show","lead"]),g(ua,{show:V.value,lead:i.lead,onClose:s[34]||(s[34]=t=>V.value=!1),onCreated:s[35]||(s[35]=()=>{Q()})},null,8,["show","lead"]),g(_a,{show:$.value,lead:i.lead,onClose:mt},null,8,["show","lead"]),g(Mt,{show:O.value,lead:i.lead,task:G.value,onClose:ct,onSaved:ut},null,8,["show","lead","task"]),i.panelType==="business"?(o(),U(rr,{key:0,show:_.value,lead:F.value||i.lead,onClose:s[36]||(s[36]=t=>_.value=!1),onAssigned:bt},null,8,["show","lead"])):b("",!0)]))}},li=Ke(V0,[["__scopeId","data-v-2360f64f"]]);export{li as L};
