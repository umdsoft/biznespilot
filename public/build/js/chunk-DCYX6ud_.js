import{r as w,a as K,o as qt,C as l,z as a,y as $t,x as Vt,A as Tt,H as p,E as D,N as f,Q as h,D as c,S as E,G as j,I as z,B as M,v as Dt,M as Lt,J as B,K as F,L as I,h as m,F as i}from"./chunk-KPSVwAyv.js";import{l as Ht,a as Nt}from"./chunk-BVrjkT6E.js";import{_ as St}from"./chunk-DlAUqK2U.js";const Xt={class:"h-[calc(100vh-8rem)] flex flex-col bg-gray-100 dark:bg-gray-900 -m-6 -mt-4"},Yt={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3 flex items-center justify-between"},Ot={class:"flex items-center gap-4"},Kt={class:"text-lg font-bold text-gray-900 dark:text-white"},Ft={class:"flex items-center gap-2"},It={class:"flex items-center gap-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},Wt={class:"text-xs font-medium w-12 text-center"},At=["disabled"],Rt={key:0,class:"animate-spin w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24"},Pt={key:1,class:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Et={class:"flex-1 flex overflow-hidden"},Qt={class:"w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex flex-col"},Ut={class:"flex-1 overflow-y-auto p-3 space-y-2"},Jt={class:"mb-3"},Gt=["d","stroke","marker-end","onClick"],Zt=["x","y","fill"],te=["d","stroke"],ee=["onMousedown","onClick"],se={class:"flex items-center gap-2"},ae={class:"font-medium text-sm truncate"},re=["onClick"],oe={class:"bg-white dark:bg-gray-800 rounded-b-xl p-3"},ie={key:0,class:"text-xs space-y-1"},le={class:"flex items-center gap-1 text-purple-600 dark:text-purple-400"},ne={key:0},de={key:1,class:"truncate"},ue={key:2,class:"text-gray-400 italic"},ce={key:0,class:"text-gray-500 pl-4"},pe={key:0,class:"text-xs text-gray-600 dark:text-gray-400 line-clamp-2"},ge={key:1,class:"text-xs text-gray-400 dark:text-gray-500 italic"},ve={key:2,class:"text-xs space-y-1"},be={class:"flex items-center gap-1 text-yellow-600 dark:text-yellow-400"},xe={key:0},ye={key:1,class:"text-gray-400 italic"},fe={key:0,class:"text-gray-600 dark:text-gray-400 pl-4"},he={key:0,class:"font-medium text-gray-800 dark:text-gray-200"},me={key:3,class:"text-xs space-y-1"},ke={class:"flex items-center gap-1 text-cyan-600 dark:text-cyan-400"},_e={key:0},we={key:1,class:"text-gray-400 italic"},Me={key:4,class:"text-xs space-y-1"},Ce={class:"flex items-center gap-1 text-indigo-600 dark:text-indigo-400"},je={key:0,class:"truncate"},ze={key:1,class:"text-gray-400 italic"},Be={class:"text-gray-500 pl-4"},qe={key:5,class:"text-xs space-y-1"},$e={class:"flex items-center gap-1 text-amber-600 dark:text-amber-400"},Ve={class:"flex gap-1 flex-wrap pl-4"},Te={key:6,class:"text-xs space-y-1"},De={class:"flex items-center gap-1 text-emerald-600 dark:text-emerald-400"},Le={class:"flex gap-1 flex-wrap pl-4"},He={key:0,class:"text-gray-400 italic"},Ne={key:7,class:"mt-2 flex items-center gap-1 text-xs text-purple-600"},Se={key:8,class:"mt-2 flex items-center gap-1 text-xs text-red-600"},Xe={key:9,class:"mt-2 flex items-center gap-1 text-xs text-gray-600"},Ye={key:10,class:"flex justify-between mt-3 pt-3 border-t border-gray-100 dark:border-gray-700"},Oe=["onMouseup"],Ke={key:1,class:"w-6"},Fe=["onMousedown"],Ie={key:11,class:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700"},We={class:"flex justify-center mb-3"},Ae=["onMouseup"],Re={class:"flex justify-between items-center"},Pe={class:"flex flex-col items-center gap-1"},Ee=["onMousedown"],Qe={class:"flex flex-col items-center gap-1"},Ue=["onMousedown"],Je={key:12,class:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700"},Ge={class:"flex justify-center mb-3"},Ze=["onMouseup"],ts={class:"flex justify-between items-center"},es={class:"flex flex-col items-center gap-1"},ss=["onMousedown"],as={class:"flex flex-col items-center gap-1"},rs=["onMousedown"],os={key:13,class:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700"},is={class:"flex justify-center mb-3"},ls=["onMouseup"],ns={class:"flex flex-wrap justify-center gap-2"},ds=["onMousedown","title"],us={class:"text-[10px] font-medium text-indigo-600 dark:text-indigo-400 max-w-[40px] truncate"},cs={key:14,class:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700"},ps={class:"flex justify-center mb-3"},gs=["onMouseup"],vs={class:"flex justify-center gap-3"},bs=["onMousedown","title"],xs={class:"text-[10px] font-medium text-amber-600 dark:text-amber-400"},ys={key:0,class:"absolute inset-0 flex items-center justify-center pointer-events-none"},fs={class:"w-80 bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 flex flex-col"},hs={class:"p-4 border-b border-gray-200 dark:border-gray-700"},ms={class:"font-semibold text-gray-900 dark:text-white text-sm"},ks={key:0,class:"flex-1 flex items-center justify-center p-4"},_s={key:1,class:"flex-1 overflow-y-auto p-4 space-y-4"},ws={key:0,class:"space-y-3"},Ms={class:"flex items-center justify-between"},Cs={key:0},js={key:1},zs={key:1},Bs={class:"grid grid-cols-4 gap-1"},qs=["onClick"],$s={class:"flex flex-col items-center gap-1"},Vs=["innerHTML"],Ts={class:"text-[10px]"},Ds={key:2},Ls={key:3},Hs={key:4},Ns={key:5},Ss=["value"],Xs={class:"pt-4 border-t border-gray-200 dark:border-gray-700"},Ys={__name:"TelegramFunnelBuilder",props:{bot:Object,funnel:Object,steps:{type:Array,default:()=>[]},panelType:{type:String,required:!0,validator:L=>["business","marketing"].includes(L)}},setup(L){const H=L,Q=(s,t=null)=>{const e=H.panelType==="business"?"business.":"marketing.";return t?route(e+s,t):route(e+s)},q=w(null),at=w(null),y=w(1),x=K({x:100,y:100}),W=w(!1),Y=K({x:0,y:0}),v=w([]),d=w(null),g=w([]),N=w(null),O=K({x:0,y:0}),u=w(null),C=K({x:0,y:0}),U=w(!1),S=w(!1);qt(()=>{H.steps.length>0&&(v.value=H.steps.map((s,t)=>({...s,type:s.step_type,x:s.position_x??100+t%3*280,y:s.position_y??100+Math.floor(t/3)*200,content:s.content||{type:"text",text:""},keyboard:s.keyboard||{type:"inline",buttons:[]},condition:s.condition||{field:"",operator:"",value:"",custom_field:""},condition_true_step_id:s.condition_true_step_id||null,condition_false_step_id:s.condition_false_step_id||null})),v.value.forEach(s=>{s.type==="condition"?(s.condition_true_step_id&&g.value.push({from:s.id,to:s.condition_true_step_id,type:"true"}),s.condition_false_step_id&&g.value.push({from:s.id,to:s.condition_false_step_id,type:"false"})):s.next_step_id&&g.value.push({from:s.id,to:s.next_step_id,type:"default"})}))});const J=()=>{y.value=Math.min(2,y.value+.1)},G=()=>{y.value=Math.max(.25,y.value-.1)},rt=()=>{y.value=1,x.x=100,x.y=100},ot=s=>{s.preventDefault(),s.deltaY<0?J():G()},it=s=>{(s.target===q.value||s.target.tagName==="svg")&&(W.value=!0,Y.x=s.clientX-x.x,Y.y=s.clientY-x.y)},lt=s=>{if(C.x=(s.clientX-x.x)/y.value,C.y=(s.clientY-q.value?.getBoundingClientRect().top-x.y)/y.value,W.value&&(x.x=s.clientX-Y.x,x.y=s.clientY-Y.y),N.value){const t=q.value.getBoundingClientRect();N.value.x=(s.clientX-t.left-x.x)/y.value-O.x,N.value.y=(s.clientY-t.top-x.y)/y.value-O.y}},Z=()=>{W.value=!1,N.value=null},_=(s,t)=>{s.dataTransfer.setData("nodeType",t)},nt=s=>{const t=s.dataTransfer.getData("nodeType");if(!t)return;const e=q.value.getBoundingClientRect(),o=(s.clientX-e.left-x.x)/y.value,r=(s.clientY-e.top-x.y)/y.value,b={id:`temp-${Date.now()}`,name:A(t),type:t==="start"?"message":t,step_type:t==="start"?"message":t,x:o,y:r,content:{type:"text",text:t==="start"?"Assalomu alaykum! Botga xush kelibsiz.":""},keyboard:{type:"inline",buttons:[]},input_type:t==="input"?"text":"none",input_field:null,action_type:"none",delay_seconds:t==="delay"?5:null,next_step_id:null,order:v.value.length,is_first:t==="start"||t==="trigger_keyword"||v.value.length===0,condition:t==="condition"?{field:"",operator:"",value:"",custom_field:""}:null,condition_true_step_id:null,condition_false_step_id:null,subscribe_check:t==="subscribe_check"?{channel_id:"",channel_username:"",not_subscribed_message:"Kanalga obuna bo'lishingiz kerak!",subscribe_button_text:"Obuna bo'lish"}:null,subscribe_true_step_id:null,subscribe_false_step_id:null,quiz:t==="quiz"?{question:"",options:[{text:"",next_step_id:null},{text:"",next_step_id:null}],allow_multiple:!1,save_answer_to:""}:null,ab_test:t==="ab_test"?{variants:[{name:"A",percentage:50,next_step_id:null},{name:"B",percentage:50,next_step_id:null}]}:null,tag:t==="tag"?{action:"add",tags:[],new_tag:""}:null,trigger:t==="trigger_keyword"?{keywords:"",match_type:"contains",is_all_messages:!1}:null};v.value.push(b),d.value=b},dt=(s,t)=>{const e=q.value.getBoundingClientRect();O.x=(s.clientX-e.left-x.x)/y.value-t.x,O.y=(s.clientY-e.top-x.y)/y.value-t.y,N.value=t},ut=s=>{d.value=s},tt=s=>{if(!confirm("Bu qadamni o'chirishni xohlaysizmi?"))return;const t=v.value.findIndex(e=>e.id===s);t>-1&&(v.value.splice(t,1),g.value=g.value.filter(e=>e.from!==s&&e.to!==s),d.value?.id===s&&(d.value=null))},$=(s,t,e="default")=>{t.preventDefault(),t.stopPropagation(),U.value=!0,u.value={from:s,type:e}},X=s=>{if(u.value&&u.value.from!==s){const t=v.value.find(o=>o.id===u.value.from),e=u.value.type||"default";e==="true"||e==="false"?(g.value=g.value.filter(o=>!(o.from===u.value.from&&o.type===e)),g.value.push({from:u.value.from,to:s,type:e}),t&&(e==="true"?t.condition_true_step_id=s:t.condition_false_step_id=s)):(g.value=g.value.filter(o=>!(o.from===u.value.from&&(!o.type||o.type==="default"))),g.value.push({from:u.value.from,to:s,type:"default"}),t&&(t.next_step_id=s))}et()},et=()=>{u.value=null,U.value=!1},ct=s=>{if(!u.value)return;const t=q.value?.getBoundingClientRect();t&&(C.x=(s.clientX-t.left-x.x)/y.value,C.y=(s.clientY-t.top-x.y)/y.value)},pt=()=>{d.value&&(g.value=g.value.filter(s=>!(s.from===d.value.id&&(!s.type||s.type==="default"))),d.value.next_step_id&&g.value.push({from:d.value.id,to:d.value.next_step_id,type:"default"}))},gt=s=>{if(!confirm("Bu bog'lanishni o'chirishni xohlaysizmi?"))return;const t=v.value.find(e=>e.id===s.from);if(s.type==="true"&&t)t.condition_true_step_id=null;else if(s.type==="false"&&t)t.condition_false_step_id=null;else if(s.type==="subscribed"&&t)t.subscribe_true_step_id=null;else if(s.type==="not_subscribed"&&t)t.subscribe_false_step_id=null;else if(s.type?.startsWith("option_")&&t){const e=parseInt(s.type.split("_")[1]);t.quiz?.options?.[e]&&(t.quiz.options[e].next_step_id=null)}else if(s.type?.startsWith("variant_")&&t){const e=parseInt(s.type.split("_")[1]);t.ab_test?.variants?.[e]&&(t.ab_test.variants[e].next_step_id=null)}else t&&(t.next_step_id=null);g.value=g.value.filter(e=>!(e.from===s.from&&e.to===s.to&&e.type===s.type))},vt=s=>{const t=v.value.find(V=>V.id===s.from),e=v.value.find(V=>V.id===s.to);if(!t||!e)return"";let o,r;if(t.type==="condition")s.type==="true"?(o=t.x+35,r=t.y+160):s.type==="false"?(o=t.x+185,r=t.y+160):(o=t.x+110,r=t.y+150);else if(t.type==="subscribe_check")s.type==="subscribed"?(o=t.x+35,r=t.y+140):s.type==="not_subscribed"?(o=t.x+185,r=t.y+140):(o=t.x+110,r=t.y+130);else if(t.type==="quiz"){const V=t.quiz?.options?.length||2;if(s.type?.startsWith("option_")){const R=parseInt(s.type.split("_")[1]),P=180/(V+1);o=t.x+30+P*(R+1),r=t.y+160}else o=t.x+110,r=t.y+150}else if(t.type==="ab_test"){const V=t.ab_test?.variants?.length||2;if(s.type?.startsWith("variant_")){const R=parseInt(s.type.split("_")[1]),P=180/(V+1);o=t.x+30+P*(R+1),r=t.y+140}else o=t.x+110,r=t.y+130}else o=t.x+110,r=t.y+120;const b=e.x+110,n=e.y+10,k=Math.abs(n-r),T=Math.min(k*.5,80);return`M ${o} ${r} C ${o} ${r+T}, ${b} ${n-T}, ${b} ${n}`},bt=()=>{if(!u.value)return"";const s=v.value.find(b=>b.id===u.value.from);if(!s)return"";let t,e;if(s.type==="condition")u.value.type==="true"?(t=s.x+35,e=s.y+160):u.value.type==="false"?(t=s.x+185,e=s.y+160):(t=s.x+110,e=s.y+150);else if(s.type==="subscribe_check")u.value.type==="subscribed"?(t=s.x+35,e=s.y+140):u.value.type==="not_subscribed"?(t=s.x+185,e=s.y+140):(t=s.x+110,e=s.y+130);else if(s.type==="quiz"){const b=s.quiz?.options?.length||2;if(u.value.type?.startsWith("option_")){const n=parseInt(u.value.type.split("_")[1]),k=180/(b+1);t=s.x+30+k*(n+1),e=s.y+160}else t=s.x+110,e=s.y+150}else if(s.type==="ab_test"){const b=s.ab_test?.variants?.length||2;if(u.value.type?.startsWith("variant_")){const n=parseInt(u.value.type.split("_")[1]),k=180/(b+1);t=s.x+30+k*(n+1),e=s.y+140}else t=s.x+110,e=s.y+130}else t=s.x+110,e=s.y+120;const o=Math.abs(C.y-e),r=Math.min(o*.4,60);return`M ${t} ${e} C ${t} ${e+r}, ${C.x} ${C.y-r}, ${C.x} ${C.y}`},xt=s=>s.type==="true"||s.type==="subscribed"?"#22c55e":s.type==="false"||s.type==="not_subscribed"?"#ef4444":s.type?.startsWith("option_")?"#6366f1":s.type?.startsWith("variant_")?"#f59e0b":"#6366f1",yt=s=>s.type==="true"||s.type==="subscribed"?"arrowhead-green":s.type==="false"||s.type==="not_subscribed"?"arrowhead-red":"arrowhead",ft=()=>u.value?u.value.type==="true"||u.value.type==="subscribed"?"#22c55e":u.value.type==="false"||u.value.type==="not_subscribed"?"#ef4444":u.value.type?.startsWith("option_")?"#6366f1":u.value.type?.startsWith("variant_")?"#f59e0b":"#6366f1":"#6366f1",st=s=>{const t=v.value.find(k=>k.id===s.from),e=v.value.find(k=>k.id===s.to);if(!t||!e)return{x:0,y:0};let o;t.type==="condition"?s.type==="true"?o=t.x+35:s.type==="false"?o=t.x+185:o=t.x+110:o=t.x+110;const r=t.type==="condition"?t.y+160:t.y+120,b=e.x+110,n=e.y+10;return{x:(o+b)/2-10,y:(r+n)/2}},ht=[{value:"text",label:"Matn",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 6h16M4 12h16M4 18h10"/></svg>'},{value:"photo",label:"Rasm",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/></svg>'},{value:"video",label:"Video",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M10 9l5 3-5 3V9z"/></svg>'},{value:"voice",label:"Ovoz",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 1v10M8 5v6M4 7v2M16 5v6M20 7v2"/><path d="M12 15a4 4 0 004-4V5a4 4 0 00-8 0v6a4 4 0 004 4z"/><path d="M17 11a5 5 0 01-10 0"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>'},{value:"video_note",label:"Aylana",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M10 9l5 3-5 3V9z"/></svg>'},{value:"document",label:"Fayl",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><path d="M14 2v6h6"/></svg>'}],mt=s=>{if(!d.value)return;const t=d.value.content?.text||d.value.content?.caption||"";d.value.content={type:s,text:s==="text"?t:"",caption:s!=="text"?t:"",file_id:d.value.content?.file_id||"",url:d.value.content?.url||"",duration:d.value.content?.duration||null}},kt=s=>{const t={start:"bg-gradient-to-r from-green-500 to-green-600 text-white",trigger_keyword:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white",message:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",input:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",condition:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white",action:"bg-gradient-to-r from-red-500 to-pink-500 text-white",delay:"bg-gradient-to-r from-gray-500 to-gray-600 text-white",end:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",subscribe_check:"bg-gradient-to-r from-cyan-500 to-teal-500 text-white",quiz:"bg-gradient-to-r from-indigo-500 to-violet-500 text-white",ab_test:"bg-gradient-to-r from-amber-500 to-yellow-500 text-white",tag:"bg-gradient-to-r from-emerald-500 to-green-500 text-white"};return t[s]||t.message},A=s=>({start:"Boshlash",trigger_keyword:"Kalit so'z",message:"Xabar",input:"Ma'lumot",condition:"Shart",action:"Amal",delay:"Kutish",end:"Tugatish",subscribe_check:"Obuna tekshir",quiz:"Savol/Quiz",ab_test:"A/B Test",tag:"Teg"})[s]||s,_t=s=>({render(){const t={start:m("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"})]),trigger_keyword:m("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})]),message:m("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})]),input:m("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),condition:m("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),action:m("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})]),delay:m("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),end:m("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"})])};return t[s]||t.message}}),wt=s=>({none:"Hech biri",text:"Matn",email:"Email",phone:"Telefon",number:"Raqam",location:"Lokatsiya",photo:"Rasm",any:"Istalgan"})[s]||s,Mt=s=>({none:"Hech narsa",create_lead:"Lid yaratish",update_user:"Foydalanuvchi yangilash",handoff:"Operatorga",send_notification:"Xabarnoma",webhook:"Webhook"})[s]||s,Ct=s=>({exact:"To'liq mos",contains:"Ichida bor",starts_with:"Bilan boshlanadi",ends_with:"Bilan tugaydi",regex:"Regex"})[s]||s,jt=s=>({equals:"teng",not_equals:"teng emas",contains:"o'z ichiga oladi",not_contains:"o'z ichiga olmaydi",starts_with:"bilan boshlanadi",ends_with:"bilan tugaydi",is_set:"mavjud",is_empty:"bo'sh",greater_than:"katta",less_than:"kichik",greater_or_equal:"katta yoki teng",less_or_equal:"kichik yoki teng",is_true:"ha (true)",is_false:"yo'q (false)"})[s]||s,zt=s=>({first_name:"Ism",last_name:"Familiya",username:"Username",phone:"Telefon",email:"Email",language_code:"Til kodi",is_premium:"Premium",user_id:"Telegram ID",custom_field:"Maxsus maydon",has_tag:"Teg mavjudligi",quiz_answer:"Quiz javobi",interaction_count:"Interaksiya soni",last_message_date:"Oxirgi xabar",funnel_step:"Joriy qadam"})[s]||s,Bt=async()=>{S.value=!0;try{const t=v.value.filter(r=>r.type!=="end").map((r,b)=>({id:String(r.id).startsWith("temp-")?null:r.id,name:r.name,step_type:r.step_type||r.type,content:r.content,keyboard:r.keyboard,input_type:r.input_type||"none",input_field:r.input_field,action_type:r.action_type||"none",action_config:r.action_config,next_step_id:["condition","subscribe_check","quiz","ab_test"].includes(r.type)?null:r.next_step_id,delay_seconds:r.delay_seconds,order:b,position_x:Math.round(r.x),position_y:Math.round(r.y),condition:r.type==="condition"?r.condition:null,condition_true_step_id:r.condition_true_step_id||null,condition_false_step_id:r.condition_false_step_id||null,subscribe_check:r.type==="subscribe_check"?r.subscribe_check:null,subscribe_true_step_id:r.subscribe_true_step_id||null,subscribe_false_step_id:r.subscribe_false_step_id||null,quiz:r.type==="quiz"?r.quiz:null,ab_test:r.type==="ab_test"?r.ab_test:null,tag:r.type==="tag"?r.tag:null,trigger:r.type==="trigger_keyword"?r.trigger:null})),e=v.value.find(r=>r.is_first)||v.value[0],o=await Nt.post(Q("telegram-funnels.funnels.save-steps",[H.bot.id,H.funnel.id]),{steps:t,first_step_id:e?.id});if(o.data.success){const r=o.data;if(r.steps){const b=v.value.filter(n=>n.type==="end");v.value=r.steps.map(n=>({...n,type:n.step_type,x:n.position_x??100,y:n.position_y??100,content:n.content||{type:"text",text:""},keyboard:n.keyboard||{type:"inline",buttons:[]},condition:n.condition||{field:"",operator:"",value:"",custom_field:""},condition_true_step_id:n.condition_true_step_id||null,condition_false_step_id:n.condition_false_step_id||null,subscribe_check:n.subscribe_check||{channel_id:"",channel_username:"",not_subscribed_message:"",subscribe_button_text:""},subscribe_true_step_id:n.subscribe_true_step_id||null,subscribe_false_step_id:n.subscribe_false_step_id||null,quiz:n.quiz||{question:"",options:[],allow_multiple:!1,save_answer_to:""},ab_test:n.ab_test||{variants:[]},tag:n.tag||{action:"add",tags:[],new_tag:""},trigger:n.trigger||{keywords:"",match_type:"contains",is_all_messages:!1}})),v.value.push(...b),g.value=[],v.value.forEach(n=>{n.type==="condition"?(n.condition_true_step_id&&g.value.push({from:n.id,to:n.condition_true_step_id,type:"true"}),n.condition_false_step_id&&g.value.push({from:n.id,to:n.condition_false_step_id,type:"false"})):n.type==="subscribe_check"?(n.subscribe_true_step_id&&g.value.push({from:n.id,to:n.subscribe_true_step_id,type:"subscribed"}),n.subscribe_false_step_id&&g.value.push({from:n.id,to:n.subscribe_false_step_id,type:"not_subscribed"})):n.type==="quiz"&&n.quiz?.options?n.quiz.options.forEach((k,T)=>{k.next_step_id&&g.value.push({from:n.id,to:k.next_step_id,type:`option_${T}`})}):n.type==="ab_test"&&n.ab_test?.variants?n.ab_test.variants.forEach((k,T)=>{k.next_step_id&&g.value.push({from:n.id,to:k.next_step_id,type:`variant_${T}`})}):n.next_step_id&&g.value.push({from:n.id,to:n.next_step_id,type:"default"})})}alert("Funnel saqlandi!")}else alert(o.data.message||"Xatolik yuz berdi")}catch(s){console.error("Save error:",s),s.response?.status===419?alert("Sessiya tugagan. Sahifani yangilang."):alert(s.response?.data?.message||"Saqlashda xatolik")}finally{S.value=!1}};return(s,t)=>(i(),l("div",Xt,[a("div",Yt,[a("div",Ot,[$t(Tt(Ht),{href:Q("telegram-funnels.funnels.index",L.bot.id),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},{default:Vt(()=>[...t[23]||(t[23]=[a("svg",{class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),_:1},8,["href"]),a("div",null,[a("h1",Kt,p(L.funnel.name),1),t[24]||(t[24]=a("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Visual Funnel Builder",-1))])]),a("div",Ft,[a("div",It,[a("button",{onClick:G,class:"p-1.5 hover:bg-gray-200 dark:hover:bg-gray-600 rounded"},[...t[25]||(t[25]=[a("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1)])]),a("span",Wt,p(Math.round(y.value*100))+"%",1),a("button",{onClick:J,class:"p-1.5 hover:bg-gray-200 dark:hover:bg-gray-600 rounded"},[...t[26]||(t[26]=[a("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),a("button",{onClick:rt,class:"p-1.5 hover:bg-gray-200 dark:hover:bg-gray-600 rounded"},[...t[27]||(t[27]=[a("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1)])])]),t[30]||(t[30]=a("div",{class:"h-6 w-px bg-gray-300 dark:bg-gray-600"},null,-1)),a("button",{onClick:Bt,disabled:S.value,class:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white text-sm font-medium rounded-lg transition-colors"},[S.value?(i(),l("svg",Rt,[...t[28]||(t[28]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):(i(),l("svg",Pt,[...t[29]||(t[29]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),D(" "+p(S.value?"Saqlanmoqda...":"Saqlash"),1)],8,At)])]),a("div",Et,[a("div",Qt,[t[45]||(t[45]=a("div",{class:"p-4 border-b border-gray-200 dark:border-gray-700"},[a("h3",{class:"font-semibold text-gray-900 dark:text-white text-sm"},"Elementlar"),a("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Canvas'ga tortib tashlang")],-1)),a("div",Ut,[a("div",Jt,[t[33]||(t[33]=a("p",{class:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-2 px-1"},"Triggerlar",-1)),a("div",{draggable:"true",onDragstart:t[0]||(t[0]=e=>_(e,"start")),class:"p-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow mb-2"},[...t[31]||(t[31]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Boshlash</p><p class="text-xs opacity-80" data-v-2b54bc78>Funnel boshi</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[1]||(t[1]=e=>_(e,"trigger_keyword")),class:"p-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg cursor-move hover:shadow-lg hover:shadow-purple-500/20 transition-all"},[...t[32]||(t[32]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Kalit so&#39;z</p><p class="text-xs opacity-80" data-v-2b54bc78>Xabarda topilganda</p></div></div>',1)])],32)]),t[44]||(t[44]=a("div",{class:"mb-3"},[a("p",{class:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-2 px-1"},"Xabarlar")],-1)),a("div",{draggable:"true",onDragstart:t[2]||(t[2]=e=>_(e,"message")),class:"p-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[34]||(t[34]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Xabar</p><p class="text-xs opacity-80" data-v-2b54bc78>Matn yuborish</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[3]||(t[3]=e=>_(e,"input")),class:"p-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[35]||(t[35]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Ma&#39;lumot</p><p class="text-xs opacity-80" data-v-2b54bc78>Foydalanuvchidan so&#39;rash</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[4]||(t[4]=e=>_(e,"condition")),class:"p-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[36]||(t[36]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Shart</p><p class="text-xs opacity-80" data-v-2b54bc78>Shartli o&#39;tish</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[5]||(t[5]=e=>_(e,"action")),class:"p-3 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[37]||(t[37]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Amal</p><p class="text-xs opacity-80" data-v-2b54bc78>Lid yaratish, webhook</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[6]||(t[6]=e=>_(e,"subscribe_check")),class:"p-3 bg-gradient-to-r from-cyan-500 to-teal-500 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[38]||(t[38]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Obuna tekshir</p><p class="text-xs opacity-80" data-v-2b54bc78>Kanal a&#39;zoligini</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[7]||(t[7]=e=>_(e,"quiz")),class:"p-3 bg-gradient-to-r from-indigo-500 to-violet-500 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[39]||(t[39]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Savol/Quiz</p><p class="text-xs opacity-80" data-v-2b54bc78>Tanlov berish</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[8]||(t[8]=e=>_(e,"ab_test")),class:"p-3 bg-gradient-to-r from-amber-500 to-yellow-500 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[40]||(t[40]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>A/B Test</p><p class="text-xs opacity-80" data-v-2b54bc78>Tasodifiy bo&#39;lish</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[9]||(t[9]=e=>_(e,"tag")),class:"p-3 bg-gradient-to-r from-emerald-500 to-green-500 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[41]||(t[41]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Teg</p><p class="text-xs opacity-80" data-v-2b54bc78>Foydalanuvchini belgilash</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[10]||(t[10]=e=>_(e,"delay")),class:"p-3 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[42]||(t[42]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Kutish</p><p class="text-xs opacity-80" data-v-2b54bc78>Vaqt kechiktirish</p></div></div>',1)])],32),a("div",{draggable:"true",onDragstart:t[11]||(t[11]=e=>_(e,"end")),class:"p-3 bg-gradient-to-r from-gray-700 to-gray-800 text-white rounded-lg cursor-move hover:shadow-lg transition-shadow"},[...t[43]||(t[43]=[f('<div class="flex items-center gap-2" data-v-2b54bc78><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center" data-v-2b54bc78><svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-2b54bc78></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z" data-v-2b54bc78></path></svg></div><div data-v-2b54bc78><p class="font-medium text-sm" data-v-2b54bc78>Tugatish</p><p class="text-xs opacity-80" data-v-2b54bc78>Funnel tugashi</p></div></div>',1)])],32)])]),a("div",{ref_key:"canvasContainer",ref:q,class:"flex-1 overflow-hidden relative bg-gray-50 dark:bg-gray-900",onDragover:t[12]||(t[12]=h(()=>{},["prevent"])),onDrop:nt,onMousedown:it,onMousemove:lt,onMouseup:Z,onMouseleave:Z,onWheel:ot},[a("div",{class:"absolute inset-0 pointer-events-none",style:E({backgroundImage:"radial-gradient(circle, #d1d5db 1px, transparent 1px)",backgroundSize:`${20*y.value}px ${20*y.value}px`,backgroundPosition:`${x.x}px ${x.y}px`})},null,4),a("div",{ref_key:"canvas",ref:at,class:"absolute",style:E({transform:`translate(${x.x}px, ${x.y}px) scale(${y.value})`,transformOrigin:"0 0"})},[(i(),l("svg",{class:"absolute top-0 left-0 w-[5000px] h-[5000px]",onMouseup:et,onMousemove:ct},[t[46]||(t[46]=f('<defs data-v-2b54bc78><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto" data-v-2b54bc78><polygon points="0 0, 10 3.5, 0 7" fill="#6366f1" data-v-2b54bc78></polygon></marker><marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto" data-v-2b54bc78><polygon points="0 0, 10 3.5, 0 7" fill="#22c55e" data-v-2b54bc78></polygon></marker><marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto" data-v-2b54bc78><polygon points="0 0, 10 3.5, 0 7" fill="#ef4444" data-v-2b54bc78></polygon></marker></defs>',1)),(i(!0),l(j,null,z(g.value,e=>(i(),l("g",{key:`${e.from}-${e.to}-${e.type||"default"}`},[a("path",{d:vt(e),fill:"none",stroke:xt(e),"stroke-width":"2.5","marker-end":`url(#${yt(e)})`,class:"transition-all duration-200 cursor-pointer hover:stroke-opacity-70",onClick:h(o=>gt(e),["stop"])},null,8,Gt),e.type==="true"||e.type==="false"?(i(),l("text",{key:0,x:st(e).x,y:st(e).y,fill:e.type==="true"?"#22c55e":"#ef4444","font-size":"11","font-weight":"600",class:"pointer-events-none select-none"},p(e.type==="true"?"Ha":"Yo'q"),9,Zt)):c("",!0)]))),128)),u.value?(i(),l("path",{key:0,d:bt(),fill:"none",stroke:ft(),"stroke-width":"2.5","stroke-dasharray":"8,4",class:"animate-pulse"},null,8,te)):c("",!0)],32)),(i(!0),l(j,null,z(v.value,e=>(i(),l("div",{key:e.id,style:E({position:"absolute",left:`${e.x}px`,top:`${e.y}px`,width:"220px"}),onMousedown:h(o=>dt(o,e),["stop"]),onClick:h(o=>ut(e),["stop"]),class:M(["rounded-xl shadow-lg transition-all cursor-move",d.value?.id===e.id?"ring-2 ring-blue-500 ring-offset-2":""])},[a("div",{class:M(["rounded-t-xl px-4 py-3 flex items-center justify-between",kt(e.type)])},[a("div",se,[(i(),Dt(Lt(_t(e.type)),{class:"w-5 h-5"})),a("span",ae,p(e.name||A(e.type)),1)]),a("button",{onClick:h(o=>tt(e.id),["stop"]),class:"p-1 hover:bg-white/20 rounded opacity-0 group-hover:opacity-100 transition-opacity"},[...t[47]||(t[47]=[a("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,re)],2),a("div",oe,[e.type==="trigger_keyword"?(i(),l("div",ie,[a("div",le,[t[48]||(t[48]=a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1)),e.trigger?.is_all_messages?(i(),l("span",ne,"Barcha xabarlar")):e.trigger?.keywords?(i(),l("span",de,p(e.trigger.keywords),1)):(i(),l("span",ue,"Kalit so'z kiriting"))]),e.trigger?.match_type&&!e.trigger?.is_all_messages?(i(),l("div",ce,p(Ct(e.trigger.match_type)),1)):c("",!0)])):c("",!0),["condition","subscribe_check","quiz","ab_test","tag","trigger_keyword"].includes(e.type)?c("",!0):(i(),l(j,{key:1},[e.content?.text?(i(),l("p",pe,p(e.content.text),1)):(i(),l("p",ge," Matn kiriting... "))],64)),e.type==="condition"?(i(),l("div",ve,[a("div",be,[t[49]||(t[49]=a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),e.condition?.field?(i(),l("span",xe,p(zt(e.condition.field)),1)):(i(),l("span",ye,"Maydon tanlang"))]),e.condition?.operator?(i(),l("div",fe,[D(p(jt(e.condition.operator))+" ",1),e.condition.value?(i(),l("span",he,'"'+p(e.condition.value)+'"',1)):c("",!0)])):c("",!0)])):c("",!0),e.type==="subscribe_check"?(i(),l("div",me,[a("div",ke,[t[50]||(t[50]=a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e.subscribe_check?.channel_username?(i(),l("span",_e,"@"+p(e.subscribe_check.channel_username),1)):(i(),l("span",we,"Kanal tanlang"))])])):c("",!0),e.type==="quiz"?(i(),l("div",Me,[a("div",Ce,[t[51]||(t[51]=a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e.quiz?.question?(i(),l("span",je,p(e.quiz.question),1)):(i(),l("span",ze,"Savol kiriting"))]),a("div",Be,p(e.quiz?.options?.length||0)+" ta variant ",1)])):c("",!0),e.type==="ab_test"?(i(),l("div",qe,[a("div",$e,[t[52]||(t[52]=a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)),a("span",null,p(e.ab_test?.variants?.length||2)+" ta variant",1)]),a("div",Ve,[(i(!0),l(j,null,z(e.ab_test?.variants||[],(o,r)=>(i(),l("span",{key:r,class:"px-1.5 py-0.5 bg-amber-100 dark:bg-amber-900 text-amber-700 dark:text-amber-300 rounded text-[10px]"},p(o.name)+": "+p(o.percentage)+"% ",1))),128))])])):c("",!0),e.type==="tag"?(i(),l("div",Te,[a("div",De,[t[53]||(t[53]=a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),a("span",null,p(e.tag?.action==="add"?"Qo'shish":"O'chirish"),1)]),a("div",Le,[(i(!0),l(j,null,z(e.tag?.tags||[],(o,r)=>(i(),l("span",{key:r,class:"px-1.5 py-0.5 bg-emerald-100 dark:bg-emerald-900 text-emerald-700 dark:text-emerald-300 rounded text-[10px]"}," #"+p(o),1))),128)),e.tag?.tags?.length?c("",!0):(i(),l("span",He,"Teg tanlang"))])])):c("",!0),e.type==="input"?(i(),l("div",Ne,[t[54]||(t[54]=a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1)),D(" "+p(wt(e.input_type)),1)])):c("",!0),e.type==="action"?(i(),l("div",Se,[t[55]||(t[55]=a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)),D(" "+p(Mt(e.action_type)),1)])):c("",!0),e.type==="delay"?(i(),l("div",Xe,[t[56]||(t[56]=a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),D(" "+p(e.delay_seconds||5)+" soniya ",1)])):c("",!0),["condition","subscribe_check","quiz","ab_test"].includes(e.type)?c("",!0):(i(),l("div",Ye,[e.type!=="start"?(i(),l("div",{key:0,class:M(["w-6 h-6 bg-gray-200 dark:bg-gray-600 rounded-full flex items-center justify-center cursor-pointer hover:bg-blue-500 hover:text-white transition-colors",{"ring-2 ring-blue-400 ring-offset-1":u.value&&u.value.from!==e.id}]),onMouseup:h(o=>X(e.id),["stop"]),title:"Kirish nuqtasi"},[...t[57]||(t[57]=[a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})],-1)])],42,Oe)):(i(),l("div",Ke)),e.type!=="end"?(i(),l("div",{key:2,class:"w-6 h-6 bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 rounded-full flex items-center justify-center cursor-pointer hover:bg-indigo-500 hover:text-white transition-colors",onMousedown:h(o=>$(e.id,o,"default"),["stop"]),title:"Chiqish nuqtasi - tortib tashlang"},[...t[58]||(t[58]=[a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 10l7-7m0 0l7 7m-7-7v18"})],-1)])],40,Fe)):c("",!0)])),e.type==="condition"?(i(),l("div",Ie,[a("div",We,[a("div",{class:M(["w-6 h-6 bg-gray-200 dark:bg-gray-600 rounded-full flex items-center justify-center cursor-pointer hover:bg-blue-500 hover:text-white transition-colors",{"ring-2 ring-blue-400 ring-offset-1":u.value&&u.value.from!==e.id}]),onMouseup:h(o=>X(e.id),["stop"]),title:"Kirish nuqtasi"},[...t[59]||(t[59]=[a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})],-1)])],42,Ae)]),a("div",Re,[a("div",Pe,[a("div",{class:"w-7 h-7 bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-400 rounded-full flex items-center justify-center cursor-pointer hover:bg-green-500 hover:text-white transition-colors font-bold text-xs",onMousedown:h(o=>$(e.id,o,"true"),["stop"]),title:"Ha - shart bajarilsa"}," checkmark ",40,Ee),t[60]||(t[60]=a("span",{class:"text-[10px] font-medium text-green-600 dark:text-green-400"},"Ha",-1))]),a("div",Qe,[a("div",{class:"w-7 h-7 bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-400 rounded-full flex items-center justify-center cursor-pointer hover:bg-red-500 hover:text-white transition-colors font-bold text-xs",onMousedown:h(o=>$(e.id,o,"false"),["stop"]),title:"Yo'q - shart bajarilmasa"}," x ",40,Ue),t[61]||(t[61]=a("span",{class:"text-[10px] font-medium text-red-600 dark:text-red-400"},"Yo'q",-1))])])])):c("",!0),e.type==="subscribe_check"?(i(),l("div",Je,[a("div",Ge,[a("div",{class:M(["w-6 h-6 bg-gray-200 dark:bg-gray-600 rounded-full flex items-center justify-center cursor-pointer hover:bg-blue-500 hover:text-white transition-colors",{"ring-2 ring-blue-400 ring-offset-1":u.value&&u.value.from!==e.id}]),onMouseup:h(o=>X(e.id),["stop"]),title:"Kirish nuqtasi"},[...t[62]||(t[62]=[a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})],-1)])],42,Ze)]),a("div",ts,[a("div",es,[a("div",{class:"w-7 h-7 bg-cyan-100 dark:bg-cyan-900 text-cyan-600 dark:text-cyan-400 rounded-full flex items-center justify-center cursor-pointer hover:bg-cyan-500 hover:text-white transition-colors font-bold text-xs",onMousedown:h(o=>$(e.id,o,"subscribed"),["stop"]),title:"Obuna bo'lgan"}," checkmark ",40,ss),t[63]||(t[63]=a("span",{class:"text-[10px] font-medium text-cyan-600 dark:text-cyan-400"},"Obuna",-1))]),a("div",as,[a("div",{class:"w-7 h-7 bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-400 rounded-full flex items-center justify-center cursor-pointer hover:bg-red-500 hover:text-white transition-colors font-bold text-xs",onMousedown:h(o=>$(e.id,o,"not_subscribed"),["stop"]),title:"Obuna bo'lmagan"}," x ",40,rs),t[64]||(t[64]=a("span",{class:"text-[10px] font-medium text-red-600 dark:text-red-400"},"Yo'q",-1))])])])):c("",!0),e.type==="quiz"?(i(),l("div",os,[a("div",is,[a("div",{class:M(["w-6 h-6 bg-gray-200 dark:bg-gray-600 rounded-full flex items-center justify-center cursor-pointer hover:bg-blue-500 hover:text-white transition-colors",{"ring-2 ring-blue-400 ring-offset-1":u.value&&u.value.from!==e.id}]),onMouseup:h(o=>X(e.id),["stop"]),title:"Kirish nuqtasi"},[...t[65]||(t[65]=[a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})],-1)])],42,ls)]),a("div",ns,[(i(!0),l(j,null,z(e.quiz?.options||[],(o,r)=>(i(),l("div",{key:r,class:"flex flex-col items-center gap-1"},[a("div",{class:"w-6 h-6 bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 rounded-full flex items-center justify-center cursor-pointer hover:bg-indigo-500 hover:text-white transition-colors font-bold text-[10px]",onMousedown:h(b=>$(e.id,b,`option_${r}`),["stop"]),title:`Javob: ${o.text||r+1}`},p(r+1),41,ds),a("span",us,p(o.text||`#${r+1}`),1)]))),128))])])):c("",!0),e.type==="ab_test"?(i(),l("div",cs,[a("div",ps,[a("div",{class:M(["w-6 h-6 bg-gray-200 dark:bg-gray-600 rounded-full flex items-center justify-center cursor-pointer hover:bg-blue-500 hover:text-white transition-colors",{"ring-2 ring-blue-400 ring-offset-1":u.value&&u.value.from!==e.id}]),onMouseup:h(o=>X(e.id),["stop"]),title:"Kirish nuqtasi"},[...t[66]||(t[66]=[a("svg",{class:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"})],-1)])],42,gs)]),a("div",vs,[(i(!0),l(j,null,z(e.ab_test?.variants||[],(o,r)=>(i(),l("div",{key:r,class:"flex flex-col items-center gap-1"},[a("div",{class:"w-7 h-7 bg-amber-100 dark:bg-amber-900 text-amber-600 dark:text-amber-400 rounded-full flex items-center justify-center cursor-pointer hover:bg-amber-500 hover:text-white transition-colors font-bold text-xs",onMousedown:h(b=>$(e.id,b,`variant_${r}`),["stop"]),title:`${o.name}: ${o.percentage}%`},p(o.name),41,bs),a("span",xs,p(o.percentage)+"%",1)]))),128))])])):c("",!0)])],46,ee))),128))],4),v.value.length===0?(i(),l("div",ys,[...t[67]||(t[67]=[f('<div class="text-center" data-v-2b54bc78><div class="w-20 h-20 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4" data-v-2b54bc78><svg class="w-10 h-10 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z" data-v-2b54bc78></path></svg></div><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2" data-v-2b54bc78>Funnel bo&#39;sh</h3><p class="text-gray-500 dark:text-gray-400 text-sm" data-v-2b54bc78>Chap paneldan elementlarni tortib tashlang</p></div>',1)])])):c("",!0)],544),a("div",fs,[a("div",hs,[a("h3",ms,p(d.value?"Qadam tahrirlash":"Qadam tanlang"),1)]),d.value?(i(),l("div",_s,[a("div",null,[t[69]||(t[69]=a("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"},"Qadam nomi",-1)),B(a("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>d.value.name=e),type:"text",class:"w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400 dark:placeholder-gray-500",placeholder:"Qadam nomini kiriting..."},null,512),[[F,d.value.name]])]),d.value.type==="trigger_keyword"?(i(),l("div",ws,[t[75]||(t[75]=f('<div class="p-3 bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg" data-v-2b54bc78><div class="flex items-center gap-2 text-purple-700 dark:text-purple-400 mb-2" data-v-2b54bc78><svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-2b54bc78><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-2b54bc78></path></svg><span class="text-xs font-medium" data-v-2b54bc78>Kalit so&#39;z triggeri</span></div><p class="text-xs text-purple-600 dark:text-purple-400" data-v-2b54bc78> Foydalanuvchi xabarida kalit so&#39;z topilganda bu trigger ishga tushadi. </p></div>',1)),a("div",Ms,[t[70]||(t[70]=a("label",{class:"text-xs font-medium text-gray-700 dark:text-gray-300"},"Barcha xabarlar uchun",-1)),a("button",{onClick:t[14]||(t[14]=e=>d.value.trigger.is_all_messages=!d.value.trigger.is_all_messages),class:M(["relative w-11 h-6 rounded-full transition-colors",d.value.trigger?.is_all_messages?"bg-purple-500":"bg-gray-300 dark:bg-gray-600"])},[a("span",{class:M(["absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform",d.value.trigger?.is_all_messages?"translate-x-5":"translate-x-0"])},null,2)],2)]),d.value.trigger?.is_all_messages?c("",!0):(i(),l("div",Cs,[t[71]||(t[71]=a("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"},"Kalit so'zlar",-1)),B(a("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>d.value.trigger.keywords=e),type:"text",class:"w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 placeholder-gray-400 dark:placeholder-gray-500",placeholder:"narx, price, baho"},null,512),[[F,d.value.trigger.keywords]]),t[72]||(t[72]=a("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Vergul bilan ajrating: narx, price, baho",-1))])),d.value.trigger?.is_all_messages?c("",!0):(i(),l("div",js,[t[74]||(t[74]=a("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"},"Mos kelish turi",-1)),B(a("select",{"onUpdate:modelValue":t[16]||(t[16]=e=>d.value.trigger.match_type=e),class:"w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"},[...t[73]||(t[73]=[f('<option value="contains" data-v-2b54bc78>Ichida bor (tavsiya etiladi)</option><option value="exact" data-v-2b54bc78>To&#39;liq mos</option><option value="starts_with" data-v-2b54bc78>Bilan boshlanadi</option><option value="ends_with" data-v-2b54bc78>Bilan tugaydi</option><option value="regex" data-v-2b54bc78>Regex (ilg&#39;or)</option>',5)])],512),[[I,d.value.trigger.match_type]])]))])):c("",!0),["message","input","start"].includes(d.value.type)?(i(),l("div",zs,[t[76]||(t[76]=a("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"},"Kontent turi",-1)),a("div",Bs,[(i(),l(j,null,z(ht,e=>a("button",{key:e.value,onClick:o=>mt(e.value),class:M(["p-2 rounded-lg text-center transition-colors",(d.value.content?.type||"text")===e.value?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 ring-1 ring-blue-500":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[a("div",$s,[a("span",{innerHTML:e.icon,class:"w-5 h-5"},null,8,Vs),a("span",Ts,p(e.label),1)])],10,qs)),64))])])):c("",!0),["message","input","start"].includes(d.value.type)&&(d.value.content?.type||"text")==="text"?(i(),l("div",Ds,[t[77]||(t[77]=a("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"},"Xabar matni",-1)),B(a("textarea",{"onUpdate:modelValue":t[17]||(t[17]=e=>d.value.content.text=e),rows:"4",class:"w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none placeholder-gray-400 dark:placeholder-gray-500",placeholder:"Xabar matni kiriting..."},null,512),[[F,d.value.content.text]]),t[78]||(t[78]=a("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," O'zgaruvchilar: {first_name}, {last_name}, {phone}, {username} ",-1))])):c("",!0),d.value.type==="input"?(i(),l("div",Ls,[t[80]||(t[80]=a("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"},"Kutilayotgan ma'lumot turi",-1)),B(a("select",{"onUpdate:modelValue":t[18]||(t[18]=e=>d.value.input_type=e),class:"w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...t[79]||(t[79]=[f('<option value="none" data-v-2b54bc78>Hech biri</option><option value="text" data-v-2b54bc78>Matn</option><option value="email" data-v-2b54bc78>Email</option><option value="phone" data-v-2b54bc78>Telefon raqam</option><option value="number" data-v-2b54bc78>Raqam</option><option value="location" data-v-2b54bc78>Lokatsiya</option><option value="photo" data-v-2b54bc78>Rasm</option><option value="any" data-v-2b54bc78>Istalgan</option>',8)])],512),[[I,d.value.input_type]])])):c("",!0),d.value.type==="action"?(i(),l("div",Hs,[t[82]||(t[82]=a("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"},"Amal turi",-1)),B(a("select",{"onUpdate:modelValue":t[19]||(t[19]=e=>d.value.action_type=e),class:"w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...t[81]||(t[81]=[f('<option value="none" data-v-2b54bc78>Hech narsa</option><option value="create_lead" data-v-2b54bc78>Lid yaratish</option><option value="update_user" data-v-2b54bc78>Foydalanuvchini yangilash</option><option value="handoff" data-v-2b54bc78>Operatorga uzatish</option><option value="send_notification" data-v-2b54bc78>Xabarnoma yuborish</option><option value="webhook" data-v-2b54bc78>Webhook</option>',6)])],512),[[I,d.value.action_type]])])):c("",!0),d.value.type==="delay"?(i(),l("div",Ns,[t[83]||(t[83]=a("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"},"Kutish vaqti (soniya)",-1)),B(a("input",{"onUpdate:modelValue":t[20]||(t[20]=e=>d.value.delay_seconds=e),type:"number",min:"1",class:"w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400 dark:placeholder-gray-500",placeholder:"5"},null,512),[[F,d.value.delay_seconds,void 0,{number:!0}]])])):c("",!0),a("div",null,[t[85]||(t[85]=a("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1"},"Keyingi qadam (avtomatik)",-1)),B(a("select",{"onUpdate:modelValue":t[21]||(t[21]=e=>d.value.next_step_id=e),onChange:pt,class:"w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[t[84]||(t[84]=a("option",{value:null},"Funnelni tugatish",-1)),(i(!0),l(j,null,z(v.value.filter(e=>e.id!==d.value.id),e=>(i(),l("option",{key:e.id,value:e.id},p(e.name||A(e.type)),9,Ss))),128))],544),[[I,d.value.next_step_id]]),t[86]||(t[86]=a("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Tugma bosilmasa avtomatik o'tiladi",-1))]),a("div",Xs,[a("button",{onClick:t[22]||(t[22]=e=>tt(d.value.id)),class:"w-full px-4 py-2 bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/30 text-red-600 dark:text-red-400 text-sm font-medium rounded-lg transition-colors flex items-center justify-center gap-2"},[...t[87]||(t[87]=[a("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),D(" Qadamni o'chirish ",-1)])])])])):(i(),l("div",ks,[...t[68]||(t[68]=[a("div",{class:"text-center text-gray-500 dark:text-gray-400"},[a("svg",{class:"w-12 h-12 mx-auto mb-3 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"})]),a("p",{class:"text-sm"},"Canvas'dan qadam tanlang")],-1)])]))])])]))}},Is=St(Ys,[["__scopeId","data-v-2b54bc78"]]);export{Is as T};
