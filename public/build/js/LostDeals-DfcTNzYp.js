import{r as e,o as t,v as l,x as s,y as a,z as o,A as n,D as r,L as i,I as d,J as u,E as c,F as m,H as g,G as y,B as v,S as p}from"./chunk-7Urb0kxg.js";import{h as x,a as b}from"./chunk-DKkye6wf.js";import{_ as h}from"./chunk-BB8-4400.js";import"./chunk-Dm-LAqtr.js";import"./app-DFslr8vl.js";import"./chunk-Di7Oc7TS.js";import"./chunk-Dg8ilgYs.js";import"./chunk-Rl16a4N0.js";import"./chunk-C1ExV0Y3.js";import"./chunk-DUcDuGHI.js";import"./chunk-C3XJH04c.js";import"./chunk-D2XW56yD.js";import"./chunk-DS-Zp4Qb.js";import"./chunk-Sfe4u6kO.js";import"./chunk-BAC6lhkp.js";import"./chunk-BugzYCIx.js";import"./chunk-ab1b1Fp4.js";import"./chunk-DhwSyUm1.js";import"./chunk-9PkX4iPz.js";import"./chunk-DOBCiesv.js";import"./chunk-YGW1Cp7-.js";import"./chunk-afst19KZ.js";import"./chunk-D4tA7yBb.js";const f={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},k={class:"mb-6 flex gap-4 items-end"},w={key:0,class:"flex justify-center py-12"},j={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},_={class:"bg-red-50 rounded-lg p-6 border border-red-200"},q={class:"flex items-center justify-between"},Y={class:"text-3xl font-bold text-red-700"},B={class:"bg-orange-50 rounded-lg p-6 border border-orange-200"},M={class:"flex items-center justify-between"},z={class:"text-3xl font-bold text-orange-700"},C={class:"bg-yellow-50 rounded-lg p-6 border border-yellow-200"},S={class:"flex items-center justify-between"},V={class:"text-3xl font-bold text-yellow-700"},L={class:"bg-white rounded-lg shadow"},O={class:"border-b border-gray-200"},T={class:"flex -mb-px"},U=["onClick"],D={class:"p-6"},F={key:0,class:"space-y-4"},H={class:"flex-1"},I={class:"flex justify-between items-center mb-2"},J={class:"font-medium text-gray-900"},N={class:"text-sm text-gray-500"},A={class:"w-full bg-gray-200 rounded-full h-3"},E={class:"mt-2 text-sm text-gray-600"},G={key:1,class:"space-y-4"},R={class:"flex-1"},Z={class:"flex justify-between items-center mb-2"},K={class:"font-medium text-gray-900"},P={class:"text-sm text-gray-500"},Q={class:"w-full bg-gray-200 rounded-full h-3"},W={class:"mt-2 text-sm text-gray-600"},X={key:2,class:"space-y-4"},$={class:"flex-1"},ee={class:"flex justify-between items-center mb-2"},te={class:"font-medium text-gray-900"},le={class:"text-sm text-gray-500"},se={class:"w-full bg-gray-200 rounded-full h-3"},ae={class:"mt-2 text-sm text-gray-600"},oe={key:3,class:"space-y-4"},ne={class:"flex-1"},re={class:"flex justify-between items-center mb-2"},ie={class:"font-medium text-gray-900"},de={class:"text-sm text-gray-500"},ue={class:"w-full bg-gray-200 rounded-full h-3"},ce={class:"mt-2 text-sm text-gray-600"},me={key:0,class:"mt-8 bg-white rounded-lg shadow p-6"},ge={class:"space-y-2"},ye={class:"font-medium"},ve={class:"text-right"},pe={class:"text-red-600 font-bold"},xe={class:"text-gray-500 ml-2"},be={__name:"LostDeals",props:{lostReasons:Object,lazyLoad:Boolean},setup(be){const he=e(!0),fe=e(null),ke=e(""),we=e(""),je=e("reason"),_e=async()=>{he.value=!0;try{const e={};ke.value&&(e.date_from=ke.value),we.value&&(e.date_to=we.value);const t=await b.get(route("business.analytics.api.lost-deals"),{params:e});fe.value=t.data}catch(e){}finally{he.value=!1}};t(()=>{_e()});const qe=e=>e?new Intl.NumberFormat("uz-UZ").format(e):"0",Ye=[{key:"reason",label:"Sabab bo'yicha"},{key:"stage",label:"Bosqich bo'yicha"},{key:"operator",label:"Operator bo'yicha"},{key:"source",label:"Manba bo'yicha"}];return(e,t)=>(c(),l(h,{title:"Yo'qotilgan Sotuvlar Tahlili"},{default:s(()=>[a(n(x),{title:"Yo'qotilgan Sotuvlar"}),o("div",f,[t[14]||(t[14]=o("div",{class:"mb-8"},[o("h1",{class:"text-2xl font-bold text-gray-900"},"Yo'qotilgan Sotuvlar Tahlili"),o("p",{class:"mt-1 text-sm text-gray-500"},"Nega sotuvlar yo'qolgani va qanday yo'qotishlarni oldini olish mumkinligi haqida")],-1)),o("div",k,[o("div",null,[t[2]||(t[2]=o("label",{class:"block text-sm font-medium text-gray-700"},"Boshlanish",-1)),d(o("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=e=>ke.value=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[u,ke.value]])]),o("div",null,[t[3]||(t[3]=o("label",{class:"block text-sm font-medium text-gray-700"},"Tugash",-1)),d(o("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>we.value=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[u,we.value]])]),o("button",{onClick:_e,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"}," Yangilash ")]),he.value?(c(),r("div",w,[...t[4]||(t[4]=[o("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):fe.value?(c(),r(m,{key:1},[o("div",j,[o("div",_,[o("div",q,[o("div",null,[t[5]||(t[5]=o("p",{class:"text-sm font-medium text-red-600"},"Jami yo'qotilgan",-1)),o("p",Y,g(fe.value.summary?.total_lost),1)]),t[6]||(t[6]=o("div",{class:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center"},[o("svg",{class:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1))])]),o("div",B,[o("div",M,[o("div",null,[t[7]||(t[7]=o("p",{class:"text-sm font-medium text-orange-600"},"Yo'qotilgan qiymat",-1)),o("p",z,g(qe(fe.value.summary?.total_value_lost)),1),t[8]||(t[8]=o("p",{class:"text-xs text-orange-500"},"so'm",-1))]),t[9]||(t[9]=o("div",{class:"h-12 w-12 rounded-full bg-orange-100 flex items-center justify-center"},[o("svg",{class:"h-6 w-6 text-orange-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]),o("div",C,[o("div",S,[o("div",null,[t[10]||(t[10]=o("p",{class:"text-sm font-medium text-yellow-600"},"O'rtacha qiymat",-1)),o("p",V,g(qe(fe.value.summary?.avg_value_lost)),1),t[11]||(t[11]=o("p",{class:"text-xs text-yellow-500"},"so'm / lid",-1))]),t[12]||(t[12]=o("div",{class:"h-12 w-12 rounded-full bg-yellow-100 flex items-center justify-center"},[o("svg",{class:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])],-1))])])]),o("div",L,[o("div",O,[o("nav",T,[(c(),r(m,null,y(Ye,e=>o("button",{key:e.key,onClick:t=>je.value=e.key,class:v(["px-6 py-3 text-sm font-medium border-b-2 transition-colors",je.value===e.key?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},g(e.label),11,U)),64))])]),o("div",D,["reason"===je.value?(c(),r("div",F,[(c(!0),r(m,null,y(fe.value.by_reason,e=>(c(),r("div",{key:e.reason,class:"flex items-center p-4 bg-gray-50 rounded-lg"},[o("div",H,[o("div",I,[o("h4",J,g(e.reason_label),1),o("span",N,g(e.count)+" lid ("+g(e.percentage)+"%)",1)]),o("div",A,[o("div",{class:"bg-red-500 h-3 rounded-full transition-all",style:p({width:e.percentage+"%"})},null,4)]),o("p",E,"Yo'qotilgan qiymat: "+g(qe(e.total_value))+" so'm",1)])]))),128))])):i("",!0),"stage"===je.value?(c(),r("div",G,[(c(!0),r(m,null,y(fe.value.by_stage,e=>(c(),r("div",{key:e.stage_id,class:"flex items-center p-4 bg-gray-50 rounded-lg"},[o("div",R,[o("div",Z,[o("h4",K,g(e.stage_name),1),o("span",P,g(e.count)+" lid ("+g(e.percentage)+"%)",1)]),o("div",Q,[o("div",{class:"bg-orange-500 h-3 rounded-full transition-all",style:p({width:e.percentage+"%"})},null,4)]),o("p",W,"Yo'qotilgan qiymat: "+g(qe(e.total_value))+" so'm",1)])]))),128))])):i("",!0),"operator"===je.value?(c(),r("div",X,[(c(!0),r(m,null,y(fe.value.by_operator,e=>(c(),r("div",{key:e.user_id,class:"flex items-center p-4 bg-gray-50 rounded-lg"},[o("div",$,[o("div",ee,[o("h4",te,g(e.user_name),1),o("span",le,g(e.count)+" lid ("+g(e.percentage)+"%)",1)]),o("div",se,[o("div",{class:"bg-yellow-500 h-3 rounded-full transition-all",style:p({width:e.percentage+"%"})},null,4)]),o("p",ae,"Yo'qotilgan qiymat: "+g(qe(e.total_value))+" so'm",1)])]))),128))])):i("",!0),"source"===je.value?(c(),r("div",oe,[(c(!0),r(m,null,y(fe.value.by_source,e=>(c(),r("div",{key:e.channel_id,class:"flex items-center p-4 bg-gray-50 rounded-lg"},[o("div",ne,[o("div",re,[o("h4",ie,g(e.channel_name),1),o("span",de,g(e.count)+" lid ("+g(e.percentage)+"%)",1)]),o("div",ue,[o("div",{class:"bg-purple-500 h-3 rounded-full transition-all",style:p({width:e.percentage+"%"})},null,4)]),o("p",ce,"Yo'qotilgan qiymat: "+g(qe(e.total_value))+" so'm",1)])]))),128))])):i("",!0)])]),fe.value.monthly_trend?.length?(c(),r("div",me,[t[13]||(t[13]=o("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Oylik trend",-1)),o("div",ge,[(c(!0),r(m,null,y(fe.value.monthly_trend,e=>(c(),r("div",{key:e.month,class:"flex items-center justify-between p-3 bg-gray-50 rounded"},[o("span",ye,g(e.month),1),o("div",ve,[o("span",pe,g(e.count)+" lid",1),o("span",xe,g(qe(e.total_value))+" so'm",1)])]))),128))])])):i("",!0)],64)):i("",!0)])]),_:1}))}};export{be as default};
