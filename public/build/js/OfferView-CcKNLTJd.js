import{r as e,b as t,o as a,e as l,C as s,L as r,I as o,y as n,v as i,A as c,B as u,z as f,J as d,K as p,N as m,F as b,G as g,H as x,M as v,D as y}from"./chunk-CpmtkKLp.js";import{h as _,a as h}from"./chunk-BhZp3z4u.js";import{u as w}from"./app-C-ZlocOh.js";import{r as k,a as j}from"./chunk-eMHYSAeQ.js";import{r as C}from"./chunk-CDwIUdYJ.js";import{r as M}from"./chunk-Bsc1JRL5.js";import{r as z}from"./chunk-CvscUVdi.js";import{r as O,a as U}from"./chunk-C9nNyFhC.js";import{r as V}from"./chunk-C2r_KHf6.js";import{r as I}from"./chunk-DmrwHl-6.js";import"./chunk-BWiubfpN.js";const S={class:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-indigo-50"},q={key:0,class:"fixed top-4 left-1/2 -translate-x-1/2 z-50 px-6 py-4 bg-green-600 text-white rounded-xl shadow-lg flex items-center gap-3"},D={class:"bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 text-white"},F={class:"max-w-4xl mx-auto px-4 py-8 text-center"},N={key:0,class:"text-purple-200 mb-2"},$={class:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center mx-auto mb-4"},A={class:"text-3xl md:text-4xl font-bold mb-4"},B={key:1,class:"text-lg text-purple-100 max-w-2xl mx-auto"},G={key:1,class:"bg-gradient-to-r from-red-500 to-orange-500 text-white py-3"},H={class:"max-w-4xl mx-auto px-4 flex items-center justify-center gap-3"},J={class:"font-semibold"},K={class:"text-xl font-bold"},L={class:"max-w-4xl mx-auto px-4 py-8"},Z={key:0,class:"bg-white rounded-2xl shadow-lg p-6 mb-6 border-l-4 border-purple-500"},E={class:"flex items-start gap-4"},P={class:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0"},Q={class:"text-xl font-bold text-gray-900 mb-2"},R={class:"text-gray-600 text-lg"},T={class:"bg-white rounded-2xl shadow-xl overflow-hidden mb-6"},W={class:"p-6 bg-gradient-to-r from-green-50 to-emerald-50 border-b border-green-100"},X={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},Y={class:"text-sm text-green-700 font-medium mb-1"},ee={class:"flex items-baseline gap-3"},te={key:0,class:"text-2xl text-gray-400 line-through"},ae={class:"text-4xl font-black text-green-700"},le={key:0,class:"text-green-600 font-semibold mt-1"},se={key:0,class:"text-right"},re={class:"text-sm text-gray-500"},oe={class:"text-2xl font-bold text-gray-900"},ne={class:"text-green-600 font-semibold"},ie={key:0,class:"p-6"},ce={class:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2"},ue={class:"space-y-3"},fe={class:"w-8 h-8 bg-amber-500 text-white rounded-lg flex items-center justify-center font-bold text-sm flex-shrink-0"},de={class:"flex-1"},pe={class:"flex items-center justify-between"},me={class:"font-bold text-gray-900"},be={key:0,class:"text-green-600 font-semibold"},ge={key:0,class:"text-gray-600 text-sm mt-1"},xe={key:1,class:"bg-white rounded-2xl shadow-lg p-6 mb-6 border-2 border-green-200"},ve={class:"flex items-start gap-4"},ye={class:"w-14 h-14 bg-green-500 rounded-xl flex items-center justify-center flex-shrink-0"},_e={class:"text-xl font-bold text-green-800 mb-2"},he={key:0,class:"text-gray-600 mb-3"},we={key:1,class:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg"},ke={class:"font-semibold"},je={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},Ce={key:0,class:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4"},Me={class:"flex items-center gap-3 text-blue-700 font-semibold mb-2"},ze={class:"text-gray-700"},Oe={key:1,class:"bg-red-50 border-2 border-red-200 rounded-xl p-4"},Ue={class:"flex items-center gap-3 text-red-700 font-semibold mb-2"},Ve={class:"text-gray-700"},Ie={key:3,class:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl p-6 mb-6 border-2 border-yellow-200"},Se={class:"text-center"},qe={class:"flex items-center justify-center gap-3 mb-2"},De={class:"text-3xl font-black text-yellow-800"},Fe={class:"text-yellow-700 font-medium"},Ne={class:"sticky bottom-4 bg-white rounded-2xl shadow-2xl p-4 border border-gray-200"},$e={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ae=["disabled"],Be={class:"text-center mt-8 text-gray-500 text-sm"},Ge={key:0},He={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Je={class:"flex min-h-screen items-center justify-center p-4"},Ke={class:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full p-6"},Le={class:"flex items-center justify-between mb-4"},Ze={class:"text-xl font-bold text-gray-900"},Ee={class:"block text-sm font-medium text-gray-700 mb-1"},Pe={class:"block text-sm font-medium text-gray-700 mb-1"},Qe={value:""},Re={value:"morning"},Te={value:"afternoon"},We={value:"evening"},Xe={class:"block text-sm font-medium text-gray-700 mb-1"},Ye=["placeholder"],et=["disabled"],tt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},at={class:"flex min-h-screen items-center justify-center p-4"},lt={class:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full p-6"},st={class:"flex items-center justify-between mb-4"},rt={class:"text-xl font-bold text-gray-900"},ot={class:"text-gray-600"},nt={value:""},it={value:"price"},ct={value:"no_need"},ut={value:"no_budget"},ft={value:"competitor"},dt={value:"other"},pt=["disabled"],mt={__name:"OfferView",props:{assignment:Object,offer:Object,lead:Object,business:Object},setup(mt){const{t:bt}=w(),gt=mt,xt=e(!1),vt=e(!1),yt=e({phone:"",preferred_time:"",message:""}),_t=e(""),ht=e(!1),wt=e(""),kt=e(null),jt=e(null),Ct=t(()=>{if(!kt.value||kt.value<=0)return null;const e=Math.floor(kt.value/864e5),t=Math.floor(kt.value%864e5/36e5),a=Math.floor(kt.value%36e5/6e4),l=Math.floor(kt.value%6e4/1e3);return e>0?bt("public_offer.time_days_hours",{days:e,hours:t}):t>0?bt("public_offer.time_hours_minutes",{hours:t,minutes:a}):`${a}:${l.toString().padStart(2,"0")}`});a(()=>{gt.assignment.expires_at?.timestamp&&(Mt(),jt.value=setInterval(Mt,1e3))}),l(()=>{jt.value&&clearInterval(jt.value)});const Mt=()=>{const e=Date.now(),t=gt.assignment.expires_at.timestamp;kt.value=Math.max(0,t-e)},zt=e=>e?new Intl.NumberFormat("uz-UZ").format(e):"0",Ot=t(()=>{const e=gt.assignment.offered_price||gt.offer.pricing||0,t=gt.assignment.discount_amount||0;return Math.max(0,e-t)}),Ut=t(()=>gt.assignment.discount_amount&&gt.assignment.discount_amount>0),Vt=async e=>{try{await h.post(route("offers.public.click",gt.assignment.tracking_code),{action:e})}catch(t){}},It=async()=>{ht.value=!0;try{const e=await h.post(route("offers.public.interested",gt.assignment.tracking_code));wt.value=e.data.message,await Vt("interested")}catch(e){}finally{ht.value=!1}},St=async()=>{ht.value=!0;try{const e=await h.post(route("offers.public.callback",gt.assignment.tracking_code),yt.value);wt.value=e.data.message,xt.value=!1,await Vt("callback")}catch(e){}finally{ht.value=!1}},qt=async()=>{ht.value=!0;try{await h.post(route("offers.public.reject",gt.assignment.tracking_code),{reason:_t.value}),vt.value=!1,wt.value=bt("public_offer.feedback_thanks")}catch(e){}finally{ht.value=!1}},Dt=t(()=>({unconditional:bt("public_offer.guarantee_unconditional"),conditional:bt("public_offer.guarantee_conditional"),performance:bt("public_offer.guarantee_performance"),hybrid:bt("public_offer.guarantee_hybrid")}));return(e,t)=>(y(),s("div",S,[r(c(_),{title:mt.offer.name},null,8,["title"]),wt.value?(y(),s("div",q,[r(c(k),{class:"w-6 h-6"}),u(" "+f(wt.value),1)])):o("",!0),n("div",D,[n("div",F,[mt.lead.name?(y(),s("p",N,f(c(bt)("public_offer.greeting",{name:mt.lead.name})),1)):o("",!0),n("div",$,[r(c(C),{class:"w-8 h-8"})]),n("h1",A,f(mt.offer.name),1),mt.offer.description?(y(),s("p",B,f(mt.offer.description),1)):o("",!0)])]),Ct.value?(y(),s("div",G,[n("div",H,[r(c(M),{class:"w-5 h-5 animate-pulse"}),n("span",J,f(c(bt)("public_offer.offer_deadline")),1),n("span",K,f(Ct.value),1)])])):o("",!0),n("div",L,[mt.offer.value_proposition?(y(),s("div",Z,[n("div",E,[n("div",P,[r(c(z),{class:"w-6 h-6 text-purple-600"})]),n("div",null,[n("h2",Q,f(c(bt)("public_offer.value_proposition_title")),1),n("p",R,f(mt.offer.value_proposition),1)])])])):o("",!0),n("div",T,[n("div",W,[n("div",X,[n("div",null,[n("p",Y,f(c(bt)("public_offer.special_price")),1),n("div",ee,[Ut.value?(y(),s("span",te,f(zt(mt.assignment.offered_price||mt.offer.pricing))+" "+f(c(bt)("common.currency")),1)):o("",!0),n("span",ae,f(zt(Ot.value))+" "+f(c(bt)("common.currency")),1)]),Ut.value?(y(),s("p",le,f(c(bt)("public_offer.discount_amount",{amount:zt(mt.assignment.discount_amount)})),1)):o("",!0)]),mt.offer.total_value&&mt.offer.total_value>Ot.value?(y(),s("div",se,[n("p",re,f(c(bt)("public_offer.total_value")),1),n("p",oe,f(zt(mt.offer.total_value))+" "+f(c(bt)("common.currency")),1),n("p",ne,f(c(bt)("public_offer.more_value",{percent:Math.round(100*(mt.offer.total_value/Ot.value-1))})),1)])):o("",!0)])]),mt.offer.components?.length>0?(y(),s("div",ie,[n("h3",ce,[r(c(C),{class:"w-6 h-6 text-amber-500"}),u(" "+f(c(bt)("public_offer.bonuses")),1)]),n("div",ue,[(y(!0),s(d,null,p(mt.offer.components,(e,t)=>(y(),s("div",{key:e.id,class:"flex items-start gap-3 p-4 bg-amber-50 rounded-xl"},[n("div",fe,f(t+1),1),n("div",de,[n("div",pe,[n("h4",me,f(e.name),1),e.value?(y(),s("span",be,f(zt(e.value))+" "+f(c(bt)("common.currency")),1)):o("",!0)]),e.description?(y(),s("p",ge,f(e.description),1)):o("",!0)])]))),128))])])):o("",!0)]),mt.offer.guarantee_type?(y(),s("div",xe,[n("div",ve,[n("div",ye,[r(c(O),{class:"w-7 h-7 text-white"})]),n("div",null,[n("h3",_e,f(Dt.value[mt.offer.guarantee_type]||mt.offer.guarantee_type),1),mt.offer.guarantee_terms?(y(),s("p",he,f(mt.offer.guarantee_terms),1)):o("",!0),mt.offer.guarantee_period_days?(y(),s("div",we,[r(c(M),{class:"w-5 h-5"}),n("span",ke,f(c(bt)("public_offer.guarantee_days",{days:mt.offer.guarantee_period_days})),1)])):o("",!0)])])])):o("",!0),mt.offer.scarcity||mt.offer.urgency?(y(),s("div",je,[mt.offer.scarcity?(y(),s("div",Ce,[n("div",Me,[r(c(M),{class:"w-5 h-5"}),u(" "+f(c(bt)("public_offer.scarcity")),1)]),n("p",ze,f(mt.offer.scarcity),1)])):o("",!0),mt.offer.urgency?(y(),s("div",Oe,[n("div",Ue,[r(c(j),{class:"w-5 h-5"}),u(" "+f(c(bt)("public_offer.urgency")),1)]),n("p",Ve,f(mt.offer.urgency),1)])):o("",!0)])):o("",!0),mt.offer.value_score?(y(),s("div",Ie,[n("div",Se,[n("div",qe,[r(c(V),{class:"w-8 h-8 text-yellow-600"}),n("span",De,f(mt.offer.value_score),1)]),n("p",Fe,f(c(bt)("public_offer.value_score")),1)])])):o("",!0),n("div",Ne,[n("div",$e,[n("button",{onClick:It,disabled:ht.value,class:"flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold rounded-xl hover:from-purple-700 hover:to-indigo-700 transition-all shadow-lg disabled:opacity-50"},[r(c(k),{class:"w-6 h-6"}),u(" "+f(c(bt)("public_offer.interested")),1)],8,Ae),n("button",{onClick:t[0]||(t[0]=e=>xt.value=!0),class:"flex items-center justify-center gap-2 px-6 py-4 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition-all shadow-lg"},[r(c(U),{class:"w-6 h-6"}),u(" "+f(c(bt)("public_offer.call_me")),1)])]),n("button",{onClick:t[1]||(t[1]=e=>vt.value=!0),class:"w-full mt-3 text-sm text-gray-400 hover:text-gray-600 transition-colors"},f(c(bt)("public_offer.not_interested")),1)]),n("div",Be,[n("p",null,f(mt.business.name),1),mt.business.phone?(y(),s("p",Ge,f(mt.business.phone),1)):o("",!0)])]),(y(),i(v,{to:"body"},[xt.value?(y(),s("div",He,[n("div",Je,[n("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:t[2]||(t[2]=e=>xt.value=!1)}),n("div",Ke,[n("div",Le,[n("h3",Ze,f(c(bt)("public_offer.callback_title")),1),n("button",{onClick:t[3]||(t[3]=e=>xt.value=!1),class:"text-gray-400 hover:text-gray-600"},[r(c(I),{class:"w-6 h-6"})])]),n("form",{onSubmit:m(St,["prevent"]),class:"space-y-4"},[n("div",null,[n("label",Ee,f(c(bt)("public_offer.phone_number"))+" *",1),b(n("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>yt.value.phone=e),type:"tel",required:"",placeholder:"+998 90 123 45 67",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"},null,512),[[g,yt.value.phone]])]),n("div",null,[n("label",Pe,f(c(bt)("public_offer.preferred_time")),1),b(n("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>yt.value.preferred_time=e),class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"},[n("option",Qe,f(c(bt)("public_offer.time_any")),1),n("option",Re,f(c(bt)("public_offer.time_morning")),1),n("option",Te,f(c(bt)("public_offer.time_afternoon")),1),n("option",We,f(c(bt)("public_offer.time_evening")),1)],512),[[x,yt.value.preferred_time]])]),n("div",null,[n("label",Xe,f(c(bt)("public_offer.message")),1),b(n("textarea",{"onUpdate:modelValue":t[6]||(t[6]=e=>yt.value.message=e),rows:"2",placeholder:c(bt)("public_offer.message_placeholder"),class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"},null,8,Ye),[[g,yt.value.message]])]),n("button",{type:"submit",disabled:ht.value,class:"w-full py-3 bg-green-600 text-white font-semibold rounded-xl hover:bg-green-700 transition-all disabled:opacity-50"},f(ht.value?c(bt)("public_form.submitting"):c(bt)("public_form.submit")),9,et)],32)])])])):o("",!0)])),(y(),i(v,{to:"body"},[vt.value?(y(),s("div",tt,[n("div",at,[n("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:t[7]||(t[7]=e=>vt.value=!1)}),n("div",lt,[n("div",st,[n("h3",rt,f(c(bt)("public_offer.feedback_title")),1),n("button",{onClick:t[8]||(t[8]=e=>vt.value=!1),class:"text-gray-400 hover:text-gray-600"},[r(c(I),{class:"w-6 h-6"})])]),n("form",{onSubmit:m(qt,["prevent"]),class:"space-y-4"},[n("p",ot,f(c(bt)("public_offer.feedback_question")),1),b(n("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>_t.value=e),class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"},[n("option",nt,f(c(bt)("public_offer.select_reason")),1),n("option",it,f(c(bt)("public_offer.reason_price")),1),n("option",ct,f(c(bt)("public_offer.reason_no_need")),1),n("option",ut,f(c(bt)("public_offer.reason_no_budget")),1),n("option",ft,f(c(bt)("public_offer.reason_competitor")),1),n("option",dt,f(c(bt)("public_offer.reason_other")),1)],512),[[x,_t.value]]),n("button",{type:"submit",disabled:ht.value,class:"w-full py-3 bg-gray-600 text-white font-semibold rounded-xl hover:bg-gray-700 transition-all disabled:opacity-50"},f(ht.value?c(bt)("public_form.submitting"):c(bt)("public_form.submit")),9,pt)],32)])])])):o("",!0)]))]))}};export{mt as default};
