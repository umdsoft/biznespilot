import{h as t,l as e,r as s}from"./chunk-BhZp3z4u.js";import{_ as a}from"./chunk-DbFbpSR2.js";import{r as o,o as n,C as r,L as i,A as l,x as c,y as d,z as u,I as m,D as x,J as p,K as g,E as h,B as v,p as y}from"./chunk-CpmtkKLp.js";import"./chunk-D7SyfRoT.js";import"./app-C-ZlocOh.js";import"./chunk-BWiubfpN.js";import"./chunk-CouA7u-j.js";import"./chunk-DmrwHl-6.js";import"./chunk-De_qwhex.js";import"./chunk-eMHYSAeQ.js";import"./chunk-beXL1A--.js";import"./chunk-CAoK8Mdm.js";import"./chunk-BiBvtcLb.js";import"./chunk-DNKDGYPp.js";import"./chunk-BiW1c8q7.js";import"./chunk-CTIk0k8a.js";import"./chunk-dqIIyBTR.js";import"./chunk-CvscUVdi.js";import"./chunk-BvbZUszZ.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-DCXiFUg-.js";import"./chunk-Bsc1JRL5.js";import"./chunk-BuJDoypK.js";const f={class:"py-12"},b={class:"max-w-8xl mx-auto sm:px-6 lg:px-8"},k={class:"mb-6 flex items-center justify-between"},j={class:"flex items-center gap-4"},w={class:"text-2xl font-bold text-gray-900"},_={class:"text-sm text-gray-600"},S={class:"flex gap-2"},C={class:"grid grid-cols-3 gap-6"},E={class:"col-span-2"},A={class:"bg-white rounded-lg shadow-sm overflow-hidden flex flex-col",style:{height:"calc(100vh - 250px)"}},I={class:"text-sm whitespace-pre-wrap"},T={key:0,class:"px-2 py-0.5 bg-white/20 rounded"},z={key:0,class:"flex items-center justify-center h-full text-gray-500"},q={class:"col-span-1 space-y-6"},M={class:"bg-white rounded-lg shadow-sm p-6"},N={class:"space-y-3"},O={key:0},D={class:"mt-1 text-sm text-gray-900"},H={key:1},L={class:"mt-1 text-sm text-gray-900"},B={key:2},R={class:"mt-1 text-sm text-gray-900"},U={class:"mt-1 text-sm text-gray-900"},P={class:"mt-1 text-sm text-gray-900 font-mono text-xs"},X={class:"bg-white rounded-lg shadow-sm p-6"},F={class:"space-y-3"},K={class:"mt-1"},Q={class:"mt-1 text-sm text-gray-900"},Y={key:0},$={class:"mt-1 text-sm text-gray-900"},J={key:1},W={class:"mt-1 text-sm text-gray-900"},Z={class:"mt-1 text-sm text-gray-900"},G={class:"mt-1 text-sm text-gray-900"},V={key:0,class:"bg-white rounded-lg shadow-sm p-6"},tt={class:"space-y-3"},et={class:"mt-1 text-sm text-gray-900"},st={class:"mt-1"},at={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},ot={__name:"ConversationDetail",props:{conversation:Object},setup(ot){const nt=ot,rt=o(null),it={telegram:"ðŸ“± Telegram",instagram:"ðŸ“· Instagram",facebook:"ðŸ‘¥ Facebook"},lt={AWARENESS:"Xabardorlik",INTEREST:"Qiziqish",CONSIDERATION:"Mulohaza",INTENT:"Niyat",PURCHASE:"Xarid",POST_PURCHASE:"Xariddan keyin"},ct=t=>new Date(t).toLocaleString("uz-UZ",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});n(()=>{y(()=>{rt.value&&(rt.value.scrollTop=rt.value.scrollHeight)})});const dt=()=>{confirm("Suhbatni yopmoqchimisiz?")&&s.post(route("business.customer-bot.conversation.close",nt.conversation.id),{},{preserveScroll:!0})},ut=()=>{s.post(route("business.customer-bot.conversation.reopen",nt.conversation.id),{},{preserveScroll:!0})},mt=()=>{confirm("Suhbatni operatorga topshirmoqchimisiz?")&&s.post(route("business.customer-bot.conversation.handoff",nt.conversation.id),{},{preserveScroll:!0})};return(s,o)=>(x(),r(p,null,[i(l(t),{title:`Suhbat - ${ot.conversation.customer_name||"Anonim"}`},null,8,["title"]),i(a,null,{default:c(()=>[d("div",f,[d("div",b,[d("div",k,[d("div",j,[i(l(e),{href:s.route("business.customer-bot.conversations"),class:"p-2 hover:bg-gray-100 rounded-md"},{default:c(()=>[...o[0]||(o[0]=[d("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1},8,["href"]),d("div",null,[d("h1",w,u(ot.conversation.customer_name||"Anonim"),1),d("p",_,u(it[ot.conversation.channel]||"ðŸ’¬"),1)])]),d("div",S,[ot.conversation.handed_off?m("",!0):(x(),r("button",{key:0,onClick:mt,class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm"}," Operatorga topshirish ")),"active"===ot.conversation.status?(x(),r("button",{key:1,onClick:dt,class:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm"}," Suhbatni yopish ")):"closed"===ot.conversation.status?(x(),r("button",{key:2,onClick:ut,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm"}," Qayta ochish ")):m("",!0)])]),d("div",C,[d("div",E,[d("div",A,[d("div",{ref_key:"messagesContainer",ref:rt,class:"flex-1 overflow-y-auto p-6 space-y-4"},[(x(!0),r(p,null,g(ot.conversation.messages,t=>(x(),r("div",{key:t.id,class:h(["flex","bot"===t.role?"justify-start":"justify-end"])},[d("div",{class:h(["max-w-md px-4 py-3 rounded-lg","bot"===t.role?"bg-gray-100 text-gray-900":"bg-blue-600 text-white"])},[d("p",I,u(t.content),1),d("div",{class:h(["mt-1 text-xs flex items-center gap-2","bot"===t.role?"text-gray-500":"text-blue-100"])},[d("span",null,u(ct(t.created_at)),1),t.detected_intent?(x(),r("span",T,u(t.detected_intent),1)):m("",!0)],2)],2)],2))),128)),0===ot.conversation.messages.length?(x(),r("div",z,[...o[1]||(o[1]=[d("div",{class:"text-center"},[d("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})]),d("p",{class:"mt-2"},"Hech qanday xabar yo'q")],-1)])])):m("",!0)],512)])]),d("div",q,[d("div",M,[o[7]||(o[7]=d("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Mijoz ma'lumotlari",-1)),d("dl",N,[ot.conversation.customer_name?(x(),r("div",O,[o[2]||(o[2]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Ism",-1)),d("dd",D,u(ot.conversation.customer_name),1)])):m("",!0),ot.conversation.customer_email?(x(),r("div",H,[o[3]||(o[3]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Email",-1)),d("dd",L,u(ot.conversation.customer_email),1)])):m("",!0),ot.conversation.customer_phone?(x(),r("div",B,[o[4]||(o[4]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Telefon",-1)),d("dd",R,u(ot.conversation.customer_phone),1)])):m("",!0),d("div",null,[o[5]||(o[5]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Kanal",-1)),d("dd",U,u(it[ot.conversation.channel]||ot.conversation.channel),1)]),d("div",null,[o[6]||(o[6]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Channel User ID",-1)),d("dd",P,u(ot.conversation.channel_user_id),1)])])]),d("div",X,[o[14]||(o[14]=d("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Holat",-1)),d("dl",F,[d("div",null,[o[8]||(o[8]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Status",-1)),d("dd",K,[d("span",{class:h(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium","active"===ot.conversation.status?"bg-green-100 text-green-800":"closed"===ot.conversation.status?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"])},u("active"===ot.conversation.status?"Faol":"closed"===ot.conversation.status?"Yopilgan":"Arxiv"),3)])]),d("div",null,[o[9]||(o[9]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Bosqich",-1)),d("dd",Q,u(lt[ot.conversation.current_stage]||ot.conversation.current_stage),1)]),ot.conversation.handed_off?(x(),r("div",Y,[o[10]||(o[10]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Operatorga topshirilgan",-1)),d("dd",$,u(ct(ot.conversation.handed_off_at)),1)])):m("",!0),ot.conversation.closed_at?(x(),r("div",J,[o[11]||(o[11]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Yopilgan vaqti",-1)),d("dd",W,u(ct(ot.conversation.closed_at)),1)])):m("",!0),d("div",null,[o[12]||(o[12]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Boshlangan",-1)),d("dd",Z,u(ct(ot.conversation.created_at)),1)]),d("div",null,[o[13]||(o[13]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Oxirgi faollik",-1)),d("dd",G,u(ct(ot.conversation.updated_at)),1)])])]),ot.conversation.lead?(x(),r("div",V,[o[18]||(o[18]=d("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Lid",-1)),d("dl",tt,[d("div",null,[o[15]||(o[15]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Lid ID",-1)),d("dd",et,u(ot.conversation.lead.id),1)]),d("div",null,[o[16]||(o[16]=d("dt",{class:"text-xs font-medium text-gray-500 uppercase"},"Holat",-1)),d("dd",st,[d("span",at,u(ot.conversation.lead.status),1)])]),d("div",null,[i(l(e),{href:s.route("business.sales.show",ot.conversation.lead.id),class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},{default:c(()=>[...o[17]||(o[17]=[v(" Lidni ko'rish ",-1)])]),_:1},8,["href"])])])])):m("",!0)])])])])]),_:1})],64))}};export{ot as default};
