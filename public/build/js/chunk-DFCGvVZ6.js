import{C as n,z as e,F as l,r as x,b as j,w as se,v as R,D as p,H as s,A as t,B as b,G as O,I as D,J as Y,K as Ae,E as A,P as me,y as g,x as z,T as re,R as bt,Q as je,_ as xt,o as ht,e as yt,L as Ee,N as Fe,p as Le}from"./chunk-KPSVwAyv.js";import{r as Re,h as vt,l as J,a as te}from"./chunk-BVrjkT6E.js";import{u as fe,r as Ne,i as mt}from"./app-BtfI-58n.js";import{o as Me,g as ft}from"./chunk-Qa9RIO0M.js";import{r as ae}from"./chunk-Qe-_4ASA.js";import{r as He}from"./chunk-Dfha1x8d.js";import{r as _t}from"./chunk-BgOPVSvg.js";import{a as Se,g as Je,c as Pe,d as kt}from"./chunk-6yb70bcY.js";import{_ as wt}from"./chunk-DlAUqK2U.js";import{r as $t}from"./chunk-uNG5YCqx.js";import{a as ue}from"./chunk-DN454CZt.js";import{r as Ct}from"./chunk-DkomcDkT.js";import{r as Bt}from"./chunk-B0ddnyT4.js";import{r as Ze}from"./chunk-Tj_a7zxz.js";import{r as Te}from"./chunk-Cwn-ie4q.js";import{r as Lt}from"./chunk-Cs44MF5c.js";import{r as We}from"./chunk-BeK6HK_O.js";import{r as Xe}from"./chunk-BL-22xYA.js";import{r as St}from"./chunk-CYw1XsNK.js";import{r as Ke}from"./chunk-BIFKCSDr.js";function Tt(y,i){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"})])}const jt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Mt={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},At={class:"relative inline-block w-full max-w-2xl px-6 py-6 overflow-hidden text-left align-bottom transition-all transform bg-slate-800 rounded-2xl shadow-xl sm:my-8 sm:align-middle border border-slate-700"},zt={class:"flex items-center justify-between mb-6"},Ot={class:"flex items-center"},Dt={class:"text-xl font-semibold text-white"},Vt={class:"text-sm text-slate-400"},qt={key:0,class:"py-12 text-center"},It={class:"mt-2 text-slate-400"},Ut={key:1},Et={key:0,class:"mb-6"},Ft={class:"flex items-center mb-3"},Rt={key:0,class:"w-6 h-6 text-green-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Nt={key:1,class:"w-6 h-6 text-yellow-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ht={class:"grid grid-cols-3 gap-4 text-center"},Jt={class:"bg-slate-700/50 rounded-lg p-3"},Pt={class:"text-2xl font-bold text-white"},Zt={class:"text-xs text-slate-400"},Wt={class:"bg-slate-700/50 rounded-lg p-3"},Xt={class:"text-2xl font-bold text-green-400"},Kt={class:"text-xs text-slate-400"},Qt={class:"bg-slate-700/50 rounded-lg p-3"},Gt={class:"text-2xl font-bold text-red-400"},Yt={class:"text-xs text-slate-400"},es={key:0,class:"mt-4"},ts={class:"text-sm font-medium text-slate-300 mb-2"},ss={class:"max-h-32 overflow-y-auto space-y-1"},as={class:"mt-4 flex justify-end"},rs={key:1},ls={key:0,class:"mb-4 p-3 bg-yellow-500/20 border border-yellow-500/30 rounded-xl"},os={class:"flex items-start"},ns={class:"text-sm text-yellow-400"},ds={class:"text-xs text-yellow-400/70 mt-1"},is={key:1,class:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-xl flex items-center"},cs={class:"text-red-400 text-sm"},us={class:"mb-4"},gs={class:"block text-sm font-medium text-slate-300 mb-2"},ps={class:"flex flex-wrap gap-2 max-h-24 overflow-y-auto p-3 bg-slate-700/30 rounded-xl"},bs={key:0,class:"inline-flex items-center px-2 py-1 bg-slate-600 rounded-lg text-xs text-slate-400"},xs={key:2,class:"mb-4"},hs={class:"block text-sm font-medium text-slate-300 mb-2"},ys={class:"flex flex-wrap gap-2"},vs=["onClick"],ms={class:"mb-4"},fs={class:"block text-sm font-medium text-slate-300 mb-2"},_s=["placeholder"],ks={class:"flex justify-between mt-2 text-xs"},ws={class:"flex items-center gap-3"},$s={class:"text-slate-500"},Cs={class:"text-teal-400 font-medium"},Bs={class:"mb-6 p-3 bg-slate-700/30 rounded-xl"},Ls={class:"text-xs text-slate-400 mb-2"},Ss={class:"flex justify-end gap-3"},Ts=["disabled"],js={key:0,class:"flex items-center"},Ms={key:1},As={__name:"BulkSmsModal",props:{show:{type:Boolean,default:!1},leads:{type:Array,default:()=>[]}},emits:["close","sent"],setup(y,{emit:i}){const{t:d}=fe(),u=y,V=i,k=x(""),U=x(null),$=x([]),v=x(!1),C=x(!1),S=x(null),w=x(null),T=j(()=>u.leads.filter(B=>B.phone)),M=j(()=>u.leads.filter(B=>!B.phone)),F=j(()=>{const B=k.value,h=B.length,f=/[^\x00-\x7F]/.test(B);let I=1;f?h<=70?I=1:I=Math.ceil(h/67):h<=160?I=1:I=Math.ceil(h/153);const W=f?I===1?70:67*I:I===1?160:153*I;return{chars:h,parts:I,isUnicode:f,maxChars:W}}),q=j(()=>T.value.length*F.value.parts),m=async()=>{try{const B=await fetch(route("business.sms.templates"),{headers:{Accept:"application/json"}});B.ok&&($.value=await B.json())}catch(B){console.error("Failed to fetch templates:",B)}},_=B=>{U.value=B.id,k.value=B.content},L=async()=>{if(!k.value.trim()){S.value=d("components.sms.enter_message");return}if(T.value.length===0){S.value=d("components.sms.no_leads_with_phone");return}C.value=!0,S.value=null,w.value=null;try{const B=await fetch(route("business.sms.bulk-send"),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({lead_ids:T.value.map(f=>f.id),message:k.value,template_id:U.value})}),h=await B.json();B.ok?(w.value=h,V("sent",h),h.failed===0&&setTimeout(()=>{N()},3e3)):S.value=h.error||d("components.sms.send_error")}catch(B){S.value=d("common.network_error_retry"),console.error("Bulk SMS send error:",B)}finally{C.value=!1}},N=()=>{k.value="",U.value=null,S.value=null,w.value=null,V("close")};return se(()=>u.show,async B=>{B&&(v.value=!0,await m(),v.value=!1)}),(B,h)=>(l(),R(me,{to:"body"},[y.show?(l(),n("div",jt,[e("div",Mt,[e("div",{class:"fixed inset-0 transition-opacity bg-slate-900/75",onClick:N}),e("div",At,[e("div",zt,[e("div",Ot,[h[1]||(h[1]=e("div",{class:"w-12 h-12 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-xl flex items-center justify-center mr-4"},[e("svg",{class:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})])],-1)),e("div",null,[e("h3",Dt,s(t(d)("components.bulk_sms.title")),1),e("p",Vt,s(t(d)("components.bulk_sms.subtitle",{count:T.value.length})),1)])]),e("button",{onClick:N,class:"text-slate-400 hover:text-white"},[...h[2]||(h[2]=[e("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),v.value?(l(),n("div",qt,[h[3]||(h[3]=e("svg",{class:"animate-spin h-8 w-8 mx-auto text-teal-500",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),e("p",It,s(t(d)("common.loading")),1)])):(l(),n("div",Ut,[w.value?(l(),n("div",Et,[e("div",{class:b(["p-4 rounded-xl",w.value.failed===0?"bg-green-500/20 border border-green-500/30":"bg-yellow-500/20 border border-yellow-500/30"])},[e("div",Ft,[w.value.failed===0?(l(),n("svg",Rt,[...h[4]||(h[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(l(),n("svg",Nt,[...h[5]||(h[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])])),e("span",{class:b([w.value.failed===0?"text-green-400":"text-yellow-400","font-semibold"])},s(w.value.message),3)]),e("div",Ht,[e("div",Jt,[e("p",Pt,s(w.value.total),1),e("p",Zt,s(t(d)("common.total")),1)]),e("div",Wt,[e("p",Xt,s(w.value.sent),1),e("p",Kt,s(t(d)("components.sms.sent")),1)]),e("div",Qt,[e("p",Gt,s(w.value.failed),1),e("p",Yt,s(t(d)("common.error")),1)])]),w.value.errors&&w.value.errors.length>0?(l(),n("div",es,[e("p",ts,s(t(d)("components.sms.errors"))+":",1),e("div",ss,[(l(!0),n(O,null,D(w.value.errors,f=>(l(),n("div",{key:f.lead_id,class:"text-xs text-red-400 bg-red-500/10 rounded px-2 py-1"},s(f.name)+": "+s(f.error),1))),128))])])):p("",!0)],2),e("div",as,[e("button",{onClick:N,class:"px-6 py-2 bg-slate-700 text-white rounded-xl hover:bg-slate-600 transition-colors"},s(t(d)("common.close")),1)])])):(l(),n("div",rs,[M.value.length>0?(l(),n("div",ls,[e("div",os,[h[6]||(h[6]=e("svg",{class:"w-5 h-5 text-yellow-400 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),e("div",null,[e("p",ns,s(t(d)("components.bulk_sms.leads_without_phone",{count:M.value.length})),1),e("p",ds,s(t(d)("components.bulk_sms.only_leads_with_phone",{count:T.value.length})),1)])])])):p("",!0),S.value?(l(),n("div",is,[h[7]||(h[7]=e("svg",{class:"w-5 h-5 text-red-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",cs,s(S.value),1)])):p("",!0),e("div",us,[e("label",gs,s(t(d)("components.bulk_sms.recipients"))+" ("+s(T.value.length)+")",1),e("div",ps,[(l(!0),n(O,null,D(T.value.slice(0,20),f=>(l(),n("span",{key:f.id,class:"inline-flex items-center px-2 py-1 bg-slate-600 rounded-lg text-xs text-slate-300"},s(f.name),1))),128)),T.value.length>20?(l(),n("span",bs," +"+s(T.value.length-20),1)):p("",!0)])]),$.value.length>0?(l(),n("div",xs,[e("label",hs,s(t(d)("components.sms.select_template")),1),e("div",ys,[(l(!0),n(O,null,D($.value,f=>(l(),n("button",{key:f.id,onClick:I=>_(f),class:b(["px-3 py-1.5 rounded-lg text-sm transition-colors",U.value===f.id?"bg-teal-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"])},s(f.name),11,vs))),128))])])):p("",!0),e("div",ms,[e("label",fs,s(t(d)("components.sms.message_text")),1),Y(e("textarea",{"onUpdate:modelValue":h[0]||(h[0]=f=>k.value=f),rows:"4",placeholder:t(d)("components.sms.message_placeholder"),class:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:border-teal-500 focus:ring-1 focus:ring-teal-500 resize-none"},null,8,_s),[[Ae,k.value]]),e("div",ks,[e("div",ws,[e("span",{class:b(F.value.isUnicode?"text-yellow-400":"text-slate-500")},s(F.value.isUnicode?t(d)("components.sms.unicode"):t(d)("components.sms.latin")),3),e("span",$s,s(F.value.chars)+" "+s(t(d)("components.sms.chars"))+" | "+s(F.value.parts)+" "+s(t(d)("components.sms.parts")),1)]),e("span",Cs,s(t(d)("common.total"))+": ~"+s(q.value)+" SMS ",1)])]),e("div",Bs,[e("p",Ls,s(t(d)("components.sms.variables"))+":",1),h[8]||(h[8]=e("div",{class:"flex flex-wrap gap-2"},[e("code",{class:"px-2 py-0.5 bg-slate-600 rounded text-teal-400 text-xs"},"{name}"),e("code",{class:"px-2 py-0.5 bg-slate-600 rounded text-teal-400 text-xs"},"{phone}"),e("code",{class:"px-2 py-0.5 bg-slate-600 rounded text-teal-400 text-xs"},"{company}"),e("code",{class:"px-2 py-0.5 bg-slate-600 rounded text-teal-400 text-xs"},"{email}")],-1))]),e("div",Ss,[e("button",{onClick:N,class:"px-4 py-2 bg-slate-700 text-slate-300 rounded-xl hover:bg-slate-600 transition-colors"},s(t(d)("common.cancel")),1),e("button",{onClick:L,disabled:C.value||!k.value.trim()||T.value.length===0,class:"px-6 py-2 bg-gradient-to-r from-teal-500 to-cyan-600 text-white font-medium rounded-xl hover:from-teal-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[C.value?(l(),n("span",js,[h[9]||(h[9]=e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),A(" "+s(t(d)("components.sms.sending")),1)])):(l(),n("span",Ms,s(t(d)("components.bulk_sms.send_to_leads",{count:T.value.length})),1))],8,Ts)])]))]))])])])):p("",!0)]))}},zs={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Os={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg z-10 overflow-hidden max-h-[90vh] overflow-y-auto"},Ds={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800"},Vs={class:"flex items-center gap-3"},qs={class:"w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl flex items-center justify-center"},Is={class:"text-lg font-semibold text-gray-900 dark:text-white"},Us={class:"p-6 space-y-5"},Es={class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800"},Fs={class:"flex items-center gap-3"},Rs={class:"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center text-white font-bold text-lg"},Ns={class:"font-semibold text-gray-900 dark:text-white"},Hs={class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},Js={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},Ps={key:0,class:"flex items-center justify-center py-8"},Zs={key:1,class:"text-center py-8"},Ws={class:"text-gray-500 dark:text-gray-400"},Xs={class:"text-sm text-gray-400 dark:text-gray-500 mt-1"},Ks={key:2,class:"space-y-2"},Qs={class:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center"},Gs={class:"flex-1"},Ys={class:"font-medium text-gray-700 dark:text-gray-300"},ea={class:"text-xs text-gray-500 dark:text-gray-400"},ta=["onClick"],sa={class:"w-10 h-10 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white font-semibold"},aa={class:"flex-1 min-w-0"},ra={class:"font-medium text-gray-900 dark:text-white"},la={key:0,class:"flex items-center gap-3 mt-1 text-xs text-gray-500 dark:text-gray-400"},oa={key:0,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},na={for:"bulk-reassign-tasks",class:"text-sm text-gray-700 dark:text-gray-300"},da={key:1,class:"text-sm text-red-500"},ia={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 sticky bottom-0"},ca=["disabled"],ua={__name:"BulkAssignModal",props:{show:{type:Boolean,default:!1},leads:{type:Array,default:()=>[]}},emits:["close","assigned"],setup(y,{emit:i}){const{t:d}=fe(),u=y,V=i,k=x([]),U=x([]),$=x(null),v=x(!0),C=x(!1),S=x(!1),w=x(""),T=async()=>{S.value=!0;try{const[m,_]=await Promise.all([fetch(route("business.api.sales.operators")),fetch(route("business.api.sales.operator-stats"))]),L=await m.json(),N=await _.json();k.value=L.operators||[],U.value=N.stats||[]}catch(m){console.error("Failed to load operators:",m)}finally{S.value=!1}},M=m=>U.value.find(_=>_.operator.id===m);se(()=>u.show,m=>{m&&(w.value="",$.value=null,v.value=!0,T())});const F=async()=>{if(!(C.value||u.leads.length===0)){C.value=!0,w.value="";try{await Ne();const m=u.leads.map(L=>L.id),_=await window.axios.post(route("business.api.sales.bulk-assign"),{lead_ids:m,operator_id:$.value,reassign_tasks:v.value});_.data.success?(V("assigned",{leads:_.data.leads,operator_id:$.value}),V("close")):w.value=_.data.error||_.data.message||d("common.error_occurred")}catch(m){if(console.error("Failed to bulk assign leads:",m),mt(m)){w.value=d("common.session_expired"),await Ne();return}m.response?.data?.error?w.value=m.response.data.error:m.response?.data?.message?w.value=m.response.data.message:w.value=d("common.network_error")}finally{C.value=!1}}},q=()=>{V("close")};return(m,_)=>(l(),R(me,{to:"body"},[g(re,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:z(()=>[y.show?(l(),n("div",zs,[e("div",{class:"fixed inset-0 bg-black/50",onClick:q}),g(re,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:z(()=>[y.show?(l(),n("div",Os,[e("div",Ds,[e("div",Vs,[e("div",qs,[g(t(Me),{class:"w-5 h-5 text-white"})]),e("h3",Is,s(t(d)("components.bulk_assign.title")),1)]),e("button",{onClick:q,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[g(t(ae),{class:"w-5 h-5"})])]),e("div",Us,[e("div",Es,[e("div",Fs,[e("div",Rs,s(y.leads.length),1),e("div",null,[e("h4",Ns,s(t(d)("components.bulk_assign.leads_selected",{count:y.leads.length})),1),e("p",Hs,s(t(d)("components.bulk_assign.leads_will_be_assigned")),1)])])]),e("div",null,[e("label",Js,s(t(d)("components.bulk_assign.select_operator")),1),S.value?(l(),n("div",Ps,[..._[2]||(_[2]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"},null,-1)])])):k.value.length===0?(l(),n("div",Zs,[g(t(ft),{class:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600 mb-3"}),e("p",Ws,s(t(d)("components.bulk_assign.no_operators")),1),e("p",Xs,s(t(d)("components.bulk_assign.add_operator_hint")),1)])):(l(),n("div",Ks,[e("button",{onClick:_[0]||(_[0]=L=>$.value=null),class:b(["w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left",$.value===null?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[e("div",Qs,[g(t(ae),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"})]),e("div",Gs,[e("span",Ys,s(t(d)("components.bulk_assign.unassigned")),1),e("p",ea,s(t(d)("components.bulk_assign.leave_without_operator")),1)]),$.value===null?(l(),R(t(He),{key:0,class:"w-5 h-5 text-orange-500"})):p("",!0)],2),(l(!0),n(O,null,D(k.value,L=>(l(),n("button",{key:L.id,onClick:N=>$.value=L.id,class:b(["w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left",$.value===L.id?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[e("div",sa,s(L.name?.charAt(0)?.toUpperCase()||"?"),1),e("div",aa,[e("span",ra,s(L.name),1),M(L.id)?(l(),n("div",la,[e("span",null,s(M(L.id).leads.total)+" lid",1),e("span",null,s(M(L.id).leads.conversion_rate)+"% conversion",1)])):p("",!0)]),$.value===L.id?(l(),R(t(He),{key:0,class:"w-5 h-5 text-orange-500"})):p("",!0)],10,ta))),128))]))]),k.value.length>0?(l(),n("div",oa,[Y(e("input",{type:"checkbox",id:"bulk-reassign-tasks","onUpdate:modelValue":_[1]||(_[1]=L=>v.value=L),class:"w-4 h-4 text-orange-500 border-gray-300 rounded focus:ring-orange-500"},null,512),[[bt,v.value]]),e("label",na,s(t(d)("components.bulk_assign.reassign_tasks")),1)])):p("",!0),w.value?(l(),n("p",da,s(w.value),1)):p("",!0)]),e("div",ia,[e("button",{onClick:q,class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 font-medium rounded-xl transition-colors"},s(t(d)("common.cancel")),1),e("button",{onClick:F,disabled:C.value||y.leads.length===0,class:b(["px-6 py-2 font-medium rounded-xl transition-colors",!C.value&&y.leads.length>0?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"])},s(C.value?t(d)("common.saving"):t(d)("components.bulk_assign.assign_leads",{count:y.leads.length})),11,ca)])])):p("",!0)]),_:1})])):p("",!0)]),_:1})]))}},ga={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},pa={class:"flex min-h-full items-center justify-center p-4"},ba={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},xa={class:"flex items-center gap-3"},ha={class:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg"},ya={class:"text-lg font-semibold text-gray-900 dark:text-white"},va={class:"text-sm text-gray-500 dark:text-gray-400"},ma={key:0,class:"px-6 py-3 bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-700"},fa={class:"flex items-center justify-between"},_a={class:"font-medium text-gray-900 dark:text-white"},ka={class:"text-sm text-gray-500 dark:text-gray-400"},wa={class:"text-right"},$a={class:"text-lg font-semibold text-gray-900 dark:text-white"},Ca={class:"px-6 py-4 max-h-[60vh] overflow-y-auto"},Ba={class:"space-y-2"},La={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},Sa={class:"grid grid-cols-1 gap-2"},Ta=["value"],ja={class:"text-xl"},Ma={key:0,class:"ml-auto w-5 h-5 bg-red-500 rounded-full flex items-center justify-center"},Aa={class:"mt-4"},za={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Oa=["placeholder"],Da={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50 rounded-b-2xl"},Va=["disabled"],qa=["disabled"],Ia={key:0,class:"flex items-center gap-2"},Ua={key:1},Ea={__name:"LostReasonModal",props:{show:{type:Boolean,default:!1},lead:{type:Object,default:null}},emits:["close","confirm"],setup(y,{expose:i,emit:d}){const{t:u}=fe(),V=y,k=d,U=j(()=>[{key:"price",label:u("components.lost_reason.reason_price"),icon:"ðŸ’°"},{key:"competitor",label:u("components.lost_reason.reason_competitor"),icon:"ðŸƒ"},{key:"no_budget",label:u("components.lost_reason.reason_no_budget"),icon:"ðŸ’¸"},{key:"no_need",label:u("components.lost_reason.reason_no_need"),icon:"ðŸš«"},{key:"no_response",label:u("components.lost_reason.reason_no_response"),icon:"ðŸ“µ"},{key:"wrong_contact",label:u("components.lost_reason.reason_wrong_contact"),icon:"âŒ"},{key:"low_quality",label:u("components.lost_reason.reason_low_quality"),icon:"ðŸ‘Ž"},{key:"timing",label:u("components.lost_reason.reason_timing"),icon:"â°"},{key:"other",label:u("components.lost_reason.reason_other"),icon:"ðŸ“"}]),$=x(""),v=x(""),C=x(!1),S=j(()=>$.value&&!C.value),w=q=>q?new Intl.NumberFormat("uz-UZ").format(q):"0",T=()=>{C.value||($.value="",v.value="",k("close"))},M=async()=>{S.value&&(C.value=!0,k("confirm",{leadId:V.lead?.uuid,reason:$.value,details:v.value}))};return i({resetForm:()=>{$.value="",v.value="",C.value=!1}}),(q,m)=>(l(),R(me,{to:"body"},[g(re,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:z(()=>[y.show?(l(),n("div",ga,[e("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:T}),e("div",pa,[g(re,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:z(()=>[y.show?(l(),n("div",{key:0,class:"relative w-full max-w-md transform rounded-2xl bg-white dark:bg-gray-800 shadow-2xl transition-all",onClick:m[2]||(m[2]=je(()=>{},["stop"]))},[e("div",ba,[e("div",xa,[e("div",ha,[g(t(_t),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),e("div",null,[e("h3",ya,s(t(u)("components.lost_reason.title")),1),e("p",va,s(t(u)("components.lost_reason.select_reason")),1)])]),e("button",{onClick:T,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[g(t(ae),{class:"w-5 h-5"})])]),y.lead?(l(),n("div",ma,[e("div",fa,[e("div",null,[e("p",_a,s(y.lead.name),1),e("p",ka,s(y.lead.phone),1)]),e("div",wa,[e("p",$a,s(w(y.lead.estimated_value))+" so'm ",1)])])])):p("",!0),e("div",Ca,[e("div",Ba,[e("label",La,s(t(u)("components.lost_reason.reason_label"))+" * ",1),e("div",Sa,[(l(!0),n(O,null,D(U.value,_=>(l(),n("label",{key:_.key,class:b(["flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all",$.value===_.key?"border-red-500 bg-red-50 dark:bg-red-900/20 ring-1 ring-red-500":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 hover:bg-gray-50 dark:hover:bg-gray-700/50"])},[Y(e("input",{type:"radio",value:_.key,"onUpdate:modelValue":m[0]||(m[0]=L=>$.value=L),class:"sr-only"},null,8,Ta),[[xt,$.value]]),e("span",ja,s(_.icon),1),e("span",{class:b(["font-medium",$.value===_.key?"text-red-700 dark:text-red-400":"text-gray-700 dark:text-gray-300"])},s(_.label),3),$.value===_.key?(l(),n("div",Ma,[...m[3]||(m[3]=[e("svg",{class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)])])):p("",!0)],2))),128))])]),e("div",Aa,[e("label",za,s(t(u)("components.lost_reason.additional_notes")),1),Y(e("textarea",{"onUpdate:modelValue":m[1]||(m[1]=_=>v.value=_),rows:"3",placeholder:t(u)("components.lost_reason.notes_placeholder"),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"},null,8,Oa),[[Ae,v.value]])])]),e("div",Da,[e("button",{onClick:T,disabled:C.value,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors disabled:opacity-50"},s(t(u)("common.cancel")),9,Va),e("button",{onClick:M,disabled:!S.value,class:b(["px-4 py-2 text-sm font-medium rounded-lg transition-all",S.value?"bg-red-600 text-white hover:bg-red-700 shadow-lg shadow-red-600/25":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"])},[C.value?(l(),n("span",Ia,[m[4]||(m[4]=e("svg",{class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),A(" "+s(t(u)("common.saving")),1)])):(l(),n("span",Ua,s(t(u)("components.lost_reason.mark_as_lost")),1))],10,qa)])])):p("",!0)]),_:1})])])):p("",!0)]),_:1})]))}},Qe={initiated:{label:"Boshlandi",color:"blue",textClass:"text-blue-500"},ringing:{label:"Jiringlamoqda",color:"blue",textClass:"text-blue-500"},answered:{label:"Javob berildi",color:"green",textClass:"text-green-500"},completed:{label:"Tugallandi",color:"green",textClass:"text-green-500"},failed:{label:"Muvaffaqiyatsiz",color:"gray",textClass:"text-gray-500"},missed:{label:"O'tkazib yuborildi",color:"red",textClass:"text-red-500"},busy:{label:"Band",color:"yellow",textClass:"text-yellow-500"},no_answer:{label:"Javob yo'q",color:"red",textClass:"text-red-500"},cancelled:{label:"Bekor qilindi",color:"gray",textClass:"text-gray-500"}},Fa=y=>Qe[y]?.label||"Noma'lum",Ra=y=>Qe[y]?.textClass||"text-blue-500",Na={class:"h-full flex flex-col -m-4"},Ha={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-3 sm:px-4 lg:px-6 py-4"},Ja={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},Pa={class:"flex items-center gap-4 lg:gap-6"},Za={class:"text-xl lg:text-2xl font-bold text-gray-900 dark:text-white"},Wa={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},Xa={key:1,class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},Ka={key:0,class:"hidden xl:flex items-center gap-4 pl-4 border-l border-gray-200 dark:border-gray-700"},Qa={class:"text-center px-2"},Ga={class:"text-xl font-bold text-green-600 dark:text-green-400"},Ya={class:"text-xs text-gray-500 dark:text-gray-400"},er={class:"text-center px-2"},tr={class:"text-xl font-bold text-blue-600 dark:text-blue-400"},sr={class:"text-xs text-gray-500 dark:text-gray-400"},ar={class:"text-center px-2"},rr={class:"text-xl font-bold text-purple-600 dark:text-purple-400"},lr={class:"text-xs text-gray-500 dark:text-gray-400"},or={key:1,class:"hidden xl:flex items-center gap-4 pl-4 border-l border-gray-200 dark:border-gray-700"},nr={class:"flex items-center gap-3"},dr={class:"relative"},ir=["placeholder"],cr={value:""},ur=["value"],gr={value:""},pr={value:"unassigned"},br=["value"],xr=["disabled","title"],hr={class:"hidden sm:inline text-sm"},yr={key:0,class:"absolute -top-1.5 -right-1.5 inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},vr={class:"flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},mr=["title"],fr=["title"],_r={class:"hidden lg:inline"},kr={key:0,class:"flex-1 overflow-x-auto overflow-y-hidden"},wr={class:"h-full px-2 sm:px-3 lg:px-4 py-4"},$r={class:"flex gap-4 h-full min-w-max"},Cr={class:"flex-1 p-2 space-y-2"},Br={key:0,class:"flex items-center justify-center gap-1.5 w-full py-1.5 border border-dashed rounded-md border-gray-300 dark:border-gray-600"},Lr={key:1,class:"flex-1 overflow-x-auto overflow-y-hidden"},Sr={class:"h-full px-2 sm:px-3 lg:px-4 py-4"},Tr={class:"flex gap-4 h-full min-w-max"},jr=["onDragover","onDrop"],Mr={class:"p-3 border-b border-gray-200 dark:border-gray-700"},Ar={class:"flex items-center justify-between mb-2"},zr={class:"flex items-center gap-2"},Or={class:"font-semibold text-gray-900 dark:text-white text-sm"},Dr={class:"px-2 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-xs font-medium rounded-full"},Vr={class:"text-xs text-gray-500 dark:text-gray-400"},qr={class:"font-medium"},Ir=["onDragstart"],Ur={key:0,class:"absolute -top-2 -right-2 flex items-center gap-1 px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full shadow-lg animate-pulse z-10"},Er={class:"flex items-start justify-between gap-2 mb-2"},Fr={class:"flex items-center gap-2 min-w-0"},Rr=["onClick"],Nr={class:"min-w-0"},Hr={key:0,class:"text-xs text-gray-500 dark:text-gray-400 truncate"},Jr={class:"relative lead-menu"},Pr=["onClick"],Zr={key:0,class:"absolute right-0 mt-1 w-36 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-20"},Wr=["onClick"],Xr={class:"flex items-center justify-between mb-2"},Kr={key:0,class:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400"},Qr={class:"flex items-center gap-1 text-xs text-gray-400 dark:text-gray-500"},Gr={key:1,class:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400 truncate mb-2"},Yr={class:"truncate"},el={class:"pt-2 border-t border-gray-100 dark:border-gray-700"},tl=["title"],sl={key:0,class:"ml-0.5 text-red-500 font-semibold"},al={class:"text-xs text-gray-400 dark:text-gray-500 text-center"},rl={key:2,class:"flex-1 overflow-auto p-4 sm:p-6"},ll={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},ol={class:"w-full"},nl={class:"bg-gray-50 dark:bg-gray-900/50"},dl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},il={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},cl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},ul={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},gl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},pl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},bl={class:"px-4 py-3 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},xl={class:"divide-y divide-gray-200 dark:divide-gray-700"},hl={key:1,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-12 text-center"},yl={class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"},vl={class:"text-gray-500 dark:text-gray-400 mb-6"},ml={key:2,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},fl={class:"w-full"},_l={class:"bg-gray-50 dark:bg-gray-900/50"},kl={class:"px-4 py-3 w-12"},wl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},$l={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Cl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Bl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Ll={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Sl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Tl={class:"px-4 py-3 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},jl={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ml={class:"px-4 py-4"},Al=["onClick"],zl={class:"px-4 py-4"},Ol={class:"flex items-center gap-3"},Dl={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Vl={class:"px-4 py-4"},ql={class:"space-y-1"},Il={key:0,class:"flex items-center gap-1.5 text-sm text-gray-600 dark:text-gray-400"},Ul={key:1,class:"flex items-center gap-1.5 text-sm text-gray-600 dark:text-gray-400"},El={class:"px-4 py-4"},Fl={class:"px-4 py-4"},Rl={key:0,class:"text-sm font-semibold text-green-600 dark:text-green-400"},Nl={key:1,class:"text-sm text-gray-400"},Hl={class:"px-4 py-4"},Jl={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},Pl={key:1,class:"text-sm text-gray-400"},Zl={class:"px-4 py-4"},Wl={key:0,class:"flex items-center gap-2"},Xl={class:"w-6 h-6 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white text-xs font-semibold"},Kl={class:"text-sm text-gray-600 dark:text-gray-400"},Ql={key:1,class:"text-sm text-gray-400"},Gl={class:"px-4 py-4 text-right"},Yl={class:"flex items-center justify-end gap-1"},eo=["onClick","title"],to={key:0,class:"fixed bottom-6 left-1/2 -translate-x-1/2 z-40"},so={class:"bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl px-6 py-4 flex items-center gap-6"},ao={class:"flex items-center gap-3"},ro={class:"text-white font-bold"},lo={class:"text-white font-medium"},oo={class:"flex items-center gap-3"},no=["title"],io=["title"],co={__name:"LeadIndex",props:{panelType:{type:String,required:!0,validator:y=>["saleshead","business","operator"].includes(y)},leads:{type:Array,default:()=>[]},stats:{type:Object,default:()=>({total_leads:0,new_leads:0,qualified_leads:0,pipeline_value:0,won_deals:0,total_value:0})},channels:{type:Array,default:()=>[]},operators:{type:Array,default:()=>[]},lazyLoad:{type:Boolean,default:!1},canAssignLeads:{type:Boolean,default:!1},pipelineStages:{type:Array,default:()=>[]}},setup(y){const{t:i}=fe(),d=y,u=j(()=>d.panelType==="saleshead"?{primary:"emerald",ring:"focus:ring-emerald-500",buttonBg:"bg-emerald-600 hover:bg-emerald-700",buttonShadow:"shadow-emerald-500/25",hoverText:"hover:text-emerald-600 dark:hover:text-emerald-400",activeView:"text-emerald-600 dark:text-emerald-400",dragOver:"bg-emerald-50 dark:bg-emerald-900/20",emptyBg:"bg-emerald-100 dark:bg-emerald-900/30",emptyIcon:"text-emerald-600 dark:text-emerald-400",sourceBg:"bg-emerald-50 dark:bg-emerald-900/20",sourceText:"text-emerald-600 dark:text-emerald-400",checkboxBg:"bg-emerald-500 border-emerald-500",selectedRowBg:"bg-emerald-50 dark:bg-emerald-900/20",selectedBorder:"border-emerald-500 dark:border-emerald-400 ring-2 ring-emerald-500/20"}:{primary:"blue",ring:"focus:ring-blue-500",buttonBg:"bg-blue-600 hover:bg-blue-700",buttonShadow:"shadow-blue-500/25",hoverText:"hover:text-blue-600 dark:hover:text-blue-400",activeView:"text-blue-600 dark:text-blue-400",dragOver:"bg-blue-50 dark:bg-blue-900/20",emptyBg:"bg-blue-100 dark:bg-blue-900/30",emptyIcon:"text-blue-600 dark:text-blue-400",sourceBg:"bg-blue-50 dark:bg-blue-900/20",sourceText:"text-blue-600 dark:text-blue-400",checkboxBg:"bg-blue-500 border-blue-500",selectedRowBg:"bg-blue-50 dark:bg-blue-900/20",selectedBorder:"border-blue-500 dark:border-blue-400 ring-2 ring-blue-500/20"}),V=o=>{const a=d.panelType==="saleshead"?"/sales-head/leads":d.panelType==="operator"?"/operator/leads":"/business/api/sales";switch(o){case"leads":return d.panelType==="saleshead"?"/sales-head/leads/api":d.panelType==="operator"?"/operator/leads/api/list":"/business/api/sales/leads";case"stats":return d.panelType==="saleshead"?"/sales-head/leads/api/stats":d.panelType==="operator"?"/operator/leads/api/stats":"/business/api/sales/stats";case"operators":return d.panelType==="saleshead"?"/sales-head/operators":"/business/api/sales/operators";case"funnel":return"/business/api/sales/funnel-stats";case"sources":return"/business/api/sales/source-stats";case"smsStatus":return d.panelType==="business"?"/business/sms/status":null;default:return a}},k=(o,a=null)=>{if(d.panelType==="saleshead")switch(o){case"create":return"/sales-head/leads/create";case"show":return`/sales-head/leads/${a}`;case"edit":return`/sales-head/leads/${a}/edit`;case"status":return`/sales-head/leads/${a}/status`;case"markLost":return`/sales-head/leads/${a}/mark-lost`;default:return"/sales-head/leads"}else if(d.panelType==="operator")switch(o){case"show":return`/operator/leads/${a}`;case"status":return`/operator/leads/${a}/status`;case"note":return`/operator/leads/${a}/note`;case"call":return`/operator/leads/${a}/call`;default:return"/operator/leads"}else switch(o){case"create":return"/business/sales/create";case"show":return`/business/sales/${a}`;case"edit":return`/business/sales/${a}/edit`;case"update":return`/business/sales/${a}`;case"markLost":return`/business/api/sales/leads/${a}/mark-lost`;default:return"/business/sales"}},U=j(()=>d.panelType==="saleshead"?"/sales-head/settings/pipeline-stages":d.panelType==="business"?"/business/settings/pipeline-stages":null),$=x(!1),v=x([]),C=x(!1),S=x(!1),w=async()=>{const o=V("smsStatus");if(o)try{const a=await fetch(o,{headers:{Accept:"application/json"}});if(a.ok){const r=await a.json();C.value=r.connected}}catch(a){console.error("Failed to check SMS status:",a)}},T=o=>{const a=v.value.findIndex(r=>r.id===o.id);a===-1?v.value.push(o):v.value.splice(a,1)},M=o=>v.value.some(a=>a.id===o.id),F=()=>{v.value.length===H.value.length?v.value=[]:v.value=[...H.value]},q=()=>{v.value=[]},m=()=>{v.value.length>0&&($.value=!0)},_=()=>{if(!C.value){Re.visit("/business/settings/sms");return}m()},L=()=>{q()},N=()=>{v.value.length>0&&(S.value=!0)},B=o=>{de(),q()},h=x(!0),f=x([]),I=x(null),W=x(!1),ze=x(!1),Oe=x({current_page:1,last_page:1,per_page:50,total:0}),le=j(()=>W.value?f.value:d.leads||[]),oe=j(()=>I.value||d.stats||{total_leads:0,new_leads:0,qualified_leads:0,pipeline_value:0,won_deals:0,total_value:0}),X=x("kanban"),K=x(""),Q=x(""),P=x(""),G=x(!1),De=x([]),ne=x(!1),Z=x(null),ee=x(null),ge=x(null),pe=x(!1),be=x(null),Ge=j(()=>d.operators.length>0?d.operators:De.value),xe={blue:{bgColor:"bg-blue-500",lightBg:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-200 dark:border-blue-800"},indigo:{bgColor:"bg-indigo-500",lightBg:"bg-indigo-50 dark:bg-indigo-900/20",borderColor:"border-indigo-200 dark:border-indigo-800"},purple:{bgColor:"bg-purple-500",lightBg:"bg-purple-50 dark:bg-purple-900/20",borderColor:"border-purple-200 dark:border-purple-800"},pink:{bgColor:"bg-pink-500",lightBg:"bg-pink-50 dark:bg-pink-900/20",borderColor:"border-pink-200 dark:border-pink-800"},red:{bgColor:"bg-red-500",lightBg:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800"},orange:{bgColor:"bg-orange-500",lightBg:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-200 dark:border-orange-800"},yellow:{bgColor:"bg-yellow-500",lightBg:"bg-yellow-50 dark:bg-yellow-900/20",borderColor:"border-yellow-200 dark:border-yellow-800"},green:{bgColor:"bg-green-500",lightBg:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-200 dark:border-green-800"},teal:{bgColor:"bg-teal-500",lightBg:"bg-teal-50 dark:bg-teal-900/20",borderColor:"border-teal-200 dark:border-teal-800"},cyan:{bgColor:"bg-cyan-500",lightBg:"bg-cyan-50 dark:bg-cyan-900/20",borderColor:"border-cyan-200 dark:border-cyan-800"},gray:{bgColor:"bg-gray-500",lightBg:"bg-gray-50 dark:bg-gray-900/20",borderColor:"border-gray-200 dark:border-gray-800"}},Ye=j(()=>[{value:"new",label:i("leads.pipeline.new"),color:"blue"},{value:"contacted",label:i("leads.pipeline.contacted"),color:"indigo"},{value:"callback",label:i("leads.pipeline.callback"),color:"purple"},{value:"considering",label:i("leads.pipeline.considering"),color:"orange"},{value:"meeting_scheduled",label:i("leads.pipeline.meeting_scheduled"),color:"yellow"},{value:"meeting_attended",label:i("leads.pipeline.meeting_attended"),color:"teal"},{value:"won",label:i("leads.pipeline.won"),color:"green",is_won:!0},{value:"lost",label:i("leads.pipeline.lost"),color:"red",is_lost:!0}]),he=j(()=>d.pipelineStages.length>0?d.pipelineStages.map(a=>({value:a.slug,label:a.name,color:a.color,is_won:a.is_won,is_lost:a.is_lost,is_system:a.is_system,...xe[a.color]||xe.gray})):Ye.value.map(a=>({...a,...xe[a.color]||xe.gray}))),et=async()=>{if(!(d.operators.length>0))try{const o=await te.get(V("operators"));De.value=o.data.operators||o.data||[]}catch(o){console.error("Error fetching operators:",o)}},de=async(o=1,a=!0)=>{a&&!ze.value&&(h.value=!0);try{const r={page:o,per_page:Oe.value.per_page,fields:"id,name,phone,email,company,status,source_id,assigned_to,estimated_value,created_at"};K.value&&(r.search=K.value),Q.value&&(r.source=Q.value),P.value&&(r.operator=P.value);const c=await te.get(V("leads"),{params:r});f.value=c.data.data||[],W.value=!0,c.data.current_page&&(Oe.value={current_page:c.data.current_page,last_page:c.data.last_page,per_page:c.data.per_page,total:c.data.total})}catch(r){console.error("Error fetching leads:",r)}finally{a&&(h.value=!1,ze.value=!0)}},_e=async()=>{try{const o=await te.get(V("stats"));I.value=o.data}catch(o){console.error("Error fetching stats:",o)}},Ve=async()=>{_e(),await de()},tt=()=>{!d.lazyLoad&&d.leads?.length>0&&!W.value&&(f.value=JSON.parse(JSON.stringify(d.leads)),W.value=!0)};se(()=>d.leads,(o,a)=>{W.value?!d.lazyLoad&&a===void 0&&o?.length>0&&(f.value=JSON.parse(JSON.stringify(o||[]))):tt()},{immediate:!0});let ye;se(K,()=>{clearTimeout(ye),ye=setTimeout(()=>{de(1,!1)},200)}),se(Q,()=>de(1,!1)),se(P,()=>de(1,!1));const H=j(()=>{let o=le.value;if(!d.lazyLoad){if(K.value){const a=K.value.toLowerCase();o=o.filter(r=>r.name?.toLowerCase().includes(a)||r.email?.toLowerCase().includes(a)||r.company?.toLowerCase().includes(a)||r.phone?.toLowerCase().includes(a))}Q.value&&(o=o.filter(a=>a.source?.id===parseInt(Q.value))),P.value&&(P.value==="unassigned"?o=o.filter(a=>!a.assigned_to):o=o.filter(a=>a.assigned_to?.id===parseInt(P.value)))}return G.value&&(o=o.filter(a=>ie(a))),o}),ke=j(()=>{const o={};return he.value.forEach(a=>{o[a.value]=H.value.filter(r=>r.status===a.value)}),o}),qe=j(()=>{const o={};return he.value.forEach(a=>{const r=ke.value[a.value]||[];o[a.value]={count:r.length,value:r.reduce((c,E)=>c+(parseFloat(E.estimated_value)||0),0)}}),o}),ve=o=>he.value.find(a=>a.value===o)||{},st=o=>!!(o.source?.name?.toLowerCase().includes("telefon")||o.source?.name?.toLowerCase().includes("phone")||o.source?.name?.toLowerCase().includes("qo'ng'iroq")||o.source?.code?.includes("phone_call")||o.data?.source?.includes("phone_call")),Ie=o=>{let a=o.data;if(typeof a=="string")try{a=JSON.parse(a)}catch{a={}}return a||{}},ie=o=>{const a=Ie(o);if(a.missed_calls>0)return!0;const r=a.last_call_status;return!!(r==="no_answer"||r==="missed"||r==="unanswered"||o.calls?.some(c=>c.status==="no_answer"||c.status==="missed"))},at=o=>Ie(o).missed_calls||1,rt=()=>{G.value=!G.value},we=j(()=>le.value.filter(o=>ie(o)).length);j(()=>le.value.filter(o=>ie(o)));const $e=o=>{be.value=o,pe.value=!0},lt=async({leadId:o,reason:a,details:r})=>{try{await te.post(k("markLost",o),{lost_reason:a,lost_reason_details:r}),pe.value=!1,be.value=null;const c=f.value.map(E=>E.id===o?{...E,status:"lost",lost_reason:a,lost_reason_details:r}:{...E});f.value=c,await Le(),_e()}catch(c){console.error("Error marking lead as lost:",c)}},ot=(o,a)=>{ne.value=!0,Z.value=a,o.dataTransfer.effectAllowed="move",o.dataTransfer.setData("text/plain",a.id),setTimeout(()=>{o.target.classList.add("opacity-50","scale-95")},0)},nt=o=>{ne.value=!1,Z.value=null,ee.value=null,o.target.classList.remove("opacity-50","scale-95")},dt=(o,a)=>{o.preventDefault(),o.dataTransfer.dropEffect="move",ee.value=a},it=o=>{o.currentTarget.contains(o.relatedTarget)||(ee.value=null)},ct=async(o,a)=>{if(o.preventDefault(),ee.value=null,Z.value&&Z.value.status!==a){const r={...Z.value},c=r.id,E=r.status;if(a==="lost"){$e(r),ne.value=!1,Z.value=null;return}ne.value=!1,Z.value=null;const gt=f.value.map(ce=>ce.id===c?{...ce,status:a}:{...ce});f.value=gt,await Le();try{d.panelType==="saleshead"?await te.post(k("status",c),{status:a}):await te.put(k("update",c),{name:r.name,email:r.email,phone:r.phone,company:r.company,source_id:r.source?.id||null,status:a,score:r.score,estimated_value:r.estimated_value},{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),_e()}catch(ce){console.error("Error updating status:",ce);const pt=f.value.map(Be=>Be.id===c?{...Be,status:E}:{...Be});f.value=pt,await Le()}return}ne.value=!1,Z.value=null},ut=o=>{ge.value=ge.value===o?null:o},Ue=o=>{o.target.closest(".lead-menu")||(ge.value=null)};let Ce=null;return ht(()=>{document.addEventListener("click",Ue),et(),Ve(),w(),Ce=Re.on("navigate",o=>{const a=o.detail.page.url;(d.panelType==="saleshead"?a.includes("/sales-head/leads")&&!a.includes("/sales-head/leads/"):a.includes("/business/sales")&&!a.includes("/business/sales/"))&&Ve()})}),yt(()=>{document.removeEventListener("click",Ue),Ce&&Ce(),ye&&clearTimeout(ye)}),(o,a)=>(l(),n(O,null,[g(t(vt),{title:y.panelType==="saleshead"?t(i)("leads.index.title"):t(i)("leads.index.sales_pipeline")},null,8,["title"]),e("div",Na,[e("div",Ha,[e("div",Ja,[e("div",Pa,[e("div",null,[e("h1",Za,s(y.panelType==="saleshead"?t(i)("leads.index.title"):t(i)("leads.index.sales_pipeline")),1),h.value?(l(),n("p",Wa,[...a[8]||(a[8]=[e("span",{class:"inline-block w-32 h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"},null,-1)])])):(l(),n("p",Xa,s(oe.value?.total_leads||0)+" "+s(t(i)("leads.index.lead_count"))+" â€¢ "+s(t(Se)(oe.value?.pipeline_value))+" pipeline ",1))]),h.value?(l(),n("div",or,[(l(),n(O,null,D(3,r=>e("div",{key:r,class:"text-center px-2"},[...a[9]||(a[9]=[e("div",{class:"w-10 h-6 bg-gray-200 dark:bg-gray-700 rounded animate-pulse mb-1"},null,-1),e("div",{class:"w-14 h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"},null,-1)])])),64))])):(l(),n("div",Ka,[e("div",Qa,[e("p",Ga,s(oe.value?.won_deals||0),1),e("p",Ya,s(t(i)("leads.stats.won")),1)]),e("div",er,[e("p",tr,s(oe.value?.new_leads||0),1),e("p",sr,s(t(i)("leads.pipeline.new")),1)]),e("div",ar,[e("p",rr,s(oe.value?.qualified_leads||0),1),e("p",lr,s(t(i)("leads.stats.qualified")),1)])]))]),e("div",nr,[e("div",dr,[g(t($t),{class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),Y(e("input",{"onUpdate:modelValue":a[0]||(a[0]=r=>K.value=r),type:"text",placeholder:t(i)("leads.index.search"),class:b(["w-48 lg:w-64 pl-10 pr-4 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:border-transparent text-sm text-gray-900 dark:text-white placeholder-gray-400",u.value.ring])},null,10,ir),[[Ae,K.value]])]),Y(e("select",{"onUpdate:modelValue":a[1]||(a[1]=r=>Q.value=r),class:b(["px-3 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:border-transparent text-sm text-gray-900 dark:text-white",u.value.ring])},[e("option",cr,s(t(i)("leads.index.all_sources")),1),(l(!0),n(O,null,D(y.channels,r=>(l(),n("option",{key:r.id,value:r.id},s(r.name),9,ur))),128))],2),[[Ee,Q.value]]),Y(e("select",{"onUpdate:modelValue":a[2]||(a[2]=r=>P.value=r),class:b(["px-3 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:border-transparent text-sm text-gray-900 dark:text-white",u.value.ring])},[e("option",gr,s(t(i)("leads.index.all_operators")),1),e("option",pr,s(t(i)("leads.index.unassigned")),1),(l(!0),n(O,null,D(Ge.value,r=>(l(),n("option",{key:r.id,value:r.id},s(r.name),9,br))),128))],2),[[Ee,P.value]]),e("button",{onClick:rt,disabled:we.value===0,class:b(["relative inline-flex items-center gap-2 px-3 py-2 font-medium rounded-lg border transition-colors",G.value?"bg-red-500 border-red-500 text-white":we.value>0?"bg-white dark:bg-gray-700 border-red-300 dark:border-red-700 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20":"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-400 cursor-not-allowed"]),title:G.value?"Barcha lidlar":"O'tkazib yuborilgan qo'ng'iroqlar"},[g(t(ue),{class:"w-4 h-4"}),e("span",hr,s(G.value?"Barchasi":"O'tkazib yuborilgan"),1),G.value?p("",!0):(l(),n("span",yr,s(we.value),1))],10,xr),e("div",vr,[e("button",{onClick:a[3]||(a[3]=r=>X.value="kanban"),class:b(["p-2 rounded-md transition-colors",X.value==="kanban"?`bg-white dark:bg-gray-600 shadow-sm ${u.value.activeView}`:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"]),title:t(i)("leads.index.kanban_view")},[g(t(Tt),{class:"w-5 h-5"})],10,mr),e("button",{onClick:a[4]||(a[4]=r=>X.value="list"),class:b(["p-2 rounded-md transition-colors",X.value==="list"?`bg-white dark:bg-gray-600 shadow-sm ${u.value.activeView}`:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"]),title:t(i)("leads.index.list_view")},[g(t(Ct),{class:"w-5 h-5"})],10,fr)]),U.value?(l(),R(t(J),{key:0,href:U.value,class:"inline-flex items-center gap-2 px-3 py-2 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-700 font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",title:t(i)("leads.index.pipeline_settings_title")},{default:z(()=>[g(t(Bt),{class:"w-5 h-5"}),e("span",_r,s(t(i)("leads.index.pipeline_settings")),1)]),_:1},8,["href","title"])):p("",!0)])])]),X.value==="kanban"&&h.value?(l(),n("div",kr,[e("div",wr,[e("div",$r,[(l(),n(O,null,D(7,r=>e("div",{key:r,class:"w-72 flex-shrink-0 flex flex-col bg-gray-50 dark:bg-gray-900/50 rounded-xl"},[a[12]||(a[12]=Fe('<div class="p-3 border-b border-gray-200 dark:border-gray-700" data-v-f9dabf4f><div class="flex items-center gap-2 mb-2" data-v-f9dabf4f><div class="w-3 h-3 rounded-full bg-gray-300 dark:bg-gray-600 animate-pulse" data-v-f9dabf4f></div><div class="w-20 h-4 bg-gray-300 dark:bg-gray-600 rounded animate-pulse" data-v-f9dabf4f></div></div><div class="w-24 h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse" data-v-f9dabf4f></div></div>',1)),e("div",Cr,[r===1?(l(),n("div",Br,[...a[10]||(a[10]=[e("div",{class:"w-3.5 h-3.5 rounded bg-gray-300 dark:bg-gray-600 animate-pulse"},null,-1),e("div",{class:"w-16 h-3 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"},null,-1)])])):p("",!0),(l(),n(O,null,D(2,c=>e("div",{key:c,class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3"},[...a[11]||(a[11]=[Fe('<div class="flex items-center gap-2 mb-2" data-v-f9dabf4f><div class="w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-600 animate-pulse" data-v-f9dabf4f></div><div class="w-24 h-4 bg-gray-300 dark:bg-gray-600 rounded animate-pulse" data-v-f9dabf4f></div></div><div class="w-32 h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse mb-2" data-v-f9dabf4f></div><div class="w-20 h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse" data-v-f9dabf4f></div>',3)])])),64))])])),64))])])])):X.value==="kanban"?(l(),n("div",Lr,[e("div",Sr,[e("div",Tr,[(l(!0),n(O,null,D(he.value,r=>(l(),n("div",{key:r.value,class:"w-72 flex-shrink-0 flex flex-col bg-gray-50 dark:bg-gray-900/50 rounded-xl",onDragover:c=>dt(c,r.value),onDragleave:it,onDrop:c=>ct(c,r.value)},[e("div",Mr,[e("div",Ar,[e("div",zr,[e("div",{class:b([r.bgColor,"w-3 h-3 rounded-full"])},null,2),e("h3",Or,s(r.label),1),e("span",Dr,s(qe.value[r.value]?.count||0),1)])]),e("div",Vr,s(t(Se)(qe.value[r.value]?.value)),1)]),e("div",{class:b(["flex-1 overflow-y-auto p-2 space-y-2 transition-colors",ee.value===r.value?u.value.dragOver:""])},[r.value==="new"?(l(),R(t(J),{key:0,href:k("create"),class:b(["flex items-center justify-center gap-1.5 w-full py-1.5 border border-dashed rounded-md transition-all hover:shadow-sm text-xs",y.panelType==="saleshead"?"border-emerald-300 dark:border-emerald-600 text-emerald-600 dark:text-emerald-400 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 hover:border-emerald-400 dark:hover:border-emerald-500":"border-blue-300 dark:border-blue-600 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-400 dark:hover:border-blue-500"])},{default:z(()=>[g(t(Ze),{class:"w-3.5 h-3.5"}),e("span",qr,s(t(i)("leads.index.add_lead")),1)]),_:1},8,["href","class"])):p("",!0),(l(!0),n(O,null,D(ke.value[r.value],c=>(l(),n("div",{key:c.id,draggable:"true",onDragstart:E=>ot(E,c),onDragend:nt,class:b(["relative bg-white dark:bg-gray-800 rounded-lg border p-3 cursor-grab active:cursor-grabbing hover:shadow-md transition-all group",ie(c)?"border-red-400 dark:border-red-500 ring-2 ring-red-500/20":M(c)?u.value.selectedBorder:`border-gray-200 dark:border-gray-700 hover:border-${u.value.primary}-300 dark:hover:border-${u.value.primary}-600`])},[ie(c)?(l(),n("div",Ur,[g(t(ue),{class:"w-3 h-3"}),e("span",null,s(at(c)),1)])):p("",!0),e("div",Er,[e("div",Fr,[e("button",{onClick:je(E=>T(c),["stop"]),class:b(["w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 transition-all",M(c)?`${u.value.checkboxBg} text-white`:`border-gray-400 dark:border-gray-500 hover:border-${u.value.primary}-500 hover:bg-${u.value.primary}-500/10 opacity-0 group-hover:opacity-100`])},[M(c)?(l(),R(t(Te),{key:0,class:"w-3 h-3"})):p("",!0)],10,Rr),e("div",{class:b(["w-8 h-8 rounded-full bg-gradient-to-br flex items-center justify-center text-white text-xs font-semibold flex-shrink-0",t(Je)(c.name)])},s(t(Pe)(c.name)),3),e("div",Nr,[g(t(J),{href:k("show",c.id),class:b(["font-medium text-gray-900 dark:text-white text-sm truncate block",u.value.hoverText])},{default:z(()=>[A(s(c.name),1)]),_:2},1032,["href","class"]),c.company?(l(),n("p",Hr,s(c.company),1)):p("",!0)])]),e("div",Jr,[e("button",{onClick:je(E=>ut(c.id),["stop"]),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded opacity-0 group-hover:opacity-100 transition-opacity"},[g(t(Lt),{class:"w-4 h-4"})],8,Pr),g(re,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:z(()=>[ge.value===c.id?(l(),n("div",Zr,[g(t(J),{href:k("show",c.id),class:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},{default:z(()=>[g(t(We),{class:"w-4 h-4"}),A(" "+s(t(i)("leads.actions.view")),1)]),_:1},8,["href"]),g(t(J),{href:k("edit",c.id),class:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},{default:z(()=>[g(t(Xe),{class:"w-4 h-4"}),A(" "+s(t(i)("leads.actions.edit")),1)]),_:1},8,["href"]),c.status!=="won"&&c.status!=="lost"?(l(),n("button",{key:0,onClick:E=>$e(c),class:"w-full flex items-center gap-2 px-3 py-2 text-sm text-orange-600 dark:text-orange-400 hover:bg-orange-50 dark:hover:bg-orange-900/20"},[g(t(ae),{class:"w-4 h-4"}),A(" "+s(t(i)("leads.actions.lost")),1)],8,Wr)):p("",!0)])):p("",!0)]),_:2},1024)])]),e("div",Xr,[c.phone?(l(),n("p",Kr,[g(t(ue),{class:"w-3 h-3"}),A(" "+s(c.phone),1)])):p("",!0),e("div",Qr,[g(t(St),{class:"w-3 h-3"}),e("span",null,s(t(kt)(c.created_at)),1)])]),c.email?(l(),n("p",Gr,[g(t(Ke),{class:"w-3 h-3 flex-shrink-0"}),e("span",Yr,s(c.email),1)])):p("",!0),e("div",el,[e("div",{class:b(["px-2 py-1 rounded text-xs text-center flex items-center justify-center gap-1.5",c.source?`${u.value.sourceBg} ${u.value.sourceText}`:"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"])},[st(c)?(l(),n("span",{key:0,class:b([t(Ra)(c.data?.last_call_status),"inline-flex items-center"]),title:t(Fa)(c.data?.last_call_status)},[g(t(ue),{class:"w-3.5 h-3.5"}),c.data?.missed_calls>0?(l(),n("span",sl,s(c.data.missed_calls),1)):p("",!0)],10,tl)):p("",!0),A(" "+s(c.source?.name||t(i)("leads.index.no_source")),1)],2)])],42,Ir))),128)),ke.value[r.value]?.length?p("",!0):(l(),n("div",{key:1,class:b(["flex flex-col items-center justify-center py-8 px-4 border-2 border-dashed rounded-lg transition-colors",ee.value===r.value?`border-${u.value.primary}-400 ${u.value.dragOver}`:"border-gray-200 dark:border-gray-700"])},[g(t(Me),{class:"w-8 h-8 text-gray-300 dark:text-gray-600 mb-2"}),e("p",al,s(t(i)("leads.index.no_leads")),1)],2))],2)],40,jr))),128))])])])):X.value==="list"?(l(),n("div",rl,[h.value?(l(),n("div",ll,[e("table",ol,[e("thead",nl,[e("tr",null,[a[13]||(a[13]=e("th",{class:"px-4 py-3 w-12"},null,-1)),e("th",dl,s(t(i)("leads.table.lead")),1),e("th",il,s(t(i)("leads.table.contact")),1),e("th",cl,s(t(i)("leads.table.status")),1),e("th",ul,s(t(i)("leads.table.value")),1),e("th",gl,s(t(i)("leads.table.source")),1),e("th",pl,s(t(i)("leads.table.operator")),1),e("th",bl,s(t(i)("leads.table.actions")),1)])]),e("tbody",xl,[(l(),n(O,null,D(5,r=>e("tr",{key:r,class:"animate-pulse"},[...a[14]||(a[14]=[e("td",{class:"px-4 py-4"},[e("div",{class:"w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-600"}),e("div",null,[e("div",{class:"w-24 h-4 bg-gray-300 dark:bg-gray-600 rounded mb-1"}),e("div",{class:"w-16 h-3 bg-gray-200 dark:bg-gray-700 rounded"})])])],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"w-28 h-3 bg-gray-200 dark:bg-gray-700 rounded"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"w-16 h-5 bg-gray-200 dark:bg-gray-700 rounded"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"w-20 h-3 bg-gray-200 dark:bg-gray-700 rounded"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"w-16 h-3 bg-gray-200 dark:bg-gray-700 rounded"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"w-20 h-3 bg-gray-200 dark:bg-gray-700 rounded"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"w-20 h-6 bg-gray-200 dark:bg-gray-700 rounded float-right"})],-1)])])),64))])])])):!le.value||le.value.length===0?(l(),n("div",hl,[e("div",{class:b(["mx-auto w-20 h-20 rounded-full flex items-center justify-center mb-6",u.value.emptyBg])},[g(t(Me),{class:b(["w-10 h-10",u.value.emptyIcon])},null,8,["class"])],2),e("h3",yl,s(t(i)("leads.index.no_leads_yet")),1),e("p",vl,s(t(i)("leads.index.add_first_lead")),1),g(t(J),{href:k("create"),class:b(["inline-flex items-center gap-2 px-6 py-3 text-white font-medium rounded-xl transition-colors",u.value.buttonBg])},{default:z(()=>[g(t(Ze),{class:"w-5 h-5"}),A(" "+s(t(i)("leads.index.add_lead")),1)]),_:1},8,["href","class"])])):(l(),n("div",ml,[e("table",fl,[e("thead",_l,[e("tr",null,[e("th",kl,[e("button",{onClick:F,class:b(["w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",v.value.length===H.value.length&&H.value.length>0?`${u.value.checkboxBg} text-white`:"border-gray-300 dark:border-gray-600 hover:border-gray-400"])},[v.value.length===H.value.length&&H.value.length>0?(l(),R(t(Te),{key:0,class:"w-3 h-3"})):p("",!0)],2)]),e("th",wl,s(t(i)("leads.table.lead")),1),e("th",$l,s(t(i)("leads.table.contact")),1),e("th",Cl,s(t(i)("leads.table.status")),1),e("th",Bl,s(t(i)("leads.table.value")),1),e("th",Ll,s(t(i)("leads.table.source")),1),e("th",Sl,s(t(i)("leads.table.operator")),1),e("th",Tl,s(t(i)("leads.table.actions")),1)])]),e("tbody",jl,[(l(!0),n(O,null,D(H.value,r=>(l(),n("tr",{key:r.id,class:b(["transition-colors",M(r)?u.value.selectedRowBg:"hover:bg-gray-50 dark:hover:bg-gray-700/50"])},[e("td",Ml,[e("button",{onClick:c=>T(r),class:b(["w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",M(r)?`${u.value.checkboxBg} text-white`:"border-gray-300 dark:border-gray-600 hover:border-gray-400"])},[M(r)?(l(),R(t(Te),{key:0,class:"w-3 h-3"})):p("",!0)],10,Al)]),e("td",zl,[e("div",Ol,[e("div",{class:b(["w-10 h-10 rounded-full bg-gradient-to-br flex items-center justify-center text-white text-sm font-semibold",t(Je)(r.name)])},s(t(Pe)(r.name)),3),e("div",null,[g(t(J),{href:k("show",r.id),class:b(["font-medium text-gray-900 dark:text-white",u.value.hoverText])},{default:z(()=>[A(s(r.name),1)]),_:2},1032,["href","class"]),r.company?(l(),n("p",Dl,s(r.company),1)):p("",!0)])])]),e("td",Vl,[e("div",ql,[r.phone?(l(),n("p",Il,[g(t(ue),{class:"w-4 h-4 text-gray-400"}),A(" "+s(r.phone),1)])):p("",!0),r.email?(l(),n("p",Ul,[g(t(Ke),{class:"w-4 h-4 text-gray-400"}),A(" "+s(r.email),1)])):p("",!0)])]),e("td",El,[e("span",{class:b(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium border",ve(r.status)?.lightBg,ve(r.status)?.borderColor])},[e("span",{class:b([ve(r.status)?.bgColor,"w-1.5 h-1.5 rounded-full mr-1.5"])},null,2),A(" "+s(ve(r.status)?.label),1)],2)]),e("td",Fl,[r.estimated_value?(l(),n("span",Rl,s(t(Se)(r.estimated_value)),1)):(l(),n("span",Nl,"-"))]),e("td",Hl,[r.source?(l(),n("span",Jl,s(r.source.name),1)):(l(),n("span",Pl,"-"))]),e("td",Zl,[r.assigned_to?(l(),n("div",Wl,[e("span",Xl,s(r.assigned_to.name?.charAt(0)?.toUpperCase()),1),e("span",Kl,s(r.assigned_to.name),1)])):(l(),n("span",Ql,"-"))]),e("td",Gl,[e("div",Yl,[g(t(J),{href:k("show",r.id),class:b(["p-2 text-gray-400 rounded-lg transition-colors",u.value.hoverText]),title:t(i)("leads.actions.view")},{default:z(()=>[g(t(We),{class:"w-4 h-4"})]),_:1},8,["href","class","title"]),g(t(J),{href:k("edit",r.id),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:t(i)("leads.actions.edit")},{default:z(()=>[g(t(Xe),{class:"w-4 h-4"})]),_:1},8,["href","title"]),r.status!=="won"&&r.status!=="lost"?(l(),n("button",{key:0,onClick:c=>$e(r),class:"p-2 text-gray-400 hover:text-orange-600 dark:hover:text-orange-400 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-lg transition-colors",title:t(i)("leads.actions.mark_lost")},[g(t(ae),{class:"w-4 h-4"})],8,eo)):p("",!0)])])],2))),128))])])]))])):p("",!0)]),(l(),R(me,{to:"body"},[g(re,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-4"},{default:z(()=>[v.value.length>0?(l(),n("div",to,[e("div",so,[e("div",ao,[e("div",{class:b(["w-10 h-10 rounded-xl flex items-center justify-center",y.panelType==="saleshead"?"bg-emerald-500":"bg-blue-500"])},[e("span",ro,s(v.value.length),1)],2),e("span",lo,s(t(i)("leads.bulk.selected")),1)]),a[17]||(a[17]=e("div",{class:"h-8 w-px bg-slate-600"},null,-1)),e("div",oo,[e("button",{onClick:_,title:C.value?t(i)("leads.bulk.sms_send_hint"):t(i)("leads.bulk.sms_setup_hint"),class:b(["inline-flex items-center gap-2 px-4 py-2 font-medium rounded-xl transition-all",C.value?"bg-gradient-to-r from-teal-500 to-cyan-600 text-white hover:from-teal-600 hover:to-cyan-700":"bg-slate-700 text-slate-300 hover:bg-slate-600"])},[a[15]||(a[15]=e("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)),A(" "+s(C.value?t(i)("leads.bulk.send_sms"):t(i)("leads.bulk.setup_sms")),1)],10,no),y.canAssignLeads?(l(),n("button",{key:0,onClick:N,title:t(i)("leads.bulk.assign_hint"),class:"inline-flex items-center gap-2 px-4 py-2 font-medium rounded-xl transition-all bg-gradient-to-r from-orange-500 to-amber-600 text-white hover:from-orange-600 hover:to-amber-700"},[a[16]||(a[16]=e("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})],-1)),A(" "+s(t(i)("leads.bulk.assign_to_operator")),1)],8,io)):p("",!0),e("button",{onClick:F,class:"px-4 py-2 bg-slate-700 text-slate-300 rounded-xl hover:bg-slate-600 transition-colors"},s(v.value.length===H.value.length?t(i)("leads.bulk.clear_selection"):t(i)("leads.bulk.select_all")),1),e("button",{onClick:q,class:"p-2 text-slate-400 hover:text-white transition-colors"},[g(t(ae),{class:"w-5 h-5"})])])])])):p("",!0)]),_:1})])),g(As,{show:$.value,leads:v.value,onClose:a[5]||(a[5]=r=>$.value=!1),onSent:L},null,8,["show","leads"]),g(ua,{show:S.value,leads:v.value,onClose:a[6]||(a[6]=r=>S.value=!1),onAssigned:B},null,8,["show","leads"]),g(Ea,{show:pe.value,lead:be.value,onClose:a[7]||(a[7]=r=>{pe.value=!1,be.value=null}),onConfirm:lt},null,8,["show","lead"])],64))}},Ao=wt(co,[["__scopeId","data-v-f9dabf4f"]]);export{Ao as L};
