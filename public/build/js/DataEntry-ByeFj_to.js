import{a as e,b as t}from"./chunk-DKkye6wf.js";import{_ as a}from"./chunk-BB8-4400.js";import{r,b as s,o as l,D as n,E as d,z as i,H as o,A as g,C as u,I as c,J as p,B as x,L as y,Q as k,S as v,F as m,G as b,w as f,K as h,v as w,x as _,y as j}from"./chunk-7Urb0kxg.js";import{u as M}from"./app-DFslr8vl.js";import"./chunk-Dm-LAqtr.js";import"./chunk-Dg8ilgYs.js";import"./chunk-Rl16a4N0.js";import"./chunk-C1ExV0Y3.js";import"./chunk-DUcDuGHI.js";import"./chunk-C3XJH04c.js";import"./chunk-D2XW56yD.js";import"./chunk-DS-Zp4Qb.js";import"./chunk-Sfe4u6kO.js";import"./chunk-BAC6lhkp.js";import"./chunk-BugzYCIx.js";import"./chunk-ab1b1Fp4.js";import"./chunk-DhwSyUm1.js";import"./chunk-9PkX4iPz.js";import"./chunk-DOBCiesv.js";import"./chunk-YGW1Cp7-.js";import"./chunk-afst19KZ.js";import"./chunk-D4tA7yBb.js";import"./chunk-Di7Oc7TS.js";const C={class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden"},z={class:"px-6 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white"},I={class:"flex items-center justify-between"},B={class:"text-lg font-semibold"},D={class:"text-sm text-blue-100"},F={class:"flex items-center gap-2"},V={key:0,class:"px-3 py-1.5 rounded-lg bg-green-500/30 border border-green-400/50 text-green-100 text-sm flex items-center gap-2"},H={key:1,class:"px-3 py-1.5 rounded-lg bg-white/20 border border-white/30 text-white text-sm flex items-center gap-2"},L={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},S={class:"space-y-4"},U={class:"text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider flex items-center"},q={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},P={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},O={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},N={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},T={class:"pt-2 border-t border-gray-200 dark:border-gray-600"},$={class:"flex justify-between items-center"},A={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},R={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},K={class:"space-y-4"},Z={class:"text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider flex items-center"},E={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},Y=["value"],G={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},Q=["value"],J={class:"pt-2 border-t border-gray-200 dark:border-gray-600 mt-auto"},X={class:"flex justify-between items-center"},W={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},ee={class:"text-lg font-bold text-orange-600 dark:text-orange-400"},te={class:"flex justify-between items-center mt-2 text-sm text-gray-500 dark:text-gray-400"},ae={class:"space-y-4"},re={class:"text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider flex items-center"},se={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},le={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},ne={class:"pt-2 border-t border-gray-200 dark:border-gray-600 mt-auto"},de={class:"flex justify-between items-center"},ie={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},oe={class:"text-lg font-bold text-green-600 dark:text-green-400"},ge={class:"flex justify-between items-center mt-2 text-sm text-gray-500 dark:text-gray-400"},ue={class:"space-y-4"},ce={class:"text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider flex items-center"},pe={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},xe=["value"],ye={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},ke=["value"],ve={class:"pt-2 border-t border-gray-200 dark:border-gray-600 mt-auto"},me={class:"flex justify-between items-center"},be={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},fe={class:"text-lg font-bold text-purple-600 dark:text-purple-400"},he={class:"flex justify-between items-center mt-2 text-sm text-gray-500 dark:text-gray-400"},we={class:"mt-6"},_e={class:"block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1"},je=["placeholder"],Me={class:"mt-6 p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 rounded-xl"},Ce={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center"},ze={class:"text-sm text-gray-500 dark:text-gray-400"},Ie={class:"text-xl font-bold text-gray-900 dark:text-gray-100"},Be={class:"text-sm text-gray-500 dark:text-gray-400"},De={class:"text-xl font-bold text-gray-900 dark:text-gray-100"},Fe={class:"text-sm text-gray-500 dark:text-gray-400"},Ve={class:"mt-6 flex items-center justify-between"},He={key:0,class:"flex items-center text-sm text-yellow-600 dark:text-yellow-400"},Le={class:"flex gap-3 ml-auto"},Se=["disabled"],Ue={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},qe={__name:"QuickEntry",props:{businessId:{type:[String,Number],required:!0}},emits:["saved","error"],setup(t,{emit:a}){const{t:v}=M(),m=t,b=a,f=(new Date).toISOString().split("T")[0],h=r(!1),w=r(!1),_=s(()=>new Date(f).toLocaleDateString("uz-UZ",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),j=r({leads_digital:0,leads_offline:0,leads_referral:0,leads_organic:0,spend_digital:0,spend_offline:0,sales_new:0,sales_repeat:0,revenue_new:0,revenue_repeat:0,notes:""}),qe=e=>"number"==typeof e?e:"string"==typeof e&&parseFloat(e.replace(/[^\d.-]/g,""))||0,Pe=s(()=>qe(j.value.leads_digital)+qe(j.value.leads_offline)+qe(j.value.leads_referral)+qe(j.value.leads_organic)),Oe=s(()=>qe(j.value.spend_digital)+qe(j.value.spend_offline)),Ne=s(()=>qe(j.value.sales_new)+qe(j.value.sales_repeat)),Te=s(()=>qe(j.value.revenue_new)+qe(j.value.revenue_repeat)),$e=s(()=>0===Pe.value||0===Oe.value?0:Math.round(Oe.value/Pe.value)),Ae=s(()=>0===Pe.value?"0.0":(Ne.value/Pe.value*100).toFixed(1)),Re=s(()=>0===Ne.value?0:Math.round(Te.value/Ne.value)),Ke=s(()=>0===Oe.value?Te.value>0?"999":"0":((Te.value-Oe.value)/Oe.value*100).toFixed(0)),Ze=e=>{const t=qe(e);return!t||isNaN(t)?"0 so'm":new Intl.NumberFormat("ru-RU").format(t)+" so'm"},Ee=e=>{const t=qe(e);return t&&0!==t?new Intl.NumberFormat("ru-RU").format(t):""},Ye=e=>{if(!e)return 0;const t=String(e).replace(/[^\d-]/g,"");return parseInt(t,10)||0},Ge=()=>{j.value={leads_digital:0,leads_offline:0,leads_referral:0,leads_organic:0,spend_digital:0,spend_offline:0,sales_new:0,sales_repeat:0,revenue_new:0,revenue_repeat:0,notes:""}},Qe=async()=>{if(m.businessId){h.value=!0;try{const t={date:f,leads_digital:qe(j.value.leads_digital),leads_offline:qe(j.value.leads_offline),leads_referral:qe(j.value.leads_referral),leads_organic:qe(j.value.leads_organic),spend_digital:qe(j.value.spend_digital),spend_offline:qe(j.value.spend_offline),sales_new:qe(j.value.sales_new),sales_repeat:qe(j.value.sales_repeat),revenue_new:qe(j.value.revenue_new),revenue_repeat:qe(j.value.revenue_repeat),notes:j.value.notes},a=await e.post(`/api/v1/businesses/${m.businessId}/kpi-entry/quick-entry`,t);a.data.success&&(b("saved",a.data.data),w.value=!0)}catch(t){b("error",t.response?.data?.message||"Xatolik yuz berdi")}finally{h.value=!1}}else b("error","Biznes topilmadi")};return l(()=>{(async()=>{if(m.businessId)try{const t=await e.get(`/api/v1/businesses/${m.businessId}/kpi-entry/quick-entry`,{params:{date:f}});if(t.data.success&&t.data.data.entry){const e=t.data.data.entry;w.value=!0,j.value={leads_digital:e.leads_digital||0,leads_offline:e.leads_offline||0,leads_referral:e.leads_referral||0,leads_organic:e.leads_organic||0,spend_digital:e.spend_digital||0,spend_offline:e.spend_offline||0,sales_new:e.sales_new||0,sales_repeat:e.sales_repeat||0,revenue_new:e.revenue_new||0,revenue_repeat:e.revenue_repeat||0,notes:e.notes||""}}else w.value=!1,Ge()}catch(t){}})()}),(e,t)=>(d(),n("div",C,[i("div",z,[i("div",I,[i("div",null,[i("h3",B,o(w.value?g(v)("kpi.edit_todays_data"):g(v)("kpi.enter_todays_data")),1),i("p",D,o(_.value),1)]),i("div",F,[w.value?(d(),n("span",V,[t[15]||(t[15]=i("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)),u(" "+o(g(v)("kpi.edit_mode")),1)])):(d(),n("span",H,[t[16]||(t[16]=i("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),u(" "+o(g(v)("kpi.new_entry")),1)]))])])]),i("form",{onSubmit:k(Qe,["prevent"]),class:"p-6"},[i("div",L,[i("div",S,[i("h4",U,[t[17]||(t[17]=i("span",{class:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center mr-2"},[i("svg",{class:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),u(" "+o(g(v)("kpi.leads")),1)]),i("div",null,[i("label",q,o(g(v)("kpi.digital_sources")),1),c(i("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=e=>j.value.leads_digital=e),min:"0",class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,512),[[p,j.value.leads_digital,void 0,{number:!0}]])]),i("div",null,[i("label",P,o(g(v)("kpi.offline_sources")),1),c(i("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=e=>j.value.leads_offline=e),min:"0",class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,512),[[p,j.value.leads_offline,void 0,{number:!0}]])]),i("div",null,[i("label",O,o(g(v)("kpi.referral_sources")),1),c(i("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>j.value.leads_referral=e),min:"0",class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,512),[[p,j.value.leads_referral,void 0,{number:!0}]])]),i("div",null,[i("label",N,o(g(v)("kpi.organic_sources")),1),c(i("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>j.value.leads_organic=e),min:"0",class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,512),[[p,j.value.leads_organic,void 0,{number:!0}]])]),i("div",T,[i("div",$,[i("span",A,o(g(v)("kpi.total_leads"))+":",1),i("span",R,o(Pe.value),1)])])]),i("div",K,[i("h4",Z,[t[18]||(t[18]=i("span",{class:"w-8 h-8 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center mr-2"},[i("svg",{class:"w-4 h-4 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),u(" "+o(g(v)("kpi.expenses")),1)]),i("div",null,[i("label",E,o(g(v)("kpi.digital_ads")),1),i("input",{type:"text",value:Ee(j.value.spend_digital),onInput:t[4]||(t[4]=e=>j.value.spend_digital=Ye(e.target.value)),onBlur:t[5]||(t[5]=e=>e.target.value=Ee(j.value.spend_digital)),class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,40,Y)]),i("div",null,[i("label",G,o(g(v)("kpi.offline_ads")),1),i("input",{type:"text",value:Ee(j.value.spend_offline),onInput:t[6]||(t[6]=e=>j.value.spend_offline=Ye(e.target.value)),onBlur:t[7]||(t[7]=e=>e.target.value=Ee(j.value.spend_offline)),class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,40,Q)]),i("div",J,[i("div",X,[i("span",W,o(g(v)("kpi.total_expense"))+":",1),i("span",ee,o(Ze(Oe.value)),1)]),i("div",te,[i("span",null,o(g(v)("kpi.cpl_per_lead"))+":",1),i("span",null,o(Ze($e.value)),1)])])]),i("div",ae,[i("h4",re,[t[19]||(t[19]=i("span",{class:"w-8 h-8 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center mr-2"},[i("svg",{class:"w-4 h-4 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})])],-1)),u(" "+o(g(v)("kpi.sales")),1)]),i("div",null,[i("label",se,o(g(v)("kpi.new_customers_count")),1),c(i("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=e=>j.value.sales_new=e),min:"0",class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,512),[[p,j.value.sales_new,void 0,{number:!0}]])]),i("div",null,[i("label",le,o(g(v)("kpi.repeat_customers_count")),1),c(i("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=e=>j.value.sales_repeat=e),min:"0",class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,512),[[p,j.value.sales_repeat,void 0,{number:!0}]])]),i("div",ne,[i("div",de,[i("span",ie,o(g(v)("kpi.total_sales"))+":",1),i("span",oe,o(Ne.value),1)]),i("div",ge,[i("span",null,o(g(v)("kpi.conversion"))+":",1),i("span",null,o(Ae.value)+"%",1)])])]),i("div",ue,[i("h4",ce,[t[20]||(t[20]=i("span",{class:"w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center mr-2"},[i("svg",{class:"w-4 h-4 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),u(" "+o(g(v)("kpi.revenue")),1)]),i("div",null,[i("label",pe,o(g(v)("kpi.from_new_customers")),1),i("input",{type:"text",value:Ee(j.value.revenue_new),onInput:t[10]||(t[10]=e=>j.value.revenue_new=Ye(e.target.value)),onBlur:t[11]||(t[11]=e=>e.target.value=Ee(j.value.revenue_new)),class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,40,xe)]),i("div",null,[i("label",ye,o(g(v)("kpi.from_repeat_customers")),1),i("input",{type:"text",value:Ee(j.value.revenue_repeat),onInput:t[12]||(t[12]=e=>j.value.revenue_repeat=Ye(e.target.value)),onBlur:t[13]||(t[13]=e=>e.target.value=Ee(j.value.revenue_repeat)),class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"},null,40,ke)]),i("div",ve,[i("div",me,[i("span",be,o(g(v)("kpi.total_revenue"))+":",1),i("span",fe,o(Ze(Te.value)),1)]),i("div",he,[i("span",null,o(g(v)("kpi.avg_check"))+":",1),i("span",null,o(Ze(Re.value)),1)])])])]),i("div",we,[i("label",_e,o(g(v)("kpi.notes_optional")),1),c(i("textarea",{"onUpdate:modelValue":t[14]||(t[14]=e=>j.value.notes=e),rows:"2",class:"w-full px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:g(v)("kpi.notes_placeholder")},null,8,je),[[p,j.value.notes]])]),i("div",Me,[i("div",Ce,[i("div",null,[i("p",ze,o(g(v)("kpi.total_leads")),1),i("p",Ie,o(Pe.value),1)]),i("div",null,[i("p",Be,o(g(v)("kpi.total_sales")),1),i("p",De,o(Ne.value),1)]),i("div",null,[i("p",Fe,o(g(v)("kpi.conversion")),1),i("p",{class:x(["text-xl font-bold",Ae.value>=10?"text-green-600":"text-yellow-600"])},o(Ae.value)+"%",3)]),i("div",null,[t[21]||(t[21]=i("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"ROI",-1)),i("p",{class:x(["text-xl font-bold",Ke.value>=100?"text-green-600":Ke.value>=0?"text-yellow-600":"text-red-600"])},o(Ke.value)+"%",3)])])]),i("div",Ve,[w.value?(d(),n("div",He,[t[22]||(t[22]=i("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),u(" "+o(g(v)("kpi.data_exists_will_update")),1)])):y("",!0),i("div",Le,[i("button",{type:"button",onClick:Ge,class:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},o(g(v)("kpi.clear")),1),i("button",{type:"submit",disabled:h.value,class:"px-6 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all shadow-md disabled:opacity-50 disabled:cursor-not-allowed flex items-center"},[h.value?(d(),n("svg",Ue,[...t[23]||(t[23]=[i("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),i("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):y("",!0),u(" "+o(h.value?g(v)("common.saving"):g(v)("common.save")),1)],8,Se)])])],32)]))}},Pe={class:"space-y-6"},Oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Ne={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},Te={class:"flex items-center justify-between"},$e={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Ae={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-1"},Re={class:"flex items-center mt-2"},Ke={class:"text-sm text-gray-500 dark:text-gray-400 ml-1"},Ze={class:"mt-4 flex gap-1"},Ee=["title"],Ye=["title"],Ge=["title"],Qe=["title"],Je={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},Xe={class:"flex items-center justify-between"},We={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},et={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-1"},tt={class:"flex items-center mt-2"},at={class:"text-sm text-gray-500 dark:text-gray-400"},rt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},st={class:"flex items-center justify-between"},lt={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},nt={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-1"},dt={class:"flex items-center mt-2"},it={class:"mt-4 flex items-center justify-between text-sm"},ot={class:"text-gray-500 dark:text-gray-400"},gt={class:"text-gray-500 dark:text-gray-400"},ut={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},ct={class:"flex items-center justify-between"},pt={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},xt={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 mt-1"},yt={class:"flex items-center mt-2"},kt={class:"text-sm text-gray-500 dark:text-gray-400"},vt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},mt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},bt={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},ft={class:"space-y-4"},ht={class:"flex items-center gap-3"},wt={class:"font-medium text-gray-900 dark:text-gray-100"},_t={class:"text-sm text-gray-500 dark:text-gray-400"},jt={class:"text-right"},Mt={class:"font-semibold text-gray-900 dark:text-gray-100"},Ct={class:"text-sm text-gray-500 dark:text-gray-400"},zt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},It={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},Bt={class:"space-y-4"},Dt={class:"flex justify-between items-center mb-2"},Ft={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},Vt={class:"flex justify-between items-center mb-2"},Ht={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Lt={class:"font-bold text-gray-900 dark:text-gray-100"},St={key:0},Ut={class:"flex justify-between items-center mb-2"},qt={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Pt={key:1},Ot={class:"flex justify-between items-center mb-2"},Nt={class:"font-bold text-gray-900 dark:text-gray-100"},Tt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden"},$t={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},At={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},Rt={class:"overflow-x-auto"},Kt={class:"w-full"},Zt={class:"bg-gray-50 dark:bg-gray-700"},Et={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Yt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Gt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Qt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Jt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Xt={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Wt={class:"divide-y divide-gray-200 dark:divide-gray-700"},ea={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"},ta={class:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100"},aa={class:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100"},ra={class:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100"},sa={class:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100"},la={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},na={key:0},da={colspan:"6",class:"px-6 py-8 text-center text-gray-500 dark:text-gray-400"},ia={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},oa={class:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4"},ga={class:"space-y-3"},ua={class:"flex-shrink-0"},ca={key:0,class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pa={key:1,class:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xa={key:2,class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ya={class:"font-medium text-gray-900 dark:text-gray-100"},ka={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},va={__name:"DataEntryDashboard",props:{businessId:{type:[String,Number],required:!0}},emits:["viewAll"],setup(t,{emit:a}){const{t:u}=M(),c=t,p=r(!0),k=r({totals:{},metrics:{},trends:{}}),f=r([]),h=r([]),w=s(()=>{const e=k.value.totals||{},t=e.leads||0;return{digital:{leads:e.leads_digital||0,spend:e.spend_digital||0,percent:t>0?Math.round((e.leads_digital||0)/t*100):0},offline:{leads:e.leads_offline||0,spend:e.spend_offline||0,percent:t>0?Math.round((e.leads_offline||0)/t*100):0},referral:{leads:e.leads_referral||0,spend:0,percent:t>0?Math.round((e.leads_referral||0)/t*100):0},organic:{leads:e.leads_organic||0,spend:0,percent:t>0?Math.round((e.leads_organic||0)/t*100):0}}}),_=e=>new Intl.NumberFormat("uz-UZ").format(e||0),j=e=>e?new Intl.NumberFormat("uz-UZ").format(e)+" so'm":"0 so'm",C=e=>{const t=k.value.totals?.leads||0;if(0===t)return 0;return(k.value.totals?.[`leads_${e}`]||0)/t*100},z=e=>({digital:u("kpi.category_digital"),offline:u("kpi.category_offline"),referral:u("kpi.category_referral"),organic:u("kpi.category_organic")}[e]||e),I=e=>({digital:"bg-blue-100 dark:bg-blue-900",offline:"bg-orange-100 dark:bg-orange-900",referral:"bg-green-100 dark:bg-green-900",organic:"bg-purple-100 dark:bg-purple-900"}[e]||"bg-gray-100"),B=e=>({digital:"text-blue-600 dark:text-blue-400",offline:"text-orange-600 dark:text-orange-400",referral:"text-green-600 dark:text-green-400",organic:"text-purple-600 dark:text-purple-400"}[e]||"text-gray-600"),D=e=>{const t=parseFloat(e)||0;return t>=15?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":t>=10?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":t>=5?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"};return l(()=>{(async()=>{if(c.businessId){p.value=!0;try{const t=await e.get(`/api/v1/businesses/${c.businessId}/kpi-entry/dashboard`);if(t.data.success&&t.data.data){const e=t.data.data;k.value={totals:e.totals||{},metrics:e.metrics||{},trends:e.trends||{},today:e.today||""},f.value=e.recent_entries||[]}}catch(t){}finally{p.value=!1}}else p.value=!1})(),(async()=>{if(c.businessId)try{const t=await e.get(`/api/v1/businesses/${c.businessId}/kpi-entry/source-analysis`);t.data.success&&(h.value=t.data.data.recommendations||[])}catch(t){}})()}),(e,t)=>(d(),n("div",Pe,[i("div",Oe,[i("div",Ne,[i("div",Te,[i("div",null,[i("p",$e,o(g(u)("kpi.total_leads")),1),i("p",Ae,o(_(k.value.totals?.leads||0)),1),i("div",Re,[i("span",{class:x(["text-sm font-medium","up"===k.value.trends?.leads?.direction?"text-green-600":"text-red-600"])},o("up"===k.value.trends?.leads?.direction?"+":"")+o(k.value.trends?.leads?.percent||0)+"% ",3),i("span",Ke,o(g(u)("kpi.vs_last_week")),1)])]),t[1]||(t[1]=i("div",{class:"w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center"},[i("svg",{class:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1))]),i("div",Ze,[k.value.totals?.leads_digital>0?(d(),n("div",{key:0,class:"h-2 rounded bg-blue-500",style:v({width:C("digital")+"%"}),title:"Digital: "+k.value.totals?.leads_digital},null,12,Ee)):y("",!0),k.value.totals?.leads_offline>0?(d(),n("div",{key:1,class:"h-2 rounded bg-orange-500",style:v({width:C("offline")+"%"}),title:"Offline: "+k.value.totals?.leads_offline},null,12,Ye)):y("",!0),k.value.totals?.leads_referral>0?(d(),n("div",{key:2,class:"h-2 rounded bg-green-500",style:v({width:C("referral")+"%"}),title:"Referral: "+k.value.totals?.leads_referral},null,12,Ge)):y("",!0),k.value.totals?.leads_organic>0?(d(),n("div",{key:3,class:"h-2 rounded bg-purple-500",style:v({width:C("organic")+"%"}),title:"Organic: "+k.value.totals?.leads_organic},null,12,Qe)):y("",!0)])]),i("div",Je,[i("div",Xe,[i("div",null,[i("p",We,o(g(u)("kpi.total_expense")),1),i("p",et,o(j(k.value.totals?.spend||0)),1),i("div",tt,[i("span",at,"CPL: "+o(j(k.value.metrics?.cpl||0)),1)])]),t[2]||(t[2]=i("div",{class:"w-12 h-12 bg-orange-100 dark:bg-orange-900 rounded-xl flex items-center justify-center"},[i("svg",{class:"w-6 h-6 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))])]),i("div",rt,[i("div",st,[i("div",null,[i("p",lt,o(g(u)("kpi.total_sales")),1),i("p",nt,o(_(k.value.totals?.sales||0)),1),i("div",dt,[i("span",{class:x(["text-sm font-medium",(k.value.metrics?.conversion_rate||0)>=10?"text-green-600":"text-yellow-600"])},o(g(u)("kpi.conversion"))+": "+o(parseFloat(k.value.metrics?.conversion_rate||0).toFixed(1))+"% ",3)])]),t[3]||(t[3]=i("div",{class:"w-12 h-12 bg-green-100 dark:bg-green-900 rounded-xl flex items-center justify-center"},[i("svg",{class:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})])],-1))]),i("div",it,[i("span",ot,o(g(u)("kpi.new"))+": "+o(k.value.totals?.sales_new||0),1),i("span",gt,o(g(u)("kpi.repeat"))+": "+o(k.value.totals?.sales_repeat||0),1)])]),i("div",ut,[i("div",ct,[i("div",null,[i("p",pt,o(g(u)("kpi.total_revenue")),1),i("p",xt,o(j(k.value.totals?.revenue||0)),1),i("div",yt,[i("span",kt,o(g(u)("kpi.avg_check"))+": "+o(j(k.value.metrics?.avg_check||0)),1)])]),t[4]||(t[4]=i("div",{class:"w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-xl flex items-center justify-center"},[i("svg",{class:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})])],-1))])])]),i("div",vt,[i("div",mt,[i("h3",bt,o(g(u)("kpi.lead_sources")),1),i("div",ft,[(d(!0),n(m,null,b(w.value,(e,a)=>(d(),n("div",{key:a,class:"flex items-center justify-between"},[i("div",ht,[i("div",{class:x(["w-10 h-10 rounded-lg flex items-center justify-center",I(a)])},["digital"===a?(d(),n("svg",{key:0,class:x(["w-5 h-5",B(a)]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[5]||(t[5]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])],2)):"offline"===a?(d(),n("svg",{key:1,class:x(["w-5 h-5",B(a)]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[6]||(t[6]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])],2)):"referral"===a?(d(),n("svg",{key:2,class:x(["w-5 h-5",B(a)]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[7]||(t[7]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])],2)):(d(),n("svg",{key:3,class:x(["w-5 h-5",B(a)]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[8]||(t[8]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1)])],2))],2),i("div",null,[i("p",wt,o(z(a)),1),i("p",_t,o(e.leads)+" "+o(g(u)("kpi.lead")),1)])]),i("div",jt,[i("p",Mt,o(e.percent)+"%",1),i("p",Ct,o(j(e.spend)),1)])]))),128))])]),i("div",zt,[i("h3",It,o(g(u)("kpi.efficiency")),1),i("div",Bt,[i("div",null,[i("div",Dt,[t[9]||(t[9]=i("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"ROI",-1)),i("span",{class:x(["font-bold",(k.value.metrics?.roi||0)>=100?"text-green-600":(k.value.metrics?.roi||0)>=0?"text-yellow-600":"text-red-600"])},o(parseFloat(k.value.metrics?.roi||0).toFixed(0))+"% ",3)]),i("div",Ft,[i("div",{class:x(["h-2 rounded-full transition-all",(k.value.metrics?.roi||0)>=100?"bg-green-500":(k.value.metrics?.roi||0)>=0?"bg-yellow-500":"bg-red-500"]),style:v({width:Math.min(Math.max(k.value.metrics?.roi||0,0),200)/2+"%"})},null,6)])]),i("div",null,[i("div",Vt,[i("span",Ht,o(g(u)("kpi.cac")),1),i("span",Lt,o(j(k.value.metrics?.cac||0)),1)])]),k.value.metrics?.ltv_cac_ratio?(d(),n("div",St,[i("div",Ut,[i("span",qt,o(g(u)("kpi.ltv_cac_ratio")),1),i("span",{class:x(["font-bold",(k.value.metrics?.ltv_cac_ratio||0)>=3?"text-green-600":"text-yellow-600"])},o(parseFloat(k.value.metrics?.ltv_cac_ratio||0).toFixed(1))+"x ",3)])])):y("",!0),k.value.metrics?.gross_margin_percent?(d(),n("div",Pt,[i("div",Ot,[t[10]||(t[10]=i("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Gross Margin",-1)),i("span",Nt,o(parseFloat(k.value.metrics?.gross_margin_percent||0).toFixed(1))+"%",1)])])):y("",!0)])])]),i("div",Tt,[i("div",$t,[i("h3",At,o(g(u)("kpi.recent_entries")),1),i("button",{onClick:t[0]||(t[0]=t=>e.$emit("viewAll")),class:"text-sm text-blue-600 dark:text-blue-400 hover:underline"},o(g(u)("kpi.view_all")),1)]),i("div",Rt,[i("table",Kt,[i("thead",Zt,[i("tr",null,[i("th",Et,o(g(u)("kpi.date")),1),i("th",Yt,o(g(u)("kpi.leads")),1),i("th",Gt,o(g(u)("kpi.expense")),1),i("th",Qt,o(g(u)("kpi.sales")),1),i("th",Jt,o(g(u)("kpi.revenue")),1),i("th",Xt,o(g(u)("kpi.conversion")),1)])]),i("tbody",Wt,[(d(!0),n(m,null,b(f.value,e=>{return d(),n("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[i("td",ea,o((t=e.date,new Date(t).toLocaleDateString("uz-UZ",{day:"2-digit",month:"short"}))),1),i("td",ta,o(e.leads_total),1),i("td",aa,o(j(e.spend_total)),1),i("td",ra,o(e.sales_total),1),i("td",sa,o(j(e.revenue_total)),1),i("td",la,[i("span",{class:x(["px-2 py-1 rounded-full text-xs font-medium",D(e.conversion_rate)])},o(parseFloat(e.conversion_rate||0).toFixed(1))+"% ",3)])]);var t}),128)),0===f.value.length?(d(),n("tr",na,[i("td",da,o(g(u)("kpi.no_data_entered")),1)])):y("",!0)])])])]),h.value.length>0?(d(),n("div",ia,[i("h3",oa,o(g(u)("kpi.recommendations")),1),i("div",ga,[(d(!0),n(m,null,b(h.value,(e,a)=>{return d(),n("div",{key:a,class:x(["flex items-start gap-3 p-4 rounded-lg",(r=e.type,{positive:"bg-green-50 dark:bg-green-900/30",warning:"bg-yellow-50 dark:bg-yellow-900/30",info:"bg-blue-50 dark:bg-blue-900/30"}[r]||"bg-gray-50")])},[i("div",ua,["positive"===e.type?(d(),n("svg",ca,[...t[11]||(t[11]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)])])):"warning"===e.type?(d(),n("svg",pa,[...t[12]||(t[12]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])])):(d(),n("svg",xa,[...t[13]||(t[13]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])]))]),i("div",null,[i("p",ya,o(e.title),1),i("p",ka,o(e.message),1)])],2);var r}),128))])])):y("",!0)]))}},ma={class:"space-y-6"},ba={class:"flex items-center justify-between"},fa={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},ha={class:"flex items-center gap-2"},wa={value:"week"},_a={value:"month"},ja={value:"quarter"},Ma={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Ca={class:"flex items-center gap-3 mb-3"},za={class:"font-medium text-gray-700 dark:text-gray-300"},Ia={class:"space-y-2"},Ba={class:"flex justify-between"},Da={class:"text-sm text-gray-500 dark:text-gray-400"},Fa={class:"font-semibold text-gray-900 dark:text-gray-100"},Va={class:"flex justify-between"},Ha={class:"text-sm text-gray-500 dark:text-gray-400"},La={class:"font-semibold text-gray-900 dark:text-gray-100"},Sa={class:"flex justify-between"},Ua={class:"text-sm text-gray-500 dark:text-gray-400"},qa={class:"flex justify-between"},Pa={class:"font-semibold text-gray-900 dark:text-gray-100"},Oa={class:"flex justify-between"},Na={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden"},Ta={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},$a={class:"font-semibold text-gray-900 dark:text-gray-100"},Aa={class:"overflow-x-auto"},Ra={class:"w-full"},Ka={class:"bg-gray-50 dark:bg-gray-700"},Za={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Ea={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Ya={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Ga={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Qa={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Ja={class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Xa={class:"divide-y divide-gray-200 dark:divide-gray-700"},Wa={class:"px-6 py-4 whitespace-nowrap"},er={class:"flex items-center gap-2"},tr={class:"text-lg"},ar={class:"font-medium text-gray-900 dark:text-gray-100"},rr={class:"px-6 py-4 whitespace-nowrap"},sr={class:"px-6 py-4 whitespace-nowrap text-right text-gray-900 dark:text-gray-100"},lr={class:"px-6 py-4 whitespace-nowrap text-right"},nr={class:"flex items-center justify-end gap-2"},dr={class:"w-16 bg-gray-200 dark:bg-gray-600 rounded-full h-2"},ir={class:"text-sm text-gray-600 dark:text-gray-400"},or={class:"px-6 py-4 whitespace-nowrap text-right text-gray-900 dark:text-gray-100"},gr={class:"px-6 py-4 whitespace-nowrap text-right"},ur={class:"px-6 py-4 whitespace-nowrap text-right text-gray-900 dark:text-gray-100"},cr={class:"px-6 py-4 whitespace-nowrap text-right"},pr={key:0},xr={colspan:"8",class:"px-6 py-8 text-center text-gray-500 dark:text-gray-400"},yr={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},kr={key:0,class:"bg-green-50 dark:bg-green-900/30 rounded-xl p-5"},vr={class:"flex items-center gap-2 mb-2"},mr={class:"font-semibold text-green-800 dark:text-green-300"},br={class:"text-lg font-bold text-green-900 dark:text-green-200"},fr={class:"text-sm text-green-700 dark:text-green-400"},hr={key:1,class:"bg-blue-50 dark:bg-blue-900/30 rounded-xl p-5"},wr={class:"flex items-center gap-2 mb-2"},_r={class:"font-semibold text-blue-800 dark:text-blue-300"},jr={class:"text-lg font-bold text-blue-900 dark:text-blue-200"},Mr={class:"text-sm text-blue-700 dark:text-blue-400"},Cr={key:2,class:"bg-purple-50 dark:bg-purple-900/30 rounded-xl p-5"},zr={class:"flex items-center gap-2 mb-2"},Ir={class:"font-semibold text-purple-800 dark:text-purple-300"},Br={class:"text-lg font-bold text-purple-900 dark:text-purple-200"},Dr={class:"text-sm text-purple-700 dark:text-purple-400"},Fr={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-6"},Vr={class:"font-semibold text-gray-900 dark:text-gray-100 mb-4"},Hr={class:"space-y-3"},Lr={class:"flex-shrink-0"},Sr={key:0,class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ur={key:1,class:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},qr={key:2,class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pr={class:"font-medium text-gray-900 dark:text-gray-100"},Or={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Nr={__name:"SourceAnalysis",props:{businessId:{type:[String,Number],required:!0}},setup(t){const{t:a}=M(),s=t,u=r(!0),p=r("month"),k=r({sources:[],totals:{},insights:{}}),w=r({digital:{leads:0,spend:0,conversion_rate:0,cpl:0,roi:0},offline:{leads:0,spend:0,conversion_rate:0,cpl:0,roi:0},referral:{leads:0,spend:0,conversion_rate:0,cpl:0,roi:0},organic:{leads:0,spend:0,conversion_rate:0,cpl:0,roi:0}}),_=r([]),j=e=>e?new Intl.NumberFormat("uz-UZ").format(e)+" so'm":"0 so'm",C=e=>({digital:a("kpi.category_digital"),offline:a("kpi.category_offline"),referral:a("kpi.category_referral"),organic:a("kpi.category_organic")}[e]||e),z=e=>({digital:"ðŸ“±",offline:"ðŸ“‹",referral:"ðŸ‘¥",organic:"ðŸŒ±"}[e]||"ðŸ“Š"),I=e=>({digital:"bg-blue-100 dark:bg-blue-900",offline:"bg-orange-100 dark:bg-orange-900",referral:"bg-green-100 dark:bg-green-900",organic:"bg-purple-100 dark:bg-purple-900"}[e]||"bg-gray-100"),B=e=>({digital:"text-blue-600 dark:text-blue-400",offline:"text-orange-600 dark:text-orange-400",referral:"text-green-600 dark:text-green-400",organic:"text-purple-600 dark:text-purple-400"}[e]||"text-gray-600"),D=async()=>{if(!s.businessId)return void(u.value=!1);u.value=!0;const t=(()=>{const e=new Date;let t,a;switch(p.value){case"week":t=new Date(e),t.setDate(e.getDate()-7),a=e;break;case"quarter":t=new Date(e.getFullYear(),3*Math.floor(e.getMonth()/3),1),a=e;break;default:t=new Date(e.getFullYear(),e.getMonth(),1),a=e}return{start_date:t.toISOString().split("T")[0],end_date:a.toISOString().split("T")[0]}})();try{const a=await e.get(`/api/v1/businesses/${s.businessId}/kpi-entry/source-analysis`,{params:t});a.data.success&&(k.value=a.data.data.analysis||{sources:[],insights:{}},_.value=a.data.data.recommendations||[]);const r=await e.get(`/api/v1/businesses/${s.businessId}/kpi-entry/category-analysis`,{params:t});r.data.success&&(w.value=r.data.data)}catch(a){}finally{u.value=!1}};return f(p,()=>{D()}),l(()=>{D()}),(e,t)=>(d(),n("div",ma,[i("div",ba,[i("h3",fa,o(g(a)("kpi.source_analysis")),1),i("div",ha,[c(i("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),class:"px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm"},[i("option",wa,o(g(a)("kpi.last_week")),1),i("option",_a,o(g(a)("kpi.current_month")),1),i("option",ja,o(g(a)("kpi.current_quarter")),1)],512),[[h,p.value]])])]),i("div",Ma,[(d(!0),n(m,null,b(w.value,(e,r)=>(d(),n("div",{key:r,class:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-5"},[i("div",Ca,[i("div",{class:x(["w-10 h-10 rounded-lg flex items-center justify-center",I(r)])},[i("span",{class:x([B(r),"text-lg font-bold"])},o(z(r)),3)],2),i("span",za,o(C(r)),1)]),i("div",Ia,[i("div",Ba,[i("span",Da,o(g(a)("kpi.leads")),1),i("span",Fa,o(e.leads),1)]),i("div",Va,[i("span",Ha,o(g(a)("kpi.expense")),1),i("span",La,o(j(e.spend)),1)]),i("div",Sa,[i("span",Ua,o(g(a)("kpi.conversion")),1),i("span",{class:x(["font-semibold",e.conversion_rate>=10?"text-green-600":"text-yellow-600"])},o(e.conversion_rate)+"% ",3)]),i("div",qa,[t[1]||(t[1]=i("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"CPL",-1)),i("span",Pa,o(j(e.cpl)),1)]),i("div",Oa,[t[2]||(t[2]=i("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"ROI",-1)),i("span",{class:x(["font-semibold",e.roi>=100?"text-green-600":e.roi>=0?"text-yellow-600":"text-red-600"])},o(e.roi)+"% ",3)])])]))),128))]),i("div",Na,[i("div",Ta,[i("h4",$a,o(g(a)("kpi.detailed_source_analysis")),1)]),i("div",Aa,[i("table",Ra,[i("thead",Ka,[i("tr",null,[i("th",Za,o(g(a)("kpi.source")),1),i("th",Ea,o(g(a)("kpi.category")),1),i("th",Ya,o(g(a)("kpi.leads")),1),i("th",Ga,o(g(a)("kpi.share")),1),i("th",Qa,o(g(a)("kpi.expense")),1),i("th",Ja,o(g(a)("kpi.conversion")),1),t[3]||(t[3]=i("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"CPL",-1)),t[4]||(t[4]=i("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"ROI",-1))])]),i("tbody",Xa,[(d(!0),n(m,null,b(k.value.sources,e=>{return d(),n("tr",{key:e.source_id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[i("td",Wa,[i("div",er,[i("span",tr,o(e.icon||"ðŸ“Š"),1),i("span",ar,o(e.source_name),1)])]),i("td",rr,[i("span",{class:x(["px-2 py-1 rounded-full text-xs font-medium",(t=e.category,{digital:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",offline:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",referral:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",organic:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"}[t]||"bg-gray-100 text-gray-800")])},o(C(e.category)),3)]),i("td",sr,o(e.leads),1),i("td",lr,[i("div",nr,[i("div",dr,[i("div",{class:"h-2 rounded-full bg-blue-500",style:v({width:e.leads_percent+"%"})},null,4)]),i("span",ir,o(e.leads_percent)+"%",1)])]),i("td",or,o(j(e.spend)),1),i("td",gr,[i("span",{class:x(["font-medium",e.conversion_rate>=15?"text-green-600":e.conversion_rate>=10?"text-blue-600":"text-yellow-600"])},o(e.conversion_rate)+"% ",3)]),i("td",ur,o(j(e.cpl)),1),i("td",cr,[i("span",{class:x(["font-medium",e.roi>=100?"text-green-600":e.roi>=0?"text-yellow-600":"text-red-600"])},o(e.roi)+"% ",3)])]);var t}),128)),k.value.sources?.length?y("",!0):(d(),n("tr",pr,[i("td",xr,o(g(a)("kpi.no_source_data")),1)]))])])])]),i("div",yr,[k.value.insights?.best_conversion?(d(),n("div",kr,[i("div",vr,[t[5]||(t[5]=i("svg",{class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),i("span",mr,o(g(a)("kpi.best_conversion")),1)]),i("p",br,o(k.value.insights.best_conversion.source_name),1),i("p",fr,o(k.value.insights.best_conversion.conversion_rate)+"% "+o(g(a)("kpi.conversion")),1)])):y("",!0),k.value.insights?.best_roi?(d(),n("div",hr,[i("div",wr,[t[6]||(t[6]=i("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})],-1)),i("span",_r,o(g(a)("kpi.best_roi")),1)]),i("p",jr,o(k.value.insights.best_roi.source_name),1),i("p",Mr,o(k.value.insights.best_roi.roi)+"% ROI ",1)])):y("",!0),k.value.insights?.lowest_cpl?(d(),n("div",Cr,[i("div",zr,[t[7]||(t[7]=i("svg",{class:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),i("span",Ir,o(g(a)("kpi.lowest_cpl")),1)]),i("p",Br,o(k.value.insights.lowest_cpl.source_name),1),i("p",Dr,o(j(k.value.insights.lowest_cpl.cpl))+" / "+o(g(a)("kpi.lead")),1)])):y("",!0)]),_.value.length>0?(d(),n("div",Fr,[i("h4",Vr,o(g(a)("kpi.recommendations")),1),i("div",Hr,[(d(!0),n(m,null,b(_.value,(e,a)=>{return d(),n("div",{key:a,class:x(["flex items-start gap-3 p-4 rounded-lg",(r=e.type,{positive:"bg-green-50 dark:bg-green-900/30",warning:"bg-yellow-50 dark:bg-yellow-900/30",info:"bg-blue-50 dark:bg-blue-900/30"}[r]||"bg-gray-50")])},[i("div",Lr,["positive"===e.type?(d(),n("svg",Sr,[...t[8]||(t[8]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)])])):"warning"===e.type?(d(),n("svg",Ur,[...t[9]||(t[9]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])])):(d(),n("svg",qr,[...t[10]||(t[10]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"},null,-1)])]))]),i("div",null,[i("p",Pr,o(e.title),1),i("p",Or,o(e.message),1)])],2);var r}),128))])])):y("",!0)]))}},Tr={class:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden"},$r={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},Ar={class:"text-lg font-semibold text-gray-900 dark:text-gray-100"},Rr={class:"flex items-center gap-4"},Kr={class:"flex items-center gap-2"},Zr={class:"overflow-x-auto"},Er={class:"w-full"},Yr={class:"bg-gray-50 dark:bg-gray-700"},Gr={class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Qr={class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",colspan:"4"},Jr={class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",colspan:"2"},Xr={class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",colspan:"2"},Wr={class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},es={class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},ts={class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},as={class:"bg-gray-100 dark:bg-gray-600"},rs={class:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400"},ss={class:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400"},ls={class:"divide-y divide-gray-200 dark:divide-gray-700"},ns={class:"px-4 py-3 whitespace-nowrap"},ds={class:"font-medium text-gray-900 dark:text-gray-100"},is={class:"text-xs text-gray-500 dark:text-gray-400"},os={class:"px-4 py-3 text-center text-sm text-blue-600 dark:text-blue-400"},gs={class:"px-4 py-3 text-center text-sm text-orange-600 dark:text-orange-400"},us={class:"px-4 py-3 text-center text-sm text-green-600 dark:text-green-400"},cs={class:"px-4 py-3 text-center text-sm text-purple-600 dark:text-purple-400"},ps={class:"px-4 py-3 text-center text-sm text-gray-900 dark:text-gray-100"},xs={class:"px-4 py-3 text-center text-sm text-gray-900 dark:text-gray-100"},ys={class:"px-4 py-3 text-center text-sm text-gray-900 dark:text-gray-100"},ks={class:"px-4 py-3 text-center text-sm text-gray-900 dark:text-gray-100"},vs={class:"px-4 py-3 text-right text-sm font-medium text-gray-900 dark:text-gray-100"},ms={class:"px-4 py-3 text-right"},bs={class:"px-4 py-3 text-center"},fs={class:"flex items-center justify-center gap-2"},hs=["onClick","title"],ws=["onClick","title"],_s={key:0},js={colspan:"12",class:"px-4 py-8 text-center text-gray-500 dark:text-gray-400"},Ms={key:0,class:"bg-gray-100 dark:bg-gray-700"},Cs={class:"font-semibold"},zs={class:"px-4 py-3 text-gray-900 dark:text-gray-100"},Is={class:"px-4 py-3 text-center text-blue-600"},Bs={class:"px-4 py-3 text-center text-orange-600"},Ds={class:"px-4 py-3 text-center text-green-600"},Fs={class:"px-4 py-3 text-center text-purple-600"},Vs={class:"px-4 py-3 text-center text-gray-900 dark:text-gray-100"},Hs={class:"px-4 py-3 text-center text-gray-900 dark:text-gray-100"},Ls={class:"px-4 py-3 text-center text-gray-900 dark:text-gray-100"},Ss={class:"px-4 py-3 text-center text-gray-900 dark:text-gray-100"},Us={class:"px-4 py-3 text-right text-gray-900 dark:text-gray-100"},qs={class:"px-4 py-3 text-right"},Ps={class:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Os={key:0,class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between"},Ns={class:"text-sm text-gray-500 dark:text-gray-400"},Ts={class:"flex gap-2"},$s=["disabled"],As=["disabled"],Rs={__name:"HistoryTable",props:{businessId:{type:[String,Number],required:!0}},emits:["edit"],setup(t,{emit:a}){const{t:u}=M(),k=t,v=a,f=r(!1),h=r([]),w=r({currentPage:1,lastPage:1,from:0,to:0,total:0}),_=r({startDate:new Date((new Date).setDate((new Date).getDate()-30)).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0]}),j=s(()=>h.value.reduce((e,t)=>(e.leads_digital+=t.leads_digital||0,e.leads_offline+=t.leads_offline||0,e.leads_referral+=t.leads_referral||0,e.leads_organic+=t.leads_organic||0,e.spend_digital+=parseFloat(t.spend_digital)||0,e.spend_offline+=parseFloat(t.spend_offline)||0,e.sales_new+=t.sales_new||0,e.sales_repeat+=t.sales_repeat||0,e.revenue_total+=parseFloat(t.revenue_total)||0,e),{leads_digital:0,leads_offline:0,leads_referral:0,leads_organic:0,spend_digital:0,spend_offline:0,sales_new:0,sales_repeat:0,revenue_total:0})),C=s(()=>{const e=j.value.leads_digital+j.value.leads_offline+j.value.leads_referral+j.value.leads_organic,t=j.value.sales_new+j.value.sales_repeat;return 0===e?0:t/e*100}),z=e=>e?new Intl.NumberFormat("uz-UZ").format(e):"0",I=e=>{const t=parseFloat(e)||0;return t>=15?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":t>=10?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300":t>=5?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"},B=async()=>{if(k.businessId){f.value=!0;try{const t=await e.get(`/api/v1/businesses/${k.businessId}/kpi-entry/daily`,{params:{start_date:_.value.startDate,end_date:_.value.endDate,page:w.value.currentPage,per_page:15}});t.data.success&&(h.value=t.data.data.data||[],w.value={currentPage:t.data.data.current_page,lastPage:t.data.data.last_page,from:t.data.data.from||0,to:t.data.data.to||0,total:t.data.data.total||0})}catch(t){}finally{f.value=!1}}else f.value=!1},D=e=>{w.value.currentPage=e,B()};return l(()=>{B()}),(t,a)=>(d(),n("div",Tr,[i("div",$r,[i("h3",Ar,o(g(u)("kpi.daily_data_history")),1),i("div",Rr,[i("div",Kr,[c(i("input",{type:"date","onUpdate:modelValue":a[0]||(a[0]=e=>_.value.startDate=e),class:"px-3 py-1.5 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"},null,512),[[p,_.value.startDate]]),a[4]||(a[4]=i("span",{class:"text-gray-500"},"-",-1)),c(i("input",{type:"date","onUpdate:modelValue":a[1]||(a[1]=e=>_.value.endDate=e),class:"px-3 py-1.5 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"},null,512),[[p,_.value.endDate]])]),i("button",{onClick:B,class:"px-4 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors"},o(g(u)("kpi.search")),1)])]),i("div",Zr,[i("table",Er,[i("thead",Yr,[i("tr",null,[i("th",Gr,o(g(u)("kpi.date")),1),i("th",Qr,o(g(u)("kpi.leads")),1),i("th",Jr,o(g(u)("kpi.expense")),1),i("th",Xr,o(g(u)("kpi.sales")),1),i("th",Wr,o(g(u)("kpi.revenue")),1),i("th",es,o(g(u)("kpi.conv")),1),i("th",ts,o(g(u)("kpi.actions")),1)]),i("tr",as,[a[5]||(a[5]=i("th",{class:"px-4 py-2"},null,-1)),a[6]||(a[6]=i("th",{class:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400"},"Dig",-1)),a[7]||(a[7]=i("th",{class:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400"},"Off",-1)),a[8]||(a[8]=i("th",{class:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400"},"Ref",-1)),a[9]||(a[9]=i("th",{class:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400"},"Org",-1)),a[10]||(a[10]=i("th",{class:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400"},"Dig",-1)),a[11]||(a[11]=i("th",{class:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400"},"Off",-1)),i("th",rs,o(g(u)("kpi.new_short")),1),i("th",ss,o(g(u)("kpi.repeat_short")),1),a[12]||(a[12]=i("th",{class:"px-4 py-2"},null,-1)),a[13]||(a[13]=i("th",{class:"px-4 py-2"},null,-1)),a[14]||(a[14]=i("th",{class:"px-4 py-2"},null,-1))])]),i("tbody",ls,[(d(!0),n(m,null,b(h.value,t=>{return d(),n("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[i("td",ns,[i("div",ds,o((r=t.date,new Date(r).toLocaleDateString("uz-UZ",{day:"2-digit",month:"short",year:"numeric"}))),1),i("div",is,o(t.day_name),1)]),i("td",os,o(t.leads_digital),1),i("td",gs,o(t.leads_offline),1),i("td",us,o(t.leads_referral),1),i("td",cs,o(t.leads_organic),1),i("td",ps,o(z(t.spend_digital)),1),i("td",xs,o(z(t.spend_offline)),1),i("td",ys,o(t.sales_new),1),i("td",ks,o(t.sales_repeat),1),i("td",vs,o(z(t.revenue_total)),1),i("td",ms,[i("span",{class:x(["px-2 py-1 rounded-full text-xs font-medium",I(t.conversion_rate)])},o(parseFloat(t.conversion_rate||0).toFixed(1))+"% ",3)]),i("td",bs,[i("div",fs,[i("button",{onClick:e=>(e=>{v("edit",e)})(t),class:"p-1.5 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900 rounded-lg transition-colors",title:g(u)("common.edit")},[...a[15]||(a[15]=[i("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,hs),i("button",{onClick:a=>(async t=>{if(confirm("Bu ma'lumotni o'chirmoqchimisiz?"))try{const a=t.date.split("T")[0];await e.delete(`/api/v1/businesses/${k.businessId}/kpi-entry/daily/${a}`),B()}catch(a){}})(t),class:"p-1.5 text-red-600 hover:bg-red-100 dark:hover:bg-red-900 rounded-lg transition-colors",title:g(u)("common.delete")},[...a[16]||(a[16]=[i("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ws)])])]);var r}),128)),0===h.value.length?(d(),n("tr",_s,[i("td",js,o(g(u)("kpi.no_data_found")),1)])):y("",!0)]),h.value.length>0?(d(),n("tfoot",Ms,[i("tr",Cs,[i("td",zs,o(g(u)("kpi.total")),1),i("td",Is,o(j.value.leads_digital),1),i("td",Bs,o(j.value.leads_offline),1),i("td",Ds,o(j.value.leads_referral),1),i("td",Fs,o(j.value.leads_organic),1),i("td",Vs,o(z(j.value.spend_digital)),1),i("td",Hs,o(z(j.value.spend_offline)),1),i("td",Ls,o(j.value.sales_new),1),i("td",Ss,o(j.value.sales_repeat),1),i("td",Us,o(z(j.value.revenue_total)),1),i("td",qs,[i("span",Ps,o(C.value.toFixed(1))+"% ",1)]),a[17]||(a[17]=i("td",{class:"px-4 py-3"},null,-1))])])):y("",!0)])]),w.value.lastPage>1?(d(),n("div",Os,[i("div",Ns,o(w.value.from)+" - "+o(w.value.to)+" / "+o(w.value.total),1),i("div",Ts,[i("button",{onClick:a[2]||(a[2]=e=>D(w.value.currentPage-1)),disabled:1===w.value.currentPage,class:"px-3 py-1.5 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700"},o(g(u)("common.previous")),9,$s),i("button",{onClick:a[3]||(a[3]=e=>D(w.value.currentPage+1)),disabled:w.value.currentPage===w.value.lastPage,class:"px-3 py-1.5 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700"},o(g(u)("common.next")),9,As)])])):y("",!0)]))}},Ks={class:"mb-6"},Zs={class:"flex items-center justify-between flex-wrap gap-4"},Es={class:"flex gap-2 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg"},Ys=["onClick"],Gs={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qs={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Js={key:2,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Xs={key:3,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ws={key:0,class:"flex items-center justify-center py-12"},el={key:0},tl={key:1},al={key:2},rl={key:3},sl={key:2,class:"fixed bottom-4 right-4 z-50"},ll={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},nl={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},dl={__name:"DataEntry",setup(e){const l=t(),g=s(()=>l.props.business?.id||l.props.auth?.user?.current_business_id),c=r("quick"),p=[{id:"quick",label:"Tezkor Kiritish",icon:"edit"},{id:"dashboard",label:"Dashboard",icon:"chart"},{id:"analysis",label:"Manba Tahlili",icon:"filter"},{id:"history",label:"Tarix",icon:"clock"}],k=r({show:!1,type:"success",message:""}),v=(e,t)=>{k.value={show:!0,type:e,message:t},setTimeout(()=>{k.value.show=!1},3e3)},f=e=>{v("success","Ma'lumotlar muvaffaqiyatli saqlandi!")},h=e=>{v("error",e)};return(e,t)=>(d(),w(a,{title:"KPI Ma'lumot Kiritish"},{default:_(()=>[i("div",Ks,[i("div",Zs,[t[5]||(t[5]=i("div",null,[i("h2",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"}," KPI Ma'lumot Kiritish "),i("p",{class:"mt-1 text-gray-600 dark:text-gray-400"}," Kunlik lidlar, sotuvlar va daromadni kiriting ")],-1)),i("div",Es,[(d(),n(m,null,b(p,e=>i("button",{key:e.id,onClick:t=>c.value=e.id,class:x(["px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2",c.value===e.id?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"])},["edit"===e.icon?(d(),n("svg",Gs,[...t[1]||(t[1]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"},null,-1)])])):"chart"===e.icon?(d(),n("svg",Qs,[...t[2]||(t[2]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"},null,-1)])])):"filter"===e.icon?(d(),n("svg",Js,[...t[3]||(t[3]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"},null,-1)])])):"clock"===e.icon?(d(),n("svg",Xs,[...t[4]||(t[4]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):y("",!0),u(" "+o(e.label),1)],10,Ys)),64))])])]),g.value?(d(),n(m,{key:1},["quick"===c.value?(d(),n("div",el,[j(qe,{"business-id":g.value,onSaved:f,onError:h},null,8,["business-id"])])):"dashboard"===c.value?(d(),n("div",tl,[j(va,{"business-id":g.value,onViewAll:t[0]||(t[0]=e=>c.value="history")},null,8,["business-id"])])):"analysis"===c.value?(d(),n("div",al,[j(Nr,{"business-id":g.value},null,8,["business-id"])])):"history"===c.value?(d(),n("div",rl,[j(Rs,{"business-id":g.value},null,8,["business-id"])])):y("",!0)],64)):(d(),n("div",Ws,[...t[6]||(t[6]=[i("div",{class:"text-center"},[i("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i("p",{class:"text-gray-500 dark:text-gray-400"},"Yuklanmoqda...")],-1)])])),k.value.show?(d(),n("div",sl,[i("div",{class:x(["px-6 py-4 rounded-xl shadow-lg flex items-center gap-3","success"===k.value.type?"bg-green-600 text-white":"bg-red-600 text-white"])},["success"===k.value.type?(d(),n("svg",ll,[...t[7]||(t[7]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(d(),n("svg",nl,[...t[8]||(t[8]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])])),i("span",null,o(k.value.message),1)],2)])):y("",!0)]),_:1}))}};export{dl as default};
