import{C as e,y as a,D as t,r as l,b as s,w as r,v as o,I as d,z as n,A as i,E as c,J as u,K as g,F as p,G as b,B as x,M as y,L as v,x as m,T as h,P as k,N as f,_ as w,o as _,e as C,H as j,R as B,p as T}from"./chunk-CpmtkKLp.js";import{r as L,h as M,l as z,a as A}from"./chunk-BhZp3z4u.js";import{u as $,r as S,i as V}from"./app-C-ZlocOh.js";import{n as q,e as O}from"./chunk-D7SyfRoT.js";import{r as U}from"./chunk-DmrwHl-6.js";import{r as D}from"./chunk-eMHYSAeQ.js";import{r as H}from"./chunk-beXL1A--.js";import{a as I,g as J,c as N,d as R}from"./chunk-i83483Sm.js";import{_ as E}from"./chunk-BCo6x5W8.js";import{r as F}from"./chunk-yvcCPqrN.js";import{a as Z}from"./chunk-C9nNyFhC.js";import{r as P}from"./chunk-DJt9P8lm.js";import{r as X}from"./chunk-DWKYWsDr.js";import{r as K}from"./chunk-BiBvtcLb.js";import{r as G}from"./chunk-CAoK8Mdm.js";import{r as W}from"./chunk-SvAoNgfJ.js";import{r as Q}from"./chunk-BFPxvklm.js";import{r as Y}from"./chunk-BaJGWy5z.js";import{r as ee}from"./chunk-Bsc1JRL5.js";import{r as ae}from"./chunk-CBAnz7Zv.js";function te(l,s){return t(),e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"})])}const le={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},se={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:p-0"},re={class:"relative inline-block w-full max-w-2xl px-6 py-6 overflow-hidden text-left align-bottom transition-all transform bg-slate-800 rounded-2xl shadow-xl sm:my-8 sm:align-middle border border-slate-700"},oe={class:"flex items-center justify-between mb-6"},de={class:"flex items-center"},ne={class:"text-xl font-semibold text-white"},ie={class:"text-sm text-slate-400"},ce={key:0,class:"py-12 text-center"},ue={class:"mt-2 text-slate-400"},ge={key:1},pe={key:0,class:"mb-6"},be={class:"flex items-center mb-3"},xe={key:0,class:"w-6 h-6 text-green-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ye={key:1,class:"w-6 h-6 text-yellow-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ve={class:"grid grid-cols-3 gap-4 text-center"},me={class:"bg-slate-700/50 rounded-lg p-3"},he={class:"text-2xl font-bold text-white"},ke={class:"text-xs text-slate-400"},fe={class:"bg-slate-700/50 rounded-lg p-3"},we={class:"text-2xl font-bold text-green-400"},_e={class:"text-xs text-slate-400"},Ce={class:"bg-slate-700/50 rounded-lg p-3"},je={class:"text-2xl font-bold text-red-400"},Be={class:"text-xs text-slate-400"},Te={key:0,class:"mt-4"},Le={class:"text-sm font-medium text-slate-300 mb-2"},Me={class:"max-h-32 overflow-y-auto space-y-1"},ze={class:"mt-4 flex justify-end"},Ae={key:1},$e={key:0,class:"mb-4 p-3 bg-yellow-500/20 border border-yellow-500/30 rounded-xl"},Se={class:"flex items-start"},Ve={class:"text-sm text-yellow-400"},qe={class:"text-xs text-yellow-400/70 mt-1"},Oe={key:1,class:"mb-4 p-3 bg-red-500/20 border border-red-500/30 rounded-xl flex items-center"},Ue={class:"text-red-400 text-sm"},De={class:"mb-4"},He={class:"block text-sm font-medium text-slate-300 mb-2"},Ie={class:"flex flex-wrap gap-2 max-h-24 overflow-y-auto p-3 bg-slate-700/30 rounded-xl"},Je={key:0,class:"inline-flex items-center px-2 py-1 bg-slate-600 rounded-lg text-xs text-slate-400"},Ne={key:2,class:"mb-4"},Re={class:"block text-sm font-medium text-slate-300 mb-2"},Ee={class:"flex flex-wrap gap-2"},Fe=["onClick"],Ze={class:"mb-4"},Pe={class:"block text-sm font-medium text-slate-300 mb-2"},Xe=["placeholder"],Ke={class:"flex justify-between mt-2 text-xs"},Ge={class:"flex items-center gap-3"},We={class:"text-slate-500"},Qe={class:"text-teal-400 font-medium"},Ye={class:"mb-6 p-3 bg-slate-700/30 rounded-xl"},ea={class:"text-xs text-slate-400 mb-2"},aa={class:"flex justify-end gap-3"},ta=["disabled"],la={key:0,class:"flex items-center"},sa={key:1},ra={__name:"BulkSmsModal",props:{show:{type:Boolean,default:!1},leads:{type:Array,default:()=>[]}},emits:["close","sent"],setup(v,{emit:m}){const{t:h}=$(),k=v,f=m,w=l(""),_=l(null),C=l([]),j=l(!1),B=l(!1),T=l(null),L=l(null),M=s(()=>k.leads.filter(e=>e.phone)),z=s(()=>k.leads.filter(e=>!e.phone)),A=s(()=>{const e=w.value,a=e.length,t=/[^\x00-\x7F]/.test(e);let l=1;l=t?a<=70?1:Math.ceil(a/67):a<=160?1:Math.ceil(a/153);return{chars:a,parts:l,isUnicode:t,maxChars:t?1===l?70:67*l:1===l?160:153*l}}),S=s(()=>M.value.length*A.value.parts),V=async()=>{if(w.value.trim())if(0!==M.value.length){B.value=!0,T.value=null,L.value=null;try{const e=await fetch(route("business.sms.bulk-send"),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({lead_ids:M.value.map(e=>e.id),message:w.value,template_id:_.value})}),a=await e.json();e.ok?(L.value=a,f("sent",a),0===a.failed&&setTimeout(()=>{q()},3e3)):T.value=a.error||h("components.sms.send_error")}catch(e){T.value=h("common.network_error_retry")}finally{B.value=!1}}else T.value=h("components.sms.no_leads_with_phone");else T.value=h("components.sms.enter_message")},q=()=>{w.value="",_.value=null,T.value=null,L.value=null,f("close")};return r(()=>k.show,async e=>{e&&(j.value=!0,await(async()=>{try{const e=await fetch(route("business.sms.templates"),{headers:{Accept:"application/json"}});e.ok&&(C.value=await e.json())}catch(e){}})(),j.value=!1)}),(l,s)=>(t(),o(y,{to:"body"},[v.show?(t(),e("div",le,[a("div",se,[a("div",{class:"fixed inset-0 transition-opacity bg-slate-900/75",onClick:q}),a("div",re,[a("div",oe,[a("div",de,[s[1]||(s[1]=a("div",{class:"w-12 h-12 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-xl flex items-center justify-center mr-4"},[a("svg",{class:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})])],-1)),a("div",null,[a("h3",ne,n(i(h)("components.bulk_sms.title")),1),a("p",ie,n(i(h)("components.bulk_sms.subtitle",{count:M.value.length})),1)])]),a("button",{onClick:q,class:"text-slate-400 hover:text-white"},[...s[2]||(s[2]=[a("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),j.value?(t(),e("div",ce,[s[3]||(s[3]=a("svg",{class:"animate-spin h-8 w-8 mx-auto text-teal-500",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),a("p",ue,n(i(h)("common.loading")),1)])):(t(),e("div",ge,[L.value?(t(),e("div",pe,[a("div",{class:c(["p-4 rounded-xl",0===L.value.failed?"bg-green-500/20 border border-green-500/30":"bg-yellow-500/20 border border-yellow-500/30"])},[a("div",be,[0===L.value.failed?(t(),e("svg",xe,[...s[4]||(s[4]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(t(),e("svg",ye,[...s[5]||(s[5]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])])),a("span",{class:c([0===L.value.failed?"text-green-400":"text-yellow-400","font-semibold"])},n(L.value.message),3)]),a("div",ve,[a("div",me,[a("p",he,n(L.value.total),1),a("p",ke,n(i(h)("common.total")),1)]),a("div",fe,[a("p",we,n(L.value.sent),1),a("p",_e,n(i(h)("components.sms.sent")),1)]),a("div",Ce,[a("p",je,n(L.value.failed),1),a("p",Be,n(i(h)("common.error")),1)])]),L.value.errors&&L.value.errors.length>0?(t(),e("div",Te,[a("p",Le,n(i(h)("components.sms.errors"))+":",1),a("div",Me,[(t(!0),e(u,null,g(L.value.errors,a=>(t(),e("div",{key:a.lead_id,class:"text-xs text-red-400 bg-red-500/10 rounded px-2 py-1"},n(a.name)+": "+n(a.error),1))),128))])])):d("",!0)],2),a("div",ze,[a("button",{onClick:q,class:"px-6 py-2 bg-slate-700 text-white rounded-xl hover:bg-slate-600 transition-colors"},n(i(h)("common.close")),1)])])):(t(),e("div",Ae,[z.value.length>0?(t(),e("div",$e,[a("div",Se,[s[6]||(s[6]=a("svg",{class:"w-5 h-5 text-yellow-400 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),a("div",null,[a("p",Ve,n(i(h)("components.bulk_sms.leads_without_phone",{count:z.value.length})),1),a("p",qe,n(i(h)("components.bulk_sms.only_leads_with_phone",{count:M.value.length})),1)])])])):d("",!0),T.value?(t(),e("div",Oe,[s[7]||(s[7]=a("svg",{class:"w-5 h-5 text-red-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),a("p",Ue,n(T.value),1)])):d("",!0),a("div",De,[a("label",He,n(i(h)("components.bulk_sms.recipients"))+" ("+n(M.value.length)+")",1),a("div",Ie,[(t(!0),e(u,null,g(M.value.slice(0,20),a=>(t(),e("span",{key:a.id,class:"inline-flex items-center px-2 py-1 bg-slate-600 rounded-lg text-xs text-slate-300"},n(a.name),1))),128)),M.value.length>20?(t(),e("span",Je," +"+n(M.value.length-20),1)):d("",!0)])]),C.value.length>0?(t(),e("div",Ne,[a("label",Re,n(i(h)("components.sms.select_template")),1),a("div",Ee,[(t(!0),e(u,null,g(C.value,a=>(t(),e("button",{key:a.id,onClick:e=>(e=>{_.value=e.id,w.value=e.content})(a),class:c(["px-3 py-1.5 rounded-lg text-sm transition-colors",_.value===a.id?"bg-teal-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"])},n(a.name),11,Fe))),128))])])):d("",!0),a("div",Ze,[a("label",Pe,n(i(h)("components.sms.message_text")),1),p(a("textarea",{"onUpdate:modelValue":s[0]||(s[0]=e=>w.value=e),rows:"4",placeholder:i(h)("components.sms.message_placeholder"),class:"w-full px-4 py-3 bg-slate-700/50 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:border-teal-500 focus:ring-1 focus:ring-teal-500 resize-none"},null,8,Xe),[[b,w.value]]),a("div",Ke,[a("div",Ge,[a("span",{class:c(A.value.isUnicode?"text-yellow-400":"text-slate-500")},n(A.value.isUnicode?i(h)("components.sms.unicode"):i(h)("components.sms.latin")),3),a("span",We,n(A.value.chars)+" "+n(i(h)("components.sms.chars"))+" | "+n(A.value.parts)+" "+n(i(h)("components.sms.parts")),1)]),a("span",Qe,n(i(h)("common.total"))+": ~"+n(S.value)+" SMS ",1)])]),a("div",Ye,[a("p",ea,n(i(h)("components.sms.variables"))+":",1),s[8]||(s[8]=a("div",{class:"flex flex-wrap gap-2"},[a("code",{class:"px-2 py-0.5 bg-slate-600 rounded text-teal-400 text-xs"},"{name}"),a("code",{class:"px-2 py-0.5 bg-slate-600 rounded text-teal-400 text-xs"},"{phone}"),a("code",{class:"px-2 py-0.5 bg-slate-600 rounded text-teal-400 text-xs"},"{company}"),a("code",{class:"px-2 py-0.5 bg-slate-600 rounded text-teal-400 text-xs"},"{email}")],-1))]),a("div",aa,[a("button",{onClick:q,class:"px-4 py-2 bg-slate-700 text-slate-300 rounded-xl hover:bg-slate-600 transition-colors"},n(i(h)("common.cancel")),1),a("button",{onClick:V,disabled:B.value||!w.value.trim()||0===M.value.length,class:"px-6 py-2 bg-gradient-to-r from-teal-500 to-cyan-600 text-white font-medium rounded-xl hover:from-teal-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},[B.value?(t(),e("span",la,[s[9]||(s[9]=a("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),x(" "+n(i(h)("components.sms.sending")),1)])):(t(),e("span",sa,n(i(h)("components.bulk_sms.send_to_leads",{count:M.value.length})),1))],8,ta)])]))]))])])])):d("",!0)]))}},oa={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},da={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg z-10 overflow-hidden max-h-[90vh] overflow-y-auto"},na={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800"},ia={class:"flex items-center gap-3"},ca={class:"w-10 h-10 bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl flex items-center justify-center"},ua={class:"text-lg font-semibold text-gray-900 dark:text-white"},ga={class:"p-6 space-y-5"},pa={class:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-200 dark:border-blue-800"},ba={class:"flex items-center gap-3"},xa={class:"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center text-white font-bold text-lg"},ya={class:"font-semibold text-gray-900 dark:text-white"},va={class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},ma={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},ha={key:0,class:"flex items-center justify-center py-8"},ka={key:1,class:"text-center py-8"},fa={class:"text-gray-500 dark:text-gray-400"},wa={class:"text-sm text-gray-400 dark:text-gray-500 mt-1"},_a={key:2,class:"space-y-2"},Ca={class:"w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center"},ja={class:"flex-1"},Ba={class:"font-medium text-gray-700 dark:text-gray-300"},Ta={class:"text-xs text-gray-500 dark:text-gray-400"},La=["onClick"],Ma={class:"w-10 h-10 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white font-semibold"},za={class:"flex-1 min-w-0"},Aa={class:"font-medium text-gray-900 dark:text-white"},$a={key:0,class:"flex items-center gap-3 mt-1 text-xs text-gray-500 dark:text-gray-400"},Sa={key:0,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},Va={for:"bulk-reassign-tasks",class:"text-sm text-gray-700 dark:text-gray-300"},qa={key:1,class:"text-sm text-red-500"},Oa={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50 sticky bottom-0"},Ua=["disabled"],Da={__name:"BulkAssignModal",props:{show:{type:Boolean,default:!1},leads:{type:Array,default:()=>[]}},emits:["close","assigned"],setup(s,{emit:b}){const{t:x}=$(),f=s,w=b,_=l([]),C=l([]),j=l(null),B=l(!0),T=l(!1),L=l(!1),M=l(""),z=e=>C.value.find(a=>a.operator.id===e);r(()=>f.show,e=>{e&&(M.value="",j.value=null,B.value=!0,(async()=>{L.value=!0;try{const[e,a]=await Promise.all([fetch(route("business.api.sales.operators")),fetch(route("business.api.sales.operator-stats"))]),t=await e.json(),l=await a.json();_.value=t.operators||[],C.value=l.stats||[]}catch(e){}finally{L.value=!1}})())});const A=async()=>{if(!T.value&&0!==f.leads.length){T.value=!0,M.value="";try{await S();const e=f.leads.map(e=>e.id),a=await window.axios.post(route("business.api.sales.bulk-assign"),{lead_ids:e,operator_id:j.value,reassign_tasks:B.value});a.data.success?(w("assigned",{leads:a.data.leads,operator_id:j.value}),w("close")):M.value=a.data.error||a.data.message||x("common.error_occurred")}catch(e){if(V(e))return M.value=x("common.session_expired"),void(await S());e.response?.data?.error?M.value=e.response.data.error:e.response?.data?.message?M.value=e.response.data.message:M.value=x("common.network_error")}finally{T.value=!1}}},H=()=>{w("close")};return(l,r)=>(t(),o(y,{to:"body"},[v(h,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:m(()=>[s.show?(t(),e("div",oa,[a("div",{class:"fixed inset-0 bg-black/50",onClick:H}),v(h,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:m(()=>[s.show?(t(),e("div",da,[a("div",na,[a("div",ia,[a("div",ca,[v(i(q),{class:"w-5 h-5 text-white"})]),a("h3",ua,n(i(x)("components.bulk_assign.title")),1)]),a("button",{onClick:H,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[v(i(U),{class:"w-5 h-5"})])]),a("div",ga,[a("div",pa,[a("div",ba,[a("div",xa,n(s.leads.length),1),a("div",null,[a("h4",ya,n(i(x)("components.bulk_assign.leads_selected",{count:s.leads.length})),1),a("p",va,n(i(x)("components.bulk_assign.leads_will_be_assigned")),1)])])]),a("div",null,[a("label",ma,n(i(x)("components.bulk_assign.select_operator")),1),L.value?(t(),e("div",ha,[...r[2]||(r[2]=[a("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"},null,-1)])])):0===_.value.length?(t(),e("div",ka,[v(i(O),{class:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600 mb-3"}),a("p",fa,n(i(x)("components.bulk_assign.no_operators")),1),a("p",wa,n(i(x)("components.bulk_assign.add_operator_hint")),1)])):(t(),e("div",_a,[a("button",{onClick:r[0]||(r[0]=e=>j.value=null),class:c(["w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left",null===j.value?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[a("div",Ca,[v(i(U),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"})]),a("div",ja,[a("span",Ba,n(i(x)("components.bulk_assign.unassigned")),1),a("p",Ta,n(i(x)("components.bulk_assign.leave_without_operator")),1)]),null===j.value?(t(),o(i(D),{key:0,class:"w-5 h-5 text-orange-500"})):d("",!0)],2),(t(!0),e(u,null,g(_.value,l=>(t(),e("button",{key:l.id,onClick:e=>j.value=l.id,class:c(["w-full flex items-center gap-3 p-3 rounded-xl border-2 transition-all text-left",j.value===l.id?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[a("div",Ma,n(l.name?.charAt(0)?.toUpperCase()||"?"),1),a("div",za,[a("span",Aa,n(l.name),1),z(l.id)?(t(),e("div",$a,[a("span",null,n(z(l.id).leads.total)+" lid",1),a("span",null,n(z(l.id).leads.conversion_rate)+"% conversion",1)])):d("",!0)]),j.value===l.id?(t(),o(i(D),{key:0,class:"w-5 h-5 text-orange-500"})):d("",!0)],10,La))),128))]))]),_.value.length>0?(t(),e("div",Sa,[p(a("input",{type:"checkbox",id:"bulk-reassign-tasks","onUpdate:modelValue":r[1]||(r[1]=e=>B.value=e),class:"w-4 h-4 text-orange-500 border-gray-300 rounded focus:ring-orange-500"},null,512),[[k,B.value]]),a("label",Va,n(i(x)("components.bulk_assign.reassign_tasks")),1)])):d("",!0),M.value?(t(),e("p",qa,n(M.value),1)):d("",!0)]),a("div",Oa,[a("button",{onClick:H,class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 font-medium rounded-xl transition-colors"},n(i(x)("common.cancel")),1),a("button",{onClick:A,disabled:T.value||0===s.leads.length,class:c(["px-6 py-2 font-medium rounded-xl transition-colors",!T.value&&s.leads.length>0?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"])},n(T.value?i(x)("common.saving"):i(x)("components.bulk_assign.assign_leads",{count:s.leads.length})),11,Ua)])])):d("",!0)]),_:1})])):d("",!0)]),_:1})]))}},Ha={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Ia={class:"flex min-h-full items-center justify-center p-4"},Ja={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Na={class:"flex items-center gap-3"},Ra={class:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg"},Ea={class:"text-lg font-semibold text-gray-900 dark:text-white"},Fa={class:"text-sm text-gray-500 dark:text-gray-400"},Za={key:0,class:"px-6 py-3 bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-700"},Pa={class:"flex items-center justify-between"},Xa={class:"font-medium text-gray-900 dark:text-white"},Ka={class:"text-sm text-gray-500 dark:text-gray-400"},Ga={class:"text-right"},Wa={class:"text-lg font-semibold text-gray-900 dark:text-white"},Qa={class:"px-6 py-4 max-h-[60vh] overflow-y-auto"},Ya={class:"space-y-2"},et={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},at={class:"grid grid-cols-1 gap-2"},tt=["value"],lt={class:"text-xl"},st={key:0,class:"ml-auto w-5 h-5 bg-red-500 rounded-full flex items-center justify-center"},rt={class:"mt-4"},ot={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},dt=["placeholder"],nt={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50 rounded-b-2xl"},it=["disabled"],ct=["disabled"],ut={key:0,class:"flex items-center gap-2"},gt={key:1},pt={__name:"LostReasonModal",props:{show:{type:Boolean,default:!1},lead:{type:Object,default:null}},emits:["close","confirm"],setup(r,{expose:k,emit:_}){const{t:C}=$(),j=r,B=_,T=s(()=>[{key:"price",label:C("components.lost_reason.reason_price"),icon:"ðŸ’°"},{key:"competitor",label:C("components.lost_reason.reason_competitor"),icon:"ðŸƒ"},{key:"no_budget",label:C("components.lost_reason.reason_no_budget"),icon:"ðŸ’¸"},{key:"no_need",label:C("components.lost_reason.reason_no_need"),icon:"ðŸš«"},{key:"no_response",label:C("components.lost_reason.reason_no_response"),icon:"ðŸ“µ"},{key:"wrong_contact",label:C("components.lost_reason.reason_wrong_contact"),icon:"âŒ"},{key:"low_quality",label:C("components.lost_reason.reason_low_quality"),icon:"ðŸ‘Ž"},{key:"timing",label:C("components.lost_reason.reason_timing"),icon:"â°"},{key:"other",label:C("components.lost_reason.reason_other"),icon:"ðŸ“"}]),L=l(""),M=l(""),z=l(!1),A=s(()=>L.value&&!z.value),S=()=>{z.value||(L.value="",M.value="",B("close"))},V=async()=>{A.value&&(z.value=!0,B("confirm",{leadId:j.lead?.uuid,reason:L.value,details:M.value}))};return k({resetForm:()=>{L.value="",M.value="",z.value=!1}}),(l,s)=>(t(),o(y,{to:"body"},[v(h,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:m(()=>[r.show?(t(),e("div",Ha,[a("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:S}),a("div",Ia,[v(h,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:m(()=>{return[r.show?(t(),e("div",{key:0,class:"relative w-full max-w-md transform rounded-2xl bg-white dark:bg-gray-800 shadow-2xl transition-all",onClick:s[2]||(s[2]=f(()=>{},["stop"]))},[a("div",Ja,[a("div",Na,[a("div",Ra,[v(i(H),{class:"w-5 h-5 text-red-600 dark:text-red-400"})]),a("div",null,[a("h3",Ea,n(i(C)("components.lost_reason.title")),1),a("p",Fa,n(i(C)("components.lost_reason.select_reason")),1)])]),a("button",{onClick:S,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[v(i(U),{class:"w-5 h-5"})])]),r.lead?(t(),e("div",Za,[a("div",Pa,[a("div",null,[a("p",Xa,n(r.lead.name),1),a("p",Ka,n(r.lead.phone),1)]),a("div",Ga,[a("p",Wa,n((l=r.lead.estimated_value,l?new Intl.NumberFormat("uz-UZ").format(l):"0"))+" so'm ",1)])])])):d("",!0),a("div",Qa,[a("div",Ya,[a("label",et,n(i(C)("components.lost_reason.reason_label"))+" * ",1),a("div",at,[(t(!0),e(u,null,g(T.value,l=>(t(),e("label",{key:l.key,class:c(["flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all",L.value===l.key?"border-red-500 bg-red-50 dark:bg-red-900/20 ring-1 ring-red-500":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 hover:bg-gray-50 dark:hover:bg-gray-700/50"])},[p(a("input",{type:"radio",value:l.key,"onUpdate:modelValue":s[0]||(s[0]=e=>L.value=e),class:"sr-only"},null,8,tt),[[w,L.value]]),a("span",lt,n(l.icon),1),a("span",{class:c(["font-medium",L.value===l.key?"text-red-700 dark:text-red-400":"text-gray-700 dark:text-gray-300"])},n(l.label),3),L.value===l.key?(t(),e("div",st,[...s[3]||(s[3]=[a("svg",{class:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)])])):d("",!0)],2))),128))])]),a("div",rt,[a("label",ot,n(i(C)("components.lost_reason.additional_notes")),1),p(a("textarea",{"onUpdate:modelValue":s[1]||(s[1]=e=>M.value=e),rows:"3",placeholder:i(C)("components.lost_reason.notes_placeholder"),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none"},null,8,dt),[[b,M.value]])])]),a("div",nt,[a("button",{onClick:S,disabled:z.value,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors disabled:opacity-50"},n(i(C)("common.cancel")),9,it),a("button",{onClick:V,disabled:!A.value,class:c(["px-4 py-2 text-sm font-medium rounded-lg transition-all",A.value?"bg-red-600 text-white hover:bg-red-700 shadow-lg shadow-red-600/25":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"])},[z.value?(t(),e("span",ut,[s[4]||(s[4]=a("svg",{class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),x(" "+n(i(C)("common.saving")),1)])):(t(),e("span",gt,n(i(C)("components.lost_reason.mark_as_lost")),1))],10,ct)])])):d("",!0)];var l}),_:1})])])):d("",!0)]),_:1})]))}},bt={initiated:{label:"Boshlandi",color:"blue",textClass:"text-blue-500"},ringing:{label:"Jiringlamoqda",color:"blue",textClass:"text-blue-500"},answered:{label:"Javob berildi",color:"green",textClass:"text-green-500"},completed:{label:"Tugallandi",color:"green",textClass:"text-green-500"},failed:{label:"Muvaffaqiyatsiz",color:"gray",textClass:"text-gray-500"},missed:{label:"O'tkazib yuborildi",color:"red",textClass:"text-red-500"},busy:{label:"Band",color:"yellow",textClass:"text-yellow-500"},no_answer:{label:"Javob yo'q",color:"red",textClass:"text-red-500"},cancelled:{label:"Bekor qilindi",color:"gray",textClass:"text-gray-500"}},xt=e=>bt[e]?.label||"Noma'lum",yt=e=>bt[e]?.textClass||"text-blue-500",vt={class:"h-full flex flex-col -m-4"},mt={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-3 sm:px-4 lg:px-6 py-4"},ht={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},kt={class:"flex items-center gap-4 lg:gap-6"},ft={class:"text-xl lg:text-2xl font-bold text-gray-900 dark:text-white"},wt={key:0,class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},_t={key:1,class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},Ct={key:0,class:"hidden xl:flex items-center gap-4 pl-4 border-l border-gray-200 dark:border-gray-700"},jt={class:"text-center px-2"},Bt={class:"text-xl font-bold text-green-600 dark:text-green-400"},Tt={class:"text-xs text-gray-500 dark:text-gray-400"},Lt={class:"text-center px-2"},Mt={class:"text-xl font-bold text-blue-600 dark:text-blue-400"},zt={class:"text-xs text-gray-500 dark:text-gray-400"},At={class:"text-center px-2"},$t={class:"text-xl font-bold text-purple-600 dark:text-purple-400"},St={class:"text-xs text-gray-500 dark:text-gray-400"},Vt={key:1,class:"hidden xl:flex items-center gap-4 pl-4 border-l border-gray-200 dark:border-gray-700"},qt={class:"flex items-center gap-3"},Ot={class:"relative"},Ut=["placeholder"],Dt={value:""},Ht=["value"],It={value:""},Jt={value:"unassigned"},Nt=["value"],Rt=["disabled","title"],Et={class:"hidden sm:inline text-sm"},Ft={key:0,class:"absolute -top-1.5 -right-1.5 inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},Zt={class:"flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},Pt=["title"],Xt=["title"],Kt={class:"hidden lg:inline"},Gt={key:0,class:"flex-1 overflow-x-auto overflow-y-hidden"},Wt={class:"h-full px-2 sm:px-3 lg:px-4 py-4"},Qt={class:"flex gap-4 h-full min-w-max"},Yt={class:"flex-1 p-2 space-y-2"},el={key:0,class:"flex items-center justify-center gap-1.5 w-full py-1.5 border border-dashed rounded-md border-gray-300 dark:border-gray-600"},al={key:1,class:"flex-1 overflow-x-auto overflow-y-hidden"},tl={class:"h-full px-2 sm:px-3 lg:px-4 py-4"},ll={class:"flex gap-4 h-full min-w-max"},sl=["onDragover","onDrop"],rl={class:"p-3 border-b border-gray-200 dark:border-gray-700"},ol={class:"flex items-center justify-between mb-2"},dl={class:"flex items-center gap-2"},nl={class:"font-semibold text-gray-900 dark:text-white text-sm"},il={class:"px-2 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-xs font-medium rounded-full"},cl={class:"text-xs text-gray-500 dark:text-gray-400"},ul={class:"font-medium"},gl=["onDragstart"],pl={key:0,class:"absolute -top-2 -right-2 flex items-center gap-1 px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full shadow-lg animate-pulse z-10"},bl={class:"flex items-start justify-between gap-2 mb-2"},xl={class:"flex items-center gap-2 min-w-0"},yl=["onClick"],vl={class:"min-w-0"},ml={key:0,class:"text-xs text-gray-500 dark:text-gray-400 truncate"},hl={class:"relative lead-menu"},kl=["onClick"],fl={key:0,class:"absolute right-0 mt-1 w-36 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 z-20"},wl=["onClick"],_l={class:"flex items-center justify-between mb-2"},Cl={key:0,class:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400"},jl={class:"flex items-center gap-1 text-xs text-gray-400 dark:text-gray-500"},Bl={key:1,class:"flex items-center gap-1.5 text-xs text-gray-500 dark:text-gray-400 truncate mb-2"},Tl={class:"truncate"},Ll={class:"pt-2 border-t border-gray-100 dark:border-gray-700"},Ml=["title"],zl={key:0,class:"ml-0.5 text-red-500 font-semibold"},Al={class:"text-xs text-gray-400 dark:text-gray-500 text-center"},$l={key:2,class:"flex-1 overflow-auto p-4 sm:p-6"},Sl={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},Vl={class:"w-full"},ql={class:"bg-gray-50 dark:bg-gray-900/50"},Ol={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Ul={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Dl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Hl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Il={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Jl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Nl={class:"px-4 py-3 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Rl={class:"divide-y divide-gray-200 dark:divide-gray-700"},El={key:1,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-12 text-center"},Fl={class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"},Zl={class:"text-gray-500 dark:text-gray-400 mb-6"},Pl={key:2,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},Xl={class:"w-full"},Kl={class:"bg-gray-50 dark:bg-gray-900/50"},Gl={class:"px-4 py-3 w-12"},Wl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Ql={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},Yl={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},es={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},as={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},ts={class:"px-4 py-3 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},ls={class:"px-4 py-3 text-right text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase"},ss={class:"divide-y divide-gray-200 dark:divide-gray-700"},rs={class:"px-4 py-4"},os=["onClick"],ds={class:"px-4 py-4"},ns={class:"flex items-center gap-3"},is={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},cs={class:"px-4 py-4"},us={class:"space-y-1"},gs={key:0,class:"flex items-center gap-1.5 text-sm text-gray-600 dark:text-gray-400"},ps={key:1,class:"flex items-center gap-1.5 text-sm text-gray-600 dark:text-gray-400"},bs={class:"px-4 py-4"},xs={class:"px-4 py-4"},ys={key:0,class:"text-sm font-semibold text-green-600 dark:text-green-400"},vs={key:1,class:"text-sm text-gray-400"},ms={class:"px-4 py-4"},hs={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},ks={key:1,class:"text-sm text-gray-400"},fs={class:"px-4 py-4"},ws={key:0,class:"flex items-center gap-2"},_s={class:"w-6 h-6 rounded-full bg-gradient-to-br from-orange-500 to-amber-600 flex items-center justify-center text-white text-xs font-semibold"},Cs={class:"text-sm text-gray-600 dark:text-gray-400"},js={key:1,class:"text-sm text-gray-400"},Bs={class:"px-4 py-4 text-right"},Ts={class:"flex items-center justify-end gap-1"},Ls=["onClick","title"],Ms={key:0,class:"fixed bottom-6 left-1/2 -translate-x-1/2 z-40"},zs={class:"bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl px-6 py-4 flex items-center gap-6"},As={class:"flex items-center gap-3"},$s={class:"text-white font-bold"},Ss={class:"text-white font-medium"},Vs={class:"flex items-center gap-3"},qs=["title"],Os=["title"],Us=E({__name:"LeadIndex",props:{panelType:{type:String,required:!0,validator:e=>["saleshead","business","operator"].includes(e)},leads:{type:Array,default:()=>[]},stats:{type:Object,default:()=>({total_leads:0,new_leads:0,qualified_leads:0,pipeline_value:0,won_deals:0,total_value:0})},channels:{type:Array,default:()=>[]},operators:{type:Array,default:()=>[]},lazyLoad:{type:Boolean,default:!1},canAssignLeads:{type:Boolean,default:!1},pipelineStages:{type:Array,default:()=>[]}},setup(k){const{t:w}=$(),S=k,V=s(()=>"saleshead"===S.panelType?{primary:"emerald",ring:"focus:ring-emerald-500",buttonBg:"bg-emerald-600 hover:bg-emerald-700",buttonShadow:"shadow-emerald-500/25",hoverText:"hover:text-emerald-600 dark:hover:text-emerald-400",activeView:"text-emerald-600 dark:text-emerald-400",dragOver:"bg-emerald-50 dark:bg-emerald-900/20",emptyBg:"bg-emerald-100 dark:bg-emerald-900/30",emptyIcon:"text-emerald-600 dark:text-emerald-400",sourceBg:"bg-emerald-50 dark:bg-emerald-900/20",sourceText:"text-emerald-600 dark:text-emerald-400",checkboxBg:"bg-emerald-500 border-emerald-500",selectedRowBg:"bg-emerald-50 dark:bg-emerald-900/20",selectedBorder:"border-emerald-500 dark:border-emerald-400 ring-2 ring-emerald-500/20"}:{primary:"blue",ring:"focus:ring-blue-500",buttonBg:"bg-blue-600 hover:bg-blue-700",buttonShadow:"shadow-blue-500/25",hoverText:"hover:text-blue-600 dark:hover:text-blue-400",activeView:"text-blue-600 dark:text-blue-400",dragOver:"bg-blue-50 dark:bg-blue-900/20",emptyBg:"bg-blue-100 dark:bg-blue-900/30",emptyIcon:"text-blue-600 dark:text-blue-400",sourceBg:"bg-blue-50 dark:bg-blue-900/20",sourceText:"text-blue-600 dark:text-blue-400",checkboxBg:"bg-blue-500 border-blue-500",selectedRowBg:"bg-blue-50 dark:bg-blue-900/20",selectedBorder:"border-blue-500 dark:border-blue-400 ring-2 ring-blue-500/20"}),O=e=>{const a="saleshead"===S.panelType?"/sales-head/leads":"operator"===S.panelType?"/operator/leads":"/business/api/sales";switch(e){case"leads":return"saleshead"===S.panelType?"/sales-head/leads/api":"operator"===S.panelType?"/operator/leads/api/list":"/business/api/sales/leads";case"stats":return"saleshead"===S.panelType?"/sales-head/leads/api/stats":"operator"===S.panelType?"/operator/leads/api/stats":"/business/api/sales/stats";case"operators":return"saleshead"===S.panelType?"/sales-head/operators":"/business/api/sales/operators";case"funnel":return"/business/api/sales/funnel-stats";case"sources":return"/business/api/sales/source-stats";case"smsStatus":return"business"===S.panelType?"/business/sms/status":null;default:return a}},D=(e,a=null)=>{if("saleshead"===S.panelType)switch(e){case"create":return"/sales-head/leads/create";case"show":return`/sales-head/leads/${a}`;case"edit":return`/sales-head/leads/${a}/edit`;case"status":return`/sales-head/leads/${a}/status`;case"markLost":return`/sales-head/leads/${a}/mark-lost`;default:return"/sales-head/leads"}else if("operator"===S.panelType)switch(e){case"show":return`/operator/leads/${a}`;case"status":return`/operator/leads/${a}/status`;case"note":return`/operator/leads/${a}/note`;case"call":return`/operator/leads/${a}/call`;default:return"/operator/leads"}else switch(e){case"create":return"/business/sales/create";case"show":case"update":return`/business/sales/${a}`;case"edit":return`/business/sales/${a}/edit`;case"markLost":return`/business/api/sales/leads/${a}/mark-lost`;default:return"/business/sales"}},H=s(()=>"saleshead"===S.panelType?"/sales-head/settings/pipeline-stages":"business"===S.panelType?"/business/settings/pipeline-stages":null),E=l(!1),le=l([]),se=l(!1),re=l(!1),oe=e=>{const a=le.value.findIndex(a=>a.id===e.id);-1===a?le.value.push(e):le.value.splice(a,1)},de=e=>le.value.some(a=>a.id===e.id),ne=()=>{le.value.length===Ne.value.length?le.value=[]:le.value=[...Ne.value]},ie=()=>{le.value=[]},ce=()=>{se.value?le.value.length>0&&(E.value=!0):L.visit("/business/settings/sms")},ue=()=>{ie()},ge=()=>{le.value.length>0&&(re.value=!0)},pe=e=>{De(),ie()},be=l(!0),xe=l([]),ye=l(null),ve=l(!1),me=l(!1),he=l({current_page:1,last_page:1,per_page:50,total:0}),ke=s(()=>ve.value?xe.value:S.leads||[]),fe=s(()=>ye.value||S.stats||{total_leads:0,new_leads:0,qualified_leads:0,pipeline_value:0,won_deals:0,total_value:0}),we=l("kanban"),_e=l(""),Ce=l(""),je=l(""),Be=l(!1),Te=l([]),Le=l(!1),Me=l(null),ze=l(null),Ae=l(null),$e=l(!1),Se=l(null),Ve=s(()=>S.operators.length>0?S.operators:Te.value),qe={blue:{bgColor:"bg-blue-500",lightBg:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-200 dark:border-blue-800"},indigo:{bgColor:"bg-indigo-500",lightBg:"bg-indigo-50 dark:bg-indigo-900/20",borderColor:"border-indigo-200 dark:border-indigo-800"},purple:{bgColor:"bg-purple-500",lightBg:"bg-purple-50 dark:bg-purple-900/20",borderColor:"border-purple-200 dark:border-purple-800"},pink:{bgColor:"bg-pink-500",lightBg:"bg-pink-50 dark:bg-pink-900/20",borderColor:"border-pink-200 dark:border-pink-800"},red:{bgColor:"bg-red-500",lightBg:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800"},orange:{bgColor:"bg-orange-500",lightBg:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-200 dark:border-orange-800"},yellow:{bgColor:"bg-yellow-500",lightBg:"bg-yellow-50 dark:bg-yellow-900/20",borderColor:"border-yellow-200 dark:border-yellow-800"},green:{bgColor:"bg-green-500",lightBg:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-200 dark:border-green-800"},teal:{bgColor:"bg-teal-500",lightBg:"bg-teal-50 dark:bg-teal-900/20",borderColor:"border-teal-200 dark:border-teal-800"},cyan:{bgColor:"bg-cyan-500",lightBg:"bg-cyan-50 dark:bg-cyan-900/20",borderColor:"border-cyan-200 dark:border-cyan-800"},gray:{bgColor:"bg-gray-500",lightBg:"bg-gray-50 dark:bg-gray-900/20",borderColor:"border-gray-200 dark:border-gray-800"}},Oe=s(()=>[{value:"new",label:w("leads.pipeline.new"),color:"blue"},{value:"contacted",label:w("leads.pipeline.contacted"),color:"indigo"},{value:"callback",label:w("leads.pipeline.callback"),color:"purple"},{value:"considering",label:w("leads.pipeline.considering"),color:"orange"},{value:"meeting_scheduled",label:w("leads.pipeline.meeting_scheduled"),color:"yellow"},{value:"meeting_attended",label:w("leads.pipeline.meeting_attended"),color:"teal"},{value:"won",label:w("leads.pipeline.won"),color:"green",is_won:!0},{value:"lost",label:w("leads.pipeline.lost"),color:"red",is_lost:!0}]),Ue=s(()=>S.pipelineStages.length>0?S.pipelineStages.map(e=>({value:e.slug,label:e.name,color:e.color,is_won:e.is_won,is_lost:e.is_lost,is_system:e.is_system,...qe[e.color]||qe.gray})):Oe.value.map(e=>({...e,...qe[e.color]||qe.gray}))),De=async(e=1,a=!0)=>{a&&!me.value&&(be.value=!0);try{const a={page:e,per_page:he.value.per_page,fields:"id,name,phone,email,company,status,source_id,assigned_to,estimated_value,created_at"};_e.value&&(a.search=_e.value),Ce.value&&(a.source=Ce.value),je.value&&(a.operator=je.value);const t=await A.get(O("leads"),{params:a});xe.value=t.data.data||[],ve.value=!0,t.data.current_page&&(he.value={current_page:t.data.current_page,last_page:t.data.last_page,per_page:t.data.per_page,total:t.data.total})}catch(t){}finally{a&&(be.value=!1,me.value=!0)}},He=async()=>{try{const e=await A.get(O("stats"));ye.value=e.data}catch(e){}},Ie=async()=>{He(),await De()};let Je;r(()=>S.leads,(e,a)=>{ve.value?!S.lazyLoad&&void 0===a&&e?.length>0&&(xe.value=JSON.parse(JSON.stringify(e||[]))):!S.lazyLoad&&S.leads?.length>0&&!ve.value&&(xe.value=JSON.parse(JSON.stringify(S.leads)),ve.value=!0)},{immediate:!0});r(_e,()=>{clearTimeout(Je),Je=setTimeout(()=>{De(1,!1)},200)}),r(Ce,()=>De(1,!1)),r(je,()=>De(1,!1));const Ne=s(()=>{let e=ke.value;if(!S.lazyLoad){if(_e.value){const a=_e.value.toLowerCase();e=e.filter(e=>e.name?.toLowerCase().includes(a)||e.email?.toLowerCase().includes(a)||e.company?.toLowerCase().includes(a)||e.phone?.toLowerCase().includes(a))}Ce.value&&(e=e.filter(e=>e.source?.id===parseInt(Ce.value))),je.value&&(e="unassigned"===je.value?e.filter(e=>!e.assigned_to):e.filter(e=>e.assigned_to?.id===parseInt(je.value)))}return Be.value&&(e=e.filter(e=>Xe(e))),e}),Re=s(()=>{const e={};return Ue.value.forEach(a=>{e[a.value]=Ne.value.filter(e=>e.status===a.value)}),e}),Ee=s(()=>{const e={};return Ue.value.forEach(a=>{const t=Re.value[a.value]||[];e[a.value]={count:t.length,value:t.reduce((e,a)=>e+(parseFloat(a.estimated_value)||0),0)}}),e}),Fe=e=>Ue.value.find(a=>a.value===e)||{},Ze=e=>!!(e.source?.name?.toLowerCase().includes("telefon")||e.source?.name?.toLowerCase().includes("phone")||e.source?.name?.toLowerCase().includes("qo'ng'iroq"))||(!!e.source?.code?.includes("phone_call")||!!e.data?.source?.includes("phone_call")),Pe=e=>{let a=e.data;if("string"==typeof a)try{a=JSON.parse(a)}catch(t){a={}}return a||{}},Xe=e=>{const a=Pe(e);if(a.missed_calls>0)return!0;const t=a.last_call_status;return"no_answer"===t||"missed"===t||"unanswered"===t||!!e.calls?.some(e=>"no_answer"===e.status||"missed"===e.status)},Ke=e=>Pe(e).missed_calls||1,Ge=()=>{Be.value=!Be.value},We=s(()=>ke.value.filter(e=>Xe(e)).length);s(()=>ke.value.filter(e=>Xe(e)));const Qe=e=>{Se.value=e,$e.value=!0},Ye=async({leadId:e,reason:a,details:t})=>{try{await A.post(D("markLost",e),{lost_reason:a,lost_reason_details:t}),$e.value=!1,Se.value=null;const l=xe.value.map(l=>l.id===e?{...l,status:"lost",lost_reason:a,lost_reason_details:t}:{...l});xe.value=l,await T(),He()}catch(l){}},ea=e=>{Le.value=!1,Me.value=null,ze.value=null,e.target.classList.remove("opacity-50","scale-95")},aa=e=>{e.currentTarget.contains(e.relatedTarget)||(ze.value=null)},ta=e=>{e.target.closest(".lead-menu")||(Ae.value=null)};let la=null;return _(()=>{document.addEventListener("click",ta),(async()=>{if(!(S.operators.length>0))try{const e=await A.get(O("operators"));Te.value=e.data.operators||e.data||[]}catch(e){}})(),Ie(),(async()=>{const e=O("smsStatus");if(e)try{const a=await fetch(e,{headers:{Accept:"application/json"}});if(a.ok){const e=await a.json();se.value=e.connected}}catch(a){}})(),la=L.on("navigate",e=>{const a=e.detail.page.url;("saleshead"===S.panelType?a.includes("/sales-head/leads")&&!a.includes("/sales-head/leads/"):a.includes("/business/sales")&&!a.includes("/business/sales/"))&&Ie()})}),C(()=>{document.removeEventListener("click",ta),la&&la(),Je&&clearTimeout(Je)}),(l,s)=>(t(),e(u,null,[v(i(M),{title:"saleshead"===k.panelType?i(w)("leads.index.title"):i(w)("leads.index.sales_pipeline")},null,8,["title"]),a("div",vt,[a("div",mt,[a("div",ht,[a("div",kt,[a("div",null,[a("h1",ft,n("saleshead"===k.panelType?i(w)("leads.index.title"):i(w)("leads.index.sales_pipeline")),1),be.value?(t(),e("p",wt,[...s[8]||(s[8]=[a("span",{class:"inline-block w-32 h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"},null,-1)])])):(t(),e("p",_t,n(fe.value?.total_leads||0)+" "+n(i(w)("leads.index.lead_count"))+" â€¢ "+n(i(I)(fe.value?.pipeline_value))+" pipeline ",1))]),be.value?(t(),e("div",Vt,[(t(),e(u,null,g(3,e=>a("div",{key:e,class:"text-center px-2"},[...s[9]||(s[9]=[a("div",{class:"w-10 h-6 bg-gray-200 dark:bg-gray-700 rounded animate-pulse mb-1"},null,-1),a("div",{class:"w-14 h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"},null,-1)])])),64))])):(t(),e("div",Ct,[a("div",jt,[a("p",Bt,n(fe.value?.won_deals||0),1),a("p",Tt,n(i(w)("leads.stats.won")),1)]),a("div",Lt,[a("p",Mt,n(fe.value?.new_leads||0),1),a("p",zt,n(i(w)("leads.pipeline.new")),1)]),a("div",At,[a("p",$t,n(fe.value?.qualified_leads||0),1),a("p",St,n(i(w)("leads.stats.qualified")),1)])]))]),a("div",qt,[a("div",Ot,[v(i(F),{class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),p(a("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>_e.value=e),type:"text",placeholder:i(w)("leads.index.search"),class:c(["w-48 lg:w-64 pl-10 pr-4 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:border-transparent text-sm text-gray-900 dark:text-white placeholder-gray-400",V.value.ring])},null,10,Ut),[[b,_e.value]])]),p(a("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>Ce.value=e),class:c(["px-3 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:border-transparent text-sm text-gray-900 dark:text-white",V.value.ring])},[a("option",Dt,n(i(w)("leads.index.all_sources")),1),(t(!0),e(u,null,g(k.channels,a=>(t(),e("option",{key:a.id,value:a.id},n(a.name),9,Ht))),128))],2),[[j,Ce.value]]),p(a("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>je.value=e),class:c(["px-3 py-2 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg focus:ring-2 focus:border-transparent text-sm text-gray-900 dark:text-white",V.value.ring])},[a("option",It,n(i(w)("leads.index.all_operators")),1),a("option",Jt,n(i(w)("leads.index.unassigned")),1),(t(!0),e(u,null,g(Ve.value,a=>(t(),e("option",{key:a.id,value:a.id},n(a.name),9,Nt))),128))],2),[[j,je.value]]),a("button",{onClick:Ge,disabled:0===We.value,class:c(["relative inline-flex items-center gap-2 px-3 py-2 font-medium rounded-lg border transition-colors",Be.value?"bg-red-500 border-red-500 text-white":We.value>0?"bg-white dark:bg-gray-700 border-red-300 dark:border-red-700 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20":"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-400 cursor-not-allowed"]),title:Be.value?"Barcha lidlar":"O'tkazib yuborilgan qo'ng'iroqlar"},[v(i(Z),{class:"w-4 h-4"}),a("span",Et,n(Be.value?"Barchasi":"O'tkazib yuborilgan"),1),Be.value?d("",!0):(t(),e("span",Ft,n(We.value),1))],10,Rt),a("div",Zt,[a("button",{onClick:s[3]||(s[3]=e=>we.value="kanban"),class:c(["p-2 rounded-md transition-colors","kanban"===we.value?`bg-white dark:bg-gray-600 shadow-sm ${V.value.activeView}`:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"]),title:i(w)("leads.index.kanban_view")},[v(i(te),{class:"w-5 h-5"})],10,Pt),a("button",{onClick:s[4]||(s[4]=e=>we.value="list"),class:c(["p-2 rounded-md transition-colors","list"===we.value?`bg-white dark:bg-gray-600 shadow-sm ${V.value.activeView}`:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"]),title:i(w)("leads.index.list_view")},[v(i(P),{class:"w-5 h-5"})],10,Xt)]),H.value?(t(),o(i(z),{key:0,href:H.value,class:"inline-flex items-center gap-2 px-3 py-2 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-700 font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",title:i(w)("leads.index.pipeline_settings_title")},{default:m(()=>[v(i(X),{class:"w-5 h-5"}),a("span",Kt,n(i(w)("leads.index.pipeline_settings")),1)]),_:1},8,["href","title"])):d("",!0)])])]),"kanban"===we.value&&be.value?(t(),e("div",Gt,[a("div",Wt,[a("div",Qt,[(t(),e(u,null,g(7,l=>a("div",{key:l,class:"w-72 flex-shrink-0 flex flex-col bg-gray-50 dark:bg-gray-900/50 rounded-xl"},[s[12]||(s[12]=B('<div class="p-3 border-b border-gray-200 dark:border-gray-700" data-v-f9dabf4f><div class="flex items-center gap-2 mb-2" data-v-f9dabf4f><div class="w-3 h-3 rounded-full bg-gray-300 dark:bg-gray-600 animate-pulse" data-v-f9dabf4f></div><div class="w-20 h-4 bg-gray-300 dark:bg-gray-600 rounded animate-pulse" data-v-f9dabf4f></div></div><div class="w-24 h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse" data-v-f9dabf4f></div></div>',1)),a("div",Yt,[1===l?(t(),e("div",el,[...s[10]||(s[10]=[a("div",{class:"w-3.5 h-3.5 rounded bg-gray-300 dark:bg-gray-600 animate-pulse"},null,-1),a("div",{class:"w-16 h-3 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"},null,-1)])])):d("",!0),(t(),e(u,null,g(2,e=>a("div",{key:e,class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3"},[...s[11]||(s[11]=[B('<div class="flex items-center gap-2 mb-2" data-v-f9dabf4f><div class="w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-600 animate-pulse" data-v-f9dabf4f></div><div class="w-24 h-4 bg-gray-300 dark:bg-gray-600 rounded animate-pulse" data-v-f9dabf4f></div></div><div class="w-32 h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse mb-2" data-v-f9dabf4f></div><div class="w-20 h-3 bg-gray-200 dark:bg-gray-700 rounded animate-pulse" data-v-f9dabf4f></div>',3)])])),64))])])),64))])])])):"kanban"===we.value?(t(),e("div",al,[a("div",tl,[a("div",ll,[(t(!0),e(u,null,g(Ue.value,l=>(t(),e("div",{key:l.value,class:"w-72 flex-shrink-0 flex flex-col bg-gray-50 dark:bg-gray-900/50 rounded-xl",onDragover:e=>{return a=e,t=l.value,a.preventDefault(),a.dataTransfer.dropEffect="move",void(ze.value=t);var a,t},onDragleave:aa,onDrop:e=>(async(e,a)=>{if(e.preventDefault(),ze.value=null,Me.value&&Me.value.status!==a){const e={...Me.value},l=e.id,s=e.status;if("lost"===a)return Qe(e),Le.value=!1,void(Me.value=null);Le.value=!1,Me.value=null;const r=xe.value.map(e=>e.id===l?{...e,status:a}:{...e});xe.value=r,await T();try{"saleshead"===S.panelType?await A.post(D("status",l),{status:a}):await A.put(D("update",l),{name:e.name,email:e.email,phone:e.phone,company:e.company,source_id:e.source?.id||null,status:a,score:e.score,estimated_value:e.estimated_value},{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),He()}catch(t){const e=xe.value.map(e=>e.id===l?{...e,status:s}:{...e});xe.value=e,await T()}return}Le.value=!1,Me.value=null})(e,l.value)},[a("div",rl,[a("div",ol,[a("div",dl,[a("div",{class:c([l.bgColor,"w-3 h-3 rounded-full"])},null,2),a("h3",nl,n(l.label),1),a("span",il,n(Ee.value[l.value]?.count||0),1)])]),a("div",cl,n(i(I)(Ee.value[l.value]?.value)),1)]),a("div",{class:c(["flex-1 overflow-y-auto p-2 space-y-2 transition-colors",ze.value===l.value?V.value.dragOver:""])},["new"===l.value?(t(),o(i(z),{key:0,href:D("create"),class:c(["flex items-center justify-center gap-1.5 w-full py-1.5 border border-dashed rounded-md transition-all hover:shadow-sm text-xs","saleshead"===k.panelType?"border-emerald-300 dark:border-emerald-600 text-emerald-600 dark:text-emerald-400 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 hover:border-emerald-400 dark:hover:border-emerald-500":"border-blue-300 dark:border-blue-600 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-400 dark:hover:border-blue-500"])},{default:m(()=>[v(i(K),{class:"w-3.5 h-3.5"}),a("span",ul,n(i(w)("leads.index.add_lead")),1)]),_:1},8,["href","class"])):d("",!0),(t(!0),e(u,null,g(Re.value[l.value],l=>(t(),e("div",{key:l.id,draggable:"true",onDragstart:e=>((e,a)=>{Le.value=!0,Me.value=a,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",a.id),setTimeout(()=>{e.target.classList.add("opacity-50","scale-95")},0)})(e,l),onDragend:ea,class:c(["relative bg-white dark:bg-gray-800 rounded-lg border p-3 cursor-grab active:cursor-grabbing hover:shadow-md transition-all group",Xe(l)?"border-red-400 dark:border-red-500 ring-2 ring-red-500/20":de(l)?V.value.selectedBorder:`border-gray-200 dark:border-gray-700 hover:border-${V.value.primary}-300 dark:hover:border-${V.value.primary}-600`])},[Xe(l)?(t(),e("div",pl,[v(i(Z),{class:"w-3 h-3"}),a("span",null,n(Ke(l)),1)])):d("",!0),a("div",bl,[a("div",xl,[a("button",{onClick:f(e=>oe(l),["stop"]),class:c(["w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 transition-all",de(l)?`${V.value.checkboxBg} text-white`:`border-gray-400 dark:border-gray-500 hover:border-${V.value.primary}-500 hover:bg-${V.value.primary}-500/10 opacity-0 group-hover:opacity-100`])},[de(l)?(t(),o(i(G),{key:0,class:"w-3 h-3"})):d("",!0)],10,yl),a("div",{class:c(["w-8 h-8 rounded-full bg-gradient-to-br flex items-center justify-center text-white text-xs font-semibold flex-shrink-0",i(J)(l.name)])},n(i(N)(l.name)),3),a("div",vl,[v(i(z),{href:D("show",l.id),class:c(["font-medium text-gray-900 dark:text-white text-sm truncate block",V.value.hoverText])},{default:m(()=>[x(n(l.name),1)]),_:2},1032,["href","class"]),l.company?(t(),e("p",ml,n(l.company),1)):d("",!0)])]),a("div",hl,[a("button",{onClick:f(e=>{return a=l.id,void(Ae.value=Ae.value===a?null:a);var a},["stop"]),class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded opacity-0 group-hover:opacity-100 transition-opacity"},[v(i(W),{class:"w-4 h-4"})],8,kl),v(h,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:m(()=>[Ae.value===l.id?(t(),e("div",fl,[v(i(z),{href:D("show",l.id),class:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},{default:m(()=>[v(i(Q),{class:"w-4 h-4"}),x(" "+n(i(w)("leads.actions.view")),1)]),_:1},8,["href"]),v(i(z),{href:D("edit",l.id),class:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"},{default:m(()=>[v(i(Y),{class:"w-4 h-4"}),x(" "+n(i(w)("leads.actions.edit")),1)]),_:1},8,["href"]),"won"!==l.status&&"lost"!==l.status?(t(),e("button",{key:0,onClick:e=>Qe(l),class:"w-full flex items-center gap-2 px-3 py-2 text-sm text-orange-600 dark:text-orange-400 hover:bg-orange-50 dark:hover:bg-orange-900/20"},[v(i(U),{class:"w-4 h-4"}),x(" "+n(i(w)("leads.actions.lost")),1)],8,wl)):d("",!0)])):d("",!0)]),_:2},1024)])]),a("div",_l,[l.phone?(t(),e("p",Cl,[v(i(Z),{class:"w-3 h-3"}),x(" "+n(l.phone),1)])):d("",!0),a("div",jl,[v(i(ee),{class:"w-3 h-3"}),a("span",null,n(i(R)(l.created_at)),1)])]),l.email?(t(),e("p",Bl,[v(i(ae),{class:"w-3 h-3 flex-shrink-0"}),a("span",Tl,n(l.email),1)])):d("",!0),a("div",Ll,[a("div",{class:c(["px-2 py-1 rounded text-xs text-center flex items-center justify-center gap-1.5",l.source?`${V.value.sourceBg} ${V.value.sourceText}`:"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"])},[Ze(l)?(t(),e("span",{key:0,class:c([i(yt)(l.data?.last_call_status),"inline-flex items-center"]),title:i(xt)(l.data?.last_call_status)},[v(i(Z),{class:"w-3.5 h-3.5"}),l.data?.missed_calls>0?(t(),e("span",zl,n(l.data.missed_calls),1)):d("",!0)],10,Ml)):d("",!0),x(" "+n(l.source?.name||i(w)("leads.index.no_source")),1)],2)])],42,gl))),128)),Re.value[l.value]?.length?d("",!0):(t(),e("div",{key:1,class:c(["flex flex-col items-center justify-center py-8 px-4 border-2 border-dashed rounded-lg transition-colors",ze.value===l.value?`border-${V.value.primary}-400 ${V.value.dragOver}`:"border-gray-200 dark:border-gray-700"])},[v(i(q),{class:"w-8 h-8 text-gray-300 dark:text-gray-600 mb-2"}),a("p",Al,n(i(w)("leads.index.no_leads")),1)],2))],2)],40,sl))),128))])])])):"list"===we.value?(t(),e("div",$l,[be.value?(t(),e("div",Sl,[a("table",Vl,[a("thead",ql,[a("tr",null,[s[13]||(s[13]=a("th",{class:"px-4 py-3 w-12"},null,-1)),a("th",Ol,n(i(w)("leads.table.lead")),1),a("th",Ul,n(i(w)("leads.table.contact")),1),a("th",Dl,n(i(w)("leads.table.status")),1),a("th",Hl,n(i(w)("leads.table.value")),1),a("th",Il,n(i(w)("leads.table.source")),1),a("th",Jl,n(i(w)("leads.table.operator")),1),a("th",Nl,n(i(w)("leads.table.actions")),1)])]),a("tbody",Rl,[(t(),e(u,null,g(5,e=>a("tr",{key:e,class:"animate-pulse"},[...s[14]||(s[14]=[a("td",{class:"px-4 py-4"},[a("div",{class:"w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded"})],-1),a("td",{class:"px-4 py-4"},[a("div",{class:"flex items-center gap-3"},[a("div",{class:"w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-600"}),a("div",null,[a("div",{class:"w-24 h-4 bg-gray-300 dark:bg-gray-600 rounded mb-1"}),a("div",{class:"w-16 h-3 bg-gray-200 dark:bg-gray-700 rounded"})])])],-1),a("td",{class:"px-4 py-4"},[a("div",{class:"w-28 h-3 bg-gray-200 dark:bg-gray-700 rounded"})],-1),a("td",{class:"px-4 py-4"},[a("div",{class:"w-16 h-5 bg-gray-200 dark:bg-gray-700 rounded"})],-1),a("td",{class:"px-4 py-4"},[a("div",{class:"w-20 h-3 bg-gray-200 dark:bg-gray-700 rounded"})],-1),a("td",{class:"px-4 py-4"},[a("div",{class:"w-16 h-3 bg-gray-200 dark:bg-gray-700 rounded"})],-1),a("td",{class:"px-4 py-4"},[a("div",{class:"w-20 h-3 bg-gray-200 dark:bg-gray-700 rounded"})],-1),a("td",{class:"px-4 py-4"},[a("div",{class:"w-20 h-6 bg-gray-200 dark:bg-gray-700 rounded float-right"})],-1)])])),64))])])])):ke.value&&0!==ke.value.length?(t(),e("div",Pl,[a("table",Xl,[a("thead",Kl,[a("tr",null,[a("th",Gl,[a("button",{onClick:ne,class:c(["w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",le.value.length===Ne.value.length&&Ne.value.length>0?`${V.value.checkboxBg} text-white`:"border-gray-300 dark:border-gray-600 hover:border-gray-400"])},[le.value.length===Ne.value.length&&Ne.value.length>0?(t(),o(i(G),{key:0,class:"w-3 h-3"})):d("",!0)],2)]),a("th",Wl,n(i(w)("leads.table.lead")),1),a("th",Ql,n(i(w)("leads.table.contact")),1),a("th",Yl,n(i(w)("leads.table.status")),1),a("th",es,n(i(w)("leads.table.value")),1),a("th",as,n(i(w)("leads.table.source")),1),a("th",ts,n(i(w)("leads.table.operator")),1),a("th",ls,n(i(w)("leads.table.actions")),1)])]),a("tbody",ss,[(t(!0),e(u,null,g(Ne.value,l=>(t(),e("tr",{key:l.id,class:c(["transition-colors",de(l)?V.value.selectedRowBg:"hover:bg-gray-50 dark:hover:bg-gray-700/50"])},[a("td",rs,[a("button",{onClick:e=>oe(l),class:c(["w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",de(l)?`${V.value.checkboxBg} text-white`:"border-gray-300 dark:border-gray-600 hover:border-gray-400"])},[de(l)?(t(),o(i(G),{key:0,class:"w-3 h-3"})):d("",!0)],10,os)]),a("td",ds,[a("div",ns,[a("div",{class:c(["w-10 h-10 rounded-full bg-gradient-to-br flex items-center justify-center text-white text-sm font-semibold",i(J)(l.name)])},n(i(N)(l.name)),3),a("div",null,[v(i(z),{href:D("show",l.id),class:c(["font-medium text-gray-900 dark:text-white",V.value.hoverText])},{default:m(()=>[x(n(l.name),1)]),_:2},1032,["href","class"]),l.company?(t(),e("p",is,n(l.company),1)):d("",!0)])])]),a("td",cs,[a("div",us,[l.phone?(t(),e("p",gs,[v(i(Z),{class:"w-4 h-4 text-gray-400"}),x(" "+n(l.phone),1)])):d("",!0),l.email?(t(),e("p",ps,[v(i(ae),{class:"w-4 h-4 text-gray-400"}),x(" "+n(l.email),1)])):d("",!0)])]),a("td",bs,[a("span",{class:c(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium border",Fe(l.status)?.lightBg,Fe(l.status)?.borderColor])},[a("span",{class:c([Fe(l.status)?.bgColor,"w-1.5 h-1.5 rounded-full mr-1.5"])},null,2),x(" "+n(Fe(l.status)?.label),1)],2)]),a("td",xs,[l.estimated_value?(t(),e("span",ys,n(i(I)(l.estimated_value)),1)):(t(),e("span",vs,"-"))]),a("td",ms,[l.source?(t(),e("span",hs,n(l.source.name),1)):(t(),e("span",ks,"-"))]),a("td",fs,[l.assigned_to?(t(),e("div",ws,[a("span",_s,n(l.assigned_to.name?.charAt(0)?.toUpperCase()),1),a("span",Cs,n(l.assigned_to.name),1)])):(t(),e("span",js,"-"))]),a("td",Bs,[a("div",Ts,[v(i(z),{href:D("show",l.id),class:c(["p-2 text-gray-400 rounded-lg transition-colors",V.value.hoverText]),title:i(w)("leads.actions.view")},{default:m(()=>[v(i(Q),{class:"w-4 h-4"})]),_:1},8,["href","class","title"]),v(i(z),{href:D("edit",l.id),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:i(w)("leads.actions.edit")},{default:m(()=>[v(i(Y),{class:"w-4 h-4"})]),_:1},8,["href","title"]),"won"!==l.status&&"lost"!==l.status?(t(),e("button",{key:0,onClick:e=>Qe(l),class:"p-2 text-gray-400 hover:text-orange-600 dark:hover:text-orange-400 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-lg transition-colors",title:i(w)("leads.actions.mark_lost")},[v(i(U),{class:"w-4 h-4"})],8,Ls)):d("",!0)])])],2))),128))])])])):(t(),e("div",El,[a("div",{class:c(["mx-auto w-20 h-20 rounded-full flex items-center justify-center mb-6",V.value.emptyBg])},[v(i(q),{class:c(["w-10 h-10",V.value.emptyIcon])},null,8,["class"])],2),a("h3",Fl,n(i(w)("leads.index.no_leads_yet")),1),a("p",Zl,n(i(w)("leads.index.add_first_lead")),1),v(i(z),{href:D("create"),class:c(["inline-flex items-center gap-2 px-6 py-3 text-white font-medium rounded-xl transition-colors",V.value.buttonBg])},{default:m(()=>[v(i(K),{class:"w-5 h-5"}),x(" "+n(i(w)("leads.index.add_lead")),1)]),_:1},8,["href","class"])]))])):d("",!0)]),(t(),o(y,{to:"body"},[v(h,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-4","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-4"},{default:m(()=>[le.value.length>0?(t(),e("div",Ms,[a("div",zs,[a("div",As,[a("div",{class:c(["w-10 h-10 rounded-xl flex items-center justify-center","saleshead"===k.panelType?"bg-emerald-500":"bg-blue-500"])},[a("span",$s,n(le.value.length),1)],2),a("span",Ss,n(i(w)("leads.bulk.selected")),1)]),s[17]||(s[17]=a("div",{class:"h-8 w-px bg-slate-600"},null,-1)),a("div",Vs,[a("button",{onClick:ce,title:se.value?i(w)("leads.bulk.sms_send_hint"):i(w)("leads.bulk.sms_setup_hint"),class:c(["inline-flex items-center gap-2 px-4 py-2 font-medium rounded-xl transition-all",se.value?"bg-gradient-to-r from-teal-500 to-cyan-600 text-white hover:from-teal-600 hover:to-cyan-700":"bg-slate-700 text-slate-300 hover:bg-slate-600"])},[s[15]||(s[15]=a("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)),x(" "+n(se.value?i(w)("leads.bulk.send_sms"):i(w)("leads.bulk.setup_sms")),1)],10,qs),k.canAssignLeads?(t(),e("button",{key:0,onClick:ge,title:i(w)("leads.bulk.assign_hint"),class:"inline-flex items-center gap-2 px-4 py-2 font-medium rounded-xl transition-all bg-gradient-to-r from-orange-500 to-amber-600 text-white hover:from-orange-600 hover:to-amber-700"},[s[16]||(s[16]=a("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})],-1)),x(" "+n(i(w)("leads.bulk.assign_to_operator")),1)],8,Os)):d("",!0),a("button",{onClick:ne,class:"px-4 py-2 bg-slate-700 text-slate-300 rounded-xl hover:bg-slate-600 transition-colors"},n(le.value.length===Ne.value.length?i(w)("leads.bulk.clear_selection"):i(w)("leads.bulk.select_all")),1),a("button",{onClick:ie,class:"p-2 text-slate-400 hover:text-white transition-colors"},[v(i(U),{class:"w-5 h-5"})])])])])):d("",!0)]),_:1})])),v(ra,{show:E.value,leads:le.value,onClose:s[5]||(s[5]=e=>E.value=!1),onSent:ue},null,8,["show","leads"]),v(Da,{show:re.value,leads:le.value,onClose:s[6]||(s[6]=e=>re.value=!1),onAssigned:pe},null,8,["show","leads"]),v(pt,{show:$e.value,lead:Se.value,onClose:s[7]||(s[7]=e=>{$e.value=!1,Se.value=null}),onConfirm:Ye},null,8,["show","lead"])],64))}},[["__scopeId","data-v-f9dabf4f"]]);export{Us as L};
