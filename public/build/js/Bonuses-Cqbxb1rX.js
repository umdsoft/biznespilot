import{r as e,v as t,x as a,y as r,C as s,I as l,F as d,D as o,J as n,K as p,z as u,H as x,A as i,E as g,B as c,G as m}from"./chunk-CpmtkKLp.js";import{r as y}from"./chunk-BhZp3z4u.js";import{_ as b}from"./chunk-BHCorYK2.js";import"./chunk-D7SyfRoT.js";import"./app-C-ZlocOh.js";import"./chunk-BWiubfpN.js";import"./chunk-CouA7u-j.js";import"./chunk-DmrwHl-6.js";import"./chunk-De_qwhex.js";import"./chunk-eMHYSAeQ.js";import"./chunk-beXL1A--.js";import"./chunk-CAoK8Mdm.js";import"./chunk-BiBvtcLb.js";import"./chunk-DNKDGYPp.js";import"./chunk-BiW1c8q7.js";import"./chunk-CTIk0k8a.js";import"./chunk-dqIIyBTR.js";import"./chunk-CvscUVdi.js";import"./chunk-BvbZUszZ.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-DCXiFUg-.js";import"./chunk-Bsc1JRL5.js";import"./chunk-BuJDoypK.js";import"./chunk-3cs9K1fB.js";import"./chunk-BG5DB3cD.js";import"./chunk-CdKrFGoA.js";import"./chunk-DvBKKKMs.js";const k={class:"mb-8"},h={class:"flex items-center justify-between flex-wrap gap-4"},v={class:"flex items-center gap-3"},f=["value"],w=["value"],j=["value"],_={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8"},q={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},B={class:"text-2xl font-bold text-gray-900 dark:text-white"},C={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},T={class:"text-2xl font-bold text-green-600"},I={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},S={class:"text-2xl font-bold text-yellow-600"},U={class:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},A={class:"text-2xl font-bold text-emerald-600"},N={class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},z={class:"overflow-x-auto"},F={class:"w-full"},J={class:"divide-y divide-gray-200 dark:divide-gray-700"},K={class:"px-6 py-4 whitespace-nowrap"},V={class:"flex items-center"},D={class:"w-10 h-10 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center text-emerald-700 dark:text-emerald-400 font-medium"},O={class:"ml-3 font-medium text-gray-900 dark:text-white"},H={class:"px-6 py-4 text-center"},M={class:"px-6 py-4 text-center"},Y={class:"px-6 py-4 text-right font-medium text-green-600"},$={class:"px-6 py-4 text-right font-medium text-red-600"},E={class:"px-6 py-4 text-right font-bold text-gray-900 dark:text-white"},G={class:"px-6 py-4 text-center"},P={class:"px-6 py-4 text-center"},R=["onClick"],X={key:1,class:"text-gray-400 text-sm"},Z={key:0},L={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Q={class:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6"},W={class:"text-gray-600 dark:text-gray-400 mb-4"},ee={class:"mb-4"},te={class:"mb-4"},ae={class:"flex justify-end gap-3"},re={__name:"Bonuses",props:{bonuses:Array,stats:Object,month:Number,year:Number,currentStatus:String,panelType:String},setup(re){const se=re,le=(new Date).getFullYear(),de=e(se.month),oe=e(se.year),ne=e(!1),pe=e(null),ue=e({approved_bonus:0,notes:""}),xe=()=>{y.get("/sales-head/sales-kpi/bonuses",{month:de.value,year:oe.value},{preserveState:!0})},ie=e=>e?new Intl.NumberFormat("uz-UZ").format(e)+" so'm":"0 so'm",ge=e=>{const t={standard:"px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700",excellent:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700",accelerator:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700"};return t[e]||t.standard},ce=e=>{const t={pending:"px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-700",approved:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-700",rejected:"px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-700"};return t[e]||t.pending},me=()=>{y.post(`/sales-head/sales-kpi/bonuses/${pe.value.id}/approve`,ue.value,{onSuccess:()=>{ne.value=!1}})};return(e,y)=>(o(),t(b,{title:"Bonuslar"},{default:a(()=>[r("div",k,[r("div",h,[y[5]||(y[5]=r("div",null,[r("h2",{class:"text-3xl font-bold text-gray-900 dark:text-gray-100"},"Bonuslar"),r("p",{class:"mt-2 text-gray-600 dark:text-gray-400"},"Oylik bonuslarni ko'rish va tasdiqlash")],-1)),r("div",v,[d(r("select",{"onUpdate:modelValue":y[0]||(y[0]=e=>de.value=e),onChange:xe,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[(o(),s(n,null,p(12,e=>r("option",{key:e,value:e},u((e=>["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentabr","Oktabr","Noyabr","Dekabr"][e-1])(e)),9,f)),64))],544),[[x,de.value]]),d(r("select",{"onUpdate:modelValue":y[1]||(y[1]=e=>oe.value=e),onChange:xe,class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800"},[r("option",{value:i(le)-1},u(i(le)-1),9,w),r("option",{value:i(le)},u(i(le)),9,j)],544),[[x,oe.value]])])])]),r("div",_,[r("div",q,[y[6]||(y[6]=r("p",{class:"text-sm text-gray-500 mb-1"},"Jami hisoblangan",-1)),r("p",B,u(ie(re.stats.total_calculated)),1)]),r("div",C,[y[7]||(y[7]=r("p",{class:"text-sm text-gray-500 mb-1"},"Tasdiqlangan",-1)),r("p",T,u(ie(re.stats.total_approved)),1)]),r("div",I,[y[8]||(y[8]=r("p",{class:"text-sm text-gray-500 mb-1"},"Kutilmoqda",-1)),r("p",S,u(re.stats.pending_count),1)]),r("div",U,[y[9]||(y[9]=r("p",{class:"text-sm text-gray-500 mb-1"},"Tasdiqlangan soni",-1)),r("p",A,u(re.stats.approved_count),1)])]),r("div",N,[r("div",z,[r("table",F,[y[11]||(y[11]=r("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[r("tr",null,[r("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Xodim"),r("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"KPI Ball"),r("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Tier"),r("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Bonus"),r("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Jarimalar"),r("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Jami"),r("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Holat"),r("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amal")])],-1)),r("tbody",J,[(o(!0),s(n,null,p(re.bonuses,e=>{return o(),s("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[r("td",K,[r("div",V,[r("div",D,u((l=e.user?.name,l?l.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"?")),1),r("span",O,u(e.user?.name),1)])]),r("td",H,[r("span",{class:g(["text-lg font-bold",(a=e.kpi_score,a>=100?"text-green-600":a>=80?"text-blue-600":"text-yellow-600")])},u(e.kpi_score)+"%",3)]),r("td",M,[r("span",{class:g(ge(e.applied_tier))},u(e.applied_tier),3)]),r("td",Y," +"+u(ie(e.base_amount)),1),r("td",$," -"+u(ie(e.total_penalties||0)),1),r("td",E,u(ie(e.final_amount)),1),r("td",G,[r("span",{class:g(ce(e.status))},u((t=e.status,{pending:"Kutilmoqda",approved:"Tasdiqlangan",rejected:"Rad etilgan"}[t]||t)),3)]),r("td",P,["pending"===e.status?(o(),s("button",{key:0,onClick:t=>(e=>{pe.value=e,ue.value={approved_bonus:e.final_amount,notes:""},ne.value=!0})(e),class:"px-3 py-1 bg-emerald-600 text-white rounded-lg text-sm hover:bg-emerald-700"}," Tasdiqlash ",8,R)):(o(),s("span",X,"-"))])]);var t,a,l}),128)),0===re.bonuses.length?(o(),s("tr",Z,[...y[10]||(y[10]=[r("td",{colspan:"8",class:"px-6 py-12 text-center text-gray-500"}," Bu oy uchun bonus ma'lumotlari yo'q ",-1)])])):l("",!0)])])])]),ne.value?(o(),s("div",L,[r("div",Q,[y[15]||(y[15]=r("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-4"},"Bonusni tasdiqlash",-1)),r("p",W,[r("strong",null,u(pe.value?.user?.name),1),y[12]||(y[12]=c(" uchun bonus tasdiqlash ",-1))]),r("div",ee,[y[13]||(y[13]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Tasdiqlangan summa",-1)),d(r("input",{"onUpdate:modelValue":y[2]||(y[2]=e=>ue.value.approved_bonus=e),type:"number",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},null,512),[[m,ue.value.approved_bonus,void 0,{number:!0}]])]),r("div",te,[y[14]||(y[14]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Izoh (ixtiyoriy)",-1)),d(r("textarea",{"onUpdate:modelValue":y[3]||(y[3]=e=>ue.value.notes=e),rows:"2",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700"},null,512),[[m,ue.value.notes]])]),r("div",ae,[r("button",{onClick:y[4]||(y[4]=e=>ne.value=!1),class:"px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}," Bekor qilish "),r("button",{onClick:me,class:"px-4 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700"}," Tasdiqlash ")])])])):l("",!0)]),_:1}))}};export{re as default};
