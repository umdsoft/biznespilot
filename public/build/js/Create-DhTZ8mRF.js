import{b as f,r as U,w as R,v as h,x as B,y as i,z as e,A as s,C as u,Q as K,D as g,L as x,E as d,F as $,G as T,B as m,H as l,M as q,I as p,J as b,K as P,R as z}from"./chunk-BcTZxe-J.js";import{u as E,h as G,l as H}from"./chunk-BYRtWSr0.js";import{_ as J}from"./chunk-CYarSvys.js";import{_ as X}from"./chunk-Dd--AZOj.js";import{_ as Z}from"./chunk-BVg2xI-u.js";import{_ as W}from"./chunk-BbDodmQc.js";import{r as ee}from"./chunk-BHX0ueEB.js";import{r as A}from"./chunk-TBIYSmbo.js";import{r as te}from"./chunk-3cjAeKxf.js";import{r as re}from"./chunk-Rs1WNzbn.js";import{a as _}from"./chunk-_yYzsx_i.js";import{r as N}from"./chunk-CQoMtUf7.js";import{r as se}from"./chunk-B4yz7jSC.js";import{r as oe}from"./chunk-TdbA8O2H.js";import{r as ae}from"./chunk-CG0drqHE.js";import{r as le}from"./chunk-qVc0_oyq.js";import{a as de}from"./chunk-D58UsNjm.js";import{r as ie}from"./chunk-Ba8J67bG.js";import{r as ne}from"./chunk-zLGxu1Jg.js";import{r as ue}from"./chunk-DD8Pd8sB.js";import"./app-DWC75jbx.js";import"./chunk-C1xeNfMu.js";import"./chunk-BVYwhYNk.js";import"./chunk-BqueMrU7.js";import"./chunk-CJsSO8V8.js";import"./chunk-CrR1zWIb.js";import"./chunk-LBbTbQSS.js";import"./chunk-I93QdGKi.js";import"./chunk-DNp5bQOL.js";import"./chunk-CklLzvQL.js";import"./chunk-CnrLL2pV.js";import"./chunk-Dy6aDPCS.js";import"./chunk-CKHdppiT.js";import"./chunk-Sr2jsNPC.js";import"./chunk-Bv_bj7dx.js";const ge={class:"py-6 min-h-screen bg-gradient-to-br from-gray-50 via-white to-purple-50/30 dark:from-gray-900 dark:via-gray-800 dark:to-purple-900/20"},pe={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},me={class:"mb-8"},be={class:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3"},ce={class:"w-12 h-12 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg"},xe={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden"},ye={class:"px-6 py-4 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/30 dark:to-indigo-900/30 border-b border-purple-100 dark:border-purple-800"},fe={class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},he={class:"p-6"},_e={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},ke=["onClick"],ve={class:"flex items-start justify-between mb-2"},we={class:"font-bold text-gray-900 dark:text-white"},Ce={class:"flex items-center justify-between text-sm"},$e={class:"text-purple-600 font-semibold"},Te={class:"text-green-600"},Ve={class:"mt-2 text-xs text-gray-500"},Me={key:0,class:"mt-2 text-sm text-red-600"},Ue={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden"},Se={class:"px-6 py-4 bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/30 dark:to-cyan-900/30 border-b border-blue-100 dark:border-blue-800"},Le={class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},je={class:"p-6"},Be={class:"grid grid-cols-2 md:grid-cols-5 gap-3"},qe=["onClick"],ze={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden"},Ae={class:"px-6 py-4 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 border-b border-green-100 dark:border-green-800"},Ne={class:"flex items-center justify-between"},Ye={class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},Fe={class:"ml-2 px-2.5 py-0.5 bg-green-100 text-green-700 rounded-full text-sm"},Ie={class:"p-6"},Qe={class:"flex flex-wrap items-center gap-4 mb-4"},De={class:"relative flex-1 min-w-48"},Oe=["value"],Re={class:"flex items-center gap-2 cursor-pointer"},Ke={class:"max-h-96 overflow-y-auto border border-gray-200 dark:border-gray-600 rounded-xl"},Pe=["onClick"],Ee={class:"flex-shrink-0"},Ge={class:"flex-1 min-w-0"},He={class:"font-medium text-gray-900 dark:text-white truncate"},Je={class:"text-sm text-gray-500 truncate"},Xe={class:"flex items-center gap-2"},Ze={key:0,class:"p-8 text-center text-gray-500"},We={key:0,class:"mt-2 text-sm text-red-600"},et={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden"},tt={class:"px-6 py-4 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/30 dark:to-orange-900/30 border-b border-yellow-100 dark:border-yellow-800"},rt={class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},st={class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},ot={class:"relative"},at=["placeholder"],lt={class:"p-4 bg-green-50 dark:bg-green-900/30 rounded-xl"},dt={class:"text-2xl font-bold text-green-800 dark:text-green-300"},it={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},nt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ut={class:"md:col-span-2"},gt={class:"md:col-span-2"},pt={class:"flex items-center gap-3 cursor-pointer"},mt=["disabled"],bt={class:"flex items-center justify-between p-6 bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700"},ct={class:"text-gray-600 dark:text-gray-400"},xt={class:"font-semibold text-purple-600"},yt={class:"font-semibold"},ft=["disabled"],tr={__name:"Create",props:{panelType:String,offers:Array,leads:Array,channels:Object},setup(V){const y=V,Y=f(()=>({business:X,saleshead:Z,operator:W})[y.panelType]||J),S=()=>({saleshead:"sales-head",business:"business",operator:"operator"})[y.panelType]||y.panelType,o=E({offer_id:"",lead_ids:[],channel:"telegram",custom_price:null,discount:null,discount_code:"",scheduled_at:"",expires_at:"",notes:"",send_immediately:!0}),k=f(()=>y.offers.find(a=>a.id===o.offer_id)),v=U(""),w=U(""),C=U(!1),c=f(()=>{let a=y.leads;if(v.value){const t=v.value.toLowerCase();a=a.filter(r=>r.name?.toLowerCase().includes(t)||r.phone?.includes(t)||r.email?.toLowerCase().includes(t))}return w.value&&(a=a.filter(t=>t.status===w.value)),C.value&&(a=a.filter(t=>t.has_telegram)),a}),L=f(()=>c.value.length>0&&c.value.every(a=>o.lead_ids.includes(a.id))),F=()=>{if(L.value)o.lead_ids=o.lead_ids.filter(a=>!c.value.find(t=>t.id===a));else{const a=c.value.map(t=>t.id);o.lead_ids=[...new Set([...o.lead_ids,...a])]}},I=a=>{const t=o.lead_ids.indexOf(a);t>-1?o.lead_ids.splice(t,1):o.lead_ids.push(a)},Q=a=>({telegram:_,sms:ue,email:ne,whatsapp:_,manual:N})[a]||_,M=a=>a?new Intl.NumberFormat("uz-UZ").format(a):"0",D=f(()=>{const a=o.custom_price||k.value?.pricing||0,t=o.discount||0;return Math.max(0,a-t)}),O=()=>{o.post(route(`${S()}.offer-automation.store`))};R(()=>o.channel,a=>{a==="telegram"&&(C.value=!0)});const j={new:"Yangi",contacted:"Bog'lanildi",qualified:"Malakali",proposal:"Taklif",negotiation:"Muzokara"};return(a,t)=>(d(),h(q(Y.value),{title:"Taklif Yuborish"},{default:B(()=>[i(s(G),{title:"Taklif Yuborish"}),e("div",ge,[e("div",pe,[e("div",me,[i(s(H),{href:a.route(`${S()}.offer-automation.index`),class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-purple-600 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-4"},{default:B(()=>[i(s(ee),{class:"w-4 h-4"}),t[10]||(t[10]=u(" Orqaga ",-1))]),_:1},8,["href"]),e("h1",be,[e("div",ce,[i(s(A),{class:"w-6 h-6 text-white"})]),t[11]||(t[11]=u(" Taklif Yuborish ",-1))]),t[12]||(t[12]=e("p",{class:"text-gray-500 dark:text-gray-400 mt-2"}," Tanlangan lidlarga taklif yuborish ",-1))]),e("form",{onSubmit:K(O,["prevent"]),class:"space-y-6"},[e("div",xe,[e("div",ye,[e("h2",fe,[i(s(te),{class:"w-5 h-5 text-purple-600"}),t[13]||(t[13]=u(" 1. Taklifni Tanlang ",-1))])]),e("div",he,[e("div",_e,[(d(!0),g($,null,T(V.offers,r=>(d(),g("div",{key:r.id,onClick:n=>s(o).offer_id=r.id,class:m(["p-4 border-2 rounded-xl cursor-pointer transition-all",s(o).offer_id===r.id?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-600 hover:border-purple-300"])},[e("div",ve,[e("h3",we,l(r.name),1),s(o).offer_id===r.id?(d(),h(s(re),{key:0,class:"w-6 h-6 text-purple-600"})):x("",!0)]),e("div",Ce,[e("span",$e,l(M(r.pricing))+" so'm",1),e("span",Te,l(r.conversion_rate)+"% CR",1)]),e("div",Ve," Qiymat bali: "+l(r.value_score),1)],10,ke))),128))]),s(o).errors.offer_id?(d(),g("p",Me,l(s(o).errors.offer_id),1)):x("",!0)])]),e("div",Ue,[e("div",Se,[e("h2",Le,[i(s(_),{class:"w-5 h-5 text-blue-600"}),t[14]||(t[14]=u(" 2. Kanal Tanlang ",-1))])]),e("div",je,[e("div",Be,[(d(!0),g($,null,T(V.channels,(r,n)=>(d(),g("button",{key:n,type:"button",onClick:ht=>s(o).channel=n,class:m(["p-4 border-2 rounded-xl flex flex-col items-center gap-2 transition-all",s(o).channel===n?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-blue-300"])},[(d(),h(q(Q(n)),{class:m(["w-6 h-6",s(o).channel===n?"text-blue-600":"text-gray-400"])},null,8,["class"])),e("span",{class:m(["text-sm font-medium",s(o).channel===n?"text-blue-600":"text-gray-600 dark:text-gray-400"])},l(r),3)],10,qe))),128))])])]),e("div",ze,[e("div",Ae,[e("div",Ne,[e("h2",Ye,[i(s(N),{class:"w-5 h-5 text-green-600"}),t[15]||(t[15]=u(" 3. Lidlarni Tanlang ",-1)),e("span",Fe,l(s(o).lead_ids.length)+" ta tanlandi ",1)])])]),e("div",Ie,[e("div",Qe,[e("div",De,[i(s(se),{class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>v.value=r),type:"text",placeholder:"Ism, telefon yoki email...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[b,v.value]])]),p(e("select",{"onUpdate:modelValue":t[1]||(t[1]=r=>w.value=r),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},[t[16]||(t[16]=e("option",{value:""},"Barcha holatlar",-1)),(d(),g($,null,T(j,(r,n)=>e("option",{key:n,value:n},l(r),9,Oe)),64))],512),[[P,w.value]]),e("label",Re,[p(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=r=>C.value=r),class:"w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500"},null,512),[[z,C.value]]),t[17]||(t[17]=e("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Faqat Telegram",-1))]),e("button",{type:"button",onClick:F,class:"px-4 py-2 text-sm font-medium text-purple-600 hover:text-purple-700 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors"},l(L.value?"Barchasini olib tashlash":"Barchasini tanlash"),1)]),e("div",Ke,[(d(!0),g($,null,T(c.value,r=>(d(),g("div",{key:r.id,onClick:n=>I(r.id),class:m(["flex items-center gap-4 p-4 border-b border-gray-100 dark:border-gray-700 last:border-b-0 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",{"bg-purple-50 dark:bg-purple-900/20":s(o).lead_ids.includes(r.id)}])},[e("div",Ee,[e("div",{class:m(["w-6 h-6 rounded border-2 flex items-center justify-center transition-colors",s(o).lead_ids.includes(r.id)?"bg-purple-600 border-purple-600":"border-gray-300 dark:border-gray-600"])},[s(o).lead_ids.includes(r.id)?(d(),h(s(oe),{key:0,class:"w-4 h-4 text-white"})):x("",!0)],2)]),e("div",Ge,[e("p",He,l(r.name),1),e("p",Je,l(r.phone),1)]),e("div",Xe,[e("span",{class:m(["px-2 py-1 text-xs font-medium rounded-full",{"bg-blue-100 text-blue-700":r.status==="new","bg-yellow-100 text-yellow-700":r.status==="contacted","bg-green-100 text-green-700":r.status==="qualified","bg-purple-100 text-purple-700":r.status==="proposal","bg-orange-100 text-orange-700":r.status==="negotiation"}])},l(j[r.status]),3),r.has_telegram?(d(),h(s(_),{key:0,class:"w-5 h-5 text-blue-500",title:"Telegram mavjud"})):x("",!0)])],10,Pe))),128)),c.value.length===0?(d(),g("div",Ze," Lidlar topilmadi ")):x("",!0)]),s(o).errors.lead_ids?(d(),g("p",We,l(s(o).errors.lead_ids),1)):x("",!0)])]),e("div",et,[e("div",tt,[e("h2",rt,[i(s(ae),{class:"w-5 h-5 text-yellow-600"}),t[18]||(t[18]=u(" 4. Qo'shimcha Sozlamalar ",-1))])]),e("div",st,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Maxsus Narx (ixtiyoriy) ",-1)),e("div",ot,[i(s(le),{class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>s(o).custom_price=r),type:"number",placeholder:k.value?M(k.value.pricing):"0",class:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,8,at),[[b,s(o).custom_price,void 0,{number:!0}]])])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Chegirma Summasi ",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>s(o).discount=r),type:"number",placeholder:"0",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[b,s(o).discount,void 0,{number:!0}]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Chegirma Kodi ",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>s(o).discount_code=r),type:"text",placeholder:"MAXSUS20",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[b,s(o).discount_code]])]),e("div",lt,[t[22]||(t[22]=e("p",{class:"text-sm text-green-700 dark:text-green-400 mb-1"},"Yakuniy Narx",-1)),e("p",dt,l(M(D.value))+" so'm",1)]),e("div",null,[e("label",it,[i(s(de),{class:"w-4 h-4 inline mr-1"}),t[23]||(t[23]=u(" Rejalashtirilgan Vaqt ",-1))]),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>s(o).scheduled_at=r),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[b,s(o).scheduled_at]])]),e("div",null,[e("label",nt,[i(s(ie),{class:"w-4 h-4 inline mr-1"}),t[24]||(t[24]=u(" Amal Qilish Muddati ",-1))]),p(e("input",{"onUpdate:modelValue":t[7]||(t[7]=r=>s(o).expires_at=r),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[b,s(o).expires_at]])]),e("div",ut,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Qo'shimcha Izoh ",-1)),p(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=r=>s(o).notes=r),rows:"2",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Ichki izohlar..."},null,512),[[b,s(o).notes]])]),e("div",gt,[e("label",pt,[p(e("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=r=>s(o).send_immediately=r),disabled:!!s(o).scheduled_at,class:"w-5 h-5 rounded border-gray-300 text-purple-600 focus:ring-purple-500"},null,8,mt),[[z,s(o).send_immediately]]),t[26]||(t[26]=e("span",{class:"text-gray-700 dark:text-gray-300"},"Darhol yuborish",-1))])])])]),e("div",bt,[e("div",ct,[e("span",xt,l(s(o).lead_ids.length),1),t[27]||(t[27]=u(" ta lidga ",-1)),e("span",yt,l(k.value?.name||"taklif"),1),t[28]||(t[28]=u(" yuboriladi ",-1))]),e("button",{type:"submit",disabled:s(o).processing||!s(o).offer_id||s(o).lead_ids.length===0,class:"inline-flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-semibold rounded-xl hover:from-purple-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg"},[i(s(A),{class:"w-5 h-5"}),u(" "+l(s(o).processing?"Yuborilmoqda...":"Yuborish"),1)],8,ft)])],32)])])]),_:1}))}};export{tr as default};
