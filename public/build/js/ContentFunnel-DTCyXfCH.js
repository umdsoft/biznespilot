import{r as F,b as i,o as X,v as j,x as V,y as v,z as t,A as c,C as s,D as g,J as U,K as E,F as a,G as x,H as o,I as p,M as H,B as m,S as T,E as D}from"./chunk-KPSVwAyv.js";import{h as tt,l as et,a as rt}from"./chunk-BVrjkT6E.js";import{_ as at}from"./chunk-BEX9HuyE.js";import{r as st}from"./chunk-J14gS6og.js";import{r as ot}from"./chunk-D5sR6A8B.js";import{r as dt}from"./chunk-Dfha1x8d.js";import{r as lt}from"./chunk-CPI6G2q3.js";import{r as nt}from"./chunk-BlCINui_.js";import{r as it}from"./chunk-BeK6HK_O.js";import{r as gt}from"./chunk-BH2bQseJ.js";import{r as xt}from"./chunk-jrLe6Yn-.js";import{r as S}from"./chunk-BgOPVSvg.js";import{a as z}from"./chunk-BgShz32H.js";import{r as ut}from"./chunk-CmNfLjGq.js";import{r as yt}from"./chunk-D59q4lxq.js";import"./chunk-C_PbB7ed.js";import"./app-DMGwzSHW.js";import"./chunk-BvkwlYlD.js";import"./chunk-Qe-_4ASA.js";import"./chunk-Ch0Q6XPl.js";import"./chunk-CYw1XsNK.js";import"./chunk-qku2UxUN.js";import"./chunk-Dems4pAU.js";import"./chunk-Cw_2vanC.js";import"./chunk-14qmXdHo.js";import"./chunk-DN454CZt.js";import"./chunk-CYZ54WJE.js";import"./chunk-D-7B8ZCD.js";const ct={class:"space-y-6"},pt={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},mt={class:"flex items-center gap-2"},bt={class:"flex items-center gap-2"},ht={key:0,class:"flex items-center justify-center py-20"},kt={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},vt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-4"},ft={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},_t={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-4"},wt={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},Ct={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-4"},Ft={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},Mt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-4"},Kt={class:"text-2xl font-bold text-green-600 dark:text-green-400 mt-1"},$t={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},jt={class:"p-6"},Tt={key:0,class:"text-center py-8"},Dt={key:1,class:"space-y-3"},St={class:"flex items-center gap-4"},zt={class:"w-32 flex-shrink-0 text-right"},Bt={class:"flex items-center justify-end gap-2"},Lt={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Nt={class:"flex-1"},qt={class:"text-white text-sm font-bold whitespace-nowrap"},It={key:0,class:"ml-36 pl-4 py-1"},Vt={key:1,class:"text-xs font-medium text-blue-500"},Ut={key:2,class:"mt-6 p-4 border border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900/20 rounded-lg"},Et={class:"flex items-start gap-3"},Ht={class:"font-medium text-red-800 dark:text-red-300"},At={class:"text-sm text-red-600 dark:text-red-400 mt-1"},Gt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Jt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Rt={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Ot={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},Pt={class:"p-6 space-y-3"},Qt={key:0,class:"text-center py-4"},Wt={class:"flex items-start gap-3"},Yt={class:"font-medium text-gray-900 dark:text-white text-sm"},Zt={class:"text-xs text-gray-600 dark:text-gray-400 mt-1"},Xt={class:"text-xs font-medium text-indigo-600 dark:text-indigo-400 mt-2"},te={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},ee={class:"p-6 space-y-4"},re={key:0,class:"text-center py-4"},ae={class:"flex items-center justify-between"},se={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},oe={class:"flex items-center gap-3 text-xs text-gray-500 dark:text-gray-400"},de={class:"font-medium text-indigo-600 dark:text-indigo-400"},le={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},ne={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},ie={class:"overflow-x-auto"},ge={key:0,class:"text-center py-8"},xe={key:1,class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ue={class:"divide-y divide-gray-200 dark:divide-gray-700"},ye={class:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400"},ce={class:"px-4 py-3"},pe={class:"max-w-xs"},me={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},be={class:"text-xs text-gray-500 dark:text-gray-400"},he={key:0},ke={class:"px-4 py-3 text-sm text-right text-gray-900 dark:text-white"},ve={class:"px-4 py-3 text-sm text-right text-gray-900 dark:text-white"},fe={class:"px-4 py-3 text-sm text-right"},_e={class:"px-4 py-3 text-sm text-right"},we={class:"px-4 py-3 text-sm text-right font-medium text-gray-900 dark:text-white"},Ce={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Fe={class:"p-6"},Me={key:0,class:"text-center py-8"},Ke={key:1,class:"space-y-4"},$e={class:"overflow-x-auto"},je={class:"min-w-full text-sm"},Te={class:"border-b border-gray-200 dark:border-gray-700"},De={class:"px-3 py-2 font-medium text-gray-700 dark:text-gray-300"},Se={key:2,class:"text-center py-20"},lr={__name:"ContentFunnel",props:{filters:Object,lazyLoad:{type:Boolean,default:!1}},setup(A){const B=A,b=F(B.filters?.date_from||""),h=F(B.filters?.date_to||""),f=F(!1),n=F(null),_=d=>d?new Intl.NumberFormat("uz-UZ").format(Math.round(d)):"0",M=d=>d?d>=1e6?(d/1e6).toFixed(1)+"M":d>=1e3?(d/1e3).toFixed(1)+"K":d.toString():"0",k=i(()=>n.value?.funnel?.funnel||[]),u=i(()=>n.value?.funnel?.dropoffs||[]),y=i(()=>n.value?.funnel?.bottleneck||null),w=i(()=>n.value?.funnel?.summary||{}),L=i(()=>n.value?.ranking||[]),C=i(()=>n.value?.by_type||[]),K=i(()=>n.value?.trend||{labels:[],datasets:[]}),N=i(()=>n.value?.insights||[]),G=d=>k.value.length?(k.value[0]?.count,k.value[d]?.count,d<=1?Math.max(100-d*8,60):d>=4?Math.max(20-(d-4)*5,5):Math.max(60-(d-2)*15,15)):100,q={content_created:{bg:"bg-blue-500",text:"text-blue-600",light:"bg-blue-50 dark:bg-blue-900/30"},published:{bg:"bg-indigo-500",text:"text-indigo-600",light:"bg-indigo-50 dark:bg-indigo-900/30"},reached:{bg:"bg-purple-500",text:"text-purple-600",light:"bg-purple-50 dark:bg-purple-900/30"},engaged:{bg:"bg-pink-500",text:"text-pink-600",light:"bg-pink-50 dark:bg-pink-900/30"},leads:{bg:"bg-orange-500",text:"text-orange-600",light:"bg-orange-50 dark:bg-orange-900/30"},qualified:{bg:"bg-yellow-500",text:"text-yellow-600",light:"bg-yellow-50 dark:bg-yellow-900/30"},won:{bg:"bg-green-500",text:"text-green-600",light:"bg-green-50 dark:bg-green-900/30"}},J={content_created:xt,published:gt,reached:it,engaged:nt,leads:lt,qualified:dt,won:ot},R={warning:S,danger:S,success:ut,info:z},I={warning:"border-yellow-300 bg-yellow-50 dark:border-yellow-700 dark:bg-yellow-900/20",danger:"border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900/20",success:"border-green-300 bg-green-50 dark:border-green-700 dark:bg-green-900/20",info:"border-blue-300 bg-blue-50 dark:border-blue-700 dark:bg-blue-900/20"},O={warning:"text-yellow-600 dark:text-yellow-400",danger:"text-red-600 dark:text-red-400",success:"text-green-600 dark:text-green-400",info:"text-blue-600 dark:text-blue-400"},P=d=>({educational:"Ta'limiy",promotional:"Reklama",inspirational:"Ilhomlantiruvchi",entertaining:"Ko'ngil ochar",behind_scenes:"Sahna ortidan",ugc:"UGC"})[d]||d,$=async()=>{f.value=!0;try{const d={};b.value&&(d.date_from=b.value),h.value&&(d.date_to=h.value);const e=await rt.get(route("business.analytics.api.content-funnel"),{params:d});n.value=e.data}catch(d){console.error("Content funnel data loading error:",d)}finally{f.value=!1}};X(()=>$());const Q=()=>$(),W=()=>{b.value="",h.value="",$()},Y=i(()=>C.value.length?Math.max(...C.value.map(d=>d.lead_conversion),1):1);return(d,e)=>(a(),j(at,{title:"Kontent Funnel"},{default:V(()=>[v(c(tt),{title:"Kontent Funnel"}),t("div",ct,[t("div",pt,[t("div",null,[t("div",mt,[v(c(et),{href:d.route("business.analytics.index"),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},{default:V(()=>[v(c(st),{class:"w-5 h-5"})]),_:1},8,["href"]),e[2]||(e[2]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Kontent Funnel",-1))]),e[3]||(e[3]=t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Kontent yaratishdan daromadgacha bo'lgan to'liq zanjir tahlili ",-1))]),t("div",bt,[U(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>b.value=r),type:"date",class:"text-sm border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[E,b.value]]),e[4]||(e[4]=t("span",{class:"text-gray-400"},"—",-1)),U(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>h.value=r),type:"date",class:"text-sm border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[E,h.value]]),t("button",{onClick:Q,class:"px-3 py-2 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700"}," Qo'llash "),b.value||h.value?(a(),s("button",{key:0,onClick:W,class:"px-3 py-2 text-gray-600 dark:text-gray-400 text-sm hover:text-gray-900"}," Tozalash ")):g("",!0)])]),f.value?(a(),s("div",ht,[...e[5]||(e[5]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):n.value?(a(),s(x,{key:1},[t("div",kt,[t("div",vt,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Kontent → Lid",-1)),t("p",ft,o(w.value.content_to_lead_rate||0)+"% ",1)]),t("div",_t,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Lid → Sotuv",-1)),t("p",wt,o(w.value.lead_to_sale_rate||0)+"% ",1)]),t("div",Ct,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Daromad / Kontent",-1)),t("p",Ft,o(_(w.value.revenue_per_content)),1)]),t("div",Mt,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Jami daromad",-1)),t("p",Kt,o(_(w.value.total_revenue))+" so'm ",1)])]),t("div",$t,[e[11]||(e[11]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Kontent → Daromad Funnel")],-1)),t("div",jt,[k.value.length?(a(),s("div",Dt,[(a(!0),s(x,null,p(k.value,(r,l)=>(a(),s("div",{key:r.stage,class:"relative"},[t("div",St,[t("div",zt,[t("div",Bt,[(a(),j(H(J[r.stage]),{class:m(["w-4 h-4",q[r.stage]?.text||"text-gray-500"])},null,8,["class"])),t("span",Lt,o(r.label),1)])]),t("div",Nt,[t("div",{class:m(["h-10 rounded-lg flex items-center px-3 transition-all duration-500",q[r.stage]?.bg||"bg-gray-500",y.value&&y.value.from===r.stage?"ring-2 ring-red-500 ring-offset-2 dark:ring-offset-gray-800":""]),style:T({width:G(l)+"%"})},[t("span",qt,o(r.stage==="won"&&r.revenue?M(r.count)+" ("+_(r.revenue)+" so'm)":M(r.count)),1)],6)])]),l<k.value.length-1&&u.value[l]?(a(),s("div",It,[u.value[l].type==="dropoff"?(a(),s("span",{key:0,class:m(["text-xs font-medium",u.value[l].rate>50?"text-red-500":u.value[l].rate>30?"text-yellow-500":"text-gray-400"])}," ↓ "+o(u.value[l].rate)+"% tushkunlik ",3)):u.value[l].type==="conversion"?(a(),s("span",Vt," → "+o(u.value[l].rate)+"% konversiya ",1)):g("",!0)])):g("",!0)]))),128))])):(a(),s("div",Tt,[...e[10]||(e[10]=[t("p",{class:"text-gray-500 dark:text-gray-400"},"Ma'lumotlar mavjud emas. Avval kontent yarating.",-1)])])),y.value?(a(),s("div",Ut,[t("div",Et,[v(c(S),{class:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),t("div",null,[t("p",Ht," Bottleneck: "+o(y.value.from)+" → "+o(y.value.to)+" ("+o(y.value.rate)+"% yo'qotish) ",1),t("p",At,o(y.value.message),1)])])])):g("",!0)])]),t("div",Gt,[t("div",Jt,[t("div",Rt,[t("h3",Ot,[v(c(z),{class:"w-5 h-5 text-yellow-500"}),e[12]||(e[12]=D(" Tavsiyalar ",-1))])]),t("div",Pt,[N.value.length?g("",!0):(a(),s("div",Qt,[...e[13]||(e[13]=[t("p",{class:"text-gray-500 dark:text-gray-400"},"Yetarli ma'lumot yig'ilgach tavsiyalar paydo bo'ladi",-1)])])),(a(!0),s(x,null,p(N.value,(r,l)=>(a(),s("div",{key:l,class:m(["p-4 rounded-lg border",I[r.type]||I.info])},[t("div",Wt,[(a(),j(H(R[r.type]||c(z)),{class:m(["w-5 h-5 flex-shrink-0 mt-0.5",O[r.type]||"text-gray-500"])},null,8,["class"])),t("div",null,[t("p",Yt,o(r.title),1),t("p",Zt,o(r.description),1),t("p",Xt,o(r.action),1)])])],2))),128))])]),t("div",te,[e[15]||(e[15]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Kontent turi bo'yicha")],-1)),t("div",ee,[C.value.length?g("",!0):(a(),s("div",re,[...e[14]||(e[14]=[t("p",{class:"text-gray-500 dark:text-gray-400"},"Ma'lumotlar mavjud emas",-1)])])),(a(!0),s(x,null,p(C.value,r=>(a(),s("div",{key:r.content_type,class:"space-y-2"},[t("div",ae,[t("span",se,o(r.label),1),t("div",oe,[t("span",null,o(r.posts_count)+" post",1),t("span",null,o(r.leads_count)+" lid",1),t("span",de,o(r.lead_conversion)+"% ",1)])]),t("div",le,[t("div",{class:"bg-indigo-500 h-2 rounded-full transition-all duration-500",style:T({width:r.lead_conversion/Y.value*100+"%"})},null,4)])]))),128))])])]),t("div",ne,[e[18]||(e[18]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Top Kontentlar")],-1)),t("div",ie,[L.value.length?(a(),s("table",xe,[e[17]||(e[17]=t("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"#"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Kontent"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Reach"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Eng."),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Lidlar"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Sotuvlar"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Daromad")])],-1)),t("tbody",ue,[(a(!0),s(x,null,p(L.value.slice(0,10),(r,l)=>(a(),s("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/30"},[t("td",ye,o(l+1),1),t("td",ce,[t("div",pe,[t("p",me,o(r.title),1),t("p",be,[D(o(P(r.content_type))+" ",1),r.published_at?(a(),s("span",he," · "+o(r.published_at),1)):g("",!0)])])]),t("td",ke,o(M(r.reach)),1),t("td",ve,o(r.engagement_rate?.toFixed(1)||0)+"%",1),t("td",fe,[t("span",{class:m(r.leads_count>0?"text-green-600 dark:text-green-400 font-medium":"text-gray-500")},o(r.leads_count),3)]),t("td",_e,[t("span",{class:m(r.sales_count>0?"text-green-600 dark:text-green-400 font-medium":"text-gray-500")},o(r.sales_count),3)]),t("td",we,o(r.revenue>0?_(r.revenue):"—"),1)]))),128))])])):(a(),s("div",ge,[...e[16]||(e[16]=[t("p",{class:"text-gray-500 dark:text-gray-400"},"Ma'lumotlar mavjud emas",-1)])]))])]),t("div",Ce,[e[21]||(e[21]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Haftalik Trend (8 hafta)")],-1)),t("div",Fe,[K.value.labels?.length?(a(),s("div",Ke,[t("div",$e,[t("table",je,[t("thead",null,[t("tr",Te,[e[20]||(e[20]=t("th",{class:"px-3 py-2 text-left text-gray-500 dark:text-gray-400 font-medium"},"Hafta",-1)),(a(!0),s(x,null,p(K.value.labels,r=>(a(),s("th",{key:r,class:"px-3 py-2 text-center text-gray-500 dark:text-gray-400 font-medium"},o(r),1))),128))])]),t("tbody",null,[(a(!0),s(x,null,p(K.value.datasets,r=>(a(),s("tr",{key:r.label,class:"border-b border-gray-100 dark:border-gray-700/50"},[t("td",De,[t("span",{class:"inline-block w-2 h-2 rounded-full mr-2",style:T({backgroundColor:r.borderColor})},null,4),D(" "+o(r.label),1)]),(a(!0),s(x,null,p(r.data,(l,Z)=>(a(),s("td",{key:Z,class:"px-3 py-2 text-center text-gray-900 dark:text-white"},o(l),1))),128))]))),128))])])])])):(a(),s("div",Me,[...e[19]||(e[19]=[t("p",{class:"text-gray-500 dark:text-gray-400"},"Ma'lumotlar mavjud emas",-1)])]))])])],64)):f.value?g("",!0):(a(),s("div",Se,[v(c(yt),{class:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto"}),e[22]||(e[22]=t("h3",{class:"mt-4 text-lg font-medium text-gray-900 dark:text-white"},"Ma'lumotlar yuklanmadi",-1)),e[23]||(e[23]=t("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Sahifani qayta yuklang yoki keyinroq urinib ko'ring.",-1))]))])]),_:1}))}};export{lr as default};
