import{a as L,r as m,b as S,C as s,z as e,y as k,x as h,A as w,H as g,D as y,J as c,K as v,G as C,I as M,B as n,E as B,F as o}from"./chunk-KPSVwAyv.js";import{l as _,a as T,r as U}from"./chunk-BVrjkT6E.js";const D={class:"max-w-4xl mx-auto space-y-6"},F={class:"flex items-center"},N={class:"text-gray-500 dark:text-gray-400"},R={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},X={class:"p-6 space-y-6"},$={class:"grid grid-cols-4 gap-3"},O=["onClick"],Y=["d"],E={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},I={key:0},K={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},Q={class:"p-6 space-y-6"},G={class:"flex items-center justify-between p-4 bg-purple-50 dark:bg-purple-900/20 rounded-xl"},J={class:"text-2xl font-bold text-purple-700 dark:text-purple-300"},P={key:0},W={class:"flex flex-wrap gap-2"},Z=["onClick"],ee={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},te={class:"p-6"},re={class:"flex items-center gap-4"},ae={class:"flex items-center justify-center gap-3"},le={class:"flex items-center justify-center gap-3"},se={key:0,class:"mt-4"},oe={class:"flex items-center justify-end gap-4"},ne=["disabled"],de=["disabled"],ie={key:0,class:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24"},be={__name:"TelegramBroadcastCreate",props:{bot:Object,availableTags:{type:Array,default:()=>[]},totalUsers:{type:Number,default:0},panelType:{type:String,required:!0,validator:d=>["business","marketing"].includes(d)}},setup(d){const x=d,b=(i,t=null)=>{const r=x.panelType==="business"?"business.":"marketing.";return Array.isArray(t)||t?route(r+i,t):route(r+i)},V=[{value:"text",label:"Matn",icon:"M4 6h16M4 12h16M4 18h7"},{value:"photo",label:"Rasm",icon:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},{value:"video",label:"Video",icon:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},{value:"document",label:"Fayl",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"}],a=L({name:"",content:{type:"text",text:"",file_id:""},scheduled_at:null}),u=m([]),l=m(!1),p=m(!1),z=S(()=>!(!a.name||a.content.type==="text"&&!a.content.text||a.content.type!=="text"&&!a.content.file_id)),j=i=>{const t=u.value.indexOf(i);t>-1?u.value.splice(t,1):u.value.push(i)},f=async(i=!1)=>{p.value=!0;try{const r=(await T.post(b("telegram-funnels.broadcasts.store",x.bot.id),{name:a.name,content:a.content,target_filter:u.value.length>0?{tags:u.value}:null,scheduled_at:l.value?a.scheduled_at:null})).data;r.success?(i&&!l.value&&await T.post(b("telegram-funnels.broadcasts.start",[x.bot.id,r.broadcast.id])),U.visit(b("telegram-funnels.broadcasts.index",x.bot.id))):alert(r.message||"Xatolik yuz berdi")}catch{alert("Server bilan bog'lanishda xatolik")}finally{p.value=!1}},q=()=>f(!1),H=()=>f(!0);return(i,t)=>(o(),s("div",D,[e("div",F,[k(w(_),{href:b("telegram-funnels.broadcasts.index",d.bot.id),class:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mr-4 transition-colors"},{default:h(()=>[...t[6]||(t[6]=[e("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),_:1},8,["href"]),e("div",null,[t[7]||(t[7]=e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Yangi Broadcast",-1)),e("p",N,"@"+g(d.bot.username)+" - Ommaviy xabar yuborish",1)])]),e("div",R,[t[13]||(t[13]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Broadcast ma'lumotlari")],-1)),e("div",X,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Broadcast nomi *",-1)),c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>a.name=r),type:"text",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white",placeholder:"Masalan: Yangi yil tabrigi"},null,512),[[v,a.name]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Xabar turi",-1)),e("div",$,[(o(),s(C,null,M(V,r=>e("button",{key:r.value,onClick:A=>a.content.type=r.value,class:n(["p-4 rounded-xl border-2 transition-all duration-200 flex flex-col items-center gap-2",a.content.type===r.value?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[(o(),s("svg",{class:n(["w-6 h-6",a.content.type===r.value?"text-purple-600":"text-gray-400"]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:r.icon},null,8,Y)],2)),e("span",{class:n(a.content.type===r.value?"text-purple-600 font-medium":"text-gray-600 dark:text-gray-400")},g(r.label),3)],10,O)),64))])]),e("div",null,[e("label",E,g(a.content.type==="text"?"Xabar matni *":"Caption (ixtiyoriy)"),1),c(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=r=>a.content.text=r),rows:"4",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white",placeholder:"Xabar matnini yozing..."},null,512),[[v,a.content.text]]),t[10]||(t[10]=e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},"HTML formatini qo'llab-quvvatlaydi: <b>, <i>, <a>, <code>",-1))]),a.content.type!=="text"?(o(),s("div",I,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"File ID *",-1)),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>a.content.file_id=r),type:"text",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white",placeholder:"Telegram file_id ni kiriting"},null,512),[[v,a.content.file_id]]),t[12]||(t[12]=e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},"Fayl Telegram serveriga yuklangan bo'lishi kerak",-1))])):y("",!0)])]),e("div",K,[t[17]||(t[17]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Qabul qiluvchilar")],-1)),e("div",Q,[e("div",G,[e("div",null,[t[14]||(t[14]=e("p",{class:"text-sm text-purple-600 dark:text-purple-400"},"Taxminiy qabul qiluvchilar",-1)),e("p",J,g(d.totalUsers),1)]),t[15]||(t[15]=e("div",{class:"w-12 h-12 bg-purple-100 dark:bg-purple-800/30 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1))]),d.availableTags.length>0?(o(),s("div",P,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Teglar bo'yicha filter (ixtiyoriy)",-1)),e("div",W,[(o(!0),s(C,null,M(d.availableTags,r=>(o(),s("button",{key:r,onClick:A=>j(r),class:n(["px-3 py-1.5 rounded-full text-sm font-medium transition-colors",u.value.includes(r)?"bg-purple-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},g(r),11,Z))),128))])])):y("",!0)])]),e("div",ee,[t[20]||(t[20]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Rejalashtirish")],-1)),e("div",te,[e("div",re,[e("button",{onClick:t[3]||(t[3]=r=>l.value=!1),class:n(["flex-1 p-4 rounded-xl border-2 transition-all duration-200",l.value?"border-gray-200 dark:border-gray-700":"border-purple-500 bg-purple-50 dark:bg-purple-900/20"])},[e("div",ae,[(o(),s("svg",{class:n(["w-6 h-6",l.value?"text-gray-400":"text-purple-600"]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...t[18]||(t[18]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)])],2)),e("span",{class:n(l.value?"text-gray-600 dark:text-gray-400":"text-purple-600 font-medium")},"Hoziroq yuborish",2)])],2),e("button",{onClick:t[4]||(t[4]=r=>l.value=!0),class:n(["flex-1 p-4 rounded-xl border-2 transition-all duration-200",l.value?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700"])},[e("div",le,[(o(),s("svg",{class:n(["w-6 h-6",l.value?"text-purple-600":"text-gray-400"]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...t[19]||(t[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),e("span",{class:n(l.value?"text-purple-600 font-medium":"text-gray-600 dark:text-gray-400")},"Keyinroq yuborish",2)])],2)]),l.value?(o(),s("div",se,[c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>a.scheduled_at=r),type:"datetime-local",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white"},null,512),[[v,a.scheduled_at]])])):y("",!0)])]),e("div",oe,[k(w(_),{href:b("telegram-funnels.broadcasts.index",d.bot.id),class:"px-6 py-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},{default:h(()=>[...t[21]||(t[21]=[B(" Bekor qilish ",-1)])]),_:1},8,["href"]),e("button",{onClick:q,disabled:p.value,class:"px-6 py-3 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white font-medium rounded-xl transition-colors"}," Qoralama saqlash ",8,ne),e("button",{onClick:H,disabled:p.value||!z.value,class:"px-6 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white font-medium rounded-xl transition-colors flex items-center gap-2"},[p.value?(o(),s("svg",ie,[...t[22]||(t[22]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):y("",!0),B(" "+g(l.value?"Rejalashtirilgan yaratish":"Yaratish va Boshlash"),1)],8,de)])]))}};export{be as _};
