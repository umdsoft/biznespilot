import{r as v,b as g,o as H,v as I,x as N,z as t,H as r,A as i,I as E,K as R,D as c,C as B,E as l,B as k,F as _,G as x,L as S}from"./chunk-BcTZxe-J.js";import{_ as K}from"./chunk-CzQQNjFL.js";import{a as O}from"./chunk-BYRtWSr0.js";import{u as T}from"./app-DWC75jbx.js";import"./chunk-CYarSvys.js";import"./chunk-BVYwhYNk.js";import"./chunk-BqueMrU7.js";import"./chunk-_yYzsx_i.js";import"./chunk-Rs1WNzbn.js";import"./chunk-CJsSO8V8.js";import"./chunk-CrR1zWIb.js";import"./chunk-CQoMtUf7.js";import"./chunk-qVc0_oyq.js";import"./chunk-LBbTbQSS.js";import"./chunk-I93QdGKi.js";import"./chunk-DNp5bQOL.js";import"./chunk-CG0drqHE.js";import"./chunk-CklLzvQL.js";import"./chunk-CnrLL2pV.js";import"./chunk-D58UsNjm.js";import"./chunk-Ba8J67bG.js";import"./chunk-BHX0ueEB.js";import"./chunk-C1xeNfMu.js";const U={class:"py-6"},Z={class:"max-w-[1600px] mx-auto px-4 sm:px-6 lg:px-8"},q={class:"mb-6 flex items-center justify-between"},J={class:"text-xl font-semibold text-gray-900 dark:text-white"},Q={class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},W={class:"flex items-center gap-3"},X={value:"7"},Y={value:"30"},tt={value:"90"},et={value:"365"},st=["disabled"],rt={class:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},at={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},ot={class:"flex items-center gap-3"},it={class:"text-2xl font-semibold text-gray-900 dark:text-white"},nt={class:"text-xs text-gray-500 dark:text-gray-400"},lt={class:"text-xs text-green-600 dark:text-green-400 flex items-center mt-0.5"},dt={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},ct={class:"flex items-center gap-3"},ut={class:"text-2xl font-semibold text-gray-900 dark:text-white"},gt={class:"text-xs text-gray-500 dark:text-gray-400"},_t={class:"text-xs text-gray-400 dark:text-gray-500 mt-0.5"},xt={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},yt={class:"flex items-center gap-3"},ht={class:"text-2xl font-semibold text-gray-900 dark:text-white"},pt={class:"text-xs text-gray-500 dark:text-gray-400"},mt={class:"text-xs text-gray-400 dark:text-gray-500 mt-0.5"},bt={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},vt={class:"flex items-center gap-3"},kt={class:"text-xs text-gray-500 dark:text-gray-400"},ft={class:"text-xs text-gray-400 dark:text-gray-500 mt-0.5"},wt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6"},At={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},Bt={class:"flex items-center justify-between mb-4"},jt={class:"text-sm font-medium text-gray-900 dark:text-white"},Ct={class:"h-48"},Mt={class:"w-full h-full",viewBox:"0 0 400 150",preserveAspectRatio:"none"},Lt=["y1","y2"],Pt=["d"],Ft=["d"],Vt=["cx","cy"],$t={class:"flex justify-between mt-2 text-xs text-gray-500 dark:text-gray-400"},zt={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4"},Gt={class:"flex items-center justify-between mb-4"},Dt={class:"text-sm font-medium text-gray-900 dark:text-white"},Ht={class:"h-48"},It={class:"w-full h-full",viewBox:"0 0 400 150",preserveAspectRatio:"none"},Nt=["y1","y2"],Et=["d"],Rt=["d"],St=["cx","cy"],Kt={class:"flex justify-between mt-2 text-xs text-gray-500 dark:text-gray-400"},Ot={class:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden"},Tt={class:"px-4 py-3 border-b border-gray-200 dark:border-gray-700"},Ut={class:"text-sm font-medium text-gray-900 dark:text-white"},Zt={class:"p-4"},qt={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},Jt={class:"flex items-center justify-between mb-2"},Qt={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},Wt={class:"text-2xl font-semibold text-gray-900 dark:text-white"},Xt={class:"text-xs text-gray-500 dark:text-gray-400"},Yt={key:0,class:"col-span-4 py-8 text-center text-sm text-gray-500 dark:text-gray-400"},we={__name:"Index",props:{initialAnalytics:{type:Object,default:()=>({})}},setup(j){const{t:o}=T(),u=j,y=v(!1),h=v("30"),d=v({active_subscriptions:u.initialAnalytics.active_subscriptions||0,subscription_growth:u.initialAnalytics.subscription_growth||0,avg_campaigns:u.initialAnalytics.average_campaigns_per_business?.toFixed(1)||"0.0",avg_conversations:u.initialAnalytics.average_conversations_per_business?.toFixed(1)||"0.0",churn_rate:u.initialAnalytics.churn_rate||0,user_growth:u.initialAnalytics.user_growth||[],business_growth:u.initialAnalytics.business_growth||[],top_industries:u.initialAnalytics.top_industries||[]}),C=g(()=>d.value.user_growth?d.value.user_growth.map(e=>e.count):[]),M=g(()=>d.value.business_growth?d.value.business_growth.map(e=>e.count):[]),f=(e,a=400,s=150,n=10)=>{if(!e||e.length===0)return[];const $=Math.max(...e,1),z=(a-n*2)/(e.length-1||1);return e.map((G,D)=>({x:n+D*z,y:s-n-G/$*(s-n*2)}))},p=g(()=>f(C.value)),m=g(()=>f(M.value)),b=e=>!e||e.length===0?"":e.map((a,s)=>`${s===0?"M":"L"} ${a.x} ${a.y}`).join(" "),w=(e,a=150)=>!e||e.length===0?"":`${b(e)} L ${e[e.length-1].x} ${a} L ${e[0].x} ${a} Z`,L=g(()=>b(p.value)),P=g(()=>w(p.value)),F=g(()=>b(m.value)),V=g(()=>w(m.value)),A=async()=>{y.value=!0;try{const e=await O.get("/admin/analytics",{params:{period:h.value}});d.value={active_subscriptions:e.data.analytics.active_subscriptions||0,subscription_growth:e.data.analytics.subscription_growth||0,avg_campaigns:e.data.analytics.average_campaigns_per_business?.toFixed(1)||"0.0",avg_conversations:e.data.analytics.average_conversations_per_business?.toFixed(1)||"0.0",churn_rate:e.data.analytics.churn_rate||0,user_growth:e.data.analytics.user_growth||[],business_growth:e.data.analytics.business_growth||[],top_industries:e.data.analytics.top_industries||[]}}catch(e){console.error("Analytics refresh failed:",e)}finally{y.value=!1}};return H(()=>{u.initialAnalytics.active_subscriptions||A()}),(e,a)=>(l(),I(K,{title:i(o)("admin.analytics.title")},{default:N(()=>[t("div",U,[t("div",Z,[t("div",q,[t("div",null,[t("h1",J,r(i(o)("admin.analytics.title")),1),t("p",Q,r(i(o)("admin.analytics.subtitle")),1)]),t("div",W,[E(t("select",{"onUpdate:modelValue":a[0]||(a[0]=s=>h.value=s),class:"px-3 py-2 text-sm border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[t("option",X,r(i(o)("admin.analytics.last_7_days")),1),t("option",Y,r(i(o)("admin.analytics.last_30_days")),1),t("option",tt,r(i(o)("admin.analytics.last_90_days")),1),t("option",et,r(i(o)("admin.analytics.last_year")),1)],512),[[R,h.value]]),t("button",{onClick:A,disabled:y.value,class:"inline-flex items-center gap-2 px-3 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-lg transition-colors disabled:opacity-50"},[(l(),c("svg",{class:k(["w-4 h-4",y.value?"animate-spin":""]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...a[1]||(a[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),B(" "+r(i(o)("admin.analytics.refresh")),1)],8,st)])]),t("div",rt,[t("div",at,[t("div",ot,[a[3]||(a[3]=t("div",{class:"w-10 h-10 bg-green-50 dark:bg-green-900/30 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",null,[t("p",it,r(d.value.active_subscriptions),1),t("p",nt,r(i(o)("admin.analytics.active_subscriptions")),1),t("p",lt,[a[2]||(a[2]=t("svg",{class:"w-3 h-3 mr-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),B(" +"+r(d.value.subscription_growth)+"% ",1)])])])]),t("div",dt,[t("div",ct,[a[4]||(a[4]=t("div",{class:"w-10 h-10 bg-blue-50 dark:bg-blue-900/30 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})])],-1)),t("div",null,[t("p",ut,r(d.value.avg_campaigns),1),t("p",gt,r(i(o)("admin.analytics.avg_campaigns")),1),t("p",_t,r(i(o)("admin.analytics.per_business")),1)])])]),t("div",xt,[t("div",yt,[a[5]||(a[5]=t("div",{class:"w-10 h-10 bg-purple-50 dark:bg-purple-900/30 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-purple-600 dark:text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1)),t("div",null,[t("p",ht,r(d.value.avg_conversations),1),t("p",pt,r(i(o)("admin.analytics.avg_conversations")),1),t("p",mt,r(i(o)("admin.analytics.per_business")),1)])])]),t("div",bt,[t("div",vt,[a[6]||(a[6]=t("div",{class:"w-10 h-10 bg-orange-50 dark:bg-orange-900/30 rounded-lg flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-orange-600 dark:text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})])],-1)),t("div",null,[t("p",{class:k(["text-2xl font-semibold",d.value.churn_rate>5?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"])},r(d.value.churn_rate)+"% ",3),t("p",kt,r(i(o)("admin.analytics.churn_rate")),1),t("p",ft,r(i(o)("admin.analytics.this_month")),1)])])])]),t("div",wt,[t("div",At,[t("div",Bt,[t("h3",jt,r(i(o)("admin.dashboard.users_growth")),1)]),t("div",Ct,[(l(),c("svg",Mt,[(l(),c(_,null,x(5,s=>t("line",{key:s,x1:"0",y1:(s-1)*37.5,x2:"400",y2:(s-1)*37.5,stroke:"currentColor",class:"text-gray-100 dark:text-gray-700","stroke-width":"1"},null,8,Lt)),64)),t("path",{d:P.value,fill:"url(#usersGradientAnalytics)",opacity:"0.3"},null,8,Pt),t("path",{d:L.value,fill:"none",stroke:"#3B82F6","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,8,Ft),(l(!0),c(_,null,x(p.value,(s,n)=>(l(),c("circle",{key:n,cx:s.x,cy:s.y,r:"4",fill:"#3B82F6"},null,8,Vt))),128)),a[7]||(a[7]=t("defs",null,[t("linearGradient",{id:"usersGradientAnalytics",x1:"0",y1:"0",x2:"0",y2:"1"},[t("stop",{offset:"0%","stop-color":"#3B82F6"}),t("stop",{offset:"100%","stop-color":"#3B82F6","stop-opacity":"0"})])],-1))]))]),t("div",$t,[(l(!0),c(_,null,x(d.value.user_growth,(s,n)=>(l(),c("span",{key:n},r(s.month),1))),128))])]),t("div",zt,[t("div",Gt,[t("h3",Dt,r(i(o)("admin.dashboard.businesses_growth")),1)]),t("div",Ht,[(l(),c("svg",It,[(l(),c(_,null,x(5,s=>t("line",{key:s,x1:"0",y1:(s-1)*37.5,x2:"400",y2:(s-1)*37.5,stroke:"currentColor",class:"text-gray-100 dark:text-gray-700","stroke-width":"1"},null,8,Nt)),64)),t("path",{d:V.value,fill:"url(#businessesGradientAnalytics)",opacity:"0.3"},null,8,Et),t("path",{d:F.value,fill:"none",stroke:"#10B981","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,8,Rt),(l(!0),c(_,null,x(m.value,(s,n)=>(l(),c("circle",{key:n,cx:s.x,cy:s.y,r:"4",fill:"#10B981"},null,8,St))),128)),a[8]||(a[8]=t("defs",null,[t("linearGradient",{id:"businessesGradientAnalytics",x1:"0",y1:"0",x2:"0",y2:"1"},[t("stop",{offset:"0%","stop-color":"#10B981"}),t("stop",{offset:"100%","stop-color":"#10B981","stop-opacity":"0"})])],-1))]))]),t("div",Kt,[(l(!0),c(_,null,x(d.value.business_growth,(s,n)=>(l(),c("span",{key:n},r(s.month),1))),128))])])]),t("div",Ot,[t("div",Tt,[t("h3",Ut,r(i(o)("admin.analytics.top_industries")),1)]),t("div",Zt,[t("div",qt,[(l(!0),c(_,null,x(d.value.top_industries,(s,n)=>(l(),c("div",{key:s.name,class:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4"},[t("div",Jt,[t("span",Qt,r(s.name),1),t("span",{class:k(["px-2 py-0.5 text-xs font-medium rounded",{"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":n===0,"bg-gray-100 text-gray-600 dark:bg-gray-600 dark:text-gray-300":n===1,"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":n===2,"bg-gray-50 text-gray-500 dark:bg-gray-700 dark:text-gray-400":n>2}])}," #"+r(n+1),3)]),t("p",Wt,r(s.count),1),t("p",Xt,r(i(o)("admin.analytics.businesses")),1)]))),128)),!d.value.top_industries||d.value.top_industries.length===0?(l(),c("div",Yt,r(i(o)("admin.common.no_data")),1)):S("",!0)])])])])])]),_:1},8,["title"]))}};export{we as default};
