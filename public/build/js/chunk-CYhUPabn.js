import{r as C}from"./chunk-BVrjkT6E.js";import{r as q}from"./chunk-Cw_2vanC.js";import{r as P}from"./chunk-CYw1XsNK.js";import{r as R}from"./chunk-B-s2QV2q.js";import{r as L}from"./chunk-DG11HGh3.js";import{r as N}from"./chunk-CYZ54WJE.js";import{r as F}from"./chunk-DOJo2mnZ.js";import{r as H}from"./chunk-Cdln-ckn.js";import{r as j,a as E}from"./chunk-Dfha1x8d.js";import{a as J}from"./chunk-Qa9RIO0M.js";import{r as D,C as o,F as a,D as b,z as e,A as i,B as g,v as f,M as p,H as c,y as x,E as M,b as Q,G as _,I as S}from"./chunk-KPSVwAyv.js";import{a as B}from"./chunk-DN454CZt.js";const U={key:0,class:"absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-amber-400 to-orange-500"},Z={class:"p-5 pl-6"},G={class:"flex items-start gap-4"},I={class:"flex-1 min-w-0 space-y-3"},K={class:"flex items-start justify-between gap-4"},O={class:"flex-1 min-w-0"},Y={class:"flex items-center gap-2 mb-1"},W={class:"text-lg font-semibold text-gray-900 dark:text-white truncate"},X={class:"text-sm text-gray-500 dark:text-gray-400 font-mono"},ee={key:0,class:"flex items-start gap-3 p-3 rounded-lg bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800"},te={class:"flex-1 min-w-0"},ae={class:"text-xs text-amber-700 dark:text-amber-300"},re={class:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400"},le={class:"flex items-center gap-1.5"},se={key:0,class:"flex items-center gap-1.5"},oe={class:"text-gray-500 dark:text-gray-400"},ne={key:1,class:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700"},ie={class:"text-xs font-mono text-gray-500 dark:text-gray-400 tabular-nums"},de={class:"flex flex-col items-end gap-2 flex-shrink-0"},ce={key:0,class:"flex flex-col items-end gap-2"},ge={class:"flex items-center gap-2"},ue={class:"text-2xl font-bold text-gray-900 dark:text-white"},me=["disabled"],be={key:0},ye={key:1},xe=["href"],he={__name:"CallListRow",props:{call:{type:Object,required:!0},isAnalyzing:{type:Boolean,default:!1}},emits:["analyze","viewReport"],setup(t,{emit:m}){const d=t,k=m,h=D(!1),w=()=>d.call.type==="incoming"?F:H,$=()=>d.call.type==="incoming"?"text-emerald-600 bg-emerald-50 dark:text-emerald-400 dark:bg-emerald-900/20":"text-blue-600 bg-blue-50 dark:text-blue-400 dark:bg-blue-900/20",y=()=>["completed","answered"].includes(d.call.status)?{icon:j,text:"Javob berildi",class:"text-emerald-600 bg-emerald-50 dark:text-emerald-400 dark:bg-emerald-900/20"}:{icon:J,text:"Javob yo'q",class:"text-red-600 bg-red-50 dark:text-red-400 dark:bg-red-900/20"},n=()=>{const u=d.call.ai_score;return u?u>=80?{class:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300",label:"A"}:u>=50?{class:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300",label:"B"}:{class:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300",label:"C"}:null},s=u=>{const l=Math.floor(u/60),z=u%60;return`${l}:${z.toString().padStart(2,"0")}`},r=u=>{const l=new Date(u);return l.toLocaleDateString("uz-UZ",{day:"numeric",month:"short"})+", "+l.toLocaleTimeString("uz-UZ",{hour:"2-digit",minute:"2-digit"})},T=()=>{h.value=!h.value},v=d.call.recommended_reason,A=d.call.ai_score!==null&&d.call.ai_score!==void 0,V=d.call.duration<30;return(u,l)=>(a(),o("div",{class:g(["group relative overflow-hidden rounded-xl border transition-all duration-200",i(v)?"bg-gradient-to-r from-amber-50/50 via-white to-white dark:from-amber-900/10 dark:via-gray-800 dark:to-gray-800 border-amber-200 dark:border-amber-800 shadow-sm hover:shadow-md":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md hover:border-gray-300 dark:hover:border-gray-600"])},[i(v)?(a(),o("div",U)):b("",!0),e("div",Z,[e("div",G,[e("div",{class:g([$(),"w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ring-1 ring-gray-900/5"])},[(a(),f(p(w()),{class:"w-6 h-6"}))],2),e("div",I,[e("div",K,[e("div",O,[e("div",Y,[e("h3",W,c(t.call.lead?.name||t.call.phone),1),(a(),f(p(y().icon),{class:g([y().class,"w-4 h-4 flex-shrink-0"])},null,8,["class"]))]),e("p",X,c(t.call.phone),1)]),e("span",{class:g([y().class,"px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap"])},c(y().text),3)]),i(v)&&!i(A)?(a(),o("div",ee,[x(i(q),{class:"w-5 h-5 text-amber-600 dark:text-amber-400 flex-shrink-0 mt-0.5"}),e("div",te,[l[2]||(l[2]=e("p",{class:"text-sm font-medium text-amber-900 dark:text-amber-100 mb-0.5"}," AI Tavsiyasi ",-1)),e("p",ae,c(t.call.recommended_reason),1)])])):b("",!0),e("div",re,[e("div",le,[x(i(P),{class:"w-4 h-4"}),e("span",{class:g(V?"text-red-600 dark:text-red-400 font-semibold":"")},c(t.call.formatted_duration||s(t.call.duration)),3)]),l[4]||(l[4]=e("span",{class:"w-1 h-1 rounded-full bg-gray-300 dark:bg-gray-600"},null,-1)),e("span",null,c(r(t.call.created_at)),1),t.call.operator?(a(),o("span",se,[l[3]||(l[3]=e("span",{class:"w-1 h-1 rounded-full bg-gray-300 dark:bg-gray-600"},null,-1)),e("span",oe,c(t.call.operator.name),1)])):b("",!0)]),t.call.recording_url?(a(),o("div",ne,[e("button",{onClick:T,class:"w-8 h-8 rounded-full bg-gray-900 dark:bg-white text-white dark:text-gray-900 flex items-center justify-center hover:scale-105 transition-transform"},[(a(),f(p(h.value?i(R):i(L)),{class:"w-4 h-4"}))]),l[5]||(l[5]=e("div",{class:"flex-1 h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},[e("div",{class:"h-full bg-gradient-to-r from-indigo-500 to-purple-500",style:{width:"0%"}})],-1)),e("span",ie,c(t.call.formatted_duration||s(t.call.duration)),1)])):b("",!0)]),e("div",de,[i(A)?(a(),o("div",ce,[e("div",ge,[e("span",ue,c(t.call.ai_score),1),e("span",{class:g([n().class,"w-10 h-10 rounded-lg flex items-center justify-center text-sm font-bold"])},c(n().label),3)]),e("button",{onClick:l[0]||(l[0]=z=>k("viewReport",t.call.id)),class:"px-4 py-2 rounded-lg bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 font-medium text-sm transition-colors flex items-center gap-2"},[x(i(N),{class:"w-4 h-4"}),l[6]||(l[6]=M(" Hisobot ",-1))])])):i(v)?(a(),o("button",{key:1,onClick:l[1]||(l[1]=z=>k("analyze",t.call.id)),disabled:t.isAnalyzing,class:g(["px-6 py-3 rounded-xl font-semibold text-sm transition-all flex items-center gap-2 shadow-lg hover:shadow-xl",t.isAnalyzing?"bg-gray-300 dark:bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white transform hover:scale-105"])},[x(i(q),{class:"w-5 h-5"}),t.isAnalyzing?(a(),o("span",be,"Tahlil qilinmoqda...")):(a(),o("span",ye,"✨ Tahlil Qilish"))],10,me)):t.call.recording_url?(a(),o("a",{key:2,href:t.call.recording_url,download:"",class:"px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 font-medium text-sm transition-colors"}," Yuklab olish ",8,xe)):b("",!0)])])]),l[7]||(l[7]=e("div",{class:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"},[e("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent"})],-1))],2))}},fe={class:"space-y-6"},ke={class:"border-b border-gray-200 dark:border-gray-700"},ve={class:"flex gap-1","aria-label":"Tabs"},pe=["onClick"],we={class:"flex items-center gap-2.5"},$e={key:0,class:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50 dark:from-emerald-900/20 dark:via-teal-900/20 dark:to-cyan-900/20 border-2 border-emerald-200 dark:border-emerald-800 p-12"},ze={class:"relative text-center space-y-4"},Ce={class:"flex justify-center"},Te={class:"relative"},Ae={class:"w-24 h-24 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center shadow-lg"},qe={key:1,class:"text-center py-16"},_e={key:2,class:"space-y-3"},Se={key:3,class:"text-center pt-6"},Me={__name:"CallList",props:{calls:{type:Array,default:()=>[]},activeTab:{type:String,default:"all"},auditCount:{type:Number,default:0},canViewAudit:{type:Boolean,default:!1},routePrefix:{type:String,default:"/business/calls"}},setup(t){const m=t,d=D(new Set),k=Q(()=>{const n=[{key:"all",label:"Barchasi",icon:B,count:m.calls.length}];return m.canViewAudit&&n.push({key:"audit",label:"Diqqat Talab",icon:E,count:m.auditCount,highlight:!0}),n}),h=n=>{C.get(m.routePrefix,{tab:n},{preserveState:!0,preserveScroll:!0})},w=async n=>{if(!d.value.has(n)){d.value.add(n);try{await new Promise(s=>setTimeout(s,2e3)),console.log("Analyzing call:",n),C.reload({preserveScroll:!0})}catch(s){console.error("Failed to analyze call:",s)}finally{d.value.delete(n)}}},$=n=>{C.get(`${m.routePrefix}/${n}`)},y=n=>d.value.has(n);return(n,s)=>(a(),o("div",fe,[e("div",ke,[e("nav",ve,[(a(!0),o(_,null,S(k.value,r=>(a(),o("button",{key:r.key,onClick:T=>h(r.key),class:g(["group relative px-6 py-4 font-semibold text-sm transition-all duration-200",t.activeTab===r.key?r.highlight?"text-orange-600 dark:text-orange-400":"text-indigo-600 dark:text-indigo-400":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"])},[e("span",we,[(a(),f(p(r.icon),{class:g(["w-5 h-5 transition-all duration-200",t.activeTab===r.key&&r.highlight&&"animate-pulse"])},null,8,["class"])),e("span",null,c(r.label),1),r.count>0?(a(),o("span",{key:0,class:g(["px-2.5 py-0.5 rounded-full text-xs font-bold transition-all duration-200",t.activeTab===r.key?r.highlight?"bg-orange-500 text-white":"bg-indigo-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"])},c(r.count>99?"99+":r.count),3)):b("",!0)]),e("span",{class:g(["absolute bottom-0 left-0 right-0 h-0.5 transition-all duration-200",t.activeTab===r.key?r.highlight?"bg-gradient-to-r from-orange-500 to-red-500":"bg-gradient-to-r from-indigo-500 to-purple-500":"bg-transparent"])},null,2)],10,pe))),128))])]),t.activeTab==="audit"&&t.calls.length===0?(a(),o("div",$e,[s[2]||(s[2]=e("div",{class:"absolute inset-0 opacity-10"},[e("div",{class:"absolute top-0 left-0 w-72 h-72 bg-emerald-400 rounded-full blur-3xl"}),e("div",{class:"absolute bottom-0 right-0 w-96 h-96 bg-teal-400 rounded-full blur-3xl"})],-1)),e("div",ze,[e("div",Ce,[e("div",Te,[e("div",Ae,[x(i(j),{class:"w-14 h-14 text-white"})]),s[0]||(s[0]=e("div",{class:"absolute -top-1 -right-1 w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center shadow-lg animate-bounce"},[e("span",{class:"text-xl"},"✨")],-1))])]),s[1]||(s[1]=e("div",null,[e("h3",{class:"text-3xl font-bold text-emerald-900 dark:text-emerald-100 mb-2"}," Ajoyib Ish! "),e("p",{class:"text-lg text-emerald-700 dark:text-emerald-300"}," Hozircha diqqat talab qiladigan qo'ng'iroqlar yo'q ")],-1))])])):t.activeTab==="all"&&t.calls.length===0?(a(),o("div",qe,[x(i(B),{class:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-600 mb-4"}),s[3]||(s[3]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," Qo'ng'iroqlar topilmadi ",-1)),s[4]||(s[4]=e("p",{class:"text-gray-500 dark:text-gray-400"}," Tanlangan davr uchun qo'ng'iroqlar mavjud emas ",-1))])):(a(),o("div",_e,[(a(!0),o(_,null,S(t.calls,r=>(a(),f(he,{key:r.id,call:r,"is-analyzing":y(r.id),onAnalyze:w,onViewReport:$},null,8,["call","is-analyzing"]))),128))])),t.calls.length>=100?(a(),o("div",Se,[...s[5]||(s[5]=[e("button",{class:"px-6 py-3 rounded-xl bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-indigo-500 dark:hover:border-indigo-400 hover:text-indigo-600 dark:hover:text-indigo-400 font-semibold transition-all"}," Ko'proq yuklash ",-1)])])):b("",!0)]))}};export{Me as _};
