import{D as d,z as e,E as l,r as q,b as E,v as $,x as m,y as n,A as a,C as S,B as v,F as b,G as x,H as s,S as C,M as N,L as R,Q as G,I as u,J as k,K as w}from"./chunk-BcTZxe-J.js";import{u as K,h as J,r as _}from"./chunk-BYRtWSr0.js";import{_ as P}from"./chunk-BVg2xI-u.js";import{b as Z,A as W,e as X}from"./chunk-CYarSvys.js";import{r as ee}from"./chunk-gCWBLgcy.js";import{r as M}from"./chunk-DNp5bQOL.js";import{a as B,r as te}from"./chunk-Rs1WNzbn.js";import{r as re}from"./chunk-I93QdGKi.js";import{r as ae}from"./chunk-C6v56q2n.js";import{r as oe}from"./chunk-BqueMrU7.js";import{S as se,Y as ie,h as L,G as le,V as de}from"./chunk-0qdfTxF1.js";import"./chunk-Dy6aDPCS.js";import"./chunk-CKHdppiT.js";import"./chunk-Sr2jsNPC.js";import"./chunk-Bv_bj7dx.js";import"./chunk-CJsSO8V8.js";import"./app-DWC75jbx.js";import"./chunk-C1xeNfMu.js";import"./chunk-BVYwhYNk.js";import"./chunk-_yYzsx_i.js";import"./chunk-CrR1zWIb.js";import"./chunk-CQoMtUf7.js";import"./chunk-qVc0_oyq.js";import"./chunk-LBbTbQSS.js";import"./chunk-CG0drqHE.js";import"./chunk-CklLzvQL.js";import"./chunk-CnrLL2pV.js";import"./chunk-D58UsNjm.js";import"./chunk-Ba8J67bG.js";import"./chunk-BHX0ueEB.js";function ne(g,j){return l(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 15a4.5 4.5 0 0 0 4.5 4.5H18a3.75 3.75 0 0 0 1.332-7.257 3 3 0 0 0-3.758-3.848 5.25 5.25 0 0 0-10.233 2.33A4.502 4.502 0 0 0 2.25 15Z"})])}const ge={class:"py-6"},ce={class:"w-full px-4 sm:px-6 lg:px-8 space-y-6"},ue={class:"flex items-center justify-between"},ye={class:"flex items-center space-x-3"},me=["disabled"],be={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},xe={class:"flex items-center justify-between"},pe={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},ve={class:"text-xs text-gray-400 mt-1"},fe={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},he={class:"lg:col-span-2 space-y-4"},ke={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},we={key:0,class:"p-6 text-center text-gray-500 dark:text-gray-400"},_e={key:1,class:"divide-y divide-gray-200 dark:divide-gray-700"},qe={class:"flex items-start justify-between"},Se={class:"flex-1"},Ce={class:"flex items-center space-x-3"},je={class:"font-medium text-gray-900 dark:text-white"},ze={key:0,class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Ve={class:"mt-1 text-xs text-gray-400"},$e={class:"flex items-center space-x-2 ml-4"},Me=["onClick"],Be=["onClick"],Le=["onClick"],Qe={class:"space-y-4"},Ae={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Te={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Ue={class:"flex items-center space-x-2"},Fe={key:0,class:"p-6 text-center text-gray-500 dark:text-gray-400"},De={key:1,class:"divide-y divide-gray-200 dark:divide-gray-700"},Oe={class:"flex items-center justify-between"},He={class:"font-medium text-gray-900 dark:text-white"},Ie={class:"text-sm text-gray-500 dark:text-gray-400"},Ye={class:"text-right"},Ee={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6"},Ne={class:"space-y-3"},Re={class:"flex justify-between"},Ge={class:"font-medium text-gray-900 dark:text-white"},Ke={class:"flex justify-between"},Je={class:"font-medium text-gray-900 dark:text-white"},Pe={class:"flex justify-between"},Ze={class:"font-medium text-gray-900 dark:text-white"},We={class:"fixed inset-0 overflow-y-auto"},Xe={class:"flex min-h-full items-center justify-center p-4"},et={class:"flex items-center justify-between mb-6"},tt=["value"],rt=["value"],at={class:"grid grid-cols-2 gap-4"},ot=["value"],st={class:"grid grid-cols-2 gap-4"},it={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"},lt=["disabled"],Ft={__name:"Index",props:{rules:Array,distribution:Object,hotLeads:Array,categories:Object,conditions:Object,scoringCategories:Object},setup(g){const j=g,f=q(!1),y=q(null),h=q(!1),o=K({name:"",description:"",field:"",condition:"not_null",value:"",value_type:"string",points:10,category:"completeness",priority:0}),Q=[{value:"phone",label:"Telefon raqami"},{value:"email",label:"Email manzili"},{value:"company",label:"Kompaniya nomi"},{value:"region",label:"Viloyat"},{value:"estimated_value",label:"Taxminiy qiymat"},{value:"source.code",label:"Manba kodi"},{value:"activities_count",label:"Faoliyatlar soni"},{value:"days_without_contact",label:"Aloqasiz kunlar"},{value:"lost_reason",label:"Yo'qotilgan sabab"}],A={hot:B,warm:W,cool:M,cold:ne,frozen:M},z=()=>{o.reset(),y.value=null,f.value=!0},T=i=>{y.value=i,o.name=i.name,o.description=i.description||"",o.field=i.field,o.condition=i.condition,o.value=i.value||"",o.value_type=i.value_type,o.points=i.points,o.category=i.category,o.priority=i.priority,f.value=!0},p=()=>{f.value=!1,y.value=null,o.reset()},U=()=>{y.value?o.put(route("sales-head.lead-scoring.update",y.value.id),{preserveScroll:!0,onSuccess:()=>p()}):o.post(route("sales-head.lead-scoring.store"),{preserveScroll:!0,onSuccess:()=>p()})},F=i=>{_.post(route("sales-head.lead-scoring.toggle",i.id),{},{preserveScroll:!0})},D=i=>{confirm(`"${i.name}" qoidasini o'chirishni xohlaysizmi?`)&&_.delete(route("sales-head.lead-scoring.destroy",i.id),{preserveScroll:!0})},O=()=>{confirm("Barcha leadlarni qayta baholashni xohlaysizmi? Bu biroz vaqt olishi mumkin.")&&(h.value=!0,_.post(route("sales-head.lead-scoring.recalculate-all"),{},{preserveScroll:!0,onFinish:()=>{h.value=!1}}))},H=()=>{confirm("Barcha qoidalar o'chiriladi va standart qoidalar tiklanadi. Davom etasizmi?")&&_.post(route("sales-head.lead-scoring.reset"),{},{preserveScroll:!0})},I=E(()=>j.distribution?.total||0),V=i=>{const t={hot:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",warm:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",cool:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",cold:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",frozen:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"};return t[i]||t.frozen},Y=i=>i>0?"text-green-600 dark:text-green-400":i<0?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400";return(i,t)=>(l(),$(P,{title:"Lead Scoring"},{default:m(()=>[n(a(J),{title:"Lead Scoring - Lidlar Ballari"}),e("div",ge,[e("div",ce,[e("div",ue,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Lead Scoring"),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Lidlarni avtomatik baholash va kategoriyalash ")],-1)),e("div",ye,[e("button",{onClick:O,disabled:h.value,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50"},[n(a(Z),{class:v(["w-4 h-4 mr-2",{"animate-spin":h.value}])},null,8,["class"]),t[8]||(t[8]=S(" Qayta baholash ",-1))],8,me),e("button",{onClick:z,class:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700"},[n(a(ee),{class:"w-4 h-4 mr-2"}),t[9]||(t[9]=S(" Qoida qo'shish ",-1))])])]),e("div",be,[(l(!0),d(b,null,x(g.scoringCategories,(r,c)=>(l(),d("div",{key:c,class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700"},[e("div",xe,[e("div",null,[e("p",pe,s(r.name),1),e("p",{class:"text-2xl font-bold mt-1",style:C({color:r.color})},s(g.distribution?.categories?.[c]?.count||0),5),e("p",ve,s(r.min)+"-"+s(r.max)+" ball",1)]),e("div",{class:"w-12 h-12 rounded-full flex items-center justify-center",style:C({backgroundColor:r.color+"20"})},[(l(),$(N(A[c]),{class:"w-6 h-6",style:C({color:r.color})},null,8,["style"]))],4)])]))),128))]),e("div",fe,[e("div",he,[e("div",ke,[e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},[t[11]||(t[11]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Scoring Qoidalari",-1)),e("button",{onClick:H,class:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}," Standartga tiklash ")]),g.rules.length===0?(l(),d("div",we,[n(a(re),{class:"w-12 h-12 mx-auto mb-3 text-gray-300 dark:text-gray-600"}),t[12]||(t[12]=e("p",null,"Hozircha qoidalar yo'q",-1)),e("button",{onClick:z,class:"mt-2 text-indigo-600 hover:text-indigo-700"}," Birinchi qoida qo'shing ")])):(l(),d("div",_e,[(l(!0),d(b,null,x(g.rules,r=>(l(),d("div",{key:r.id,class:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[e("div",qe,[e("div",Se,[e("div",Ce,[e("h3",je,s(r.name),1),e("span",{class:v(["px-2 py-0.5 text-xs rounded-full",V(r.category)])},s(r.category_info?.name||r.category),3),e("span",{class:v(["px-2 py-0.5 text-xs font-bold rounded",Y(r.points)])},s(r.points>0?"+":"")+s(r.points)+" ball ",3)]),r.description?(l(),d("p",ze,s(r.description),1)):R("",!0),e("p",Ve,s(r.field)+" "+s(r.condition_label)+" "+s(r.value||""),1)]),e("div",$e,[e("button",{onClick:c=>F(r),class:v(["p-1.5 rounded-lg transition-colors",r.is_active?"text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30":"text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"])},[n(a(te),{class:"w-5 h-5"})],10,Me),e("button",{onClick:c=>T(r),class:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[n(a(ae),{class:"w-5 h-5"})],8,Be),e("button",{onClick:c=>D(r),class:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors"},[n(a(X),{class:"w-5 h-5"})],8,Le)])])]))),128))]))])]),e("div",Qe,[e("div",Ae,[e("div",Te,[e("div",Ue,[n(a(B),{class:"w-5 h-5 text-red-500"}),t[13]||(t[13]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Issiq Lidlar",-1))]),t[14]||(t[14]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Top 10 yuqori balli lidlar",-1))]),g.hotLeads.length===0?(l(),d("div",Fe,[...t[15]||(t[15]=[e("p",null,"Hozircha issiq lidlar yo'q",-1)])])):(l(),d("div",De,[(l(!0),d(b,null,x(g.hotLeads,r=>(l(),d("div",{key:r.id,class:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[e("div",Oe,[e("div",null,[e("p",He,s(r.name),1),e("p",Ie,s(r.company||r.phone),1)]),e("div",Ye,[e("div",{class:v(["inline-flex items-center px-2.5 py-1 rounded-full text-sm font-bold",V(r.score_category)])},s(r.score),3)])])]))),128))]))]),e("div",Ee,[t[19]||(t[19]=e("h3",{class:"font-semibold text-gray-900 dark:text-white mb-4"},"Statistika",-1)),e("dl",Ne,[e("div",Re,[t[16]||(t[16]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"Jami lidlar",-1)),e("dd",Ge,s(I.value),1)]),e("div",Ke,[t[17]||(t[17]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"O'rtacha ball",-1)),e("dd",Je,s(g.distribution?.average_score||0),1)]),e("div",Pe,[t[18]||(t[18]=e("dt",{class:"text-gray-500 dark:text-gray-400"},"Faol qoidalar",-1)),e("dd",Ze,s(g.rules.filter(r=>r.is_active).length)+" / "+s(g.rules.length),1)])])])])]),n(a(se),{appear:"",show:f.value,as:"template"},{default:m(()=>[n(a(ie),{as:"div",onClose:p,class:"relative z-50"},{default:m(()=>[n(a(L),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:m(()=>[...t[20]||(t[20]=[e("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm"},null,-1)])]),_:1}),e("div",We,[e("div",Xe,[n(a(L),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:m(()=>[n(a(le),{class:"w-full max-w-lg transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 shadow-xl transition-all"},{default:m(()=>[e("div",et,[n(a(de),{class:"text-lg font-semibold text-gray-900 dark:text-white"},{default:m(()=>[S(s(y.value?"Qoidani tahrirlash":"Yangi qoida qo'shish"),1)]),_:1}),e("button",{onClick:p,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[n(a(oe),{class:"w-5 h-5"})])]),e("form",{onSubmit:G(U,["prevent"]),class:"space-y-4"},[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Qoida nomi * ",-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>a(o).name=r),type:"text",required:"",placeholder:"Masalan: Telefon raqami mavjud",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[k,a(o).name]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Kategoriya * ",-1)),u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=r=>a(o).category=r),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},[(l(!0),d(b,null,x(g.categories,(r,c)=>(l(),d("option",{key:c,value:c},s(r.name),9,tt))),128))],512),[[w,a(o).category]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Maydon * ",-1)),u(e("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>a(o).field=r),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},[t[23]||(t[23]=e("option",{value:""},"Maydonni tanlang",-1)),(l(),d(b,null,x(Q,r=>e("option",{key:r.value,value:r.value},s(r.label),9,rt)),64))],512),[[w,a(o).field]])]),e("div",at,[e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Shart * ",-1)),u(e("select",{"onUpdate:modelValue":t[3]||(t[3]=r=>a(o).condition=r),required:"",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},[(l(!0),d(b,null,x(g.conditions,(r,c)=>(l(),d("option",{key:c,value:c},s(r),9,ot))),128))],512),[[w,a(o).condition]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Qiymat ",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>a(o).value=r),type:"text",placeholder:"Shart qiymati",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[k,a(o).value]])])]),e("div",st,[e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Ball * ",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>a(o).points=r),type:"number",required:"",min:"-50",max:"50",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[k,a(o).points,void 0,{number:!0}]]),t[28]||(t[28]=e("p",{class:"text-xs text-gray-500 mt-1"},"Ijobiy yoki salbiy (-50 dan +50 gacha)",-1))]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Qiymat turi ",-1)),u(e("select",{"onUpdate:modelValue":t[6]||(t[6]=r=>a(o).value_type=r),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},[...t[29]||(t[29]=[e("option",{value:"string"},"Matn",-1),e("option",{value:"number"},"Raqam",-1),e("option",{value:"boolean"},"Ha/Yo'q",-1)])],512),[[w,a(o).value_type]])])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Tavsif ",-1)),u(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=r=>a(o).description=r),rows:"2",placeholder:"Qoida haqida qisqacha ma'lumot",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[k,a(o).description]])]),e("div",it,[e("button",{type:"button",onClick:p,class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," Bekor qilish "),e("button",{type:"submit",disabled:a(o).processing,class:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 transition-colors"},s(y.value?"Saqlash":"Qo'shish"),9,lt)])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])])]),_:1}))}};export{Ft as default};
