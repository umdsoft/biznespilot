import{r as y,b as x,o as H,v as S,x as L,y as m,z as e,A as c,D as o,L as h,E as a,H as u,C as _,S as R,F as q,G as j,B as v,I as U,J as X}from"./chunk-BcTZxe-J.js";import{h as P,a as E}from"./chunk-BYRtWSr0.js";import{_ as W}from"./chunk-D2CDubcM.js";import{b as J}from"./chunk-CYarSvys.js";import{r as Z}from"./chunk-Bv_bj7dx.js";import{r as A}from"./chunk-Rs1WNzbn.js";import{r as ee}from"./chunk-B__b4fK0.js";import{r as te}from"./chunk-DVnlbxPa.js";import{r as re}from"./chunk-CoBrxO6j.js";import"./app-DWC75jbx.js";import"./chunk-C1xeNfMu.js";import"./chunk-BVYwhYNk.js";import"./chunk-BqueMrU7.js";import"./chunk-_yYzsx_i.js";import"./chunk-CJsSO8V8.js";import"./chunk-CrR1zWIb.js";import"./chunk-CQoMtUf7.js";import"./chunk-qVc0_oyq.js";import"./chunk-LBbTbQSS.js";import"./chunk-I93QdGKi.js";import"./chunk-DNp5bQOL.js";import"./chunk-CG0drqHE.js";import"./chunk-CklLzvQL.js";import"./chunk-CnrLL2pV.js";import"./chunk-D58UsNjm.js";import"./chunk-Ba8J67bG.js";import"./chunk-BHX0ueEB.js";const se={class:"max-w-3xl mx-auto"},ae={key:0,class:"flex items-center justify-center py-24"},le={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-8 text-center"},oe={class:"text-red-600 dark:text-red-300"},ne={key:2,class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-12 text-center"},ie={class:"w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-6"},ue={class:"text-gray-600 dark:text-gray-400 mb-8"},de={href:"/hr/surveys",class:"inline-flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},ce={key:3,class:"space-y-6"},ve={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm"},pe={class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},ge={key:0,class:"text-gray-600 dark:text-gray-400 text-sm mb-4"},ye={key:1,class:"flex items-center gap-2 text-sm text-purple-600 dark:text-purple-400"},me={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm"},be={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-2"},xe={class:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},he={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"},fe={class:"p-6"},ke={class:"mb-6"},_e={class:"flex items-start gap-4"},we={class:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center shrink-0"},$e={class:"text-lg font-bold text-purple-600 dark:text-purple-400"},Se={class:"text-lg font-medium text-gray-900 dark:text-white pt-2"},Ae={key:0,class:"mt-6"},Ce={class:"flex items-center justify-center gap-3"},qe=["onClick"],je={key:1,class:"mt-6 space-y-3"},Be=["onClick"],ze={key:2,class:"mt-6 space-y-3"},Ie=["onClick"],Me={key:3,class:"mt-6 flex items-center justify-center gap-4"},Ve={key:4,class:"mt-6"},De={key:5,class:"mt-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"},Ee={class:"text-red-600 dark:text-red-400 text-sm"},Je={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700/50 flex items-center justify-between"},Ne=["disabled"],Qe=["disabled"],Oe=["disabled"],gt={__name:"Fill",props:{currentBusiness:Object,surveyId:String},setup(N){const g=N,w=y(!0),b=y(!1),B=y(!1),n=y(null),f=y({}),d=y(0),p=y(""),z=y(null),Q=async()=>{if(!g.currentBusiness?.id||!g.surveyId){p.value="Biznes yoki so'rovnoma tanlanmagan",w.value=!1;return}w.value=!0,p.value="";try{const s=await E.get(`/api/v1/businesses/${g.currentBusiness.id}/hr/surveys/${g.surveyId}`);n.value=s.data.data,z.value=Date.now(),n.value?.questions&&n.value.questions.forEach((t,r)=>{f.value[`q_${r}`]=null})}catch(s){console.error("Error fetching survey:",s),p.value=s.response?.data?.message||"So'rovnomani yuklashda xatolik"}finally{w.value=!1}},i=x(()=>n.value?.questions?.[d.value]||null),k=x(()=>n.value?.questions?.length||0),I=x(()=>k.value===0?0:Math.round((d.value+1)/k.value*100)),l=x({get(){return f.value[`q_${d.value}`]},set(s){f.value[`q_${d.value}`]=s}}),M=s=>!(s===null||s===""||s===void 0||Array.isArray(s)&&s.length===0),V=x(()=>n.value?.settings?.allow_skip?!0:M(l.value)),D=x(()=>n.value?.settings?.allow_skip?!0:Object.values(f.value).every(M)),O=()=>{d.value<k.value-1&&d.value++},F=()=>{d.value>0&&d.value--},K=s=>{l.value=s},C=s=>{l.value=s},T=s=>{const t=Array.isArray(l.value)?[...l.value]:[],r=t.indexOf(s);r>-1?t.splice(r,1):t.push(s),l.value=t},Y=async()=>{if(!g.currentBusiness?.id||!g.surveyId)return;b.value=!0,p.value="";const s=Math.round((Date.now()-z.value)/1e3);try{await E.post(`/api/v1/businesses/${g.currentBusiness.id}/hr/surveys/${g.surveyId}/respond`,{answers:f.value,time_spent_seconds:s}),B.value=!0}catch(t){console.error("Error submitting survey:",t),p.value=t.response?.data?.message||"Javoblarni yuborishda xatolik"}finally{b.value=!1}};return H(Q),(s,t)=>(a(),S(W,{title:n.value?.title||"So'rovnoma"},{default:L(()=>[m(c(P),{title:n.value?.title||"So'rovnoma to'ldirish"},null,8,["title"]),e("div",se,[w.value?(a(),o("div",ae,[m(c(J),{class:"w-10 h-10 animate-spin text-purple-600"})])):p.value&&!n.value?(a(),o("div",le,[m(c(Z),{class:"w-16 h-16 mx-auto text-red-400 mb-4"}),t[3]||(t[3]=e("h2",{class:"text-xl font-semibold text-red-800 dark:text-red-400 mb-2"},"Xatolik",-1)),e("p",oe,u(p.value),1)])):B.value?(a(),o("div",ne,[e("div",ie,[m(c(A),{class:"w-12 h-12 text-green-600"})]),t[5]||(t[5]=e("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-4"}," Rahmat! ",-1)),e("p",ue," Javoblaringiz muvaffaqiyatli qabul qilindi. "+u(n.value?.is_anonymous?"Javoblaringiz anonim saqlanadi.":""),1),e("a",de,[m(c(ee),{class:"w-5 h-5"}),t[4]||(t[4]=_(" So'rovnomalarga qaytish ",-1))])])):n.value?(a(),o("div",ce,[e("div",ve,[e("h1",pe,u(n.value.title),1),n.value.description?(a(),o("p",ge,u(n.value.description),1)):h("",!0),n.value.is_anonymous?(a(),o("div",ye,[m(c(A),{class:"w-4 h-4"}),t[6]||(t[6]=_(" Bu so'rovnoma anonim - javoblaringiz maxfiy saqlanadi ",-1))])):h("",!0)]),e("div",me,[e("div",be,[e("span",null,"Savol "+u(d.value+1)+" / "+u(k.value),1),e("span",null,u(I.value)+"%",1)]),e("div",xe,[e("div",{class:"h-full bg-purple-600 transition-all duration-300",style:R({width:`${I.value}%`})},null,4)])]),e("div",he,[e("div",fe,[e("div",ke,[e("div",_e,[e("div",we,[e("span",$e,u(d.value+1),1)]),e("h2",Se,u(i.value?.text),1)])]),i.value?.type==="scale"||i.value?.type==="rating"?(a(),o("div",Ae,[e("div",Ce,[(a(!0),o(q,null,j((i.value.scale_max||5)-(i.value.scale_min||1)+1,r=>(a(),o("button",{key:r,onClick:$=>K((i.value.scale_min||1)+r-1),class:v(["w-14 h-14 rounded-xl font-bold text-lg transition-all",l.value===(i.value.scale_min||1)+r-1?"bg-purple-600 text-white scale-110 shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-purple-100 dark:hover:bg-purple-900/30"])},u((i.value.scale_min||1)+r-1),11,qe))),128))]),t[7]||(t[7]=e("div",{class:"flex justify-between text-sm text-gray-500 mt-4 px-2"},[e("span",null,"Kam"),e("span",null,"Ko'p")],-1))])):i.value?.type==="choice"?(a(),o("div",je,[(a(!0),o(q,null,j(i.value.options,(r,$)=>(a(),o("button",{key:$,onClick:G=>C(r),class:v(["w-full p-4 text-left rounded-xl border-2 transition-all",l.value===r?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-700"])},[e("span",{class:v(["font-medium",l.value===r?"text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300"])},u(r),3)],10,Be))),128))])):i.value?.type==="multiple_choice"?(a(),o("div",ze,[(a(!0),o(q,null,j(i.value.options,(r,$)=>(a(),o("button",{key:$,onClick:G=>T(r),class:v(["w-full p-4 text-left rounded-xl border-2 transition-all flex items-center gap-3",Array.isArray(l.value)&&l.value.includes(r)?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-700"])},[e("div",{class:v(["w-5 h-5 rounded border-2 flex items-center justify-center",Array.isArray(l.value)&&l.value.includes(r)?"border-purple-500 bg-purple-500":"border-gray-300 dark:border-gray-600"])},[Array.isArray(l.value)&&l.value.includes(r)?(a(),S(c(A),{key:0,class:"w-3 h-3 text-white"})):h("",!0)],2),e("span",{class:v(["font-medium",Array.isArray(l.value)&&l.value.includes(r)?"text-purple-700 dark:text-purple-300":"text-gray-700 dark:text-gray-300"])},u(r),3)],10,Ie))),128))])):i.value?.type==="yes_no"?(a(),o("div",Me,[e("button",{onClick:t[0]||(t[0]=r=>C("yes")),class:v(["px-12 py-4 rounded-xl font-bold text-lg transition-all",l.value==="yes"?"bg-green-600 text-white scale-105 shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-900/30"])}," Ha ",2),e("button",{onClick:t[1]||(t[1]=r=>C("no")),class:v(["px-12 py-4 rounded-xl font-bold text-lg transition-all",l.value==="no"?"bg-red-600 text-white scale-105 shadow-lg":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-red-100 dark:hover:bg-red-900/30"])}," Yo'q ",2)])):i.value?.type==="text"?(a(),o("div",Ve,[U(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=r=>l.value=r),rows:"4",class:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"Javobingizni yozing..."},null,512),[[X,l.value]])])):h("",!0),p.value?(a(),o("div",De,[e("p",Ee,u(p.value),1)])):h("",!0)]),e("div",Je,[e("button",{onClick:F,disabled:d.value===0,class:v(["flex items-center gap-2 px-4 py-2 rounded-lg transition-colors",d.value===0?"text-gray-400 cursor-not-allowed":"text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},[m(c(te),{class:"w-5 h-5"}),t[8]||(t[8]=_(" Oldingi ",-1))],10,Ne),d.value<k.value-1?(a(),o("button",{key:0,onClick:O,disabled:!V.value,class:v(["flex items-center gap-2 px-6 py-2 rounded-lg font-medium transition-colors",V.value?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-300 dark:bg-gray-600 text-gray-500 cursor-not-allowed"])},[t[9]||(t[9]=_(" Keyingi ",-1)),m(c(re),{class:"w-5 h-5"})],10,Qe)):(a(),o("button",{key:1,onClick:Y,disabled:!D.value||b.value,class:v(["flex items-center gap-2 px-6 py-2 rounded-lg font-medium transition-colors",D.value&&!b.value?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 dark:bg-gray-600 text-gray-500 cursor-not-allowed"])},[b.value?(a(),S(c(J),{key:0,class:"w-5 h-5 animate-spin"})):(a(),S(c(A),{key:1,class:"w-5 h-5"})),_(" "+u(b.value?"Yuborilmoqda...":"Yuborish"),1)],10,Oe))])])])):h("",!0)])]),_:1},8,["title"]))}};export{gt as default};
