import{b as U,a as f}from"./chunk-BYRtWSr0.js";import{i as V,j as $,_ as E}from"./chunk-D6nU8-nU.js";import{u as T}from"./app-CPufef6f.js";import{r as p,o as z,e as G,v as b,x as g,V as H,D as s,E as e,F as _,G as j,A as m,L as n,H as o,z as F,M as W}from"./chunk-BcTZxe-J.js";const q={key:0,class:"pt-3 mt-3 border-t border-gray-200 dark:border-gray-700"},J={key:0,class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},K={key:1,class:"mb-2"},O={class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},Q={class:"flex-1"},R={key:0,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},X={key:1,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},Y={key:2,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},Z={key:3,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-orange-500 text-white rounded-full"},ot={__name:"BusinessLayout",props:{title:{type:String,default:""}},setup(L){const{t:B}=T(),M=U(),k=V,i=p(0),u=p(0),c=p({total:0,overdue:0}),d=p({total:0,overdue:0});let v=null,h=null,x=null,y=null;const w=async()=>{try{const t=await f.get("/business/inbox",{headers:{Accept:"application/json"}});t.data.stats?.unread?.total!==void 0&&(i.value=t.data.stats.unread.total)}catch(t){t.response?.status!==404&&console.error("Failed to fetch inbox stats:",t)}},I=async()=>{try{const t=await f.get("/business/api/sales/stats");t.data?.new_leads!==void 0&&(u.value=t.data.new_leads)}catch(t){t.response?.status!==404&&console.error("Failed to fetch leads stats:",t)}},C=async()=>{try{const t=await f.get("/business/tasks/stats");t.data&&(c.value={total:t.data.total||0,overdue:t.data.overdue||0})}catch(t){t.response?.status!==404&&console.error("Failed to fetch task stats:",t)}},P=async()=>{try{const t=await f.get("/business/todos/api/dashboard");t.data?.stats&&(d.value={total:t.data.stats.total_today||0,overdue:t.data.stats.overdue||0})}catch(t){t.response?.status!==404&&console.error("Failed to fetch todo stats:",t)}},A=()=>{w(),I(),C(),P(),v=setInterval(w,1e4),h=setInterval(I,15e3),x=setInterval(C,1e4),y=setInterval(P,3e4)},D=()=>{v&&clearInterval(v),h&&clearInterval(h),x&&clearInterval(x),y&&clearInterval(y)},N=t=>{const r=M.url;return t.exact?r===t.href||r===t.href+"/":t.activeMatch?t.activeMatch(r):r.startsWith(t.href)};return z(()=>{A()}),G(()=>{D()}),(t,r)=>(e(),b(E,{title:L.title||m(B)("layout.home"),config:m(k)},{navigation:g(()=>[(e(!0),s(_,null,j(m(k).navigation,(l,S)=>(e(),s(_,{key:S},[S>0?(e(),s("div",q,[l.title?(e(),s("p",J,o(l.title),1)):n("",!0)])):l.title?(e(),s("div",K,[F("p",O,o(l.title),1)])):n("",!0),(e(!0),s(_,null,j(l.items,a=>(e(),b($,{key:a.href,href:a.href,active:N(a)},{default:g(()=>[(e(),b(W(a.icon),{class:"w-5 h-5 mr-3"})),F("span",Q,o(a.label),1),a.href==="/business/inbox"&&i.value>0?(e(),s("span",R,o(i.value>99?"99+":i.value),1)):n("",!0),a.href==="/business/sales"&&u.value>0?(e(),s("span",X,o(u.value>99?"99+":u.value),1)):n("",!0),a.href==="/business/tasks"&&c.value.overdue>0?(e(),s("span",Y,o(c.value.overdue>99?"99+":c.value.overdue),1)):n("",!0),a.href==="/business/todos"&&d.value.overdue>0?(e(),s("span",Z,o(d.value.overdue>99?"99+":d.value.overdue),1)):n("",!0)]),_:2},1032,["href","active"]))),128))],64))),128))]),default:g(()=>[H(t.$slots,"default")]),_:3},8,["title","config"]))}};export{ot as _};
