import{r as e,h as t,l as a}from"./chunk-BhZp3z4u.js";import{_ as r}from"./chunk-BHCorYK2.js";import{_ as s}from"./chunk-DbFbpSR2.js";import{_ as l}from"./chunk-Cb_-eVu9.js";import{b as i,C as o,D as n,y as d,E as u,v as m,O as p,I as c,z as g,L as h,B as y,A as x,r as b,F as v,H as f,J as k,K as _,x as w,ar as j}from"./chunk-CpmtkKLp.js";import{r as S}from"./chunk-D7oP9pDe.js";import{a as M}from"./chunk-eMHYSAeQ.js";import{r as $}from"./chunk-C2r_KHf6.js";import{r as q}from"./chunk-DCXiFUg-.js";import{r as A}from"./chunk-beXL1A--.js";import{r as C}from"./chunk-dqIIyBTR.js";import{r as B}from"./chunk-BB7xsSUf.js";import{o as D}from"./chunk-D7SyfRoT.js";import{r as O}from"./chunk-Bsc1JRL5.js";import{r as z}from"./chunk-CAoK8Mdm.js";import{r as T}from"./chunk-DmrwHl-6.js";import{r as I}from"./chunk-DOHfaLsi.js";import{_ as K}from"./chunk-BCo6x5W8.js";import{r as L}from"./chunk-CMUwByRV.js";import{A as R}from"./chunk-DlkF2xYt.js";import{r as H}from"./chunk-DWKYWsDr.js";import"./chunk-3cs9K1fB.js";import"./chunk-BG5DB3cD.js";import"./chunk-CdKrFGoA.js";import"./chunk-DvBKKKMs.js";import"./app-C-ZlocOh.js";import"./chunk-BWiubfpN.js";import"./chunk-CouA7u-j.js";import"./chunk-De_qwhex.js";import"./chunk-BiBvtcLb.js";import"./chunk-DNKDGYPp.js";import"./chunk-BiW1c8q7.js";import"./chunk-CTIk0k8a.js";import"./chunk-CvscUVdi.js";import"./chunk-BvbZUszZ.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-BuJDoypK.js";const J={class:"flex items-start gap-3 pl-2"},E={class:"flex-1 min-w-0"},F={class:"flex items-start justify-between gap-2"},N={class:"flex-1"},U={class:"font-medium text-white text-sm"},Y={class:"text-gray-400 text-sm mt-1"},P={class:"flex items-center gap-3 mt-2 text-xs text-gray-500"},Q={class:"flex items-center gap-1"},V={class:"flex items-center gap-1"},X={key:0,class:"mt-3"},Z={__name:"AlertCard",props:{alert:{type:Object,required:!0}},emits:["mark-read","dismiss","action"],setup(t,{emit:a}){const r=t,s=a,l=i(()=>{const e={low:"bg-gray-500",medium:"bg-blue-500",high:"bg-orange-500",urgent:"bg-red-500"};return e[r.alert.priority]||e.medium}),b=i(()=>"urgent"===r.alert.priority?"bg-red-500/10 border-red-500/30":"high"===r.alert.priority?"bg-orange-500/10 border-orange-500/30":"bg-gray-800 border-gray-700"),v=i(()=>({lead_followup:B,kpi_warning:C,target_reminder:q,penalty_warning:A,daily_summary:q,achievement:$,streak_warning:M,leaderboard_change:S}[r.alert.type]||D)),f=i(()=>({lead_followup:"bg-purple-500/20",kpi_warning:"bg-orange-500/20",target_reminder:"bg-blue-500/20",penalty_warning:"bg-red-500/20",daily_summary:"bg-green-500/20",achievement:"bg-yellow-500/20",streak_warning:"bg-orange-500/20",leaderboard_change:"bg-blue-500/20"}[r.alert.type]||"bg-gray-500/20")),k=i(()=>({lead_followup:"text-purple-400",kpi_warning:"text-orange-400",target_reminder:"text-blue-400",penalty_warning:"text-red-400",daily_summary:"text-green-400",achievement:"text-yellow-400",streak_warning:"text-orange-400",leaderboard_change:"text-blue-400"}[r.alert.type]||"text-gray-400")),_=i(()=>({lead_followup:"bg-purple-500/20 text-purple-400",kpi_warning:"bg-orange-500/20 text-orange-400",target_reminder:"bg-blue-500/20 text-blue-400",penalty_warning:"bg-red-500/20 text-red-400",daily_summary:"bg-green-500/20 text-green-400",achievement:"bg-yellow-500/20 text-yellow-400",streak_warning:"bg-orange-500/20 text-orange-400",leaderboard_change:"bg-blue-500/20 text-blue-400"}[r.alert.type]||"bg-gray-500/20 text-gray-400")),w=i(()=>({lead_followup:"Follow-up",kpi_warning:"KPI",target_reminder:"Eslatma",penalty_warning:"Jarima",daily_summary:"Xulosa",achievement:"Yutuq",streak_warning:"Streak",leaderboard_change:"Reyting"}[r.alert.type]||r.alert.type)),j=i(()=>{const e=new Date(r.alert.created_at),t=new Date,a=Math.floor((t-e)/1e3);return a<60?"Hozirgina":a<3600?`${Math.floor(a/60)} daqiqa oldin`:a<86400?`${Math.floor(a/3600)} soat oldin`:a<604800?`${Math.floor(a/86400)} kun oldin`:e.toLocaleDateString("uz-UZ")}),K=i(()=>["lead_followup","penalty_warning","streak_warning"].includes(r.alert.type)),L=i(()=>({lead_followup:"Lidga o'tish",penalty_warning:"Tafsilotlar",streak_warning:"Davom etish"}[r.alert.type]||"Ko'rish")),R=()=>{s("action",r.alert),"lead_followup"===r.alert.type&&r.alert.data?.lead_id?e.visit(route("sales-head.leads.show",r.alert.data.lead_id)):"penalty_warning"===r.alert.type&&e.visit(route("sales-head.sales-kpi.penalties"))};return(e,a)=>(n(),o("div",{class:u(["relative rounded-lg border p-4 transition-all duration-200",[b.value,{"opacity-60":"read"===t.alert.status}]])},[d("div",{class:u(["absolute left-0 top-0 bottom-0 w-1 rounded-l-lg",l.value])},null,2),d("div",J,[d("div",{class:u(["flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center",f.value])},[(n(),m(p(v.value),{class:u(["w-5 h-5",k.value])},null,8,["class"]))],2),d("div",E,[d("div",F,[d("div",N,[d("h4",U,g(t.alert.title),1),d("p",Y,g(t.alert.message),1),d("div",P,[d("span",Q,[h(x(O),{class:"w-3.5 h-3.5"}),y(" "+g(j.value),1)]),d("span",{class:u(["px-2 py-0.5 rounded-full text-xs",_.value])},g(w.value),3)])]),d("div",V,["unread"===t.alert.status?(n(),o("button",{key:0,onClick:a[0]||(a[0]=a=>e.$emit("mark-read",t.alert)),class:"p-1.5 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-white transition-colors",title:"O'qilgan deb belgilash"},[h(x(z),{class:"w-4 h-4"})])):c("",!0),d("button",{onClick:a[1]||(a[1]=a=>e.$emit("dismiss",t.alert)),class:"p-1.5 rounded-lg hover:bg-gray-700 text-gray-400 hover:text-red-400 transition-colors",title:"Yopish"},[h(x(T),{class:"w-4 h-4"})])])]),K.value?(n(),o("div",X,[d("button",{onClick:R,class:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 transition-colors"},[y(g(L.value)+" ",1),h(x(I),{class:"w-3.5 h-3.5"})])])):c("",!0)])])],2))}},G={class:"space-y-3"},W={class:"flex items-center justify-between mb-4"},ee={class:"flex items-center gap-2"},te={key:0,class:"px-2 py-0.5 text-xs font-medium bg-red-500 text-white rounded-full"},ae={class:"flex items-center gap-2"},re=["value"],se={key:0,class:"text-center py-12 bg-gray-800 rounded-xl"},le={class:"text-gray-400"},ie={key:1,class:"text-center pt-4"},oe=K({__name:"AlertList",props:{alerts:{type:Array,default:()=>[]},alertTypes:{type:Object,default:()=>({})},hasMore:{type:Boolean,default:!1}},emits:["mark-read","dismiss","action","mark-all-read","load-more"],setup(e,{emit:t}){const a=e,r=b("all"),s=i(()=>"all"===r.value?a.alerts:a.alerts.filter(e=>e.type===r.value)),l=i(()=>a.alerts.filter(e=>"unread"===e.status).length);return(t,a)=>(n(),o("div",G,[d("div",W,[d("div",ee,[a[6]||(a[6]=d("h3",{class:"text-lg font-semibold text-white"},"Bildirishnomalar",-1)),l.value>0?(n(),o("span",te,g(l.value),1)):c("",!0)]),d("div",ae,[v(d("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),class:"text-sm bg-gray-700 border-gray-600 text-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[a[7]||(a[7]=d("option",{value:"all"},"Barchasi",-1)),(n(!0),o(k,null,_(e.alertTypes,(e,t)=>(n(),o("option",{key:t,value:t},g(e.name),9,re))),128))],512),[[f,r.value]]),l.value>0?(n(),o("button",{key:0,onClick:a[1]||(a[1]=e=>t.$emit("mark-all-read")),class:"text-sm text-gray-400 hover:text-white transition-colors"}," Barchasini o'qish ")):c("",!0)])]),0===s.value.length?(n(),o("div",se,[h(x(L),{class:"w-12 h-12 mx-auto text-gray-600 mb-3"}),d("p",le,g("all"===r.value?"Hozircha bildirishnomalar yo'q":"Bu turda bildirishnomalar yo'q"),1)])):c("",!0),h(j,{name:"list",tag:"div",class:"space-y-3"},{default:w(()=>[(n(!0),o(k,null,_(s.value,e=>(n(),m(Z,{key:e.id,alert:e,onMarkRead:a[2]||(a[2]=e=>t.$emit("mark-read",e)),onDismiss:a[3]||(a[3]=e=>t.$emit("dismiss",e)),onAction:a[4]||(a[4]=e=>t.$emit("action",e))},null,8,["alert"]))),128))]),_:1}),e.hasMore?(n(),o("div",ie,[d("button",{onClick:a[5]||(a[5]=e=>t.$emit("load-more")),class:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors"}," Ko'proq yuklash... ")])):c("",!0)]))}},[["__scopeId","data-v-284d023a"]]),ne={class:"py-6"},de={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},ue={class:"mb-6"},me={class:"flex items-center justify-between"},pe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},ce={class:"bg-gray-800 rounded-xl p-4"},ge={class:"text-2xl font-bold text-white"},he={class:"bg-gray-800 rounded-xl p-4"},ye={class:"text-2xl font-bold text-red-400"},xe={class:"bg-gray-800 rounded-xl p-4"},be={class:"text-2xl font-bold text-orange-400"},ve={class:"bg-gray-800 rounded-xl p-4"},fe={class:"text-2xl font-bold text-gray-300"},ke={class:"bg-gray-800/50 rounded-xl p-6"},_e={__name:"Index",props:{alerts:{type:Array,default:()=>[]},role:{type:String,default:"sales_operator"},unreadCount:{type:Number,default:0},alertTypes:{type:Object,default:()=>({})},priorities:{type:Object,default:()=>({})}},setup(o){const u=o,b=i(()=>({owner:s,sales_head:r,sales_operator:l}[u.role]||r)),v=i(()=>["owner","sales_head"].includes(u.role)),f=i(()=>u.alerts.filter(e=>"urgent"===e.priority&&"unread"===e.status).length),k=i(()=>u.alerts.filter(e=>"high"===e.priority&&"unread"===e.status).length),_=i(()=>u.alerts.filter(e=>["urgent","high"].includes(e.priority)&&"unread"===e.status).slice(0,3)),j=t=>{e.post(route("sales-head.alerts.read",t.id),{},{preserveScroll:!0,preserveState:!0})},S=t=>{e.post(route("sales-head.alerts.dismiss",t.id),{},{preserveScroll:!0,preserveState:!0})},M=()=>{e.post(route("sales-head.alerts.mark-all-read"),{},{preserveScroll:!0,preserveState:!0})},$=e=>{j(e)};return(e,r)=>(n(),m(p(b.value),null,{default:w(()=>[h(x(t),{title:"Bildirishnomalar"}),d("div",ne,[d("div",de,[d("div",ue,[d("div",me,[r[1]||(r[1]=d("div",null,[d("h1",{class:"text-2xl font-bold text-white"},"Bildirishnomalar"),d("p",{class:"text-gray-400 mt-1"}," Muhim xabarlar va ogohlantirishlar ")],-1)),v.value?(n(),m(x(a),{key:0,href:e.route("sales-head.alerts.settings"),class:"inline-flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors"},{default:w(()=>[h(x(H),{class:"w-5 h-5"}),r[0]||(r[0]=y(" Sozlamalar ",-1))]),_:1},8,["href"])):c("",!0)])]),d("div",pe,[d("div",ce,[d("div",ge,g(o.unreadCount),1),r[2]||(r[2]=d("div",{class:"text-sm text-gray-400"},"O'qilmagan",-1))]),d("div",he,[d("div",ye,g(f.value),1),r[3]||(r[3]=d("div",{class:"text-sm text-gray-400"},"Shoshilinch",-1))]),d("div",xe,[d("div",be,g(k.value),1),r[4]||(r[4]=d("div",{class:"text-sm text-gray-400"},"Muhim",-1))]),d("div",ve,[d("div",fe,g(o.alerts.length),1),r[5]||(r[5]=d("div",{class:"text-sm text-gray-400"},"Jami",-1))])]),_.value.length>0?(n(),m(R,{key:0,alerts:_.value,onDismiss:S,class:"mb-6"},null,8,["alerts"])):c("",!0),d("div",ke,[h(oe,{alerts:o.alerts,"alert-types":o.alertTypes,onMarkRead:j,onDismiss:S,onMarkAllRead:M,onAction:$},null,8,["alerts","alert-types"])])])])]),_:1}))}};export{_e as default};
