import{r as e,o as a,v as t,x as s,L as r,y as l,C as i,I as d,A as n,B as o,E as u,D as c,z as p,J as g,K as x,F as y,_ as v}from"./chunk-CpmtkKLp.js";import{h as m,l as h,a as k}from"./chunk-BhZp3z4u.js";import{_ as b}from"./chunk-BDBDdGhv.js";import{a as f}from"./chunk-D7SyfRoT.js";import{r as w}from"./chunk-BiBvtcLb.js";import{r as j}from"./chunk-CTIk0k8a.js";import{r as _}from"./chunk-CHHwFzll.js";import{r as B}from"./chunk-dqIIyBTR.js";import{r as $}from"./chunk-BYG0zTrL.js";import{r as q}from"./chunk-BFPxvklm.js";import{r as C}from"./chunk-_MRth-Ty.js";import"./app-C-ZlocOh.js";import"./chunk-BWiubfpN.js";import"./chunk-CouA7u-j.js";import"./chunk-DmrwHl-6.js";import"./chunk-De_qwhex.js";import"./chunk-eMHYSAeQ.js";import"./chunk-beXL1A--.js";import"./chunk-CAoK8Mdm.js";import"./chunk-DNKDGYPp.js";import"./chunk-BiW1c8q7.js";import"./chunk-CvscUVdi.js";import"./chunk-BvbZUszZ.js";import"./chunk-C9nNyFhC.js";import"./chunk-BYA8ViGa.js";import"./chunk-DCXiFUg-.js";import"./chunk-Bsc1JRL5.js";import"./chunk-BuJDoypK.js";const z={class:"space-y-6"},S={class:"flex items-center justify-between"},Y={class:"flex items-center gap-3"},H=["disabled"],F={key:0,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"},I={class:"text-red-800 dark:text-red-400"},J={key:1,class:"grid grid-cols-1 md:grid-cols-4 gap-4"},T={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm"},A={class:"flex items-center gap-3"},E={class:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-xl flex items-center justify-center"},K={class:"text-2xl font-bold text-gray-900 dark:text-white"},M={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm"},N={class:"flex items-center gap-3"},O={class:"w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-xl flex items-center justify-center"},P={class:"text-2xl font-bold text-green-600"},Q={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm"},R={class:"flex items-center gap-3"},D={class:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center"},G={class:"text-2xl font-bold text-blue-600"},L={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm"},U={class:"flex items-center gap-3"},V={class:"w-12 h-12 bg-orange-100 dark:bg-orange-900/30 rounded-xl flex items-center justify-center"},W={class:"text-2xl font-bold text-orange-600"},X={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden"},Z={class:"overflow-x-auto"},ee={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ae={class:"divide-y divide-gray-200 dark:divide-gray-700"},te={class:"px-6 py-4"},se={class:"text-sm font-medium text-gray-900 dark:text-white"},re={class:"text-sm text-gray-500 dark:text-gray-400"},le={key:0,class:"ml-2 text-xs text-purple-600"},ie={class:"px-6 py-4 whitespace-nowrap"},de={class:"px-6 py-4 whitespace-nowrap"},ne={class:"px-6 py-4 whitespace-nowrap"},oe={class:"flex items-center gap-2"},ue={class:"text-sm font-medium text-gray-900 dark:text-white"},ce={class:"text-xs text-gray-500"},pe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ge={key:0},xe={key:1},ye={class:"px-6 py-4 whitespace-nowrap text-right"},ve={class:"flex items-center justify-end gap-2"},me=["onClick"],he=["onClick"],ke={key:0,class:"p-8 text-center"},be={key:1,class:"p-8 text-center text-gray-500 dark:text-gray-400"},fe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50"},we={class:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4"},je={class:"space-y-3"},_e=["value"],Be={class:"font-medium text-gray-900 dark:text-white"},$e={class:"text-sm text-gray-500 dark:text-gray-400"},qe={class:"flex justify-end gap-3 mt-6"},Ce=["disabled"],ze=["disabled"],Se={__name:"Index",props:{currentBusiness:Object},setup(Se){const Ye=Se,He=e(!0),Fe=e(!1),Ie=e([]),Je=e(null),Te=e(!1),Ae=e("q12"),Ee=e(""),Ke=[{value:"q12",label:"Gallup Q12 Ishga Qiziqish",description:"Hodimlar ishga qiziqishini o'lchash"},{value:"pulse",label:"Haftalik Pulse",description:"Tezkor kayfiyat tekshiruvi"},{value:"exit",label:"Exit Interview",description:"Ketayotgan hodimlar uchun"}],Me=async()=>{if(!Ye.currentBusiness?.id)return Ee.value="Biznes tanlanmagan",void(He.value=!1);He.value=!0,Ee.value="";try{const[e,a]=await Promise.all([k.get(`/api/v1/businesses/${Ye.currentBusiness.id}/hr/surveys`),k.get(`/api/v1/businesses/${Ye.currentBusiness.id}/hr/surveys/statistics`)]);Ie.value=e.data.data?.data||e.data.data||[],Je.value=a.data.data}catch(e){Ee.value=e.response?.data?.message||"Ma'lumotlarni yuklashda xatolik"}finally{He.value=!1}},Ne=async()=>{if(Ye.currentBusiness?.id){Fe.value=!0,Ee.value="";try{const e=await k.post(`/api/v1/businesses/${Ye.currentBusiness.id}/hr/surveys/from-template`,{template:Ae.value});e.data.success?(Te.value=!1,await Me()):Ee.value=e.data.message||"Xatolik yuz berdi"}catch(e){Ee.value=e.response?.data?.message||"So'rovnoma yaratishda xatolik"}finally{Fe.value=!1}}else Ee.value="Biznes tanlanmagan"};return a(Me),(e,a)=>(c(),t(b,{title:"So'rovnomalar"},{default:s(()=>[r(n(m),{title:"HR So'rovnomalar"}),l("div",z,[l("div",S,[a[6]||(a[6]=l("div",null,[l("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," HR So'rovnomalar "),l("p",{class:"text-gray-500 dark:text-gray-400 mt-1"}," Hodimlar fikrlarini yig'ish va tahlil qilish ")],-1)),l("div",Y,[l("button",{onClick:Me,disabled:He.value,class:"flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700"},[r(n(f),{class:u(["w-5 h-5",He.value?"animate-spin":""])},null,8,["class"]),a[4]||(a[4]=o(" Yangilash ",-1))],8,H),l("button",{onClick:a[0]||(a[0]=e=>Te.value=!0),class:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},[r(n(w),{class:"w-5 h-5"}),a[5]||(a[5]=o(" Yangi so'rovnoma ",-1))])])]),Ee.value?(c(),i("div",F,[l("p",I,p(Ee.value),1)])):d("",!0),Je.value?(c(),i("div",J,[l("div",T,[l("div",A,[l("div",E,[r(n(j),{class:"w-6 h-6 text-purple-600 dark:text-purple-400"})]),l("div",null,[a[7]||(a[7]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Jami",-1)),l("p",K,p(Je.value.total_surveys||0),1)])])]),l("div",M,[l("div",N,[l("div",O,[r(n(_),{class:"w-6 h-6 text-green-600 dark:text-green-400"})]),l("div",null,[a[8]||(a[8]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Faol",-1)),l("p",P,p(Je.value.status_distribution?.active||0),1)])])]),l("div",Q,[l("div",R,[l("div",D,[r(n(B),{class:"w-6 h-6 text-blue-600 dark:text-blue-400"})]),l("div",null,[a[9]||(a[9]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"O'rtacha javob",-1)),l("p",G,p(Je.value.avg_response_rate?.toFixed(1)||0)+"% ",1)])])]),l("div",L,[l("div",U,[l("div",V,[r(n($),{class:"w-6 h-6 text-orange-600 dark:text-orange-400"})]),l("div",null,[a[10]||(a[10]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Jami javoblar",-1)),l("p",W,p(Je.value.total_responses||0),1)])])])])):d("",!0),l("div",X,[l("div",Z,[l("table",ee,[a[11]||(a[11]=l("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[l("tr",null,[l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"So'rovnoma"),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Turi"),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Status"),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Javoblar"),l("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Muddat"),l("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"Amallar")])],-1)),l("tbody",ae,[(c(!0),i(g,null,x(Ie.value,e=>{return c(),i("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[l("td",te,[l("div",null,[l("div",se,p(e.title),1),l("div",re,[o(p(e.questions_count)+" ta savol ",1),e.is_anonymous?(c(),i("span",le," (Anonim) ")):d("",!0)])])]),l("td",ie,[l("span",{class:u(["px-3 py-1 text-xs font-medium rounded-full",(g=e.type,{engagement:"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400",pulse:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",exit:"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",onboarding:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900/30 dark:text-cyan-400","360_feedback":"bg-pink-100 text-pink-800 dark:bg-pink-900/30 dark:text-pink-400",custom:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}[g]||"bg-gray-100 text-gray-800")])},p(e.type_label),3)]),l("td",de,[l("span",{class:u(["px-3 py-1 text-xs font-medium rounded-full",(a=e.status,{draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",active:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",closed:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"}[a]||"bg-gray-100 text-gray-800")])},p(e.status_label),3)]),l("td",ne,[l("div",oe,[l("span",ue,p(e.response_count),1),l("span",ce," ("+p(e.response_rate?.toFixed(1))+"%) ",1)])]),l("td",pe,[e.end_date?(c(),i("div",ge,p(e.end_date)+"gacha ",1)):(c(),i("div",xe,"-"))]),l("td",ye,[l("div",ve,[r(n(h),{href:`/hr/surveys/${e.id}`,class:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",title:"Tafsilotlar"},{default:s(()=>[r(n(q),{class:"w-5 h-5"})]),_:1},8,["href"]),"draft"===e.status?(c(),i("button",{key:0,onClick:a=>(async e=>{if(Ye.currentBusiness?.id)try{await k.post(`/api/v1/businesses/${Ye.currentBusiness.id}/hr/surveys/${e}/activate`),Me()}catch(a){}})(e.id),class:"p-2 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg",title:"Faollashtirish"},[r(n(_),{class:"w-5 h-5"})],8,me)):d("",!0),"active"===e.status?(c(),i("button",{key:1,onClick:a=>(async e=>{if(Ye.currentBusiness?.id)try{await k.post(`/api/v1/businesses/${Ye.currentBusiness.id}/hr/surveys/${e}/close`),Me()}catch(a){}})(e.id),class:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",title:"Yopish"},[r(n(C),{class:"w-5 h-5"})],8,he)):d("",!0),e.response_count>0?(c(),t(n(h),{key:2,href:`/hr/surveys/${e.id}/results`,class:"p-2 text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-lg",title:"Natijalar"},{default:s(()=>[r(n(B),{class:"w-5 h-5"})]),_:1},8,["href"])):d("",!0)])])]);var a,g}),128))])])]),He.value?(c(),i("div",ke,[r(n(f),{class:"w-8 h-8 mx-auto animate-spin text-purple-600"}),a[12]||(a[12]=l("p",{class:"mt-2 text-gray-500"},"Yuklanmoqda...",-1))])):0===Ie.value.length?(c(),i("div",be,[r(n(j),{class:"w-12 h-12 mx-auto opacity-50 mb-3"}),a[13]||(a[13]=l("p",null,"So'rovnomalar topilmadi",-1)),l("button",{onClick:a[1]||(a[1]=e=>Te.value=!0),class:"mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"}," Birinchi so'rovnomani yarating ")])):d("",!0)])]),Te.value?(c(),i("div",fe,[l("div",we,[a[14]||(a[14]=l("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Yangi so'rovnoma yaratish ",-1)),a[15]||(a[15]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-4"}," Tayyor shablondan tanlang: ",-1)),l("div",je,[(c(),i(g,null,x(Ke,e=>l("label",{key:e.value,class:u(["block p-4 border rounded-lg cursor-pointer transition-colors",Ae.value===e.value?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50"])},[y(l("input",{type:"radio","onUpdate:modelValue":a[2]||(a[2]=e=>Ae.value=e),value:e.value,class:"sr-only"},null,8,_e),[[v,Ae.value]]),l("div",Be,p(e.label),1),l("div",$e,p(e.description),1)],2)),64))]),l("div",qe,[l("button",{onClick:a[3]||(a[3]=e=>Te.value=!1),disabled:Fe.value,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg disabled:opacity-50"}," Bekor qilish ",8,Ce),l("button",{onClick:Ne,disabled:Fe.value,class:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 flex items-center gap-2"},[Fe.value?(c(),t(n(f),{key:0,class:"w-4 h-4 animate-spin"})):d("",!0),o(" "+p(Fe.value?"Yaratilmoqda...":"Yaratish"),1)],8,ze)])])])):d("",!0)]),_:1}))}};export{Se as default};
