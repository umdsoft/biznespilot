import{r as b,b as w,o as H,e as J,D as n,y as u,L as d,z as e,v as D,A as s,C as p,H as t,F as K,G as Q,Q as N,I as k,J as O,K as B,P as F,E as a}from"./chunk-BcTZxe-J.js";import{h as Z,a as j}from"./chunk-BYRtWSr0.js";import{u as W}from"./app-CPufef6f.js";import{r as T,a as X}from"./chunk-Rs1WNzbn.js";import{r as L}from"./chunk-3cjAeKxf.js";import{r as I}from"./chunk-Ba8J67bG.js";import{r as Y}from"./chunk-DNp5bQOL.js";import{r as ee,a as te}from"./chunk-CklLzvQL.js";import{r as se}from"./chunk-Brk9BpGk.js";import{r as P}from"./chunk-BqueMrU7.js";import"./chunk-C1xeNfMu.js";const oe={class:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-indigo-50"},re={key:0,class:"fixed top-4 left-1/2 -translate-x-1/2 z-50 px-6 py-4 bg-green-600 text-white rounded-xl shadow-lg flex items-center gap-3"},le={class:"bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 text-white"},ae={class:"max-w-4xl mx-auto px-4 py-8 text-center"},ne={key:0,class:"text-purple-200 mb-2"},ie={class:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center mx-auto mb-4"},ce={class:"text-3xl md:text-4xl font-bold mb-4"},de={key:1,class:"text-lg text-purple-100 max-w-2xl mx-auto"},ue={key:1,class:"bg-gradient-to-r from-red-500 to-orange-500 text-white py-3"},fe={class:"max-w-4xl mx-auto px-4 flex items-center justify-center gap-3"},me={class:"font-semibold"},be={class:"text-xl font-bold"},_e={class:"max-w-4xl mx-auto px-4 py-8"},ge={key:0,class:"bg-white rounded-2xl shadow-lg p-6 mb-6 border-l-4 border-purple-500"},pe={class:"flex items-start gap-4"},xe={class:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0"},he={class:"text-xl font-bold text-gray-900 mb-2"},ve={class:"text-gray-600 text-lg"},ye={class:"bg-white rounded-2xl shadow-xl overflow-hidden mb-6"},we={class:"p-6 bg-gradient-to-r from-green-50 to-emerald-50 border-b border-green-100"},ke={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},je={class:"text-sm text-green-700 font-medium mb-1"},$e={class:"flex items-baseline gap-3"},Ce={key:0,class:"text-2xl text-gray-400 line-through"},Me={class:"text-4xl font-black text-green-700"},Ve={key:0,class:"text-green-600 font-semibold mt-1"},Ie={key:0,class:"text-right"},Se={class:"text-sm text-gray-500"},Re={class:"text-2xl font-bold text-gray-900"},Ue={class:"text-green-600 font-semibold"},ze={key:0,class:"p-6"},De={class:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2"},Ne={class:"space-y-3"},Oe={class:"w-8 h-8 bg-amber-500 text-white rounded-lg flex items-center justify-center font-bold text-sm flex-shrink-0"},Be={class:"flex-1"},Fe={class:"flex items-center justify-between"},Te={class:"font-bold text-gray-900"},Le={key:0,class:"text-green-600 font-semibold"},Pe={key:0,class:"text-gray-600 text-sm mt-1"},qe={key:1,class:"bg-white rounded-2xl shadow-lg p-6 mb-6 border-2 border-green-200"},Ee={class:"flex items-start gap-4"},Ae={class:"w-14 h-14 bg-green-500 rounded-xl flex items-center justify-center flex-shrink-0"},Ge={class:"text-xl font-bold text-green-800 mb-2"},He={key:0,class:"text-gray-600 mb-3"},Je={key:1,class:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg"},Ke={class:"font-semibold"},Qe={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},Ze={key:0,class:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4"},We={class:"flex items-center gap-3 text-blue-700 font-semibold mb-2"},Xe={class:"text-gray-700"},Ye={key:1,class:"bg-red-50 border-2 border-red-200 rounded-xl p-4"},et={class:"flex items-center gap-3 text-red-700 font-semibold mb-2"},tt={class:"text-gray-700"},st={key:3,class:"bg-gradient-to-r from-yellow-50 to-orange-50 rounded-2xl p-6 mb-6 border-2 border-yellow-200"},ot={class:"text-center"},rt={class:"flex items-center justify-center gap-3 mb-2"},lt={class:"text-3xl font-black text-yellow-800"},at={class:"text-yellow-700 font-medium"},nt={class:"sticky bottom-4 bg-white rounded-2xl shadow-2xl p-4 border border-gray-200"},it={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ct=["disabled"],dt={class:"text-center mt-8 text-gray-500 text-sm"},ut={key:0},ft={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},mt={class:"flex min-h-screen items-center justify-center p-4"},bt={class:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full p-6"},_t={class:"flex items-center justify-between mb-4"},gt={class:"text-xl font-bold text-gray-900"},pt={class:"block text-sm font-medium text-gray-700 mb-1"},xt={class:"block text-sm font-medium text-gray-700 mb-1"},ht={value:""},vt={value:"morning"},yt={value:"afternoon"},wt={value:"evening"},kt={class:"block text-sm font-medium text-gray-700 mb-1"},jt=["placeholder"],$t=["disabled"],Ct={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Mt={class:"flex min-h-screen items-center justify-center p-4"},Vt={class:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full p-6"},It={class:"flex items-center justify-between mb-4"},St={class:"text-xl font-bold text-gray-900"},Rt={class:"text-gray-600"},Ut={value:""},zt={value:"price"},Dt={value:"no_need"},Nt={value:"no_budget"},Ot={value:"competitor"},Bt={value:"other"},Ft=["disabled"],Zt={__name:"OfferView",props:{assignment:Object,offer:Object,lead:Object,business:Object},setup(r){const{t:o}=W(),f=r,x=b(!1),h=b(!1),_=b({phone:"",preferred_time:"",message:""}),$=b(""),m=b(!1),v=b(""),g=b(null),C=b(null),S=w(()=>{if(!g.value||g.value<=0)return null;const c=Math.floor(g.value/(1e3*60*60*24)),l=Math.floor(g.value%(1e3*60*60*24)/(1e3*60*60)),i=Math.floor(g.value%(1e3*60*60)/(1e3*60)),V=Math.floor(g.value%(1e3*60)/1e3);return c>0?o("public_offer.time_days_hours",{days:c,hours:l}):l>0?o("public_offer.time_hours_minutes",{hours:l,minutes:i}):`${i}:${V.toString().padStart(2,"0")}`});H(()=>{f.assignment.expires_at?.timestamp&&(R(),C.value=setInterval(R,1e3))}),J(()=>{C.value&&clearInterval(C.value)});const R=()=>{const c=Date.now(),l=f.assignment.expires_at.timestamp;g.value=Math.max(0,l-c)},y=c=>c?new Intl.NumberFormat("uz-UZ").format(c):"0",M=w(()=>{const c=f.assignment.offered_price||f.offer.pricing||0,l=f.assignment.discount_amount||0;return Math.max(0,c-l)}),U=w(()=>f.assignment.discount_amount&&f.assignment.discount_amount>0),z=async c=>{try{await j.post(route("offers.public.click",f.assignment.tracking_code),{action:c})}catch(l){console.error("Click tracking failed:",l)}},q=async()=>{m.value=!0;try{const c=await j.post(route("offers.public.interested",f.assignment.tracking_code));v.value=c.data.message,await z("interested")}catch(c){console.error("Interest submission failed:",c)}finally{m.value=!1}},E=async()=>{m.value=!0;try{const c=await j.post(route("offers.public.callback",f.assignment.tracking_code),_.value);v.value=c.data.message,x.value=!1,await z("callback")}catch(c){console.error("Callback submission failed:",c)}finally{m.value=!1}},A=async()=>{m.value=!0;try{await j.post(route("offers.public.reject",f.assignment.tracking_code),{reason:$.value}),h.value=!1,v.value=o("public_offer.feedback_thanks")}catch(c){console.error("Reject submission failed:",c)}finally{m.value=!1}},G=w(()=>({unconditional:o("public_offer.guarantee_unconditional"),conditional:o("public_offer.guarantee_conditional"),performance:o("public_offer.guarantee_performance"),hybrid:o("public_offer.guarantee_hybrid")}));return(c,l)=>(a(),n("div",oe,[u(s(Z),{title:r.offer.name},null,8,["title"]),v.value?(a(),n("div",re,[u(s(T),{class:"w-6 h-6"}),p(" "+t(v.value),1)])):d("",!0),e("div",le,[e("div",ae,[r.lead.name?(a(),n("p",ne,t(s(o)("public_offer.greeting",{name:r.lead.name})),1)):d("",!0),e("div",ie,[u(s(L),{class:"w-8 h-8"})]),e("h1",ce,t(r.offer.name),1),r.offer.description?(a(),n("p",de,t(r.offer.description),1)):d("",!0)])]),S.value?(a(),n("div",ue,[e("div",fe,[u(s(I),{class:"w-5 h-5 animate-pulse"}),e("span",me,t(s(o)("public_offer.offer_deadline")),1),e("span",be,t(S.value),1)])])):d("",!0),e("div",_e,[r.offer.value_proposition?(a(),n("div",ge,[e("div",pe,[e("div",xe,[u(s(Y),{class:"w-6 h-6 text-purple-600"})]),e("div",null,[e("h2",he,t(s(o)("public_offer.value_proposition_title")),1),e("p",ve,t(r.offer.value_proposition),1)])])])):d("",!0),e("div",ye,[e("div",we,[e("div",ke,[e("div",null,[e("p",je,t(s(o)("public_offer.special_price")),1),e("div",$e,[U.value?(a(),n("span",Ce,t(y(r.assignment.offered_price||r.offer.pricing))+" "+t(s(o)("common.currency")),1)):d("",!0),e("span",Me,t(y(M.value))+" "+t(s(o)("common.currency")),1)]),U.value?(a(),n("p",Ve,t(s(o)("public_offer.discount_amount",{amount:y(r.assignment.discount_amount)})),1)):d("",!0)]),r.offer.total_value&&r.offer.total_value>M.value?(a(),n("div",Ie,[e("p",Se,t(s(o)("public_offer.total_value")),1),e("p",Re,t(y(r.offer.total_value))+" "+t(s(o)("common.currency")),1),e("p",Ue,t(s(o)("public_offer.more_value",{percent:Math.round((r.offer.total_value/M.value-1)*100)})),1)])):d("",!0)])]),r.offer.components?.length>0?(a(),n("div",ze,[e("h3",De,[u(s(L),{class:"w-6 h-6 text-amber-500"}),p(" "+t(s(o)("public_offer.bonuses")),1)]),e("div",Ne,[(a(!0),n(K,null,Q(r.offer.components,(i,V)=>(a(),n("div",{key:i.id,class:"flex items-start gap-3 p-4 bg-amber-50 rounded-xl"},[e("div",Oe,t(V+1),1),e("div",Be,[e("div",Fe,[e("h4",Te,t(i.name),1),i.value?(a(),n("span",Le,t(y(i.value))+" "+t(s(o)("common.currency")),1)):d("",!0)]),i.description?(a(),n("p",Pe,t(i.description),1)):d("",!0)])]))),128))])])):d("",!0)]),r.offer.guarantee_type?(a(),n("div",qe,[e("div",Ee,[e("div",Ae,[u(s(ee),{class:"w-7 h-7 text-white"})]),e("div",null,[e("h3",Ge,t(G.value[r.offer.guarantee_type]||r.offer.guarantee_type),1),r.offer.guarantee_terms?(a(),n("p",He,t(r.offer.guarantee_terms),1)):d("",!0),r.offer.guarantee_period_days?(a(),n("div",Je,[u(s(I),{class:"w-5 h-5"}),e("span",Ke,t(s(o)("public_offer.guarantee_days",{days:r.offer.guarantee_period_days})),1)])):d("",!0)])])])):d("",!0),r.offer.scarcity||r.offer.urgency?(a(),n("div",Qe,[r.offer.scarcity?(a(),n("div",Ze,[e("div",We,[u(s(I),{class:"w-5 h-5"}),p(" "+t(s(o)("public_offer.scarcity")),1)]),e("p",Xe,t(r.offer.scarcity),1)])):d("",!0),r.offer.urgency?(a(),n("div",Ye,[e("div",et,[u(s(X),{class:"w-5 h-5"}),p(" "+t(s(o)("public_offer.urgency")),1)]),e("p",tt,t(r.offer.urgency),1)])):d("",!0)])):d("",!0),r.offer.value_score?(a(),n("div",st,[e("div",ot,[e("div",rt,[u(s(se),{class:"w-8 h-8 text-yellow-600"}),e("span",lt,t(r.offer.value_score),1)]),e("p",at,t(s(o)("public_offer.value_score")),1)])])):d("",!0),e("div",nt,[e("div",it,[e("button",{onClick:q,disabled:m.value,class:"flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold rounded-xl hover:from-purple-700 hover:to-indigo-700 transition-all shadow-lg disabled:opacity-50"},[u(s(T),{class:"w-6 h-6"}),p(" "+t(s(o)("public_offer.interested")),1)],8,ct),e("button",{onClick:l[0]||(l[0]=i=>x.value=!0),class:"flex items-center justify-center gap-2 px-6 py-4 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition-all shadow-lg"},[u(s(te),{class:"w-6 h-6"}),p(" "+t(s(o)("public_offer.call_me")),1)])]),e("button",{onClick:l[1]||(l[1]=i=>h.value=!0),class:"w-full mt-3 text-sm text-gray-400 hover:text-gray-600 transition-colors"},t(s(o)("public_offer.not_interested")),1)]),e("div",dt,[e("p",null,t(r.business.name),1),r.business.phone?(a(),n("p",ut,t(r.business.phone),1)):d("",!0)])]),(a(),D(F,{to:"body"},[x.value?(a(),n("div",ft,[e("div",mt,[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:l[2]||(l[2]=i=>x.value=!1)}),e("div",bt,[e("div",_t,[e("h3",gt,t(s(o)("public_offer.callback_title")),1),e("button",{onClick:l[3]||(l[3]=i=>x.value=!1),class:"text-gray-400 hover:text-gray-600"},[u(s(P),{class:"w-6 h-6"})])]),e("form",{onSubmit:N(E,["prevent"]),class:"space-y-4"},[e("div",null,[e("label",pt,t(s(o)("public_offer.phone_number"))+" *",1),k(e("input",{"onUpdate:modelValue":l[4]||(l[4]=i=>_.value.phone=i),type:"tel",required:"",placeholder:"+998 90 123 45 67",class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"},null,512),[[O,_.value.phone]])]),e("div",null,[e("label",xt,t(s(o)("public_offer.preferred_time")),1),k(e("select",{"onUpdate:modelValue":l[5]||(l[5]=i=>_.value.preferred_time=i),class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"},[e("option",ht,t(s(o)("public_offer.time_any")),1),e("option",vt,t(s(o)("public_offer.time_morning")),1),e("option",yt,t(s(o)("public_offer.time_afternoon")),1),e("option",wt,t(s(o)("public_offer.time_evening")),1)],512),[[B,_.value.preferred_time]])]),e("div",null,[e("label",kt,t(s(o)("public_offer.message")),1),k(e("textarea",{"onUpdate:modelValue":l[6]||(l[6]=i=>_.value.message=i),rows:"2",placeholder:s(o)("public_offer.message_placeholder"),class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"},null,8,jt),[[O,_.value.message]])]),e("button",{type:"submit",disabled:m.value,class:"w-full py-3 bg-green-600 text-white font-semibold rounded-xl hover:bg-green-700 transition-all disabled:opacity-50"},t(m.value?s(o)("public_form.submitting"):s(o)("public_form.submit")),9,$t)],32)])])])):d("",!0)])),(a(),D(F,{to:"body"},[h.value?(a(),n("div",Ct,[e("div",Mt,[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:l[7]||(l[7]=i=>h.value=!1)}),e("div",Vt,[e("div",It,[e("h3",St,t(s(o)("public_offer.feedback_title")),1),e("button",{onClick:l[8]||(l[8]=i=>h.value=!1),class:"text-gray-400 hover:text-gray-600"},[u(s(P),{class:"w-6 h-6"})])]),e("form",{onSubmit:N(A,["prevent"]),class:"space-y-4"},[e("p",Rt,t(s(o)("public_offer.feedback_question")),1),k(e("select",{"onUpdate:modelValue":l[9]||(l[9]=i=>$.value=i),class:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"},[e("option",Ut,t(s(o)("public_offer.select_reason")),1),e("option",zt,t(s(o)("public_offer.reason_price")),1),e("option",Dt,t(s(o)("public_offer.reason_no_need")),1),e("option",Nt,t(s(o)("public_offer.reason_no_budget")),1),e("option",Ot,t(s(o)("public_offer.reason_competitor")),1),e("option",Bt,t(s(o)("public_offer.reason_other")),1)],512),[[B,$.value]]),e("button",{type:"submit",disabled:m.value,class:"w-full py-3 bg-gray-600 text-white font-semibold rounded-xl hover:bg-gray-700 transition-all disabled:opacity-50"},t(m.value?s(o)("public_form.submitting"):s(o)("public_form.submit")),9,Ft)],32)])])])):d("",!0)]))]))}};export{Zt as default};
