import{a as e,r as a,b as r,C as t,y as l,L as o,x as s,A as d,z as n,I as i,F as u,G as c,J as g,K as p,E as b,B as y,D as x}from"./chunk-CpmtkKLp.js";import{l as m,a as k,r as v}from"./chunk-BhZp3z4u.js";const h={class:"max-w-4xl mx-auto space-y-6"},f={class:"flex items-center"},w={class:"text-gray-500 dark:text-gray-400"},M={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},C={class:"p-6 space-y-6"},_={class:"grid grid-cols-4 gap-3"},j=["onClick"],z=["d"],B={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},T={key:0},V={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},q={class:"p-6 space-y-6"},H={class:"flex items-center justify-between p-4 bg-purple-50 dark:bg-purple-900/20 rounded-xl"},A={class:"text-2xl font-bold text-purple-700 dark:text-purple-300"},L={key:0},U={class:"flex flex-wrap gap-2"},F=["onClick"],X={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},O={class:"p-6"},R={class:"flex items-center gap-4"},Y={class:"flex items-center justify-center gap-3"},D={class:"flex items-center justify-center gap-3"},I={key:0,class:"mt-4"},K={class:"flex items-center justify-end gap-4"},Q=["disabled"],S=["disabled"],E={key:0,class:"animate-spin w-5 h-5",fill:"none",viewBox:"0 0 24 24"},G={__name:"TelegramBroadcastCreate",props:{bot:Object,availableTags:{type:Array,default:()=>[]},totalUsers:{type:Number,default:0},panelType:{type:String,required:!0,validator:e=>["business","marketing"].includes(e)}},setup(G){const J=G,N=(e,a=null)=>{const r="business"===J.panelType?"business.":"marketing.";return Array.isArray(a)||a?route(r+e,a):route(r+e)},P=[{value:"text",label:"Matn",icon:"M4 6h16M4 12h16M4 18h7"},{value:"photo",label:"Rasm",icon:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},{value:"video",label:"Video",icon:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"},{value:"document",label:"Fayl",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"}],W=e({name:"",content:{type:"text",text:"",file_id:""},scheduled_at:null}),Z=a([]),$=a(!1),ee=a(!1),ae=r(()=>!!W.name&&(!("text"===W.content.type&&!W.content.text)&&!("text"!==W.content.type&&!W.content.file_id))),re=async(e=!1)=>{ee.value=!0;try{const a=(await k.post(N("telegram-funnels.broadcasts.store",J.bot.id),{name:W.name,content:W.content,target_filter:Z.value.length>0?{tags:Z.value}:null,scheduled_at:$.value?W.scheduled_at:null})).data;a.success?(e&&!$.value&&await k.post(N("telegram-funnels.broadcasts.start",[J.bot.id,a.broadcast.id])),v.visit(N("telegram-funnels.broadcasts.index",J.bot.id))):alert(a.message||"Xatolik yuz berdi")}catch(a){alert("Server bilan bog'lanishda xatolik")}finally{ee.value=!1}},te=()=>re(!1),le=()=>re(!0);return(e,a)=>(x(),t("div",h,[l("div",f,[o(d(m),{href:N("telegram-funnels.broadcasts.index",G.bot.id),class:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mr-4 transition-colors"},{default:s(()=>[...a[6]||(a[6]=[l("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),_:1},8,["href"]),l("div",null,[a[7]||(a[7]=l("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Yangi Broadcast",-1)),l("p",w,"@"+n(G.bot.username)+" - Ommaviy xabar yuborish",1)])]),l("div",M,[a[13]||(a[13]=l("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[l("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Broadcast ma'lumotlari")],-1)),l("div",C,[l("div",null,[a[8]||(a[8]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Broadcast nomi *",-1)),u(l("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>W.name=e),type:"text",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white",placeholder:"Masalan: Yangi yil tabrigi"},null,512),[[c,W.name]])]),l("div",null,[a[9]||(a[9]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Xabar turi",-1)),l("div",_,[(x(),t(g,null,p(P,e=>l("button",{key:e.value,onClick:a=>W.content.type=e.value,class:b(["p-4 rounded-xl border-2 transition-all duration-200 flex flex-col items-center gap-2",W.content.type===e.value?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[(x(),t("svg",{class:b(["w-6 h-6",W.content.type===e.value?"text-purple-600":"text-gray-400"]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:e.icon},null,8,z)],2)),l("span",{class:b(W.content.type===e.value?"text-purple-600 font-medium":"text-gray-600 dark:text-gray-400")},n(e.label),3)],10,j)),64))])]),l("div",null,[l("label",B,n("text"===W.content.type?"Xabar matni *":"Caption (ixtiyoriy)"),1),u(l("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>W.content.text=e),rows:"4",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white",placeholder:"Xabar matnini yozing..."},null,512),[[c,W.content.text]]),a[10]||(a[10]=l("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},"HTML formatini qo'llab-quvvatlaydi: <b>, <i>, <a>, <code>",-1))]),"text"!==W.content.type?(x(),t("div",T,[a[11]||(a[11]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"File ID *",-1)),u(l("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>W.content.file_id=e),type:"text",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white",placeholder:"Telegram file_id ni kiriting"},null,512),[[c,W.content.file_id]]),a[12]||(a[12]=l("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},"Fayl Telegram serveriga yuklangan bo'lishi kerak",-1))])):i("",!0)])]),l("div",V,[a[17]||(a[17]=l("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[l("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Qabul qiluvchilar")],-1)),l("div",q,[l("div",H,[l("div",null,[a[14]||(a[14]=l("p",{class:"text-sm text-purple-600 dark:text-purple-400"},"Taxminiy qabul qiluvchilar",-1)),l("p",A,n(G.totalUsers),1)]),a[15]||(a[15]=l("div",{class:"w-12 h-12 bg-purple-100 dark:bg-purple-800/30 rounded-xl flex items-center justify-center"},[l("svg",{class:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1))]),G.availableTags.length>0?(x(),t("div",L,[a[16]||(a[16]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Teglar bo'yicha filter (ixtiyoriy)",-1)),l("div",U,[(x(!0),t(g,null,p(G.availableTags,e=>(x(),t("button",{key:e,onClick:a=>(e=>{const a=Z.value.indexOf(e);a>-1?Z.value.splice(a,1):Z.value.push(e)})(e),class:b(["px-3 py-1.5 rounded-full text-sm font-medium transition-colors",Z.value.includes(e)?"bg-purple-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},n(e),11,F))),128))])])):i("",!0)])]),l("div",X,[a[20]||(a[20]=l("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700"},[l("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Rejalashtirish")],-1)),l("div",O,[l("div",R,[l("button",{onClick:a[3]||(a[3]=e=>$.value=!1),class:b(["flex-1 p-4 rounded-xl border-2 transition-all duration-200",$.value?"border-gray-200 dark:border-gray-700":"border-purple-500 bg-purple-50 dark:bg-purple-900/20"])},[l("div",Y,[(x(),t("svg",{class:b(["w-6 h-6",$.value?"text-gray-400":"text-purple-600"]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...a[18]||(a[18]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)])],2)),l("span",{class:b($.value?"text-gray-600 dark:text-gray-400":"text-purple-600 font-medium")},"Hoziroq yuborish",2)])],2),l("button",{onClick:a[4]||(a[4]=e=>$.value=!0),class:b(["flex-1 p-4 rounded-xl border-2 transition-all duration-200",$.value?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-700"])},[l("div",D,[(x(),t("svg",{class:b(["w-6 h-6",$.value?"text-purple-600":"text-gray-400"]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...a[19]||(a[19]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),l("span",{class:b($.value?"text-purple-600 font-medium":"text-gray-600 dark:text-gray-400")},"Keyinroq yuborish",2)])],2)]),$.value?(x(),t("div",I,[u(l("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>W.scheduled_at=e),type:"datetime-local",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 dark:text-white"},null,512),[[c,W.scheduled_at]])])):i("",!0)])]),l("div",K,[o(d(m),{href:N("telegram-funnels.broadcasts.index",G.bot.id),class:"px-6 py-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},{default:s(()=>[...a[21]||(a[21]=[y(" Bekor qilish ",-1)])]),_:1},8,["href"]),l("button",{onClick:te,disabled:ee.value,class:"px-6 py-3 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-400 text-white font-medium rounded-xl transition-colors"}," Qoralama saqlash ",8,Q),l("button",{onClick:le,disabled:ee.value||!ae.value,class:"px-6 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white font-medium rounded-xl transition-colors flex items-center gap-2"},[ee.value?(x(),t("svg",E,[...a[22]||(a[22]=[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):i("",!0),y(" "+n($.value?"Rejalashtirilgan yaratish":"Yaratish va Boshlash"),1)],8,S)])]))}};export{G as _};
