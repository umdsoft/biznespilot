import{r as h,b as C,o as R,v as V,x as v,y as i,z as e,A as r,E as m,H as t,J as z,K as B,C as o,D as k,F as s,B as I,M}from"./chunk-KPSVwAyv.js";import{h as P,l as $,a as S}from"./chunk-BVrjkT6E.js";import{_ as U}from"./chunk-BEX9HuyE.js";import{u as A}from"./app-DMGwzSHW.js";import{r as E}from"./chunk-D59q4lxq.js";import{r as D}from"./chunk-1saQqATc.js";import{r as F}from"./chunk-Db7_HC3e.js";import{r as H}from"./chunk-D-7B8ZCD.js";import{r as J}from"./chunk-CmNfLjGq.js";import{r as K}from"./chunk-H5tv0cw2.js";import{r as Z}from"./chunk-qku2UxUN.js";import{r as q}from"./chunk-DZ5Qpl5B.js";import"./chunk-C_PbB7ed.js";import"./chunk-BgShz32H.js";import"./chunk-Qe-_4ASA.js";import"./chunk-Ch0Q6XPl.js";import"./chunk-Dfha1x8d.js";import"./chunk-BgOPVSvg.js";import"./chunk-CYw1XsNK.js";import"./chunk-D5sR6A8B.js";import"./chunk-Dems4pAU.js";import"./chunk-Cw_2vanC.js";import"./chunk-14qmXdHo.js";import"./chunk-DN454CZt.js";import"./chunk-CYZ54WJE.js";import"./chunk-J14gS6og.js";import"./chunk-BvkwlYlD.js";const G={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4"},Q={class:"text-2xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-3"},W={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},X={class:"flex gap-2"},Y={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 mb-6"},ee={class:"flex flex-wrap items-end gap-4"},te={class:"flex-1 min-w-[180px]"},re={class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5"},ae={class:"flex-1 min-w-[180px]"},se={class:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5"},oe={class:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},de={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 hover:shadow-md transition-shadow"},le={class:"flex items-center gap-3 mb-3"},ne={class:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center"},ie={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},ce={key:0,class:"text-2xl font-bold text-gray-900 dark:text-gray-100 animate-pulse"},_e={key:1,class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},ge={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 hover:shadow-md transition-shadow"},ue={class:"flex items-center gap-3 mb-3"},xe={class:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center"},ye={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},pe={key:0,class:"text-2xl font-bold text-gray-900 dark:text-gray-100 animate-pulse"},me={key:1,class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},be={key:2,class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},fe={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 hover:shadow-md transition-shadow"},he={class:"flex items-center gap-3 mb-3"},ve={class:"w-10 h-10 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center"},ke={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},we={key:0,class:"text-2xl font-bold text-gray-900 dark:text-gray-100 animate-pulse"},je={key:1,class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},Ce={key:2,class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},$e={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 hover:shadow-md transition-shadow"},De={class:"flex items-center gap-3 mb-3"},Ve={class:"w-10 h-10 bg-orange-100 dark:bg-orange-900/30 rounded-lg flex items-center justify-center"},ze={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Be={key:0,class:"text-2xl font-bold text-gray-900 dark:text-gray-100 animate-pulse"},Fe={key:1,class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},Oe={key:2,class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Ne={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden mb-6"},Te={class:"px-5 py-4 border-b border-gray-100 dark:border-gray-700 flex items-center gap-2"},Le={class:"text-base font-semibold text-gray-900 dark:text-gray-100"},Re={class:"p-5"},Ie={key:0,class:"text-center py-6 text-gray-400 animate-pulse"},Me={key:1,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Pe={class:"border border-gray-100 dark:border-gray-700 rounded-lg p-4"},Se={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2"},Ue={key:0},Ae={class:"font-bold text-gray-900 dark:text-gray-100 mb-2"},Ee={class:"space-y-1 text-sm text-gray-600 dark:text-gray-400"},He={class:"text-green-600 dark:text-green-400 font-semibold"},Je={class:"text-blue-600 dark:text-blue-400 font-semibold"},Ke={key:1,class:"text-sm text-gray-400 dark:text-gray-500"},Ze={class:"border border-gray-100 dark:border-gray-700 rounded-lg p-4"},qe={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2"},Ge={key:0},Qe={class:"font-bold text-gray-900 dark:text-gray-100 mb-2"},We={class:"space-y-1 text-sm text-gray-600 dark:text-gray-400"},Xe={class:"text-green-600 dark:text-green-400 font-semibold"},Ye={class:"text-blue-600 dark:text-blue-400 font-semibold"},et={key:1,class:"text-sm text-gray-400 dark:text-gray-500"},tt={class:"border border-gray-100 dark:border-gray-700 rounded-lg p-4"},rt={class:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2"},at={key:0},st={class:"font-bold text-gray-900 dark:text-gray-100 mb-2"},ot={class:"space-y-1 text-sm text-gray-600 dark:text-gray-400"},dt={class:"text-green-600 dark:text-green-400 font-semibold"},lt={class:"text-blue-600 dark:text-blue-400 font-semibold"},nt={key:1,class:"text-sm text-gray-400 dark:text-gray-500"},it={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},ct={class:"px-5 py-4 border-b border-gray-100 dark:border-gray-700 flex items-center justify-between"},_t={class:"flex items-center gap-2"},gt={class:"text-base font-semibold text-gray-900 dark:text-gray-100"},ut={class:"p-5"},xt={key:0,class:"text-center py-6 text-gray-400 animate-pulse"},yt={key:1,class:"grid grid-cols-2 md:grid-cols-4 gap-4"},pt={class:"text-center p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},mt={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},bt={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},ft={class:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg"},ht={class:"text-2xl font-bold text-green-600 dark:text-green-400"},vt={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},kt={class:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},wt={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},jt={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},Ct={class:"text-center p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg"},$t={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},Dt={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},tr={__name:"Dashboard",props:{metrics:{type:Object,default:()=>({})},revenue_trends:Object,top_performers:{type:Object,default:()=>({})},funnel_summary:{type:Object,default:()=>({})},filters:Object,lazyLoad:{type:Boolean,default:!1}},setup(O){const{t:a}=A(),g=O,y=h(g.filters?.date_from||""),p=h(g.filters?.date_to||""),c=h(!1),b=h({metrics:null,top_performers:null,funnel_summary:null}),n=C(()=>b.value.metrics||g.metrics||{}),d=C(()=>b.value.top_performers||g.top_performers||{}),f=C(()=>b.value.funnel_summary||g.funnel_summary||{}),u=l=>l?new Intl.NumberFormat("uz-UZ").format(l)+" so'm":"0 so'm",x=l=>l?.toFixed(1)||"0",N=l=>l>0?"text-green-600 dark:text-green-400":l<0?"text-red-600 dark:text-red-400":"text-gray-500",w=async()=>{if(g.lazyLoad){c.value=!0;try{const l={};y.value&&(l.date_from=y.value),p.value&&(l.date_to=p.value);const _=await S.get("/business/analytics/api/initial",{params:l});_.data&&(b.value={metrics:_.data.metrics,top_performers:_.data.top_performers,funnel_summary:_.data.funnel_summary})}catch(l){console.error("Analytics data loading error:",l)}finally{c.value=!1}}};R(()=>{w()});const T=()=>{w()},L=()=>{y.value="",p.value="",w()};return(l,_)=>(s(),V(U,{title:r(a)("analytics.sales_analytics")},{default:v(()=>[i(r(P),{title:r(a)("analytics.dashboard")},null,8,["title"]),e("div",G,[e("div",null,[e("h1",Q,[i(r(E),{class:"w-7 h-7 text-blue-600 dark:text-blue-400"}),m(" "+t(r(a)("analytics.sales_analytics")),1)]),e("p",W,t(r(a)("analytics.track_sales_conversion")),1)]),e("div",X,[i(r($),{href:"/business/analytics/funnel",class:"inline-flex items-center px-3 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 text-gray-700 dark:text-gray-300 text-sm font-medium rounded-lg transition-all gap-2"},{default:v(()=>[i(r(D),{class:"w-4 h-4"}),m(" "+t(r(a)("analytics.funnel")),1)]),_:1}),i(r($),{href:"/business/analytics/performance",class:"inline-flex items-center px-3 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 text-gray-700 dark:text-gray-300 text-sm font-medium rounded-lg transition-all gap-2"},{default:v(()=>[i(r(F),{class:"w-4 h-4"}),m(" "+t(r(a)("analytics.performance")),1)]),_:1})])]),e("div",Y,[e("div",ee,[e("div",te,[e("label",re,t(r(a)("reports.filter.start_date")),1),z(e("input",{"onUpdate:modelValue":_[0]||(_[0]=j=>y.value=j),type:"date",class:"w-full px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[B,y.value]])]),e("div",ae,[e("label",se,t(r(a)("reports.filter.end_date")),1),z(e("input",{"onUpdate:modelValue":_[1]||(_[1]=j=>p.value=j),type:"date",class:"w-full px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[B,p.value]])]),e("button",{onClick:T,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors"},t(r(a)("common.filter")),1),e("button",{onClick:L,class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 text-sm font-medium rounded-lg transition-colors"},t(r(a)("reports.filter.reset")),1)])]),e("div",oe,[e("div",de,[e("div",le,[e("div",ne,[i(r(H),{class:"w-5 h-5 text-green-600 dark:text-green-400"})]),e("span",ie,t(r(a)("analytics.total_revenue")),1)]),c.value?(s(),o("p",ce,"---")):(s(),o("p",_e,t(u(n.value.total_revenue)),1)),!c.value&&n.value.revenue_growth?(s(),o("p",{key:2,class:I(["text-xs mt-1",N(n.value.revenue_growth)])},[(s(),V(M(n.value.revenue_growth>0?r(J):r(K)),{class:"w-3.5 h-3.5 inline"})),m(" "+t(n.value.revenue_growth>0?"+":"")+t(x(n.value.revenue_growth))+"% "+t(r(a)("analytics.vs_previous_period")),1)],2)):k("",!0)]),e("div",ge,[e("div",ue,[e("div",xe,[i(r(Z),{class:"w-5 h-5 text-blue-600 dark:text-blue-400"})]),e("span",ye,t(r(a)("dashboard.total_leads")),1)]),c.value?(s(),o("p",pe,"---")):(s(),o("p",me,t(n.value.total_leads||0),1)),c.value?k("",!0):(s(),o("p",be,t(n.value.new_leads||0)+" "+t(r(a)("analytics.new"))+" · "+t(n.value.active_pipeline_deals||0)+" "+t(r(a)("analytics.active_pipeline")),1))]),e("div",fe,[e("div",he,[e("div",ve,[i(r(q),{class:"w-5 h-5 text-purple-600 dark:text-purple-400"})]),e("span",ke,t(r(a)("analytics.won_deals")),1)]),c.value?(s(),o("p",we,"---")):(s(),o("p",je,t(n.value.won_deals||0),1)),c.value?k("",!0):(s(),o("p",Ce,t(x(n.value.conversion_rate))+"% CR · "+t(r(a)("analytics.average"))+": "+t(u(n.value.avg_deal_size)),1))]),e("div",$e,[e("div",De,[e("div",Ve,[i(r(D),{class:"w-5 h-5 text-orange-600 dark:text-orange-400"})]),e("span",ze,t(r(a)("analytics.pipeline_value")),1)]),c.value?(s(),o("p",Be,"---")):(s(),o("p",Fe,t(u(n.value.pipeline_value)),1)),c.value?k("",!0):(s(),o("p",Oe,t(r(a)("analytics.potential_revenue")),1))])]),e("div",Ne,[e("div",Te,[i(r(F),{class:"w-5 h-5 text-yellow-500"}),e("h3",Le,t(r(a)("analytics.top_performers")),1)]),e("div",Re,[c.value?(s(),o("div",Ie,t(r(a)("dashboard.loading")),1)):(s(),o("div",Me,[e("div",Pe,[e("p",Se,t(r(a)("analytics.top_ideal_customer")),1),d.value.top_dream_buyer?(s(),o("div",Ue,[e("p",Ae,t(d.value.top_dream_buyer.dream_buyer_name),1),e("div",Ee,[e("p",null,"Leads: "+t(d.value.top_dream_buyer.total_leads),1),e("p",He," CR: "+t(x(d.value.top_dream_buyer.conversion_rate))+"% ",1),e("p",Je,t(u(d.value.top_dream_buyer.total_revenue)),1)])])):(s(),o("p",Ke,t(r(a)("reports.no_data")),1))]),e("div",Ze,[e("p",qe,t(r(a)("analytics.top_offer")),1),d.value.top_offer?(s(),o("div",Ge,[e("p",Qe,t(d.value.top_offer.offer_name),1),e("div",We,[e("p",null,"Value Score: "+t(d.value.top_offer.value_score),1),e("p",Xe," CR: "+t(x(d.value.top_offer.conversion_rate))+"% ",1),e("p",Ye,t(u(d.value.top_offer.total_revenue)),1)])])):(s(),o("p",et,t(r(a)("reports.no_data")),1))]),e("div",tt,[e("p",rt,t(r(a)("analytics.top_source")),1),d.value.top_source?(s(),o("div",at,[e("p",st,t(d.value.top_source.source_name),1),e("div",ot,[e("p",null,"Type: "+t(d.value.top_source.channel_type),1),e("p",dt," ROI: "+t(x(d.value.top_source.roi))+"% ",1),e("p",lt,t(u(d.value.top_source.total_revenue)),1)])])):(s(),o("p",nt,t(r(a)("reports.no_data")),1))])]))])]),e("div",it,[e("div",ct,[e("div",_t,[i(r(D),{class:"w-5 h-5 text-blue-500"}),e("h3",gt,t(r(a)("analytics.conversion_funnel_overview")),1)]),i(r($),{href:"/business/analytics/funnel",class:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium"},{default:v(()=>[m(t(r(a)("common.view"))+" → ",1)]),_:1})]),e("div",ut,[c.value?(s(),o("div",xt,t(r(a)("dashboard.loading")),1)):(s(),o("div",yt,[e("div",pt,[e("p",mt,t(f.value.total_leads||0),1),e("p",bt,t(r(a)("analytics.total_leads_label")),1)]),e("div",ft,[e("p",ht,t(f.value.won_leads||0),1),e("p",vt,t(r(a)("analytics.won_label")),1)]),e("div",kt,[e("p",wt,t(f.value.active_leads||0),1),e("p",jt,t(r(a)("analytics.active_label")),1)]),e("div",Ct,[e("p",$t,t(x(f.value.overall_conversion_rate))+"%",1),e("p",Dt,t(r(a)("analytics.conversion_rate_label")),1)])]))])])]),_:1},8,["title"]))}};export{tr as default};
