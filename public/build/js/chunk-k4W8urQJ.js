import{a as e,r as a,b as t,o as l,e as s,v as r,x as n,V as o,D as u,E as d,F as i,G as c,A as m,L as f,H as x,z as b,I as v,B as h,y,M as p,W as k}from"./chunk-7Urb0kxg.js";import{b as g,a as w}from"./chunk-DKkye6wf.js";import{y as j,o as C,j as _,_ as I}from"./chunk-Dm-LAqtr.js";import{_ as W}from"./chunk-DmCyVuil.js";import{u as E}from"./app-DFslr8vl.js";const M={key:0,class:"pt-3 mt-3 border-t border-gray-200 dark:border-gray-700"},$={key:0,class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},q={key:1,class:"mb-2"},z={class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},F={key:0,class:"mb-1"},H=["onClick"],L={class:"flex-1 text-left"},S={class:"mt-1 ml-4 pl-4 border-l-2 border-gray-200 dark:border-gray-700 space-y-1"},A={class:"flex-1"},B={key:0,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-emerald-500 text-white rounded-full"},D={key:1,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},G={key:2,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-orange-500 text-white rounded-full"},N={key:3,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},U={__name:"SalesHeadLayout",props:{title:{type:String,default:""}},setup(U){const{t:V}=E(),Z=g(),J=j,K=e({}),O=a({new:0,total:0}),P=a({total:0,overdue:0}),Q=a({missed:0,total:0}),R=a({unread:0,total:0}),T=a({deals:0,revenue:0});let X=null;const Y=t(()=>{return[{label:V("layout.today"),value:`${T.value.deals} ${V("layout.deals")}`,bgClass:"bg-emerald-50 dark:bg-emerald-900/30",labelClass:"text-emerald-600 dark:text-emerald-400",valueClass:"text-emerald-700 dark:text-emerald-300"},{label:V("layout.amount"),value:(e=T.value.revenue,e?new Intl.NumberFormat("uz-UZ").format(e)+" "+V("common.currency"):"0 "+V("common.currency")),bgClass:"bg-blue-50 dark:bg-blue-900/30",labelClass:"text-blue-600 dark:text-blue-400",valueClass:"text-blue-700 dark:text-blue-300"}];var e}),ee=async()=>{try{const e=await w.get("/sales-head/api/stats");e.data&&(O.value=e.data.leads||{new:0,total:0},P.value=e.data.tasks||{total:0,overdue:0},Q.value=e.data.calls||{missed:0,total:0},R.value=e.data.inbox||{unread:0,total:0},T.value=e.data.today||{deals:0,revenue:0})}catch(e){}},ae=e=>{const a=Z.url;return e.exact?a===e.href||a===e.href+"/":e.activeMatch?e.activeMatch(a):a.startsWith(e.href)};return l(()=>{J.navigation.forEach(e=>{e.items.forEach(e=>{if(e.children){const a=e.children.some(e=>Z.url.startsWith(e.href));K[e.label]=a}})}),ee(),X=setInterval(ee,3e4)}),s(()=>{X&&(clearInterval(X),X=null)}),(e,a)=>(d(),r(I,{title:U.title||m(V)("layout.home"),config:m(J),"quick-stats":Y.value},{notifications:n(()=>[y(W)]),navigation:n(()=>[(d(!0),u(i,null,c(m(J).navigation,(e,a)=>(d(),u(i,{key:a},[a>0?(d(),u("div",M,[e.title?(d(),u("p",$,x(e.title),1)):f("",!0)])):e.title?(d(),u("div",q,[b("p",z,x(e.title),1)])):f("",!0),(d(!0),u(i,null,c(e.items,e=>{return d(),u(i,{key:e.href||e.label},[e.children?(d(),u("div",F,[b("button",{onClick:a=>{return t=e.label,void(K[t]=!K[t]);var t},class:h(["w-full flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors",(a=e.children,a.some(e=>Z.url.startsWith(e.href))?"bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700/50")])},[(d(),r(p(e.icon),{class:"w-5 h-5 mr-3"})),b("span",L,x(e.label),1),y(m(C),{class:h(["w-4 h-4 transition-transform duration-200",K[e.label]?"rotate-180":""])},null,8,["class"])],10,H),v(b("div",S,[(d(!0),u(i,null,c(e.children,e=>(d(),r(_,{key:e.href,href:e.href,active:ae(e),class:"!py-1.5 !text-sm"},{default:n(()=>[b("span",null,x(e.label),1)]),_:2},1032,["href","active"]))),128))],512),[[k,K[e.label]]])])):(d(),r(_,{key:1,href:e.href,active:ae(e)},{default:n(()=>[(d(),r(p(e.icon),{class:"w-5 h-5 mr-3"})),b("span",A,x(e.label),1),"/sales-head/leads"===e.href&&O.value.new>0?(d(),u("span",B,x(O.value.new>99?"99+":O.value.new),1)):f("",!0),"/sales-head/tasks"===e.href&&P.value.overdue>0?(d(),u("span",D,x(P.value.overdue>99?"99+":P.value.overdue),1)):f("",!0),"/sales-head/calls"===e.href&&Q.value.missed>0?(d(),u("span",G,x(Q.value.missed>99?"99+":Q.value.missed),1)):f("",!0),"/sales-head/inbox"===e.href&&R.value.unread>0?(d(),u("span",N,x(R.value.unread>99?"99+":R.value.unread),1)):f("",!0)]),_:2},1032,["href","active"]))],64);var a}),128))],64))),128))]),default:n(()=>[o(e.$slots,"default")]),_:3},8,["title","config","quick-stats"]))}};export{U as _};
