import{r as e,l as t}from"./chunk-DKkye6wf.js";import{b as a,r,w as o,v as l,E as s,y as d,x as n,D as i,L as u,z as c,T as g,H as y,A as b,Q as p,I as m,J as x,F as v,G as k,K as f,O as h,P as w,B as _,_ as j,C,M as S,S as T,W as O}from"./chunk-7Urb0kxg.js";import{u as q,r as A,i as K}from"./app-DFslr8vl.js";import{r as U}from"./chunk-Rl16a4N0.js";import{e as P,b as $,f as V,o as R,m as M}from"./chunk-Dm-LAqtr.js";import{r as E}from"./chunk-ujXbNZhL.js";import{_ as F}from"./chunk-BCo6x5W8.js";import{r as N}from"./chunk-GwKSGd69.js";import{r as X}from"./chunk-DS-Zp4Qb.js";import{a as z}from"./chunk-YGW1Cp7-.js";import{r as D}from"./chunk-C3XJH04c.js";import{r as I}from"./chunk-nj8YW1QN.js";import{r as B}from"./chunk-DUcDuGHI.js";import{r as J}from"./chunk-CrCLH5wG.js";import{r as L}from"./chunk-jWGe-wOn.js";import{r as H}from"./chunk-C3pypjVL.js";import{r as W}from"./chunk-DeF73GU9.js";import{r as G}from"./chunk-afst19KZ.js";const Q={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Y={class:"flex min-h-full items-center justify-center p-4"},Z={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-lg w-full"},ee={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},te={class:"text-lg font-semibold text-gray-900 dark:text-white"},ae={key:0,class:"p-3 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm rounded-lg"},re={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},oe=["placeholder"],le={key:0,class:"mt-1 text-sm text-red-600"},se={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},de=["placeholder"],ne={class:"grid grid-cols-2 gap-4"},ie={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ue=["value"],ce={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ge=["value"],ye={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},be={key:1},pe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},me={value:""},xe=["value"],ve={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ke={class:"space-y-2 mb-2"},fe={class:"flex-1 text-sm text-gray-700 dark:text-gray-300"},he=["onClick"],we={class:"flex gap-2"},_e=["placeholder"],je={class:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-200 dark:border-gray-700"},Ce=["disabled"],Se={__name:"TodoModal",props:{show:Boolean,todo:Object,teamMembers:Array,templates:Array,types:Object,priorities:Object,panelType:{type:String,default:"business",validator:e=>["business","saleshead"].includes(e)}},emits:["close","saved"],setup(e,{emit:t}){const{t:_}=q(),j=e,C=a(()=>"saleshead"===j.panelType?"sales-head":"business"),S=t,T=r({title:"",description:"",type:"personal",priority:"medium",due_date:"",assigned_to:"",subtasks:[]}),O=r(""),$=r(!1),V=r({}),R=()=>{T.value={title:"",description:"",type:"personal",priority:"medium",due_date:"",assigned_to:"",subtasks:[]},O.value="",V.value={}};o(()=>j.todo,e=>{e?T.value={title:e.title||"",description:e.description||"",type:e.type||"personal",priority:e.priority||"medium",due_date:e.due_date?e.due_date.slice(0,16):"",assigned_to:e.assignee?.id||"",subtasks:e.subtasks?.map(e=>({title:e.title}))||[]}:R()},{immediate:!0});const M=()=>{O.value.trim()&&(T.value.subtasks.push({title:O.value.trim()}),O.value="")},F=async()=>{$.value=!0,V.value={};const e=j.todo?route(`${C.value}.todos.update`,j.todo.id):route(`${C.value}.todos.store`);try{await A();const t={title:T.value.title,description:T.value.description||null,type:T.value.type,priority:T.value.priority,due_date:T.value.due_date||null,assigned_to:T.value.assigned_to||null,subtasks:T.value.subtasks},a=j.todo?await window.axios.put(e,t):await window.axios.post(e,t);!1!==a.data.success?(S("saved"),S("close"),R()):V.value=a.data.errors||{general:a.data.error||_("todo.error_occurred")}}catch(t){if(K(t))return V.value={general:_("todo.session_expired")},void(await A());t.response?.data?.errors?V.value=t.response.data.errors:t.response?.data?.error?V.value={general:t.response.data.error}:V.value={general:_("todo.network_error")}}finally{$.value=!1}},N=()=>{S("close"),R()},X=a(()=>!!j.todo),z=a(()=>X.value?_("todo.edit_title"):_("todo.new_title"));return(t,a)=>(s(),l(w,{to:"body"},[d(g,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:n(()=>[e.show?(s(),i("div",Q,[c("div",{class:"fixed inset-0 bg-gray-500 dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-75",onClick:N}),c("div",Y,[d(g,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:n(()=>[e.show?(s(),i("div",Z,[c("div",ee,[c("h3",te,y(z.value),1),c("button",{onClick:N,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"},[d(b(U),{class:"w-5 h-5"})])]),c("form",{onSubmit:p(F,["prevent"]),class:"p-6 space-y-4"},[V.value.general?(s(),i("div",ae,y(V.value.general),1)):u("",!0),c("div",null,[c("label",re,y(b(_)("todo.title_label"))+" * ",1),m(c("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>T.value.title=e),type:"text",required:"",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:b(_)("todo.title_placeholder")},null,8,oe),[[x,T.value.title]]),V.value.title?(s(),i("p",le,y(V.value.title[0]),1)):u("",!0)]),c("div",null,[c("label",se,y(b(_)("todo.description_label")),1),m(c("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>T.value.description=e),rows:"3",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:b(_)("todo.description_placeholder")},null,8,de),[[x,T.value.description]])]),c("div",ne,[c("div",null,[c("label",ie,y(b(_)("todo.type_label")),1),m(c("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>T.value.type=e),class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[(s(!0),i(v,null,k(e.types,(e,t)=>(s(),i("option",{key:t,value:t},y(e),9,ue))),128))],512),[[f,T.value.type]])]),c("div",null,[c("label",ce,y(b(_)("todo.priority_label")),1),m(c("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>T.value.priority=e),class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[(s(!0),i(v,null,k(e.priorities,(e,t)=>(s(),i("option",{key:t,value:t},y(e),9,ge))),128))],512),[[f,T.value.priority]])])]),c("div",null,[c("label",ye,y(b(_)("todo.due_date_label")),1),m(c("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>T.value.due_date=e),type:"datetime-local",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,T.value.due_date]])]),e.teamMembers&&e.teamMembers.length>0?(s(),i("div",be,[c("label",pe,y(b(_)("todo.assignee_label")),1),m(c("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>T.value.assigned_to=e),class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[c("option",me,y(b(_)("todo.assignee_self")),1),(s(!0),i(v,null,k(e.teamMembers,e=>(s(),i("option",{key:e.id,value:e.id},y(e.name)+" ("+y(e.role)+") ",9,xe))),128))],512),[[f,T.value.assigned_to]])])):u("",!0),c("div",null,[c("label",ve,y(b(_)("todo.subtasks_label")),1),c("div",ke,[(s(!0),i(v,null,k(T.value.subtasks,(e,t)=>(s(),i("div",{key:t,class:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700 rounded-lg"},[c("span",fe,y(e.title),1),c("button",{type:"button",onClick:e=>(e=>{T.value.subtasks.splice(e,1)})(t),class:"p-1 text-gray-400 hover:text-red-500"},[d(b(P),{class:"w-4 h-4"})],8,he)]))),128))]),c("div",we,[m(c("input",{"onUpdate:modelValue":a[6]||(a[6]=e=>O.value=e),type:"text",onKeyup:h(M,["enter"]),class:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",placeholder:b(_)("todo.new_subtask")},null,40,_e),[[x,O.value]]),c("button",{type:"button",onClick:M,class:"px-3 py-2 bg-gray-100 dark:bg-gray-600 text-gray-600 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-500"},[d(b(E),{class:"w-5 h-5"})])])])],32),c("div",je,[c("button",{type:"button",onClick:N,class:"px-4 py-2.5 text-gray-700 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},y(b(_)("common.cancel")),1),c("button",{onClick:F,disabled:$.value,class:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl transition-colors disabled:opacity-50"},y($.value?b(_)("todo.saving"):b(_)("common.save")),9,Ce)])])):u("",!0)]),_:1})])])):u("",!0)]),_:1})]))}},Te={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Oe={class:"flex min-h-full items-center justify-center p-4"},qe={key:0,class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full"},Ae={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Ke={class:"text-lg font-semibold text-gray-900 dark:text-white"},Ue={key:0,class:"p-3 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-sm rounded-lg"},Pe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},$e={class:"grid grid-cols-4 gap-2"},Ve=["onClick"],Re={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Me={key:1},Ee={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Fe={class:"flex gap-2"},Ne=["onClick"],Xe={key:2},ze={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},De=["placeholder"],Ie={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Be={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Je={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Le={class:"space-y-2"},He=["value"],We={class:"text-sm text-gray-700 dark:text-gray-300"},Ge={class:"flex items-center justify-between px-6 py-4 border-t border-gray-200 dark:border-gray-700"},Qe={class:"flex items-center gap-3"},Ye=["disabled"],Ze={__name:"RecurrenceModal",props:{show:Boolean,todo:Object,panelType:{type:String,default:"business",validator:e=>["business","saleshead"].includes(e)}},emits:["close","saved"],setup(e,{emit:t}){const{t:f}=q(),h=e,C=a(()=>"saleshead"===h.panelType?"sales-head":"business"),S=t,T=r({frequency:"daily",interval:1,days_of_week:[],day_of_month:null,start_date:"",end_date:"",generation_mode:"on_time"}),O=r(!1),P=r({}),$=a(()=>({daily:f("todos.recurrence.daily"),weekly:f("todos.recurrence.weekly"),monthly:f("todos.recurrence.monthly"),yearly:f("todos.recurrence.yearly")})),V=a(()=>[{value:1,label:f("todos.recurrence.day_mon")},{value:2,label:f("todos.recurrence.day_tue")},{value:3,label:f("todos.recurrence.day_wed")},{value:4,label:f("todos.recurrence.day_thu")},{value:5,label:f("todos.recurrence.day_fri")},{value:6,label:f("todos.recurrence.day_sat")},{value:7,label:f("todos.recurrence.day_sun")}]),R=a(()=>({on_time:f("todos.recurrence.on_time"),advance:f("todos.recurrence.advance")})),M=()=>(new Date).toISOString().split("T")[0],E=()=>{T.value={frequency:"daily",interval:1,days_of_week:[],day_of_month:null,start_date:M(),end_date:"",generation_mode:"on_time"},P.value={}};o(()=>h.todo,e=>{if(e?.recurrence){const t=e.recurrence;T.value={frequency:t.frequency||"daily",interval:t.interval||1,days_of_week:t.days_of_week||[],day_of_month:t.day_of_month||null,start_date:t.start_date||M(),end_date:t.end_date||"",generation_mode:t.generation_mode||"on_time"}}else E()},{immediate:!0});const F=async()=>{O.value=!0,P.value={};const e=h.todo?.recurrence?route(`${C.value}.todo-recurrences.update`,h.todo.recurrence.id):route(`${C.value}.todos.recurrence.store`,h.todo.id);try{await A();const t={frequency:T.value.frequency,interval:T.value.interval,days_of_week:"weekly"===T.value.frequency?T.value.days_of_week:null,day_of_month:"monthly"===T.value.frequency?T.value.day_of_month:null,start_date:T.value.start_date,end_date:T.value.end_date||null,generation_mode:T.value.generation_mode},a=h.todo?.recurrence?await window.axios.put(e,t):await window.axios.post(e,t);!1!==a.data.success?(S("saved"),S("close"),E()):P.value=a.data.errors||{general:a.data.error||f("common.error")}}catch(t){if(K(t))return P.value={general:f("todos.recurrence.session_expired")},void(await A());t.response?.data?.errors?P.value=t.response.data.errors:t.response?.data?.error?P.value={general:t.response.data.error}:P.value={general:f("todos.recurrence.network_error")}}finally{O.value=!1}},N=async()=>{if(h.todo?.recurrence&&confirm(f("todos.recurrence.delete_confirm")))try{await A();!1!==(await window.axios.delete(route(`${C.value}.todo-recurrences.destroy`,h.todo.recurrence.id))).data.success&&(S("saved"),S("close"))}catch(e){K(e)&&(P.value={general:f("todos.recurrence.session_expired")},await A())}},X=()=>{S("close"),E()},z=a(()=>!!h.todo?.recurrence),D=a(()=>z.value?f("todos.recurrence.edit_title"):f("todos.recurrence.title")),I=a(()=>({daily:f("todos.recurrence.interval_day"),weekly:f("todos.recurrence.interval_week"),monthly:f("todos.recurrence.interval_month"),yearly:f("todos.recurrence.interval_year")}[T.value.frequency]||""));return(t,a)=>(s(),l(w,{to:"body"},[d(g,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:n(()=>[e.show?(s(),i("div",Te,[c("div",{class:"fixed inset-0 bg-gray-500 dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-75",onClick:X}),c("div",Oe,[d(g,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:n(()=>[e.show?(s(),i("div",qe,[c("div",Ae,[c("h3",Ke,y(D.value),1),c("button",{onClick:X,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"},[d(b(U),{class:"w-5 h-5"})])]),c("form",{onSubmit:p(F,["prevent"]),class:"p-6 space-y-4"},[P.value.general?(s(),i("div",Ue,y(P.value.general),1)):u("",!0),c("div",null,[c("label",Pe,y(b(f)("todos.recurrence.frequency")),1),c("div",$e,[(s(!0),i(v,null,k($.value,(e,t)=>(s(),i("button",{key:t,type:"button",onClick:e=>T.value.frequency=t,class:_(["px-3 py-2 text-sm font-medium rounded-lg transition-colors",T.value.frequency===t?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},y(e),11,Ve))),128))])]),c("div",null,[c("label",Re,y(b(f)("todos.recurrence.every"))+" "+y(I.value),1),m(c("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>T.value.interval=e),type:"number",min:"1",max:"365",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,T.value.interval,void 0,{number:!0}]])]),"weekly"===T.value.frequency?(s(),i("div",Me,[c("label",Ee,y(b(f)("todos.recurrence.days")),1),c("div",Fe,[(s(!0),i(v,null,k(V.value,e=>(s(),i("button",{key:e.value,type:"button",onClick:t=>(e=>{const t=T.value.days_of_week.indexOf(e);t>-1?T.value.days_of_week.splice(t,1):(T.value.days_of_week.push(e),T.value.days_of_week.sort((e,t)=>e-t))})(e.value),class:_(["w-10 h-10 text-sm font-medium rounded-lg transition-colors",T.value.days_of_week.includes(e.value)?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},y(e.label),11,Ne))),128))])])):u("",!0),"monthly"===T.value.frequency?(s(),i("div",Xe,[c("label",ze,y(b(f)("todos.recurrence.day_of_month")),1),m(c("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>T.value.day_of_month=e),type:"number",min:"1",max:"31",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:b(f)("todos.recurrence.day_of_month_placeholder")},null,8,De),[[x,T.value.day_of_month,void 0,{number:!0}]])])):u("",!0),c("div",null,[c("label",Ie,y(b(f)("todos.recurrence.start_date")),1),m(c("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>T.value.start_date=e),type:"date",required:"",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,T.value.start_date]])]),c("div",null,[c("label",Be,y(b(f)("todos.recurrence.end_date")),1),m(c("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>T.value.end_date=e),type:"date",class:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[x,T.value.end_date]])]),c("div",null,[c("label",Je,y(b(f)("todos.recurrence.generation_time")),1),c("div",Le,[(s(!0),i(v,null,k(R.value,(e,t)=>(s(),i("label",{key:t,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[m(c("input",{type:"radio","onUpdate:modelValue":a[4]||(a[4]=e=>T.value.generation_mode=e),value:t,class:"text-blue-600 focus:ring-blue-500"},null,8,He),[[j,T.value.generation_mode]]),c("span",We,y(e),1)]))),128))])])],32),c("div",Ge,[c("div",null,[z.value?(s(),i("button",{key:0,type:"button",onClick:N,class:"text-sm text-red-600 hover:text-red-700 font-medium"},y(b(f)("common.delete")),1)):u("",!0)]),c("div",Qe,[c("button",{type:"button",onClick:X,class:"px-4 py-2.5 text-gray-700 dark:text-gray-300 font-medium rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},y(b(f)("common.cancel")),1),c("button",{onClick:F,disabled:O.value,class:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl transition-colors disabled:opacity-50"},y(O.value?b(f)("common.saving")+"...":b(f)("common.save")),9,Ye)])])])):u("",!0)]),_:1})])])):u("",!0)]),_:1})]))}},et={class:"flex min-h-screen items-start justify-center p-4 pt-16"},tt={class:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl z-10"},at={class:"p-6"},rt={class:"flex items-start gap-4 mb-6"},ot=["disabled"],lt={class:"flex-1"},st={class:"flex items-center flex-wrap gap-2 mt-2"},dt={class:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-sm"},nt={key:1,class:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 text-sm"},it={key:0,class:"mb-6 p-4 bg-purple-50 dark:bg-purple-900/20 rounded-xl border border-purple-200 dark:border-purple-800/30"},ut={class:"flex items-center justify-between mb-3"},ct={class:"font-semibold text-purple-800 dark:text-purple-300 flex items-center gap-2"},gt={class:"text-sm font-bold text-purple-700 dark:text-purple-400"},yt={class:"h-2 bg-purple-200 dark:bg-purple-800/50 rounded-full overflow-hidden mb-3"},bt={class:"space-y-2"},pt={class:"flex items-center gap-2"},mt={class:"text-sm text-gray-700 dark:text-gray-300"},xt={class:"flex items-center gap-2"},vt={key:0,class:"text-xs text-green-600 dark:text-green-400"},kt={key:2,class:"w-5 h-5 rounded-full border-2 border-gray-300 dark:border-gray-600"},ft={key:0,class:"mt-3 flex items-center gap-2 text-sm text-amber-600 dark:text-amber-400"},ht={class:"mb-6"},wt={class:"text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2"},_t=["placeholder"],jt={key:1,class:"text-gray-700 dark:text-gray-300"},Ct={key:1,class:"grid grid-cols-2 gap-4 mb-6"},St={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Tt=["value"],Ot={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},qt=["value"],At={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Kt={key:0},Ut={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Pt={value:""},$t=["value"],Vt={key:1,class:"col-span-2"},Rt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Mt={class:"flex flex-wrap gap-2"},Et=["onClick"],Ft={key:2,class:"mb-6"},Nt={class:"space-y-2"},Xt=["onClick"],zt={class:"mb-6"},Dt={class:"flex gap-2"},It=["placeholder"],Bt=["disabled"],Jt={class:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700"},Lt={class:"text-xs text-gray-500 dark:text-gray-400"},Ht={class:"flex items-center gap-2"},Wt=["disabled"],Gt=F({__name:"TodoDetailModal",props:{show:Boolean,todo:Object,teamMembers:Array,types:Object,priorities:Object},emits:["close","update","delete","toggle","toggleSubtask","addSubtask"],setup(e,{emit:t}){const{t:j}=q(),A=e,K=t,M=r(!1),F=r({}),L=r(""),H=r(!0),W=r(!1);o(()=>A.todo,e=>{e&&(F.value={title:e.title,description:e.description||"",type:e.type,priority:e.priority,due_date:e.due_date?e.due_date.substring(0,16):"",assigned_to:e.assignee?.id||"",assignee_ids:e.assignees?.map(e=>e.user_id)||[]})},{immediate:!0});const G={urgent:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-400",border:"border-red-500"},high:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-400",border:"border-orange-500"},medium:{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-400",border:"border-yellow-500"},low:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-400",border:"border-green-500"}},Q={personal:V,team:X,process:$},Y=a(()=>"completed"===A.todo?.status),Z=a(()=>A.todo?.is_team_task),ee=()=>{M.value=!1,K("close")},te=()=>{M.value=!0},ae=()=>{M.value=!1,A.todo&&(F.value={title:A.todo.title,description:A.todo.description||"",type:A.todo.type,priority:A.todo.priority,due_date:A.todo.due_date?A.todo.due_date.substring(0,16):"",assigned_to:A.todo.assignee?.id||"",assignee_ids:A.todo.assignees?.map(e=>e.user_id)||[]})},re=async()=>{W.value=!0;try{await K("update",A.todo.id,F.value),M.value=!1}finally{W.value=!1}},oe=()=>{K("toggle",A.todo)},le=()=>{confirm(j("todos.detail.delete_confirm"))&&K("delete",A.todo)},se=()=>{L.value.trim()&&(K("addSubtask",A.todo,L.value.trim()),L.value="")};return(t,a)=>(s(),l(w,{to:"body"},[d(g,{name:"modal"},{default:n(()=>[e.show&&e.todo?(s(),i("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:p(ee,["self"])},[c("div",et,[c("div",{class:"fixed inset-0 bg-black/60",onClick:ee}),c("div",tt,[c("div",{class:_(["h-2 rounded-t-2xl",G[e.todo.priority]?.border?`bg-${"urgent"===e.todo.priority?"red":"high"===e.todo.priority?"orange":"medium"===e.todo.priority?"yellow":"green"}-500`:"bg-gray-400"])},null,2),c("div",at,[c("div",rt,[c("button",{onClick:oe,disabled:Z.value&&!e.todo.can_complete,class:_(["flex-shrink-0 w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all mt-1",Y.value?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-green-400",Z.value&&!e.todo.can_complete?"opacity-50 cursor-not-allowed":""])},[Y.value?(s(),l(b(N),{key:0,class:"w-5 h-5"})):u("",!0)],10,ot),c("div",lt,[M.value?m((s(),i("input",{key:0,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value.title=e),type:"text",class:"w-full text-xl font-bold bg-transparent border-b-2 border-blue-500 text-gray-900 dark:text-white focus:outline-none pb-1"},null,512)),[[x,F.value.title]]):(s(),i("h2",{key:1,class:_(["text-xl font-bold text-gray-900 dark:text-white",Y.value?"line-through text-gray-500":""])},y(e.todo.title),3)),c("div",st,[c("span",dt,[(s(),l(S(Q[e.todo.type]),{class:"w-4 h-4"})),C(" "+y(e.todo.type_label),1)]),c("span",{class:_(["px-2.5 py-1 rounded-lg text-sm font-medium",G[e.todo.priority]?.bg,G[e.todo.priority]?.text])},y(e.todo.priority_label),3),e.todo.due_date_formatted?(s(),i("span",{key:0,class:_(["inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-sm",e.todo.is_overdue?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"])},[d(b(z),{class:"w-4 h-4"}),C(" "+y(e.todo.due_date_formatted),1)],2)):u("",!0),e.todo.is_recurring?(s(),i("span",nt,[d(b($),{class:"w-4 h-4"}),C(" "+y(e.todo.recurrence?.frequency_label),1)])):u("",!0)])]),c("button",{onClick:ee,class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"},[d(b(U),{class:"w-6 h-6"})])]),Z.value?(s(),i("div",it,[c("div",ut,[c("h3",ct,[d(b(X),{class:"w-5 h-5"}),C(" "+y(b(j)("todos.detail.team_progress")),1)]),c("span",gt,y(e.todo.completed_assignees_count)+"/"+y(e.todo.assignees_count)+" "+y(b(j)("todos.detail.completed")),1)]),c("div",yt,[c("div",{style:T({width:`${e.todo.team_progress}%`}),class:"h-full bg-purple-500 transition-all duration-300"},null,4)]),c("div",bt,[(s(!0),i(v,null,k(e.todo.assignees,e=>(s(),i("div",{key:e.id,class:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-lg"},[c("div",pt,[c("div",{class:_(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold",e.is_completed?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"])},y(e.user?.name?.charAt(0).toUpperCase()),3),c("span",mt,y(e.user?.name),1)]),c("div",xt,[e.is_completed?(s(),i("span",vt,y(e.completed_at),1)):u("",!0),e.is_completed?(s(),l(b(N),{key:1,class:"w-5 h-5 text-green-500"})):(s(),i("div",kt))])]))),128))]),!e.todo.is_team_completed&&e.todo.assignees_count>0?(s(),i("div",ft,[d(b(D),{class:"w-4 h-4"}),C(" "+y(b(j)("todos.detail.team_incomplete_warning")),1)])):u("",!0)])):u("",!0),c("div",ht,[c("h3",wt,y(b(j)("todos.detail.description")),1),M.value?m((s(),i("textarea",{key:0,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value.description=e),rows:"3",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white resize-none",placeholder:b(j)("todos.detail.description_placeholder")},null,8,_t)),[[x,F.value.description]]):(s(),i("p",jt,y(e.todo.description||b(j)("todos.detail.no_description")),1))]),M.value?(s(),i("div",Ct,[c("div",null,[c("label",St,y(b(j)("todos.detail.type")),1),m(c("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>F.value.type=e),class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"},[(s(!0),i(v,null,k(e.types,(e,t)=>(s(),i("option",{key:t,value:t},y(e),9,Tt))),128))],512),[[f,F.value.type]])]),c("div",null,[c("label",Ot,y(b(j)("todos.detail.priority")),1),m(c("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>F.value.priority=e),class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"},[(s(!0),i(v,null,k(e.priorities,(e,t)=>(s(),i("option",{key:t,value:t},y(e),9,qt))),128))],512),[[f,F.value.priority]])]),c("div",null,[c("label",At,y(b(j)("todos.detail.due_date")),1),m(c("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>F.value.due_date=e),type:"datetime-local",class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"},null,512),[[x,F.value.due_date]])]),"team"!==F.value.type?(s(),i("div",Kt,[c("label",Ut,y(b(j)("todos.detail.assign_to")),1),m(c("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>F.value.assigned_to=e),class:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white"},[c("option",Pt,y(b(j)("common.select")),1),(s(!0),i(v,null,k(e.teamMembers,e=>(s(),i("option",{key:e.id,value:e.id},y(e.name),9,$t))),128))],512),[[f,F.value.assigned_to]])])):u("",!0),"team"===F.value.type?(s(),i("div",Vt,[c("label",Rt,y(b(j)("todos.detail.team_members")),1),c("div",Mt,[(s(!0),i(v,null,k(e.teamMembers,e=>(s(),i("button",{key:e.id,onClick:t=>(e=>{const t=F.value.assignee_ids.indexOf(e);t>-1?F.value.assignee_ids.splice(t,1):F.value.assignee_ids.push(e)})(e.id),class:_(["px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",F.value.assignee_ids.includes(e.id)?"bg-purple-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},y(e.name),11,Et))),128))])])):u("",!0)])):u("",!0),e.todo.subtasks&&e.todo.subtasks.length>0?(s(),i("div",Ft,[c("button",{onClick:a[6]||(a[6]=e=>H.value=!H.value),class:"flex items-center gap-2 text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3 hover:text-gray-700 dark:hover:text-gray-200"},[(s(),l(S(H.value?b(I):b(R)),{class:"w-4 h-4"})),C(" "+y(b(j)("todos.detail.subtasks"))+" ("+y(e.todo.completed_subtasks_count)+"/"+y(e.todo.subtasks_count)+") ",1)]),m(c("div",Nt,[(s(!0),i(v,null,k(e.todo.subtasks,e=>(s(),i("div",{key:e.id,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[c("button",{onClick:t=>(e=>{K("toggleSubtask",A.todo,e)})(e),class:_(["flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",e.is_completed?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-green-400"])},[e.is_completed?(s(),l(b(B),{key:0,class:"w-3 h-3"})):u("",!0)],10,Xt),c("span",{class:_(["text-sm",e.is_completed?"line-through text-gray-400":"text-gray-700 dark:text-gray-300"])},y(e.title),3)]))),128))],512),[[O,H.value]])])):u("",!0),c("div",zt,[c("div",Dt,[m(c("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>L.value=e),type:"text",placeholder:b(j)("todos.detail.add_subtask_placeholder"),onKeyup:h(se,["enter"]),class:"flex-1 px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white text-sm"},null,40,It),[[x,L.value]]),c("button",{onClick:se,disabled:!L.value.trim(),class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg transition-colors"},[d(b(E),{class:"w-5 h-5"})],8,Bt)])]),c("div",Jt,[c("div",Lt,y(b(j)("todos.detail.created"))+": "+y(e.todo.created_at),1),c("div",Ht,[M.value?(s(),i(v,{key:0},[c("button",{onClick:ae,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},y(b(j)("common.cancel")),1),c("button",{onClick:re,disabled:W.value,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors"},y(W.value?b(j)("common.saving")+"...":b(j)("common.save")),9,Wt)],64)):(s(),i(v,{key:1},[c("button",{onClick:le,class:"p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"},[d(b(P),{class:"w-5 h-5"})]),c("button",{onClick:te,class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-medium rounded-lg transition-colors flex items-center gap-2"},[d(b(J),{class:"w-4 h-4"}),C(" "+y(b(j)("common.edit")),1)])],64))])])])])])])):u("",!0)]),_:1})]))}},[["__scopeId","data-v-8996e677"]]),Qt={class:"h-full flex flex-col -m-4 sm:-m-6 lg:-m-8"},Yt={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 lg:px-8 py-4"},Zt={class:"flex items-center justify-between"},ea={class:"text-2xl font-bold text-gray-900 dark:text-white"},ta={class:"text-sm text-gray-500 dark:text-gray-400 mt-1"},aa={class:"flex items-center gap-3"},ra={class:"flex items-center gap-4 mt-4"},oa={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},la=["onClick"],sa={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},da=["onClick"],na={class:"flex items-center gap-4 ml-auto text-sm"},ia={class:"flex items-center gap-1.5 text-red-600 dark:text-red-400"},ua={class:"font-semibold"},ca={class:"text-gray-500 dark:text-gray-400"},ga={class:"flex items-center gap-1.5 text-green-600 dark:text-green-400"},ya={class:"font-semibold"},ba={class:"text-gray-500 dark:text-gray-400"},pa={class:"flex-1 overflow-x-auto p-4 sm:p-6"},ma={class:"flex gap-4 h-full min-w-max"},xa={class:"p-3 flex items-center gap-2"},va={class:"font-semibold text-gray-700 dark:text-gray-300 text-sm"},ka={class:"ml-auto text-xs font-bold px-2 py-0.5 bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-full"},fa={class:"flex-1 overflow-y-auto p-2 space-y-2"},ha=["onClick"],wa={class:"flex items-start gap-2 mb-2"},_a={class:"flex-1 min-w-0"},ja={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-2"},Ca=["onClick"],Sa={class:"flex items-center flex-wrap gap-1.5 mt-2"},Ta={key:0,class:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400"},Oa={key:0,class:"mt-3"},qa={class:"flex items-center justify-between text-xs mb-1"},Aa={class:"text-gray-500 dark:text-gray-400"},Ka={class:"font-medium text-gray-700 dark:text-gray-300"},Ua={class:"h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Pa={class:"flex items-center mt-2 -space-x-1"},$a=["title"],Va={key:0,class:"w-6 h-6 rounded-full border-2 border-white dark:border-gray-800 bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-xs font-medium text-gray-600 dark:text-gray-400"},Ra={key:1,class:"mt-3"},Ma={class:"flex items-center justify-between text-xs mb-1"},Ea={class:"text-gray-500 dark:text-gray-400"},Fa={class:"font-medium text-gray-700 dark:text-gray-300"},Na={class:"h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Xa={class:"flex items-center justify-between mt-3 pt-2 border-t border-gray-100 dark:border-gray-700"},za={key:1,class:"text-xs text-gray-400"},Da={key:2,class:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400"},Ia={class:"w-5 h-5 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center text-xs font-medium text-gray-700 dark:text-gray-300"},Ba={key:0,class:"text-center py-8 text-gray-400 dark:text-gray-500"},Ja={class:"text-sm"},La={class:"p-2 border-t border-gray-200 dark:border-gray-700"},Ha=F({__name:"TodosIndex",props:{todos:Object,stats:Object,teamMembers:Array,templates:Array,types:Object,priorities:Object,statuses:Object,filter:String,statusFilter:String,panelType:{type:String,default:"business",validator:e=>["business","saleshead","marketing","finance","operator","hr"].includes(e)}},setup(g){const{t:p}=q(),m=g,x=a(()=>({business:{primaryColor:"blue",routePrefix:"business",buttonClass:"bg-blue-600 hover:bg-blue-700 shadow-blue-500/25",templatesRoute:"business.todo-templates.index"},saleshead:{primaryColor:"emerald",routePrefix:"sales-head",buttonClass:"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-500/25",templatesRoute:"sales-head.todo-templates.index"},marketing:{primaryColor:"blue",routePrefix:"marketing",buttonClass:"bg-blue-600 hover:bg-blue-700 shadow-blue-500/25",templatesRoute:"marketing.todo-templates.index"},finance:{primaryColor:"green",routePrefix:"finance",buttonClass:"bg-green-600 hover:bg-green-700 shadow-green-500/25",templatesRoute:"finance.todo-templates.index"},operator:{primaryColor:"blue",routePrefix:"operator",buttonClass:"bg-blue-600 hover:bg-blue-700 shadow-blue-500/25",templatesRoute:"operator.todo-templates.index"},hr:{primaryColor:"purple",routePrefix:"hr",buttonClass:"bg-purple-600 hover:bg-purple-700 shadow-purple-500/25",templatesRoute:"hr.todo-templates.index"}}[m.panelType])),f=r(!1),h=r(!1),w=r(!1),j=r(null),O=r(null),A=r(null),K=r(m.filter||"all"),U=r(m.statusFilter||"active"),P=r(null),R=[{key:"overdue",labelKey:"todos.columns.overdue",color:"red",icon:D},{key:"today",labelKey:"todos.columns.today",color:"blue",icon:G},{key:"tomorrow",labelKey:"todos.columns.tomorrow",color:"indigo",icon:z},{key:"this_week",labelKey:"todos.columns.this_week",color:"purple",icon:z},{key:"later",labelKey:"todos.columns.later",color:"gray",icon:z}],F=[{value:"all",labelKey:"todos.filters.all"},{value:"personal",labelKey:"todos.filters.personal"},{value:"team",labelKey:"todos.filters.team"},{value:"process",labelKey:"todos.filters.process"}],N=[{value:"active",labelKey:"todos.status.active"},{value:"completed",labelKey:"todos.status.completed"},{value:"all",labelKey:"todos.status.all"}];o([K,U],()=>{e.get(route(`${x.value.routePrefix}.todos.index`),{filter:K.value,status:U.value},{preserveState:!0,preserveScroll:!0})});const X=(e=null)=>{j.value=e,f.value=!0},I=()=>{f.value=!1,j.value=null},J=()=>{h.value=!1,A.value=null},Q=()=>{w.value=!1,O.value=null},Y=()=>{e.reload({preserveScroll:!0})},Z=()=>{e.reload({preserveScroll:!0})},ee=async(t,a)=>{try{const r=await fetch(route(`${x.value.routePrefix}.todos.update`,t),{method:"PUT",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});if(r.ok){const t=await r.json();O.value=t.todo,e.reload({preserveScroll:!0})}}catch(r){}},te=async t=>{try{(await fetch(route(`${x.value.routePrefix}.todos.destroy`,t.id),{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}})).ok&&(Q(),e.reload({preserveScroll:!0}))}catch(a){}},ae=async t=>{try{const a=await fetch(route(`${x.value.routePrefix}.todos.toggle`,t.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}});if(a.ok){const t=await a.json();O.value=t.todo,e.reload({preserveScroll:!0})}}catch(a){}},re=async(t,a)=>{try{if((await fetch(route(`${x.value.routePrefix}.todos.subtasks.toggle`,[t.id,a.id]),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}})).ok){const a=await fetch(route(`${x.value.routePrefix}.todos.show`,t.id),{headers:{Accept:"application/json"}});if(a.ok){const e=await a.json();O.value=e.todo}e.reload({preserveScroll:!0})}}catch(r){}},oe=async(t,a)=>{try{if((await fetch(route(`${x.value.routePrefix}.todos.subtasks.store`,t.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({title:a})})).ok){const a=await fetch(route(`${x.value.routePrefix}.todos.show`,t.id),{headers:{Accept:"application/json"}});if(a.ok){const e=await a.json();O.value=e.todo}e.reload({preserveScroll:!0})}}catch(r){}},le=e=>{const t={urgent:"bg-red-500",high:"bg-orange-500",medium:"bg-yellow-500",low:"bg-green-500"};return t[e]||t.medium},se=e=>{const t={urgent:"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-400",high:"bg-orange-100 text-orange-700 dark:bg-orange-900/50 dark:text-orange-400",medium:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/50 dark:text-yellow-400",low:"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400"};return t[e]||t.medium},de=e=>{const t={red:"bg-red-500",blue:"bg-blue-500",indigo:"bg-indigo-500",purple:"bg-purple-500",gray:"bg-gray-500"};return t[e]||t.gray},ne=e=>m.todos[e]||[],ie=e=>ne(e).length,ue=a(()=>{try{return route(x.value.templatesRoute),!0}catch{return!1}});return(a,r)=>(s(),i(v,null,[c("div",Qt,[c("div",Yt,[c("div",Zt,[c("div",null,[c("h1",ea,y(b(p)("todos.title")),1),c("p",ta,y(b(p)("todos.active_count",{count:g.stats.total})),1)]),c("div",aa,[ue.value?(s(),l(b(t),{key:0,href:a.route(x.value.templatesRoute),class:"inline-flex items-center gap-2 px-4 py-2.5 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 font-medium rounded-xl transition-colors"},{default:n(()=>[d(b(L),{class:"w-5 h-5"}),C(" "+y(b(p)("todos.templates")),1)]),_:1},8,["href"])):u("",!0),c("button",{onClick:r[0]||(r[0]=e=>X()),class:_(["inline-flex items-center gap-2 px-4 py-2.5 text-white font-medium rounded-xl transition-colors shadow-lg",x.value.buttonClass])},[d(b(E),{class:"w-5 h-5"}),C(" "+y(b(p)("todos.new_task")),1)],2)])]),c("div",ra,[c("div",oa,[(s(),i(v,null,k(F,e=>c("button",{key:e.value,onClick:t=>K.value=e.value,class:_(["px-4 py-2 text-sm font-medium rounded-md transition-colors",K.value===e.value?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])},y(b(p)(e.labelKey)),11,la)),64))]),c("div",sa,[(s(),i(v,null,k(N,e=>c("button",{key:e.value,onClick:t=>U.value=e.value,class:_(["px-4 py-2 text-sm font-medium rounded-md transition-colors",U.value===e.value?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])},y(b(p)(e.labelKey)),11,da)),64))]),c("div",na,[c("div",ia,[d(b(D),{class:"w-4 h-4"}),c("span",ua,y(g.stats.overdue),1),c("span",ca,y(b(p)("todos.stats.overdue")),1)]),c("div",ga,[d(b(B),{class:"w-4 h-4"}),c("span",ya,y(g.stats.completed_today),1),c("span",ba,y(b(p)("todos.stats.completed_today")),1)])])])]),c("div",pa,[c("div",ma,[(s(),i(v,null,k(R,t=>c("div",{key:t.key,class:"flex flex-col w-80 bg-gray-100 dark:bg-gray-800/50 rounded-xl"},[c("div",xa,[c("div",{class:_(["w-2 h-2 rounded-full",de(t.color)])},null,2),c("h3",va,y(b(p)(t.labelKey)),1),c("span",ka,y(ie(t.key)),1)]),c("div",fa,[(s(!0),i(v,null,k(ne(t.key),t=>(s(),i("div",{key:t.id,onClick:e=>(async e=>{P.value=e.id;try{const t=await fetch(route(`${x.value.routePrefix}.todos.show`,e.id),{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(t.ok){const e=await t.json();O.value=e.todo,w.value=!0}}catch(t){}finally{P.value=null}})(t),class:_(["bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-3 cursor-pointer transition-all hover:shadow-md hover:border-gray-300 dark:hover:border-gray-600",P.value===t.id?"opacity-50":"","completed"===t.status?"opacity-60":""])},[c("div",wa,[c("div",{class:_(["w-1 h-full min-h-[20px] rounded-full",le(t.priority)])},null,2),c("div",_a,[c("h4",{class:_(["font-medium text-gray-900 dark:text-white text-sm leading-snug","completed"===t.status?"line-through text-gray-500 dark:text-gray-500":""])},y(t.title),3),t.description?(s(),i("p",ja,y(t.description),1)):u("",!0)]),c("button",{onClick:a=>(async(t,a)=>{a?.stopPropagation();try{(await fetch(route(`${x.value.routePrefix}.todos.toggle`,t.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}})).ok&&e.reload({preserveScroll:!0})}catch(r){}})(t,a),class:_(["flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-all","completed"===t.status?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-green-400 hover:bg-green-50 dark:hover:bg-green-900/20"])},["completed"===t.status?(s(),l(b(H),{key:0,class:"w-3 h-3"})):u("",!0)],10,Ca)]),c("div",Sa,[c("span",{class:_(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs","team"===t.type?"bg-purple-100 text-purple-700 dark:bg-purple-900/50 dark:text-purple-400":"process"===t.type?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"])},["team"===t.type?(s(),l(b(M),{key:0,class:"w-3 h-3"})):"process"===t.type?(s(),l(b(W),{key:1,class:"w-3 h-3"})):(s(),l(b(V),{key:2,class:"w-3 h-3"})),C(" "+y(t.type_label),1)],2),c("span",{class:_(["px-1.5 py-0.5 rounded text-xs font-medium",se(t.priority)])},y(t.priority_label),3),t.is_recurring?(s(),i("span",Ta,[d(b($),{class:"w-3 h-3"})])):u("",!0)]),"team"===t.type&&t.assignees&&t.assignees.length>0?(s(),i("div",Oa,[c("div",qa,[c("span",Aa,y(b(p)("todos.team_progress")),1),c("span",Ka,y(t.completed_assignees_count||0)+"/"+y(t.assignees_count||t.assignees.length),1)]),c("div",Ua,[c("div",{style:T({width:`${t.team_progress||0}%`}),class:_(["h-full transition-all duration-300",100===(t.team_progress||0)?"bg-green-500":"bg-blue-500"])},null,6)]),c("div",Pa,[(s(!0),i(v,null,k(t.assignees.slice(0,5),(e,t)=>(s(),i("div",{key:e.id,class:_(["w-6 h-6 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center text-xs font-medium",e.is_completed?"bg-green-500 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300"]),title:e.user?.name+(e.is_completed?" (bajarilgan)":"")},y(e.user?.name?.charAt(0)?.toUpperCase()),11,$a))),128)),t.assignees.length>5?(s(),i("div",Va," +"+y(t.assignees.length-5),1)):u("",!0)])])):t.subtasks_count>0?(s(),i("div",Ra,[c("div",Ma,[c("span",Ea,y(b(p)("todos.subtasks")),1),c("span",Fa,y(t.completed_subtasks_count)+"/"+y(t.subtasks_count),1)]),c("div",Na,[c("div",{style:T({width:`${t.progress}%`}),class:_(["h-full transition-all duration-300",100===t.progress?"bg-green-500":"bg-blue-500"])},null,6)])])):u("",!0),c("div",Xa,[t.due_date_formatted?(s(),i("div",{key:0,class:_(["flex items-center gap-1 text-xs",t.is_overdue?"text-red-500":"text-gray-500 dark:text-gray-400"])},[d(b(G),{class:"w-3.5 h-3.5"}),C(" "+y(t.due_date_formatted),1)],2)):(s(),i("div",za,y(b(p)("todos.no_deadline")),1)),"team"!==t.type&&t.assignee?(s(),i("div",Da,[c("div",Ia,y(t.assignee.name?.charAt(0)?.toUpperCase()),1)])):u("",!0)])],10,ha))),128)),0===ie(t.key)?(s(),i("div",Ba,[(s(),l(S(t.icon),{class:"w-8 h-8 mx-auto mb-2 opacity-50"})),c("p",Ja,y(b(p)("todos.no_tasks")),1)])):u("",!0)]),c("div",La,[c("button",{onClick:r[1]||(r[1]=e=>X()),class:"w-full flex items-center justify-center gap-2 py-2 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors"},[d(b(E),{class:"w-4 h-4"}),C(" "+y(b(p)("todos.add_task")),1)])])])),64))])])]),d(Se,{show:f.value,todo:j.value,"team-members":g.teamMembers,templates:g.templates,types:g.types,priorities:g.priorities,"panel-type":g.panelType,onClose:I,onSaved:Y},null,8,["show","todo","team-members","templates","types","priorities","panel-type"]),d(Ze,{show:h.value,todo:A.value,"panel-type":g.panelType,onClose:J,onSaved:Z},null,8,["show","todo","panel-type"]),d(Gt,{show:w.value,todo:O.value,"team-members":g.teamMembers,types:g.types,priorities:g.priorities,onClose:Q,onUpdate:ee,onDelete:te,onToggle:ae,onToggleSubtask:re,onAddSubtask:oe},null,8,["show","todo","team-members","types","priorities"])],64))}},[["__scopeId","data-v-2a143832"]]);export{Ha as T};
