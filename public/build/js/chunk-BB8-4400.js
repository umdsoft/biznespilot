import{b as e,a as t}from"./chunk-DKkye6wf.js";import{i as a,j as s,_ as l}from"./chunk-Dm-LAqtr.js";import{u as r}from"./app-DFslr8vl.js";import{r as n,o,e as i,v as u,x as d,V as c,D as v,E as p,F as f,G as x,A as h,L as m,H as y,z as b,M as g}from"./chunk-7Urb0kxg.js";const k={key:0,class:"pt-3 mt-3 border-t border-gray-200 dark:border-gray-700"},w={key:0,class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},j={key:1,class:"mb-2"},_={class:"px-3 mb-2 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},I={class:"flex-1"},M={key:0,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},A={key:1,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},L={key:2,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-red-500 text-white rounded-full animate-pulse"},z={key:3,class:"ml-auto inline-flex items-center justify-center min-w-[20px] h-5 px-1.5 text-xs font-bold bg-orange-500 text-white rounded-full"},B={__name:"BusinessLayout",props:{title:{type:String,default:""}},setup(B){const{t:D}=r(),E=e(),F=a,G=n(0),H=n(0),S=n({total:0,overdue:0}),V=n({total:0,overdue:0});let W=null,$=null,q=null,C=null;const J=async()=>{try{const e=await t.get("/business/inbox",{headers:{Accept:"application/json"}});void 0!==e.data.stats?.unread?.total&&(G.value=e.data.stats.unread.total)}catch(e){e.response}},K=async()=>{try{const e=await t.get("/business/api/sales/stats");void 0!==e.data?.new_leads&&(H.value=e.data.new_leads)}catch(e){e.response}},N=async()=>{try{const e=await t.get("/business/tasks/stats");e.data&&(S.value={total:e.data.total||0,overdue:e.data.overdue||0})}catch(e){e.response}},O=async()=>{try{const e=await t.get("/business/todos/api/dashboard");e.data?.stats&&(V.value={total:e.data.stats.total_today||0,overdue:e.data.stats.overdue||0})}catch(e){e.response}},P=e=>{const t=E.url;return e.exact?t===e.href||t===e.href+"/":e.activeMatch?e.activeMatch(t):t.startsWith(e.href)};return o(()=>{J(),K(),N(),O(),W=setInterval(J,1e4),$=setInterval(K,15e3),q=setInterval(N,1e4),C=setInterval(O,3e4)}),i(()=>{W&&clearInterval(W),$&&clearInterval($),q&&clearInterval(q),C&&clearInterval(C)}),(e,t)=>(p(),u(l,{title:B.title||h(D)("layout.home"),config:h(F)},{navigation:d(()=>[(p(!0),v(f,null,x(h(F).navigation,(e,t)=>(p(),v(f,{key:t},[t>0?(p(),v("div",k,[e.title?(p(),v("p",w,y(e.title),1)):m("",!0)])):e.title?(p(),v("div",j,[b("p",_,y(e.title),1)])):m("",!0),(p(!0),v(f,null,x(e.items,e=>(p(),u(s,{key:e.href,href:e.href,active:P(e)},{default:d(()=>[(p(),u(g(e.icon),{class:"w-5 h-5 mr-3"})),b("span",I,y(e.label),1),"/business/inbox"===e.href&&G.value>0?(p(),v("span",M,y(G.value>99?"99+":G.value),1)):m("",!0),"/business/sales"===e.href&&H.value>0?(p(),v("span",A,y(H.value>99?"99+":H.value),1)):m("",!0),"/business/tasks"===e.href&&S.value.overdue>0?(p(),v("span",L,y(S.value.overdue>99?"99+":S.value.overdue),1)):m("",!0),"/business/todos"===e.href&&V.value.overdue>0?(p(),v("span",z,y(V.value.overdue>99?"99+":V.value.overdue),1)):m("",!0)]),_:2},1032,["href","active"]))),128))],64))),128))]),default:d(()=>[c(e.$slots,"default")]),_:3},8,["title","config"]))}};export{B as _};
